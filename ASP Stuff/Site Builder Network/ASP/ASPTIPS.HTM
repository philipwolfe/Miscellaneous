
<HTML>
<HEAD>


<TITLE>SBN Server: ASP Tips</TITLE>

<META NAME="Description" CONTENT="Site Builder Network Magazine article by Nancy Cluts, providing tips on improving ASP performance" />
<META NAME="Keywords" CONTENT="asp, global.asa, html, object tag" />
<META NAME="Robots" CONTENT="All" />

<META NAME="Author" CONTENT="Nancy Cluts" />
<META NAME="Posted" CONTENT="" />
<META NAME="Updated" CONTENT="07/27/1998" />

<META NAME="MS.LOCALE" CONTENT="EN-US" />
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1" />

<LINK REL="stylesheet" TYPE="text/css" HREF="../../../sitebuilder/shared/css/navbar.css" />
<LINK REL="stylesheet" TYPE="text/css" HREF="../../../sitebuilder/shared/css/ie4-wks.css" />


<SCRIPT LANGUAGE="JavaScript"><!--

// -----------------------------------------------------------
// Client-side BrowserData constructor
// Populated using data from server-side oBD object to avoid redundancy
// -----------------------------------------------------------

function BrowserData()
{
this.userAgent = "Mozilla/4.0 (compatible; MSIE 4.01; Windows NT)";
this.browser = "MSIE";
this.majorVer = "4";
this.minorVer = "01";
this.betaVer = 0;
this.platform = "NT";
this.getsNavBar = true;
this.doesActiveX = true;

}
var oBD = new BrowserData();

//--></SCRIPT>

<SCRIPT LANGUAGE="Javascript"><!--

// -----------------------------------------------------------
// window_load()
// Container function for load.
// -----------------------------------------------------------

function window_load()
{
if (oBD.getsNavBar)
{
if ("function" == typeof(InitNavLinks)) InitNavLinks();
if ("function" == typeof(CheckToTop)) CheckToTop();
}
}
window.onload = window_load;

//--></SCRIPT>

</HEAD>

<BODY TOPMARGIN="0" LEFTMARGIN="0" MARGINHEIGHT="0" MARGINWIDTH="0" BGCOLOR="#FFFFFF">


<TABLE WIDTH="100%" CELLPADDING="0" CELLSPACING="0" BORDER="0">
<TR>
<TD ROWSPAN="2" WIDTH="460" VALIGN="top"><NOBR><A HREF="http://www.microsoft.com/" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/home.gif" WIDTH="103" HEIGHT="21" ALT="Microsoft Home" BORDER="0"></A><A HREF="http://www.microsoft.com/PRODUCTS/DEFAULT.asp?DIVISIONID="10"" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/prod.gif" WIDTH="81" HEIGHT="21" ALT="products" BORDER="0"></A><A HREF="http://www.microsoft.com/search/default.asp" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/search.gif" WIDTH="68" HEIGHT="21" ALT="search" BORDER="0"></A><A HREF="http://www.microsoft.com/ISAPI/GOSUPPORT.asp?TARGET=/SUPPORT/" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/support.gif" WIDTH="74" HEIGHT="21" ALT="support" BORDER="0"></A><A HREF="http://www.microsoft.com/referral/default.asp" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/shop.gif" WIDTH="55" HEIGHT="21" ALT="shop" BORDER="0"></A><A HREF="http://www.microsoft.com/ISAPI/GOREGWIZ.asp?TARGET=/REGWIZ/REGWIZ.asp" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/write.gif" WIDTH="78" HEIGHT="21" ALT="Write Us" BORDER="0"></A><IMG SRC="../../../library/images/gifs/toolbar/spacer.gif" WIDTH="1" HEIGHT="21" ALT="" BORDER="0"></NOBR></TD>
<TD BGCOLOR="#000000" WIDTH="100%" HEIGHT="20">&nbsp;</TD>
<TD ROWSPAN="2" WIDTH="91" ALIGN="right" VALIGN="top"><A HREF="http://www.microsoft.com/" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/msft.gif" WIDTH="91" HEIGHT="21" ALT="Microsoft Home" BORDER="0"></A></TD>
</TR>
<TR>
<TD COLSPAN="3" BGCOLOR="#FFFFFF" WIDTH="100%" HEIGHT="1"></TD>
</TR>
</TABLE>

<TABLE ID="tblNavBar" BORDER="0" CELLPADDING="0" CELLSPACING="0">
<TR VALIGN="top">
<TD CLASS="clsSBNLogo" TITLE="SBN Home" HEIGHT="34" WIDTH="90"><A HREF="/sitebuilder/default.htm" TARGET="_top" expNoTOC="true"><IMG HEIGHT="34" WIDTH="90" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/sbnbrand2.gif" ALT="SBN Home" /></A></TD>
<TD CLASS="clsNavBarItem" expItemNum="1">Magazine<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD>&nbsp;|&nbsp;</TD>
<TD CLASS="clsNavBarItem" expItemNum="2">Community<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD>&nbsp;|&nbsp;</TD>
<TD CLASS="clsNavBarItem" expItemNum="3">Workshop<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD>&nbsp;|&nbsp;</TD>
<TD CLASS="clsNavBarItem" expItemNum="4">Tools&nbsp;&amp;&nbsp;Samples<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD>&nbsp;|&nbsp;</TD>
<TD CLASS="clsNavBarItem" expItemNum="5">Training<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD>&nbsp;|&nbsp;</TD>
<TD CLASS="clsNavBarItem" expItemNum="6">Site&nbsp;Info<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD WIDTH="100%"></TD>
</TR>
</TABLE>


<TABLE ID="tblNavLinks" CLASS="clsNavLinks" CELLPADDING="0" CELLSPACING="0" BORDER="0" WIDTH="100%">
<TR>
<TD COLSPAN="2" HEIGHT="8"><IMG WIDTH="1" HEIGHT="8" SRC="../../../sitebuilder/shared/graphics/trans.gif"></TD>
<TD ROWSPAN="2"><A HREF="../../../workshop/default.htm" TARGET="_top"><IMG ALIGN="right" HEIGHT="30" WIDTH="106" BORDER="0" ALT="Click to return to the Workshop home page" SRC="../../../workshop/graphics/wrkbrand2.gif" /></A><BR /></TD>
</TR>
<TR>
<TD ROWSPAN="2">
<A HREF="../../../workshop/server/pg00164.htm"><IMG HEIGHT="32" WIDTH="31" HSPACE="25" BORDER="0" ALT="Click to return to the Server Technologies home page" SRC="../../../workshop/graphics/icons//server.gif" /></A>
</TD>
<TD>
<TABLE CELLPADDING="3" CELLSPACING="0" BORDER="0">
<TR>

<TD><A ID="lnkShowImg" HREF="../../../workshop/server/toc.htm" TARGET="_top"><IMG ID="imgShow" CLASS="clsLeftMenu" HEIGHT="15" WIDTH="18" BORDER="0" SRC="../../../workshop/graphics/icons/nl-show-0.gif" ALT="" /></A><BR></TD>
<TD NOWRAP><A ID="lnkShowText" CLASS="clsLeftMenu" HREF="../../../workshop/server/toc.htm" TARGET="_top">show toc</A> &nbsp;&nbsp; </TD>

<TD><A ID="lnkSyncImg" HREF="../../../workshop/pg00572.htm#/workshop/server/asp/asptips.htm" TARGET="_top"><IMG ID="imgSync" CLASS="clsLeftMenu" HEIGHT="15" WIDTH="18" BORDER="0" SRC="../../../workshop/graphics/icons/nl-sync-0.gif" ALT="" /></A><BR></TD>
<TD NOWRAP><A ID="lnkSyncText" CLASS="clsLeftMenu" HREF="../../../workshop/pg00572.htm#/workshop/server/asp/asptips.htm" TARGET="_top">sync toc</A> &nbsp;&nbsp; </TD>

<TD><A ID="lnkSearchImg" HREF="http://www.microsoft.com/isapi/gosearch.asp?TARGET=/dev/web/default.asp" TARGET="_top"><IMG ID="imgSearch" CLASS="clsLeftMenu" HEIGHT="15" WIDTH="18" BORDER="0" SRC="../../../workshop/graphics/icons/nl-search-0.gif" ALT="" /></A><BR></TD>
<TD NOWRAP><A ID="lnkSearchText" CLASS="clsLeftMenu" HREF="http://www.microsoft.com/isapi/gosearch.asp?TARGET=/dev/web/default.asp" TARGET="_top">search</A> &nbsp;&nbsp; </TD>

<TD><A ID="lnkIndexImg" HREF="../../../workshop/index/pg00001.htm"><IMG ID="imgIndex" CLASS="clsLeftMenu" HEIGHT="15" WIDTH="18" BORDER="0" SRC="../../../workshop/graphics/icons/nl-index-0.gif" ALT="" /></A><BR></TD>
<TD NOWRAP><A ID="lnkIndexText" CLASS="clsLeftMenu" HREF="../../../workshop/index/pg00001.htm">index</A> &nbsp;&nbsp; </TD>

</TR>
</TABLE>
</TD>
</TR>
<TR>
<TD COLSPAN="2" WIDTH="100%">
<TABLE CELLPADDING="2" CELLSPACING="0" BORDER="0">
<TR>
<TD>&nbsp;</TD>
</TR>
</TABLE>
</TD>
</TR>
</TABLE>

<BR CLEAR="all" />
<DIV CLASS="clsBucketBranch"><A HREF="../../../workshop/pg00004.htm" TARGET="_top">Workshop</A>&nbsp;&nbsp;|&nbsp;&nbsp;<A HREF="../../../workshop/pg00571.htm#/workshop/server/pg00164.htm" TARGET="_top">Server Technologies</A></DIV>

<DIV CLASS="clsDocBody">

<!-- DOCUMENT CONTENT START -->

<H1><A NAME="ASP" IDX_TYPE="sbngen" IDX_CONCEPT="stopindex;ASP, 15 tips">15 ASP Tips to Improve Performance and Style</A></H1>
<HR SIZE="1" />
<P>Nancy Cluts
<BR>Developer Technology Engineer<br>Microsoft Corporation
<P>Updated: October 8, 1997 
<P><a href="asptips.zip"><IMG SRC="../../../sitebuilder/graphics/icodownl.gif" WIDTH=16 HEIGHT=20 BORDER=0 ALT="Download"> Download this document in Microsoft Word (.DOC) format (zipped, 8.7K)</a>.
<P> 
<P><b>Contents</b>
<br><a href="asptips.htm#intro">Introduction</a>
<br><a href="asptips.htm#TIP1">Tip 1: Use GLOBAL.ASA for Application Level Files</a>
<br><a href="asptips.htm#TIP2">Tip 2: Remove HTML Comments from Production Code</a>
<br><a href="asptips.htm#TIP3">Tip 3: Batch Response.Write Statements</a>
<br><a href="asptips.htm#TIP4">Tip 4: Instantiate Objects Using the &lt;OBJECT&gt; Tag</a>
<br><a href="asptips.htm#TIP5">Tip 5: Use Local Variables Whenever Possible</a>
<br><a href="asptips.htm#TIP6">Tip 6: Avoid Re-Dimensioning Arrays</a>
<br><a href="asptips.htm#TIP7">Tip 7: Avoid &quot;Public&quot; Variables</a>
<br><a href="asptips.htm#TIP8">Tip 8: Use Literal Paths</a>
<br><a href="asptips.htm#TIP9">Tip 9: Use the &quot;Dictionary&quot; Object</a>
<br><a href="asptips.htm#TIP10">Tip 10: Take Advantage of Your Browser's Validation Abilities</a>
<br><a href="asptips.htm#TIP11">Tip 11: Avoid Using Server Variables</a>
<br><a href="asptips.htm#TIP12">Tip 12: Turn On &quot;Option Explicit&quot;</a>
<br><a href="asptips.htm#TIP13">Tip 13: Copy Collections Values to Local Variables</a>
<br><a href="asptips.htm#TIP14">Tip 14: Be Careful of the Session Object</a>
<br><a href="asptips.htm#TIP15">Tip 15: Do Performance Testing</a>

<a name="intro"></a><h2>Introduction</h2>
<P>
If you are anything like me, you probably enjoy tinkering with the latest technology. Staying on that bleeding edge can be a great kick, but it can also leave you scratching your head. You may have come up with something totally cool for your Web site -- but since no other Web site has the feature, you end up wondering where to get help.
<P>The Site Builder Web site is a lot like that. We try to use as much of the newest technology as possible. This makes our Web site very innovative, but it can also (sometimes) make it slow. Like you, we are always looking for ways to improve the performance of our Web pages and to improve our coding style. Recently, we were lucky enough to get some great suggestions from people on the Internet Information Server (IIS) team, including ways to improve our ASP performance and style tips. Immediately, we (Sue and I fired off e-mail, but I was first) thought we should pass this information on to our friends (that would be you). The suggestions listed in this article have been tested on  <A HREF="http://www.microsoft.com/isapi/gohome.asp?TARGET=/" target="_top">home.microsoft.com</A> <IMG SRC="../../../sitebuilder/graphics/leave-site.gif" WIDTH="17" HEIGHT="11" BORDER="0" ALT="Non-SBN link">, and have been very successful. And if you choose to only follow one or two of the listed tips, follow Tip 1 and Tip 9. The combination of these two tips caused the most significant speed improvement (twice as fast) on  <A HREF="http://www.microsoft.com/isapi/gohome.asp?TARGET=/" target="_top">home.microsoft.com</A> <IMG SRC="../../../sitebuilder/graphics/leave-site.gif" WIDTH="17" HEIGHT="11" BORDER="0" ALT="Non-SBN link">. So, if you need to be judicious about your time and effort (and who doesn't?), implement tips 1 and 9.
<P>
<P> <A HREF="asptips.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h2><A NAME="TIP1" IDX_TYPE="sbngen" IDX_CONCEPT="GLOBAL.ASA;ASP, GLOBAL.ASA">Tip 1: Use GLOBAL.ASA for Application Level Files</A>
</h2>

  <P>Instead of using the ASP FileSystem Object to read files on a page, load the file(s) into an Application level array in GLOBAL.ASA. GLOBAL.ASA is an optional file in which you can specify event scripts and declare objects that have session or application scope. GLOBAL.ASA is not displayed to users but stores application-global event information and objects. Then use your page to reference the Application level array with the data in it.  This means the read from the file happens once per server instead of once per page per user.  You can run a separate .ASP file to refresh the contents of the Application level array. You may also want to consider using the <b>Dictionary</b> object (see tip 9). Remember, this tip gives you the greatest bang for the buck, so if you want to speed things up, take the advice given in this tip.
<P>
<P>
Confused about how to implement this? <P>
If you are a script developer, you have to use the FileSystem Object to read files into an array or into a <b>Dictionary</b> object. Something that might not immediately occur to you is to read files in your GLOBAL.ASA file and to put the array (the one you are reading the files into) or the <b>Dictionary</b> object into Application state. This lets users access the information in the array or <b>Dictionary</b> object without having to retrieve the information each time via an .ASP file request.
<P>I know what you are thinking: "But what if the cached content needs to be updated? I bet I can't use it then!" Wrong. You can. If the contents of the cached information need to change, you can call into an Administrator-access-only .ASP file containing script that can do an <B>Application.Lock</B> command, update the cached information in the array or <b>Dictionary</b> object, and finally do an <b>Application.Unlock</b> command. 

<P>
<P> <A HREF="asptips.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h2><a name="TIP2"></a><A NAME="update_1" IDX_TYPE="sbngen" IDX_CONCEPT="ASP, HTML comments">Tip 2: Remove HTML Comments from Production Code</A>
</h2>



<P>That's right. If it was hard to write, it should be hard to understand. Only kidding, but it does seem that if you remove all HTML comments (script comments are fine), large sections of HTML text can be block copied to the client.  As a result, your script will run faster on IIS 3.0 (Under IIS 4.0, HTML comments no longer cause performance degradation). Of course, for your own edification (and to keep code maintainence from being a nightmare) you might want to keep a special README file containing notes on what you did and why -- or you might want to consider keeping comments in any place where the code seems "obscure." You can also keep a copy of your source code with the comments and strip the comments out of a separate copy for production. This way, you can keep your comments to yourself.
<P>
In production of applications that use C or C++ code, developers generally maintain source code which can be compiled into two versions: the debug version and the retail version. Most tools for creating applications using C++, such as Microsoft Visual C++,  have this functionality built in. This would be a nice addition to HTML tools.


<P> <A HREF="asptips.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h2><A NAME="TIP3" IDX_TYPE="sbngen" IDX_CONCEPT="ASP, batch Response.Write statements">Tip 3: Batch Response.Write Statements</A>
</h2>
<P>If you use the &lt;%=&#133;%&gt; syntax to write in multiple places in your code, consider "batching" those writes by replacing multiple, interspersed &lt;%=&#133;%&gt; writes with one Response.Write statement.  While you are making that change, take a look at how you have your HTML code with regard to your script. Try not to intersperse HTML and script too much; instead, try to have blocks of script and blocks of HTML.
<P> <A HREF="asptips.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h2><A NAME="TIP4" IDX_TYPE="sbngen" IDX_CONCEPT="OBJECT tag, for instantiating objects">Tip 4: Instantiate Objects Using the &lt;OBJECT&gt; Tag</A>
</h2>
<P>If you need to refer to objects that may not be used, instantiate them by using the <b>&lt;OBJECT&gt;</b> tag rather than using <b>Server.CreateObject</b>.  Using <b>Server.CreateObject</b> causes the object to be created immediately. If you don't use that object later, you end up wasting resources.
<P> <A HREF="asptips.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h2><A NAME="TIP5" IDX_TYPE="sbngen" IDX_CONCEPT="ASP, local variables">Tip 5: Use Local Variables Whenever Possible</A></h2>

<I>(The following new tip replaces one previously published, "Use a Single Line for Dim Variables," which contained incorrect information):</i>

<BR>
<P>Local variables are variables that reside within subroutines and functions (this is known as local scope). These variables are compiled into numeric references and put in a table. Local variable references can be resolved at compile time. Global variables are resolved at run time. This means that local-variable access is many times faster than global-variable access. Also, undimensioned global variables are the slowest of all -- the first time an undimensioned global variable is used, the entire object model is searched for an object with that named property before a new one is created.
<P>Here's an example of some fairly common code:
<P>
<PRE class=clsCode>Foo.bar.blah.baz = Foo.bar.blah.qaz(1)
If Foo.bar.blah.zaq = Foo.bar.blah.abc then
</PRE>
<P>When this code runs, here's what happens:
<OL>
1)
The variable <i>Foo</i> is resolved as a global object. 
</OL>
<OL>
2) The variable <i>bar</i> is resolved globally as a member of <i>Foo</i>. 
</OL>
<OL>3) The variable <i>blah</i> is resolved globally as a member of <i>Foo.bar</i>.

</OL>
<OL>
4) The variable <i>qaz</i> is resolved globally as a member of <i>foo.bar.blah</i>.

</OL>
<OL>
5) Invoke <i>Foo.bar.blah.quaz(1)</i>.

</OL>
<OL>
6) Do steps 1 through 3 <b>again</b>. The system does not know if the call to <i>qaz</i> changed the object model, so steps 1 through 3 must be done again to resolve <i>baz</i>.

</OL>
<OL>
7) Resolve <i>baz</i> as a member of <i>Foo.bar.blah</i>.  Do the property put.

</OL>
<OL>
8) Do steps 1 through  3 again and resolve <i>zaq</i>.

</OL>
<OL>
9) Do steps 1 through 3 yet another time and resolve <i>abc</i>.

</OL>As you can see, this is terribly inefficient (and way slow). The fast way to write this code in Visual Basic Scripting Edition (VBScript) is:
<P>
<PRE class=clsCode>Set myobj = Foo.bar.blah ' do the resolution of blah ONCE
Myobj.baz = myobj.qaz(1)
If Myobj.zaq = Myobj.abc then

</PRE>
<P> <A HREF="asptips.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<P>
<h2><A NAME="TIP6" IDX_TYPE="sbngen" IDX_CONCEPT="ASP, re-dimensioning arrays;Arrays, re-dimensioning">Tip 6: Avoid Re-Dimensioning Arrays</A>
</h2>


<P>While we're on the subject of <b>Dim</b>: Try to avoid <b>Redim</b>-ing arrays. You would use <b>Redim</b> to reset the size of the array. As far as performance is concerned, if you have a machine that is constrained by physical memory size,

 it's much better to set the initial dimension of the array in its worst-case scenario -- or to set the dimension to its optimal case and redim as necessary. 
This does not mean that you should just go out and allocate a couple megs of memory if you know you aren't going to need it. 

<p> The code below shows you gratuitous use of <b>Dim</b> and <b>Redim</b>.
<P>
<PRE class=clsCode>&lt;% 
dim MyArray()
Redim MyArrray(2)
MyArray(0) = "hello"
MyArray(1) = "good-bye"
.
.
.
some other code where you end up needing 
more space happens then ...
Redim Preserve MyArray(5)
MyArray(2) = "more stuff"
MyArray(3) = "even more stuff"
MyArray(4) = "yet more stuff"
%&gt;
</PRE>
<P>It is far better to simply <b>Dim</b> the array to the correct size (in this case 5) initially, then <b>Redim</b> the array to make it larger.   You may waste a little memory (if you don't end up using all of the elements), but the gain will be speed.
<P> <A HREF="asptips.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h2><A NAME="TIP7" IDX_TYPE="sbngen" IDX_CONCEPT="ASP, public variables">Tip 7: Avoid &quot;Public&quot; Variables</A>
</h2>
<P>Don't use variables defined as <b>Public</b>.  If you are writing VBScript or accessing variables in your ActiveX control or java applet, avoid using <b>Public</b> variables. 
The <B>Public</B> keyword is currently being investigated for future use, and since

  <b>Public</b> doesn't buy you anything, it's better to use <b>Dim</b>.

<P> <A HREF="asptips.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h2><A NAME="TIP8" IDX_TYPE="sbngen" IDX_CONCEPT="ASP, literal paths">Tip 8: Use Literal Paths</A>
</h2>
<P>Try to avoid <b>MapPath</b> if at all possible. Instead, use the literal path if you know it.  Using <b>MapPath</b> requires IIS to retreive the current server path, which means a special request to IIS -- which in turn means (you guessed it) decreased performance.
<P> <A HREF="asptips.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h2><A NAME="TIP9" IDX_TYPE="sbngen" IDX_CONCEPT="ASP, dictionary object">Tip 9: Use the &quot;Dictionary&quot; Object</A>
</h2>

<P>
The VBScript-provided <B>Dictionary</B> object provides fast look up and storage of arbitrary key-data pairs. The <B>Dictionary</B> object gives you access to items in the array by <B>key</B>,so it is faster to find things that aren't contiguous in memory (because you are specifying the key that you are using rather than having to know where in the array the object resides). If you have non-linear key-data that you need to search, it will be faster using the <B>Dictionary</B> object.
<P>
However, in the spirit of not throwing out the baby with the bath water, arrays provide a much faster lookup and storage of key-data pairs that are contiguous in memory. It is also important to note that indexing a dictionary is slower than indexing an array. You should choose the data structure that works best for you.
 
 <P> <A HREF="asptips.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h2><A NAME="TIP10" IDX_TYPE="sbngen" IDX_CONCEPT="ASP, browser validation">Tip 10: Take Advantage of Your Browser's Validation Abilities</A>
</h2>
<P>If you are running a smart browser, the browser is capable of doing some validation for you. Take advantage of this whenever you can. Then, perform validation via your scripting. When all else fails, then you can go ahead and access your database on the back-end. But remember, whenever you access that database that lives on the server, you are going to take a performance hit. This can be very expensive if you have several values in a form that you are validating. If you know that you will need to run some script on the client side, go ahead and move the code to the client side for faster performance. When you are running on the client, you have the processor(s) for your use; the server has to use its processing power for all of the requests it receives. 
<P>Another idea: If you are using a form that employs server-side scripting and has lots of conditional input, move that conditional code to the client's scripting engine - for example, VBScript or JScript.
 While this makes server code faster by skipping a browsecap and a conditional, it does send over the wire code that isn't necessarily needed. With a small script, this is probably a good choice. For bigger scripts, it might not be useful.
<P> <A HREF="asptips.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h2><A NAME="TIP11" IDX_TYPE="sbngen" IDX_CONCEPT="ASP, server variables">Tip 11: Avoid Using Server Variables</A>
</h2>
<P>Accessing server variables causes your Web site to make a special request to the server and collect all server variables, not just the one that you requested. This is akin to needing to retrieve a specific item in a folder that you have in that musty attic of yours. When you want that one item, you have to go to the attic to get the folder first, before you can access the item. This is the same thing that happens when you request a server variable, the performance hit occurs the first time you request a server variable. Subsequent requests for other server variables does not cause a performance hit. 
<P> <A HREF="asptips.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h2><A NAME="TIP12" IDX_TYPE="sbngen" IDX_CONCEPT="ASP, option explicit">Tip 12: Turn On &quot;Option Explicit&quot;</A>
</h2>

<P>Turn on the <b>Option Explicit</b> option in your .asp file. Unlike C, Visual Basic allows you to use variables without explicitly declaring them. Turning on this option helps to identify undefined variables - you will get an error message for undefined variables.
 Turning on Option Explicit makes undeclared local variables illegal. Undeclared local variables are as slow as global variables (about twice as slow as declared local variables). Turning on this option will help you find these slugs so that you can get them out of your code.

<P> <A HREF="asptips.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h2><A NAME="TIP13" IDX_TYPE="sbngen" IDX_CONCEPT="ASP, collections values">Tip 13: Copy Collections Values to Local Variables</A>
</h2>
<P>If there are collections values that you are using repeatedly, copy these values onto the client in the form of local variables. This saves you a look-up operation on the collection each time you use the value and will speed up your script.
<P> <A HREF="asptips.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h2><A NAME="TIP14" IDX_TYPE="sbngen" IDX_CONCEPT="ASP, session object">Tip 14: Be Careful of the Session Object</A>
</h2>
<P>You can use the <b>Session</b> object to store information that you may need for a particular user-session. Variables that are stored in the <b>Session </b>object are not discarded when the user jumps between pages in the application; instead, these variables persist for the entire user-session. The Web server automatically creates a <b>Session </b>object when a Web page from the application is requested by a user who does not already have a session. The server destroys the <b>Session </b>object when the session expires or is abandoned. To avoid this, you can turn off the <b>Session</b> feature; however, the <b>Session</b> feature can't be turned off on a per application basis in IIS 3.0. Turning it off for the entire server is faster but drops a lot of functionality. Instead, be very careful to use the <b>Session</b> object only when you really need to.
<P>If you use the <b>Session</b> object at all in your application, be sure to use it as soon as possible in order to avoid the <b>Session</b> object from being reset. In IIS 4.0, the session state can be enabled on a per-application basis and it can be disabled for specified .asp files.

<P> <A HREF="asptips.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h2><A NAME="TIP15" IDX_TYPE="sbngen" IDX_CONCEPT="ASP, performance testing">Tip 15: Do Performance Testing</A>
</h2>
<P>Yeah, you already knew this -- but I feel bad about telling you to scrap your HTML comments, and this is one way to redeem myself. Performance test your ASP-based applications. This will help you to keep an eye on performance and, of course, will prove that you have "style." Don't wait until you get the weekly "Slow as a slug" award for Web sites. Instead, run performance tests when you make significant changes to your .asp files. Heck, since you're testing all of your changes integrally (aren't you?), why not add a performance test to your daily testing? 
<P>


<P>
<P>






<!-- DOCUMENT CONTENT END -->

</DIV>

<DIV CLASS="clsDocBody">
<HR SIZE="1" />
<P><I>Did you find this article useful? Gripes? Compliments? Suggestions for other articles? <A TITLE="Go ahead. Make our day! Send us your thoughts." HREF="../../../sitebuilder/pg00562.htm" TARGET="_top">Write us!</A></I></P>
<P ID="pBackTop"><A HREF="asptips.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif" WIDTH="18" HEIGHT="8" BORDER="0" ALT="Back to top">Back to top</A></P>

<P CLASS="clsIncCpyRt">

</P>

&copy; <A CLASS="clsIncCpyRt" HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">1998 Microsoft Corporation. All rights reserved. Terms of use</A>.

<P>&nbsp;</P>
</DIV>
<SCRIPT LANGUAGE="JavaScript"><!--

function CheckToTop()
{
var eBody = document.body;
if (eBody.scrollHeight > eBody.offsetHeight) pBackTop.style.display = 'block';
}

//--></SCRIPT>

<DIV ID="divMenu1" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="../../../sitebuilder/magazine/default.htm">Magazine Home</DIV>
<DIV expURL="../../../sitebuilder/magazine/jane.htm">Ask Jane</DIV>
<DIV expURL="../../../sitebuilder/magazine/dude.htm">DHTML Dude</DIV>
<DIV expURL="../../../sitebuilder/magazine/xml.htm">Extreme XML</DIV>
<DIV expURL="../../../sitebuilder/magazine/starters.htm">For Starters</DIV>
<DIV expURL="../../../sitebuilder/magazine/hess.htm">More or Hess</DIV>
<DIV expURL="../../../sitebuilder/magazine/server.htm">Servin' It Up</DIV>
<DIV expURL="../../../sitebuilder/magazine/site.htm">Site Lights</DIV>
<DIV expURL="../../../sitebuilder/magazine/webmen.htm">Web Men Talking</DIV>
</DIV>
<DIV ID="divMenu2" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="http://www.microsoft.com/sbnmember/default.asp">Member Community Home</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/freebies/default.asp">Benefits: Freebies &amp; Discounts</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/promote/default.asp">Benefits: Promote Your Site</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/connect/default.asp">Benefits: Connect with Your Peers</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/glance-lev.asp">Benefits at a Glance</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/osig/default.asp">Online Special-Interest Groups</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/levels/member.asp">Your Membership</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/freebies/stores.asp">SBN Stores</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/apply/registration.asp">Join Now</DIV>
</DIV>
<DIV ID="divMenu3" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="../../../workshop/default.htm">Workshop Home</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/essentials/default.htm">Essentials</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/delivery/default.htm">Content &amp; Component Delivery</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/components/default.htm">Component Development</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/database/default.htm">Data Access &amp; Databases</DIV>
<DIV expURL="../../../workshop/design/default.htm">Design</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/author/default.htm">DHTML, HTML &amp; CSS</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/xml/default.htm">Extensible Markup Language (XML)</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/languages/default.htm">Languages &amp; Development Tools</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/messaging/default.htm">Messaging &amp; Collaboration</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/networking/default.htm">Networking, Protocols &amp; Data Formats</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/browser/default.htm">Reusing Browser Technology</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/security/default.htm">Security &amp; Cryptography</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/server/default.htm">Server Technologies</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/imedia/default.htm">Streaming &amp; Interactive Media</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/management/default.htm">Web Content Management</DIV>
<DIV expURL="../../../workshop/index/default.htm">Workshop Index</DIV>
</DIV>
<DIV ID="divMenu4" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="../../../gallery/default.htm">Tools &amp; Samples Home</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/gallery/tools/default.htm">Tools</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/gallery/samples/default.htm">Samples, Headers, Libs</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/gallery/images/default.htm">Images</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/gallery/sounds/default.htm">Sounds</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/gallery/stylesheets/default.htm">Style Sheets</DIV>
<DIV expURL="http://www.microsoft.com/typography/fontpack/win.htm">Web Fonts</DIV>
</DIV>
<DIV ID="divMenu5" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="../../../devtraining/default.htm">Training Home</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/seminars/default.htm">SBN Live Seminars</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/chat/default.htm">SBN Live Chats</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/atec.htm">Courses</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/peer/default.htm">Peer Support</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/mastering.htm">CD-ROM Training</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/books_kits.htm">Books & Training Kits</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/mscert/default.htm">Certification</DIV>
</DIV>
<DIV ID="divMenu6" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="../../../sitebuilder/default.htm">SBN Home</DIV>
<DIV expURL="../../../sitebuilder/siteinfo/newtosite.htm">New to SBN?</DIV>
<DIV expURL="../../../sitebuilder/whatsnew.htm">What's New on SBN</DIV>
<DIV expURL="../../../sitebuilder/siteinfo/sitemap.htm">Site Map</DIV>
<DIV expURL="http://www.microsoft.com/isapi/gosearch.asp?TARGET=/dev/web/default.asp">Site Search</DIV>
<DIV expURL="../../../sitebuilder/siteinfo/glossary/default.htm">Glossary</DIV>
<DIV expURL="../../../sitebuilder/write-us.htm">Write Us</DIV>
<DIV expURL="../../../sitebuilder/siteinfo/about.htm">About This Site</DIV>
</DIV>
<SCRIPT LANGUAGE="JavaScript" SRC="../../../sitebuilder/shared/js/navbar.js"></SCRIPT> 
<SCRIPT LANGUAGE="JavaScript" SRC="../../../sitebuilder/shared/js/navlinks.js"></SCRIPT>


</BODY>
</HTML>
