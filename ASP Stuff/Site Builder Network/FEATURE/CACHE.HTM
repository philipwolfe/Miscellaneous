
<HTML>
<HEAD>


<TITLE>SBN Server: Got Any Cache?</TITLE>

<META NAME="Description" CONTENT="Got Any Cache? Why and how to cache data on the server." />
<META NAME="Keywords" CONTENT="data caching, caching on the server" />
<META NAME="Robots" CONTENT="All" />

<META NAME="Author" CONTENT="Nancy Cluts" />
<META NAME="Posted" CONTENT="" />
<META NAME="Updated" CONTENT="07/27/1998" />

<META NAME="MS.LOCALE" CONTENT="EN-US" />
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1" />

<LINK REL="stylesheet" TYPE="text/css" HREF="../../../sitebuilder/shared/css/navbar.css" />
<LINK REL="stylesheet" TYPE="text/css" HREF="../../../sitebuilder/shared/css/ie4-wks.css" />


<SCRIPT LANGUAGE="JavaScript"><!--

// -----------------------------------------------------------
// Client-side BrowserData constructor
// Populated using data from server-side oBD object to avoid redundancy
// -----------------------------------------------------------

function BrowserData()
{
this.userAgent = "Mozilla/4.0 (compatible; MSIE 4.01; Windows NT)";
this.browser = "MSIE";
this.majorVer = "4";
this.minorVer = "01";
this.betaVer = 0;
this.platform = "NT";
this.getsNavBar = true;
this.doesActiveX = true;

}
var oBD = new BrowserData();

//--></SCRIPT>

<SCRIPT LANGUAGE="Javascript"><!--

// -----------------------------------------------------------
// window_load()
// Container function for load.
// -----------------------------------------------------------

function window_load()
{
if (oBD.getsNavBar)
{
if ("function" == typeof(InitNavLinks)) InitNavLinks();
if ("function" == typeof(CheckToTop)) CheckToTop();
}
}
window.onload = window_load;

//--></SCRIPT>

</HEAD>

<BODY TOPMARGIN="0" LEFTMARGIN="0" MARGINHEIGHT="0" MARGINWIDTH="0" BGCOLOR="#FFFFFF">


<TABLE WIDTH="100%" CELLPADDING="0" CELLSPACING="0" BORDER="0">
<TR>
<TD ROWSPAN="2" WIDTH="460" VALIGN="top"><NOBR><A HREF="http://www.microsoft.com/" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/home.gif" WIDTH="103" HEIGHT="21" ALT="Microsoft Home" BORDER="0"></A><A HREF="http://www.microsoft.com/PRODUCTS/DEFAULT.asp?DIVISIONID="10"" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/prod.gif" WIDTH="81" HEIGHT="21" ALT="products" BORDER="0"></A><A HREF="http://www.microsoft.com/search/default.asp" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/search.gif" WIDTH="68" HEIGHT="21" ALT="search" BORDER="0"></A><A HREF="http://www.microsoft.com/ISAPI/GOSUPPORT.asp?TARGET=/SUPPORT/" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/support.gif" WIDTH="74" HEIGHT="21" ALT="support" BORDER="0"></A><A HREF="http://www.microsoft.com/referral/default.asp" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/shop.gif" WIDTH="55" HEIGHT="21" ALT="shop" BORDER="0"></A><A HREF="http://www.microsoft.com/ISAPI/GOREGWIZ.asp?TARGET=/REGWIZ/REGWIZ.asp" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/write.gif" WIDTH="78" HEIGHT="21" ALT="Write Us" BORDER="0"></A><IMG SRC="../../../library/images/gifs/toolbar/spacer.gif" WIDTH="1" HEIGHT="21" ALT="" BORDER="0"></NOBR></TD>
<TD BGCOLOR="#000000" WIDTH="100%" HEIGHT="20">&nbsp;</TD>
<TD ROWSPAN="2" WIDTH="91" ALIGN="right" VALIGN="top"><A HREF="http://www.microsoft.com/" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/msft.gif" WIDTH="91" HEIGHT="21" ALT="Microsoft Home" BORDER="0"></A></TD>
</TR>
<TR>
<TD COLSPAN="3" BGCOLOR="#FFFFFF" WIDTH="100%" HEIGHT="1"></TD>
</TR>
</TABLE>

<TABLE ID="tblNavBar" BORDER="0" CELLPADDING="0" CELLSPACING="0">
<TR VALIGN="top">
<TD CLASS="clsSBNLogo" TITLE="SBN Home" HEIGHT="34" WIDTH="90"><A HREF="/sitebuilder/default.htm" TARGET="_top" expNoTOC="true"><IMG HEIGHT="34" WIDTH="90" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/sbnbrand2.gif" ALT="SBN Home" /></A></TD>
<TD CLASS="clsNavBarItem" expItemNum="1">Magazine<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD>&nbsp;|&nbsp;</TD>
<TD CLASS="clsNavBarItem" expItemNum="2">Community<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD>&nbsp;|&nbsp;</TD>
<TD CLASS="clsNavBarItem" expItemNum="3">Workshop<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD>&nbsp;|&nbsp;</TD>
<TD CLASS="clsNavBarItem" expItemNum="4">Tools&nbsp;&amp;&nbsp;Samples<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD>&nbsp;|&nbsp;</TD>
<TD CLASS="clsNavBarItem" expItemNum="5">Training<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD>&nbsp;|&nbsp;</TD>
<TD CLASS="clsNavBarItem" expItemNum="6">Site&nbsp;Info<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD WIDTH="100%"></TD>
</TR>
</TABLE>


<TABLE ID="tblNavLinks" CLASS="clsNavLinks" CELLPADDING="0" CELLSPACING="0" BORDER="0" WIDTH="100%">
<TR>
<TD COLSPAN="2" HEIGHT="8"><IMG WIDTH="1" HEIGHT="8" SRC="../../../sitebuilder/shared/graphics/trans.gif"></TD>
<TD ROWSPAN="2"><A HREF="../../../workshop/default.htm" TARGET="_top"><IMG ALIGN="right" HEIGHT="30" WIDTH="106" BORDER="0" ALT="Click to return to the Workshop home page" SRC="../../../workshop/graphics/wrkbrand2.gif" /></A><BR /></TD>
</TR>
<TR>
<TD ROWSPAN="2">
<A HREF="../../../workshop/server/pg00164.htm"><IMG HEIGHT="32" WIDTH="31" HSPACE="25" BORDER="0" ALT="Click to return to the Server Technologies home page" SRC="../../../workshop/graphics/icons//server.gif" /></A>
</TD>
<TD>
<TABLE CELLPADDING="3" CELLSPACING="0" BORDER="0">
<TR>

<TD><A ID="lnkShowImg" HREF="../../../workshop/server/toc.htm" TARGET="_top"><IMG ID="imgShow" CLASS="clsLeftMenu" HEIGHT="15" WIDTH="18" BORDER="0" SRC="../../../workshop/graphics/icons/nl-show-0.gif" ALT="" /></A><BR></TD>
<TD NOWRAP><A ID="lnkShowText" CLASS="clsLeftMenu" HREF="../../../workshop/server/toc.htm" TARGET="_top">show toc</A> &nbsp;&nbsp; </TD>

<TD><A ID="lnkSyncImg" HREF="../../../workshop/pg01083.htm#/workshop/server/feature/cache.htm" TARGET="_top"><IMG ID="imgSync" CLASS="clsLeftMenu" HEIGHT="15" WIDTH="18" BORDER="0" SRC="../../../workshop/graphics/icons/nl-sync-0.gif" ALT="" /></A><BR></TD>
<TD NOWRAP><A ID="lnkSyncText" CLASS="clsLeftMenu" HREF="../../../workshop/pg01083.htm#/workshop/server/feature/cache.htm" TARGET="_top">sync toc</A> &nbsp;&nbsp; </TD>

<TD><A ID="lnkSearchImg" HREF="http://www.microsoft.com/isapi/gosearch.asp?TARGET=/dev/web/default.asp" TARGET="_top"><IMG ID="imgSearch" CLASS="clsLeftMenu" HEIGHT="15" WIDTH="18" BORDER="0" SRC="../../../workshop/graphics/icons/nl-search-0.gif" ALT="" /></A><BR></TD>
<TD NOWRAP><A ID="lnkSearchText" CLASS="clsLeftMenu" HREF="http://www.microsoft.com/isapi/gosearch.asp?TARGET=/dev/web/default.asp" TARGET="_top">search</A> &nbsp;&nbsp; </TD>

<TD><A ID="lnkIndexImg" HREF="../../../workshop/index/pg00001.htm"><IMG ID="imgIndex" CLASS="clsLeftMenu" HEIGHT="15" WIDTH="18" BORDER="0" SRC="../../../workshop/graphics/icons/nl-index-0.gif" ALT="" /></A><BR></TD>
<TD NOWRAP><A ID="lnkIndexText" CLASS="clsLeftMenu" HREF="../../../workshop/index/pg00001.htm">index</A> &nbsp;&nbsp; </TD>

</TR>
</TABLE>
</TD>
</TR>
<TR>
<TD COLSPAN="2" WIDTH="100%">
<TABLE CELLPADDING="2" CELLSPACING="0" BORDER="0">
<TR>
<TD>&nbsp;</TD>
</TR>
</TABLE>
</TD>
</TR>
</TABLE>

<BR CLEAR="all" />
<DIV CLASS="clsBucketBranch"><A HREF="../../../workshop/pg00004.htm" TARGET="_top">Workshop</A>&nbsp;&nbsp;|&nbsp;&nbsp;<A HREF="../../../workshop/pg01083.htm#/workshop/server/pg00164.htm" TARGET="_top">Server Technologies</A></DIV>

<DIV CLASS="clsDocBody">

<!-- DOCUMENT CONTENT START -->

<H1><a name="title" IDX_TYPE="sbngen" IDX_CONCEPT="stopindex; Caching, server; Server caching; Internet Start site, use of server caching">Got Any Cache?</A></H1>
<HR SIZE="1" />
<h6><a name="title2" IDX_TYPE="task" IDX_CONCEPT="Use server caching"></a></h6>
<P>Nancy Winnick Cluts
<BR>Developer Technology Engineer
<BR>Microsoft Corporation
<P>April 30, 1998
<P><a href="cache.zip"><IMG SRC="../../../sitebuilder/graphics/icodownl.gif" WIDTH=16 HEIGHT=20 BORDER=0 ALT="Download"> Download this document in Microsoft Word (.DOC) format (zipped, 21.2K)</a>.
<P> <a name="top"></a><b>Contents</b>
<br> <A HREF="cache.htm#topic1">Introduction</A>
<br><A HREF="cache.htm#topic2">What Server Caching Is and Why to  Use It</A>
<br> <A HREF="cache.htm#topic3">What to Cache and How To Cache</A>
<br> <A HREF="cache.htm#topic4">Output Caching</A>
<br> <A HREF="cache.htm#topic5">Input Caching</A>
<br> <A HREF="cache.htm#topic6">Summary</A>
<P><b>Editor's Note:</b> This article is one of three on technologies used by the Internet Start site. You'll also want to read <a href="pull.htm">Getting Content from the Web to the Client</a>
 and <a href="personalize.htm">The Internet Start Site: Now It's Personal</A>.
<P>
<h2><A NAME="topic1"></A>Introduction
</h2>
<P>This article delves into the subject of server caching, one of the technologies used by the <a href="http://www.microsoft.com/isapi/gohome.asp?TARGET=/" TARGET="_top">Internet Start site</a> <IMG SRC="../../../sitebuilder/graphics/leave-site.gif" WIDTH="17" HEIGHT="11" BORDER="0" ALT="Non-SBN link">. This is the third in a series of articles about things that you can do to add personalization to your Web site and to enhance performance. In this article, you will learn what server caching is, why you should use it, and when and where to use it. You will also have the ability to see the benefits of server caching in action. By the time you finish this article, you will see how easy it is to cache data on the server and, given the improved performance, that you cannot afford to overlook the advantages of server caching.
<P>
<h2><A NAME="topic2"></A>What Server Caching Is and Why to Use It
</h2>
<P>When we use the word "cache," we are talking about data that is saved in memory. When we talk about server caching, we are talking about saving specific data in memory on the server. This is different from data that is stored in a database on your server's hard disk, because the machine must still use its processing power to retrieve or sort information from that database. Once you have retrieved the data and saved it, you can access it again much faster than if you had to rerun your query.
<P>Now that you know why to cache data on the server, it's time to look at what data should be cached. Just because you can cache data doesn't mean you should. If you have data that is constantly changing, caching the data isn't going to buy you anything. In fact, you would just be wasting memory. However, if you have data that you will access over and over and that does not change often (in this case, often means every few seconds or minutes), this data is a good candidate for caching.
<P><A HREF="cache.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A><P>
<h2><A NAME="topic3"></A>What to Cache and How To Cache
</h2>
<P>There are two basic methods of data caching: output caching and input caching. When deciding what data to cache, ask yourself, "Is the data dynamic or static?" Static data can be hard-coded in your script while dynamic data can be retrieved via ASP and cached. But you might also have what can be referred to as semi-dynamic data. Semi-dynamic data is data that you don't want to hard-code into your script (that is, it may be a large amount of data) but you want to leverage the data you already have. For example, you may store all of your data in a database. The data may be fairly static (that is, it doesn't change much); however, you don't want to hard-code it into every HTML file. Remember that you have to maintain all of those files, so if you make a change in one, you must propagate those changes to every file. Instead, you may want to cache the data that you will ultimately present to the user.
<P><A HREF="cache.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A><P>
<h2><A NAME="topic4" IDX_TYPE="sbngen" IDX_CONCEPT="Server caching, output; Output caching, server">Output Caching</A>
</h2>
<P>Output caching is the term for saving data that is in its final presentation state (that is, saving the HTML tags along with the data). This type of caching is otherwise known as caching <i>transformed</i> output. With transformed output, you take the input and transform it into what you are going to present, then cache the transformed data -- you save the data as you would display it. This type of caching gives you the most bang for the performance buck because you only retrieve the data and format it once. It saves work (translated into time) for every request you don't have to reprocess. Output caching works especially well for a Web page that will be shown to many in the same manner.
<P><a href="cachemdb.zip"><IMG SRC="../../../sitebuilder/graphics/icodownl.gif" WIDTH=16 HEIGHT=20 BORDER=0 ALT="Download"> Download sports.mdb to run the sample code (zipped, 6.38K)</a>.

<P>The following script (in SPORTS.ASP, which uses the database in SPORTS.MDB) is an example of output caching. To run this sample, follow the steps below:
<P>1. Save SPORTS.ASP to a directory that has script access (you can run .asp files from it).
<P>2. Save SPORTS.MDB to a directory that the IUSR_machinename account can access. Note: This should not be a directory that is published on the Web unless you don't mind people downloading the file.
<P>3. Create a System data source name (DSN) to provide access to SPORTS.MDB.
<P>4. Request SPORTS.ASP using your browser and the HTTP protocol (not FILE) so the ASP file will run.
<P>
<b>Note</b> No Global.asa is needed for this first example.

<P>
<PRE class=clsCode>
<b>SPORTS.ASP

</b>&lt;%@ LANGUAGE=JavaScript %&gt;
&lt;html&gt;
&lt;body&gt;
&lt;form method=post&gt;

What is your favorite sport? &lt;%= getSportsListBox() %&gt;
&lt;p&gt;

&lt;input type=submit&gt;

&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
&lt;%

function getSportsListBox()
{
  SportsListBox = Application(&quot;SportsListBox&quot;)

  if (SportsListBox != null) return SportsListBox;

  crlf = String.fromCharCode(13, 10)

  SportsListBox = &quot;&lt;select name=Sports&gt;&quot; + crlf;

  SQL = &quot;SELECT SportName FROM Sports ORDER BY SportName&quot;;

  cnnSports = Server.CreateObject(&quot;ADODB.Connection&quot;);

  cnnSports.Open(&quot;Sports&quot;, &quot;WebUser&quot;, &quot;WebPassword&quot;);

  rstSports = cnnSports.Execute(SQL);

  fldSportName = rstSports(&quot;SportName&quot;);

  while (!rstSports.EOF){
    SportsListBox = SportsListBox + &quot;  &lt;option&gt;&quot; +
      fldSportName + &quot;&lt;/option&gt;&quot; + crlf;
    rstSports.MoveNext();
  }

  SportsListBox = SportsListBox + &quot;&lt;/select&gt;&quot;

  Application(&quot;SportsListBox&quot;) = SportsListBox

  return SportsListBox;
}

%&gt;
</PRE>

<P>In the script above, notice the second line in the function <b>getSportsListBox</b>. This line checks to see if the application-level variable, <i>SportsListBox</i>, is NULL. If the variable is NULL, this is the first time that this function has run and the function continues processing the data into its final form. If this variable is non-NULL, it has already been processed and is returned. This data is saved in its transformed state for display on the Web page.
<P>
<h3>What Output Caching Buys You
</h3>
<P>For a concrete example of the improvement you will see by using output caching, try commenting out the script that saves the data (the second to last line in the <b>getSportsListBox</b> function) as follows:
<P>
<PRE class=clsCode> // Application("SportsListBox") = SportsListBox
</PRE>
<P>Next, run the Web Capacity Analysis Tool (<A HREF="../../../workshop/server/toolbox/wcat.htm">WCAT</A>) on the .ASP file. On my laptop, I get about 10 requests processed per second. That's not too bad. Now, take the commenting syntax out (remove the &quot;//&quot; characters) and run WCat again. On my laptop, I get 60 requests processed per second. That's a six-fold performance gain by using just one line of script! Ask yourself, "Can I afford to not do this when I can so easily improve the performance on my site?"
<P><A HREF="cache.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A><P>
<h2><A NAME="topic5" IDX_TYPE="sbngen" IDX_CONCEPT="Server caching, input; Input caching, server">Input Caching</A>
</h2>
<P>But what if you have data that is used by many but presented in different ways to provide personalization? You cannot use output caching in this situation; however, you can use input caching. With input caching, you save the data but not the presentation. This works well for a site that is personalized, where you cannot cache the transformed output because everyone would get the same view. Instead, cache the data using a Visual Basic&#174; Scripting Edition (VBScript)-provided Dictionary object (<A HREF="http://premium.microsoft.com/msdn/library/tools/vbscript/htm/vsobjdictionary.htm" TARGET="_top">http://premium.microsoft.com/msdn/library/tools/<Br>vbscript/htm/
vsobjdictionary.htm</A> <IMG SRC="../../../sitebuilder/graphics/leave-site.gif" WIDTH="17" HEIGHT="11" BORDER="0" ALT="Non-SBN link">) or an ActiveX&#174; Data Objects (ADO) Recordset (<A HREF="http://www.microsoft.com/msdn/sdk/inetsdk/help/rds/dg02_3.htm" TARGET="_top">http://www.microsoft.com/msdn/sdk/inetsdk/help/rds/dg02_3.htm</A> <IMG SRC="../../../sitebuilder/graphics/leave-site.gif" WIDTH="17" HEIGHT="11" BORDER="0" ALT="Non-SBN link">).
<P>The example below uses an ADO Recordset to cache data. Using a Recordset allows you to have multiple properties for each entry (row). The VBScript Dictionary object provides for the storage of one value per entry (key). To see just how easy it is to cache input, try the example below.
<P>
<PRE class=clsCode>
<b>GLOBAL.ASA

</b>&lt;!--METADATA TYPE=&quot;TypeLib&quot;
   FILE=&quot;C:\Program Files\Common Files\system\ado\msado15.dll&quot;--&gt;

&lt;SCRIPT LANGUAGE=VBScript RUNAT=&quot;Server&quot;&gt;

Sub Application_OnStart

  SQL = &quot;SELECT CompanyName, City FROM Customers&quot;

  cnnAdvWorks = &quot;DSN=AdvWorks&quot;

  Set rsCustomers = Server.CreateObject(&quot;ADODB.Recordset&quot;)

  ' This is usable disconnected

  rsCustomers.CursorLocation = adUseClient

  rsCustomers.Open SQL, cnnAdvWorks, adOpenStatic, AdLockReadOnly

  ' Disconnect the Recordset

  rsCustomers.ActiveConnection = Nothing

  Set Application(&quot;rsCustomers&quot;) = rsCustomers

End Sub

&lt;/SCRIPT&gt;
<P>
<b>Customers.ASP
</b>&lt;%

  Set myCustomers = Application(&quot;rsCustomers&quot;).Clone

  Set CompanyName = myCustomers(&quot;CompanyName&quot;)
  Set City        = myCustomers(&quot;City&quot;)

  Do Until myCustomers.EOF
%&gt;

&lt;b&gt;&lt;%= CompanyName %&gt;&lt;/b&gt; is located in &lt;b&gt;&lt;%= City %&gt;&lt;/b&gt;.&lt;p&gt;

&lt;%
    myCustomers.MoveNext
  Loop
%&gt;
</PRE>
<P>In this example, when the Application is started, the <i>rsCustomers</i> Recordset is saved into Application state. Then, anytime the Customers.asp page is called, the same Recordset is used to provide the data. The Recordset <b>Clone</b> method is used to get a private cursor to the shared <i>rsCustomers</i> Recordset. Using the <b>Clone</b> method, the ASP page will share the data while being able to navigate the data separately from other concurrent page requests.
<P>
<h3>Client-Based Cursors
</h3>
<P>As shown in the example above, you can save information in the GLOBAL.ASA file. Then you can get the results of a query and step through the recordset via the <b>MoveNext</b>, <b>MovePrevious</b>, <b>MoveFirst</b>, and <b>MoveLast</b> commands. This works great in that the information is saved out and the database isn't queried over and over again. But what happens when the database is shared among users? UserA may have gone in and stepped through a few records. Then UserB comes in and does a <b>MoveFirst</b>, effectively resetting the cursor to the beginning of the recordset. This messes up UserA and UserB big-time. The problem is summed up as follows: Multiple users cannot navigate the same recordset at the same time.
<P>Now that I've shown you the problem, here's the good news: ADO version 1.5 has its own cursor engine. What this means is that you can use a <i>client-based</i> cursor when stepping through your recordset. A client-based cursor is just what the name implies: a cursor that is for use on the client machine only. Now, look again at the use of the <b>Clone</b> method in the example above. The private cursor available to the Web page is a client-based cursor.
<P>To try this: Initialize, make the connection, and save out the cursor in your GLOBAL.ASA file. Then release your connection so that others can access the file for writing (if necessary). Then, in your script, use the <b>Clone</b> method (as demonstrated in the above example). This clones the cursor -- NOT the data. This is important, because if you have a very large database, you don't want to cache the entire database for each view when you only need a few records for each view. The data is shared -- the cursor is cloned.
<P>
<h3>ADO and Threading
</h3>
<P>For Recordsets in Application state to scale well, ADO must be marked "Both" threaded. If the threading model is "Both," ADO is assumed to be thread-safe and is instantiated on the calling thread. Any method call on this object will translate directly to a method call on the underlying COM object on the calling thread. A detailed discussion about ADO and threads and how to specify the threading model can be found in the article "Improving the Performance of Data Access Components with IIS 4.0" in the section entitled "Threading Support" (<A HREF="../../../workshop/server/components/daciisperf.htm#topic2">http://www.microsoft.com/workshop/server/components/daciisperf.asp#topic2</A>).
<P>
<h3>Filtering Data and Indexing
</h3>
<P>Another innovation in ADO 1.5 is the ability to apply a filter to data. This means that you can grab just a few records from a Recordset based on some specified criteria. Once again, if you have a large database and only a few records to use, the filter would hypothetically be going through all of your records (perhaps thousands) just to create a view. Multiply that by several users and it can severely impact the performance of your Web page.
<P>In the next version of ADO (version 2.0) slated to ship with Visual Studio&#153; 98, you will be able to search on your client-based cursor and index the data you get. This should really speed things up. But this is a topic in and of itself, so I will cover how you do this in a future article.
<P><A HREF="cache.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A><P>
<h2><A NAME="topic6"></A>Summary
</h2>
<P>Given the information in this article, you can look at your own script and see if the opportunity exists to cache data on the server. Mix and match so that you use the appropriate type of caching for the data you are trying to save. You will get the greatest benefit by trying to incorporate output caching. But if there isn't a good place for you to do that, improve performance by finding areas where you can cache input. More detailed information about ADO can be found at  <A HREF="http://www.microsoft.com/msdn/sdk/inetsdk/help/ado/idx01.htm" TARGET="_top">http://www.microsoft.com/msdn/sdk/inetsdk/help/ado/idx01.htm</A> <IMG SRC="../../../sitebuilder/graphics/leave-site.gif" WIDTH="17" HEIGHT="11" BORDER="0" ALT="Non-SBN link">. More information about ASP and IIS can be found in our Server area at  <A HREF="../../../workshop/server/default.htm">http://www.microsoft.com/workshop/server/default.asp</A>.
<P><P>

<P>







<!-- DOCUMENT CONTENT END -->

</DIV>

<DIV CLASS="clsDocBody">
<HR SIZE="1" />
<P><I>Did you find this article useful? Gripes? Compliments? Suggestions for other articles? <A TITLE="Go ahead. Make our day! Send us your thoughts." HREF="../../../sitebuilder/pg00562.htm" TARGET="_top">Write us!</A></I></P>
<P ID="pBackTop"><A HREF="cache.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif" WIDTH="18" HEIGHT="8" BORDER="0" ALT="Back to top">Back to top</A></P>

<P CLASS="clsIncCpyRt">

</P>

&copy; <A CLASS="clsIncCpyRt" HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">1998 Microsoft Corporation. All rights reserved. Terms of use</A>.

<P>&nbsp;</P>
</DIV>
<SCRIPT LANGUAGE="JavaScript"><!--

function CheckToTop()
{
var eBody = document.body;
if (eBody.scrollHeight > eBody.offsetHeight) pBackTop.style.display = 'block';
}

//--></SCRIPT>

<DIV ID="divMenu1" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="../../../sitebuilder/magazine/default.htm">Magazine Home</DIV>
<DIV expURL="../../../sitebuilder/magazine/jane.htm">Ask Jane</DIV>
<DIV expURL="../../../sitebuilder/magazine/dude.htm">DHTML Dude</DIV>
<DIV expURL="../../../sitebuilder/magazine/xml.htm">Extreme XML</DIV>
<DIV expURL="../../../sitebuilder/magazine/starters.htm">For Starters</DIV>
<DIV expURL="../../../sitebuilder/magazine/hess.htm">More or Hess</DIV>
<DIV expURL="../../../sitebuilder/magazine/server.htm">Servin' It Up</DIV>
<DIV expURL="../../../sitebuilder/magazine/site.htm">Site Lights</DIV>
<DIV expURL="../../../sitebuilder/magazine/webmen.htm">Web Men Talking</DIV>
</DIV>
<DIV ID="divMenu2" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="http://www.microsoft.com/sbnmember/default.asp">Member Community Home</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/freebies/default.asp">Benefits: Freebies &amp; Discounts</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/promote/default.asp">Benefits: Promote Your Site</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/connect/default.asp">Benefits: Connect with Your Peers</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/glance-lev.asp">Benefits at a Glance</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/osig/default.asp">Online Special-Interest Groups</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/levels/member.asp">Your Membership</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/freebies/stores.asp">SBN Stores</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/apply/registration.asp">Join Now</DIV>
</DIV>
<DIV ID="divMenu3" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="../../../workshop/default.htm">Workshop Home</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/essentials/default.htm">Essentials</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/delivery/default.htm">Content &amp; Component Delivery</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/components/default.htm">Component Development</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/database/default.htm">Data Access &amp; Databases</DIV>
<DIV expURL="../../../workshop/design/default.htm">Design</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/author/default.htm">DHTML, HTML &amp; CSS</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/xml/default.htm">Extensible Markup Language (XML)</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/languages/default.htm">Languages &amp; Development Tools</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/messaging/default.htm">Messaging &amp; Collaboration</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/networking/default.htm">Networking, Protocols &amp; Data Formats</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/browser/default.htm">Reusing Browser Technology</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/security/default.htm">Security &amp; Cryptography</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/server/default.htm">Server Technologies</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/imedia/default.htm">Streaming &amp; Interactive Media</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/management/default.htm">Web Content Management</DIV>
<DIV expURL="../../../workshop/index/default.htm">Workshop Index</DIV>
</DIV>
<DIV ID="divMenu4" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="../../../gallery/default.htm">Tools &amp; Samples Home</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/gallery/tools/default.htm">Tools</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/gallery/samples/default.htm">Samples, Headers, Libs</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/gallery/images/default.htm">Images</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/gallery/sounds/default.htm">Sounds</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/gallery/stylesheets/default.htm">Style Sheets</DIV>
<DIV expURL="http://www.microsoft.com/typography/fontpack/win.htm">Web Fonts</DIV>
</DIV>
<DIV ID="divMenu5" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="../../../devtraining/default.htm">Training Home</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/seminars/default.htm">SBN Live Seminars</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/chat/default.htm">SBN Live Chats</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/atec.htm">Courses</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/peer/default.htm">Peer Support</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/mastering.htm">CD-ROM Training</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/books_kits.htm">Books & Training Kits</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/mscert/default.htm">Certification</DIV>
</DIV>
<DIV ID="divMenu6" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="../../../sitebuilder/default.htm">SBN Home</DIV>
<DIV expURL="../../../sitebuilder/siteinfo/newtosite.htm">New to SBN?</DIV>
<DIV expURL="../../../sitebuilder/whatsnew.htm">What's New on SBN</DIV>
<DIV expURL="../../../sitebuilder/siteinfo/sitemap.htm">Site Map</DIV>
<DIV expURL="http://www.microsoft.com/isapi/gosearch.asp?TARGET=/dev/web/default.asp">Site Search</DIV>
<DIV expURL="../../../sitebuilder/siteinfo/glossary/default.htm">Glossary</DIV>
<DIV expURL="../../../sitebuilder/write-us.htm">Write Us</DIV>
<DIV expURL="../../../sitebuilder/siteinfo/about.htm">About This Site</DIV>
</DIV>
<SCRIPT LANGUAGE="JavaScript" SRC="../../../sitebuilder/shared/js/navbar.js"></SCRIPT> 
<SCRIPT LANGUAGE="JavaScript" SRC="../../../sitebuilder/shared/js/navlinks.js"></SCRIPT>


</BODY>
</HTML>