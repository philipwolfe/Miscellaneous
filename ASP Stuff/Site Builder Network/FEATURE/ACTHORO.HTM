
<HTML>
<HEAD>


<TITLE>SBN Server: Your Daily Horoscope:  Using ISAPI, ASP, and the Active Desktop to Deliver a Customized Horoscope</TITLE>

<META NAME="Description" CONTENT="Your Daily Horoscope:  Using ISAPI, ASP, and the Active Desktop to Deliver a Customized Horoscope. A description of Microsoft's Internet Start site and how it uses personalization technology." />
<META NAME="Keywords" CONTENT="Active Desktop, ISAPI, Internet Server API, ASP, Active Server Pages, desktop items, daily horoscope" />
<META NAME="Robots" CONTENT="All" />

<META NAME="Author" CONTENT="Kannan Ramasubramanian" />
<META NAME="Posted" CONTENT="" />
<META NAME="Updated" CONTENT="07/27/1998" />

<META NAME="MS.LOCALE" CONTENT="EN-US" />
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1" />

<LINK REL="stylesheet" TYPE="text/css" HREF="../../../sitebuilder/shared/css/navbar.css" />
<LINK REL="stylesheet" TYPE="text/css" HREF="../../../sitebuilder/shared/css/ie4-wks.css" />


<SCRIPT LANGUAGE="JavaScript"><!--

// -----------------------------------------------------------
// Client-side BrowserData constructor
// Populated using data from server-side oBD object to avoid redundancy
// -----------------------------------------------------------

function BrowserData()
{
this.userAgent = "Mozilla/4.0 (compatible; MSIE 4.01; Windows NT)";
this.browser = "MSIE";
this.majorVer = "4";
this.minorVer = "01";
this.betaVer = 0;
this.platform = "NT";
this.getsNavBar = true;
this.doesActiveX = true;

}
var oBD = new BrowserData();

//--></SCRIPT>

<SCRIPT LANGUAGE="Javascript"><!--

// -----------------------------------------------------------
// window_load()
// Container function for load.
// -----------------------------------------------------------

function window_load()
{
if (oBD.getsNavBar)
{
if ("function" == typeof(InitNavLinks)) InitNavLinks();
if ("function" == typeof(CheckToTop)) CheckToTop();
}
}
window.onload = window_load;

//--></SCRIPT>

<SCRIPT LANGUAGE="JavaScript"><!--

  function showSample(sURL) {
    sFeatures = "width=520,height=400,left=10,top=10,toolbar=0,statusbar=0,scrollbars=1,resizable=1";
    newWin = window.open (sURL, "_blank", sFeatures);
    return false;
  }

//--></SCRIPT>


</HEAD>

<BODY TOPMARGIN="0" LEFTMARGIN="0" MARGINHEIGHT="0" MARGINWIDTH="0" BGCOLOR="#FFFFFF">


<TABLE WIDTH="100%" CELLPADDING="0" CELLSPACING="0" BORDER="0">
<TR>
<TD ROWSPAN="2" WIDTH="460" VALIGN="top"><NOBR><A HREF="http://www.microsoft.com/" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/home.gif" WIDTH="103" HEIGHT="21" ALT="Microsoft Home" BORDER="0"></A><A HREF="http://www.microsoft.com/PRODUCTS/DEFAULT.asp?DIVISIONID="10"" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/prod.gif" WIDTH="81" HEIGHT="21" ALT="products" BORDER="0"></A><A HREF="http://www.microsoft.com/search/default.asp" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/search.gif" WIDTH="68" HEIGHT="21" ALT="search" BORDER="0"></A><A HREF="http://www.microsoft.com/ISAPI/GOSUPPORT.asp?TARGET=/SUPPORT/" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/support.gif" WIDTH="74" HEIGHT="21" ALT="support" BORDER="0"></A><A HREF="http://www.microsoft.com/referral/default.asp" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/shop.gif" WIDTH="55" HEIGHT="21" ALT="shop" BORDER="0"></A><A HREF="http://www.microsoft.com/ISAPI/GOREGWIZ.asp?TARGET=/REGWIZ/REGWIZ.asp" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/write.gif" WIDTH="78" HEIGHT="21" ALT="Write Us" BORDER="0"></A><IMG SRC="../../../library/images/gifs/toolbar/spacer.gif" WIDTH="1" HEIGHT="21" ALT="" BORDER="0"></NOBR></TD>
<TD BGCOLOR="#000000" WIDTH="100%" HEIGHT="20">&nbsp;</TD>
<TD ROWSPAN="2" WIDTH="91" ALIGN="right" VALIGN="top"><A HREF="http://www.microsoft.com/" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/msft.gif" WIDTH="91" HEIGHT="21" ALT="Microsoft Home" BORDER="0"></A></TD>
</TR>
<TR>
<TD COLSPAN="3" BGCOLOR="#FFFFFF" WIDTH="100%" HEIGHT="1"></TD>
</TR>
</TABLE>

<TABLE ID="tblNavBar" BORDER="0" CELLPADDING="0" CELLSPACING="0">
<TR VALIGN="top">
<TD CLASS="clsSBNLogo" TITLE="SBN Home" HEIGHT="34" WIDTH="90"><A HREF="/sitebuilder/default.htm" TARGET="_top" expNoTOC="true"><IMG HEIGHT="34" WIDTH="90" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/sbnbrand2.gif" ALT="SBN Home" /></A></TD>
<TD CLASS="clsNavBarItem" expItemNum="1">Magazine<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD>&nbsp;|&nbsp;</TD>
<TD CLASS="clsNavBarItem" expItemNum="2">Community<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD>&nbsp;|&nbsp;</TD>
<TD CLASS="clsNavBarItem" expItemNum="3">Workshop<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD>&nbsp;|&nbsp;</TD>
<TD CLASS="clsNavBarItem" expItemNum="4">Tools&nbsp;&amp;&nbsp;Samples<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD>&nbsp;|&nbsp;</TD>
<TD CLASS="clsNavBarItem" expItemNum="5">Training<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD>&nbsp;|&nbsp;</TD>
<TD CLASS="clsNavBarItem" expItemNum="6">Site&nbsp;Info<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD WIDTH="100%"></TD>
</TR>
</TABLE>


<TABLE ID="tblNavLinks" CLASS="clsNavLinks" CELLPADDING="0" CELLSPACING="0" BORDER="0" WIDTH="100%">
<TR>
<TD COLSPAN="2" HEIGHT="8"><IMG WIDTH="1" HEIGHT="8" SRC="../../../sitebuilder/shared/graphics/trans.gif"></TD>
<TD ROWSPAN="2"><A HREF="../../../workshop/default.htm" TARGET="_top"><IMG ALIGN="right" HEIGHT="30" WIDTH="106" BORDER="0" ALT="Click to return to the Workshop home page" SRC="../../../workshop/graphics/wrkbrand2.gif" /></A><BR /></TD>
</TR>
<TR>
<TD ROWSPAN="2">
<A HREF="../../../workshop/server/pg00164.htm"><IMG HEIGHT="32" WIDTH="31" HSPACE="25" BORDER="0" ALT="Click to return to the Server Technologies home page" SRC="../../../workshop/graphics/icons//server.gif" /></A>
</TD>
<TD>
<TABLE CELLPADDING="3" CELLSPACING="0" BORDER="0">
<TR>

<TD><A ID="lnkShowImg" HREF="../../../workshop/server/toc.htm" TARGET="_top"><IMG ID="imgShow" CLASS="clsLeftMenu" HEIGHT="15" WIDTH="18" BORDER="0" SRC="../../../workshop/graphics/icons/nl-show-0.gif" ALT="" /></A><BR></TD>
<TD NOWRAP><A ID="lnkShowText" CLASS="clsLeftMenu" HREF="../../../workshop/server/toc.htm" TARGET="_top">show toc</A> &nbsp;&nbsp; </TD>

<TD><A ID="lnkSyncImg" HREF="../../../workshop/pg00273.htm#/workshop/server/feature/acthoro.htm" TARGET="_top"><IMG ID="imgSync" CLASS="clsLeftMenu" HEIGHT="15" WIDTH="18" BORDER="0" SRC="../../../workshop/graphics/icons/nl-sync-0.gif" ALT="" /></A><BR></TD>
<TD NOWRAP><A ID="lnkSyncText" CLASS="clsLeftMenu" HREF="../../../workshop/pg00273.htm#/workshop/server/feature/acthoro.htm" TARGET="_top">sync toc</A> &nbsp;&nbsp; </TD>

<TD><A ID="lnkSearchImg" HREF="http://www.microsoft.com/isapi/gosearch.asp?TARGET=/dev/web/default.asp" TARGET="_top"><IMG ID="imgSearch" CLASS="clsLeftMenu" HEIGHT="15" WIDTH="18" BORDER="0" SRC="../../../workshop/graphics/icons/nl-search-0.gif" ALT="" /></A><BR></TD>
<TD NOWRAP><A ID="lnkSearchText" CLASS="clsLeftMenu" HREF="http://www.microsoft.com/isapi/gosearch.asp?TARGET=/dev/web/default.asp" TARGET="_top">search</A> &nbsp;&nbsp; </TD>

<TD><A ID="lnkIndexImg" HREF="../../../workshop/index/pg00001.htm"><IMG ID="imgIndex" CLASS="clsLeftMenu" HEIGHT="15" WIDTH="18" BORDER="0" SRC="../../../workshop/graphics/icons/nl-index-0.gif" ALT="" /></A><BR></TD>
<TD NOWRAP><A ID="lnkIndexText" CLASS="clsLeftMenu" HREF="../../../workshop/index/pg00001.htm">index</A> &nbsp;&nbsp; </TD>

</TR>
</TABLE>
</TD>
</TR>
<TR>
<TD COLSPAN="2" WIDTH="100%">
<TABLE CELLPADDING="2" CELLSPACING="0" BORDER="0">
<TR>
<TD>&nbsp;</TD>
</TR>
</TABLE>
</TD>
</TR>
</TABLE>

<BR CLEAR="all" />
<DIV CLASS="clsBucketBranch"><A HREF="../../../workshop/pg00004.htm" TARGET="_top">Workshop</A>&nbsp;&nbsp;|&nbsp;&nbsp;<A HREF="../../../workshop/pg00272.htm#/workshop/server/pg00164.htm" TARGET="_top">Server Technologies</A></DIV>

<DIV CLASS="clsDocBody">

<!-- DOCUMENT CONTENT START -->

<H1><a name="title" IDX_TYPES="sbngen" IDX_CONCEPT="stopindex; Active Desktop items, daily horoscope">Your Daily Horoscope:  Using ISAPI, ASP, and the Active Desktop to Deliver a Customized Horoscope</A></H1>
<HR SIZE="1" />
<h6><a name="title2" IDX_TYPES="task" IDX_CONCEPT="How to use ISAPI, ASP, and the Active Desktop to deliver a customized daily message"></a></h6>
<P>Kannan Ramasubramanian
<BR>Servinet Consulting Group
<P>June 11, 1998


<P><a href="acthoro.zip"><IMG SRC="../../../sitebuilder/graphics/icodownl.gif" WIDTH=16 HEIGHT=20 BORDER=0 ALT="Download"> Download this document in Microsoft Word (.DOC) format (zipped, 24K)</a>.
<p>
<a href="http://www.aslaninc.com/horoscope/horoscope.zip"><IMG SRC="../../../sitebuilder/graphics/icodownl.gif" WIDTH=16 HEIGHT=20 BORDER=0 ALT="Download"> Download the Daily Horoscope application files (zipped, 1,650K)</a>. <IMG SRC="../../../sitebuilder/graphics/leave-ms.gif" WIDTH="33" HEIGHT="11" BORDER="0" ALT="Non-MS link"><p>
<b>Contents</b>
<BR><a href="acthoro.htm#intro">Introduction</a>
<BR><a href="acthoro.htm#theapp">The Application</a>
<BR><a href="acthoro.htm#key1">Key File #1:  Horoscope.asp</a>
<BR><a href="acthoro.htm#key2">Key File #2:  Horoscopecdf.asp</a>
<BR><a href="acthoro.htm#key3">Key File #3:  Horoscope.cls</a>
<BR><a href="acthoro.htm#adapt">Adapting Daily Horoscope to Other Uses</a>
<br><a href="acthoro.htm#moreinfo">For More Information</a>
<BR><a href="acthoro.htm#summary">Summary</a>
<BR><a href="acthoro.htm#appendix">Appendix:  How to Install Daily Horoscope on Your Own Server</a>
<P>
<h2><a name="intro">Introduction</a>
</h2>
<P>The Daily Horoscope is a desktop component that provides subscribers with an update of what the stars hold in store for them each day. It requires that users have Microsoft&#174; Internet Explorer 4.0 running on their machines with Active Desktop&#153; interface enabled. While I make no claims about the accuracy of the forecasts (which appear courtesy of <A HREF="http://www.infospace.com/" TARGET="_top">Infospace</A> <IMG SRC="../../../sitebuilder/graphics/leave-ms.gif" WIDTH="33" HEIGHT="11" BORDER="0" ALT="Non-MS link">), Daily Horoscope certainly demystifies the various technologies it incorporates. And even though it is little more than a few lines of text, it provides an excellent starting-point to learn about several cool and useful technologies, most notably Active Desktop&#153;, the Internet Server API (ISAPI), Active Server Pages (ASP), and Visual Basic&#174; (and its counterpart Visual Basic&#174; Scripting Edition [VBScript]). It could also <a href="acthoro.htm#adapt">easily be modified</a> to generate a simple &quot;Message of the Day&quot; for broadcast over a corporate intranet.
<P>This article will walk you through a description of the application, and a detailed explanation of the key files and code snippets. It also points you to more detailed material on relevant subjects such as the Internet Server API. You can also install Daily Horoscope on your own Web server. We've included the Daily Horoscope code, and  <A HREF="acthoro.htm#appendix">instructions for installing Daily Horoscope</A> on your server are in the Appendix.
<P>
<A HREF="acthoro.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<h2><a name="theapp">The Application</a>
</h2>
<P>Daily Horoscope resides on a Web server alongside your other ASP, CGI, and ISAPI scripts. It can be viewed as running two discreet processes:  one, visitors log on to the Web site and subscribe to the Horoscope delivery service, and two, the Channel Definition Format (CDF) file fetches the day's horoscope and updates the desktop component. Figure 1 shows the subscription process and Figure 2 shows the daily update process.
<P><img src="horofig1.gif" width="356" height="288">
<P><b>Figure 1. The subscription process
<P><img src="horofig2.gif" width="384" height="218">
<P>Figure 2. The daily update process</b>
<P>The application flow consists of the following steps:
<OL>

<LI>   A site visitor, running Internet Explorer 4.0 with Active Desktop enabled, requests the URL to access the Daily Horoscope page (for example, http://www.aslaninc.com/horoscope/horoscope.asp).
<LI>   The page displays a form with a drop-down menu of all the astrological signs. Visitors select their sign and click the Submit button.
<LI>   Daily Horoscope takes the returned astrological sign value, dynamically generates a Channel Definition Format (CDF) file, and returns it to the visitor's browser.
<LI>   Internet Explorer alerts the user that the application wishes to install a Desktop item, and asks whether to allow it to proceed.
<LI>   Upon confirmation, Internet Explorer displays information about the Active Desktop item along with some customization options.
<LI>   Internet Explorer downloads and installs the Active Desktop item.
<LI>   That day's horoscope is accessed, downloaded, and displayed on the user's desktop, and will be updated daily beginning the next morning.

</OL>
<br>
Try it yourself! <a href="http://www.aslaninc.com/horoscope/horoscope.asp" TARGET="_top">Install the Daily Horoscope Desktop item</a> <IMG SRC="../../../sitebuilder/graphics/leave-ms.gif" WIDTH="33" HEIGHT="11" BORDER="0" ALT="Non-MS link"> from <a href="http://www.servi.net/" TARGET="_top">Servinet</a> <IMG SRC="../../../sitebuilder/graphics/leave-ms.gif" WIDTH="33" HEIGHT="11" BORDER="0" ALT="Non-MS link">. Remember that you need to be running Internet Explorer 4.0 and above with Active Desktop enabled.
<p>
<A HREF="acthoro.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<p><a name="key1"></a><h2>Key File #1:  Horoscope.asp
</h2>
<P>Let's take a closer look at the files that make Daily Horoscope work. Horoscope.asp is the entry point to the application, the file that users initially access. The code listing below presents its introductory section:
<P>
<PRE class=clsCode>&lt;% if request(&quot;sunsign&quot;) = &quot;&quot; then %&gt;
 &lt;HTML&gt;
 &lt;TITLE&gt;Horoscope for the day&lt;/TITLE&gt;
 &lt;FORM ACTION=&quot;horoscope.asp&quot; METHOD=&quot;POST&quot;&gt;
 &lt;BR&gt;&lt;BR&gt;
 &lt;TABLE&gt;
 &lt;TR&gt;
 &lt;TD&gt;
 &lt;STRONG&gt;Please choose your sign: &lt;/STRONG&gt;
 &lt;SELECT NAME=&quot;sunsign&quot;&gt;
  &lt;OPTION VALUE=&quot;aries&quot;&gt;Aries&lt;/OPTION&gt;
  &lt;OPTION VALUE=&quot;taurus&quot;&gt;Taurus&lt;/OPTION&gt;
  &lt;OPTION VALUE=&quot;gemini&quot;&gt;Gemini&lt;/OPTION&gt;
  &lt;OPTION VALUE=&quot;cancer&quot;&gt;Cancer&lt;/OPTION&gt;
  &lt;OPTION VALUE=&quot;leo&quot;&gt;Leo&lt;/OPTION&gt;
  &lt;OPTION VALUE=&quot;virgo&quot;&gt;Virgo&lt;/OPTION&gt;
  &lt;OPTION VALUE=&quot;libra&quot;&gt;Libra&lt;/OPTION&gt;
  &lt;OPTION VALUE=&quot;scorpio&quot;&gt;Scorpio&lt;/OPTION&gt;
  &lt;OPTION VALUE=&quot;sagittarius&quot;&gt;Sagittarius&lt;/OPTION&gt;
  &lt;OPTION VALUE=&quot;capricorn&quot;&gt;Capricorn&lt;/OPTION&gt;
  &lt;OPTION VALUE=&quot;acquarius&quot;&gt;Acquarius&lt;/OPTION&gt;
  &lt;OPTION VALUE=&quot;pisces&quot;&gt;Pisces&lt;/OPTION&gt;
 &lt;/SELECT&gt;
 &lt;/TD&gt;
 &lt;TD&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
 &lt;INPUT TYPE=&quot;SUBMIT&quot; VALUE=&quot;Submit&quot;&gt;
 &lt;/td&gt;
 &lt;/TABLE&gt;
 &lt;/FORM&gt;
 &lt;/HTML&gt;
&lt;% else %&gt;
 &lt;% if request(&quot;sunsign&quot;) &lt;&gt; &quot;aries&quot; and
 request(&quot;sunsign&quot;) &lt;&gt; &quot;taurus&quot; and
 request(&quot;sunsign&quot;) &lt;&gt; &quot;gemini&quot; and
 request(&quot;sunsign&quot;) &lt;&gt; &quot;cancer&quot; and
 request(&quot;sunsign&quot;) &lt;&gt; &quot;leo&quot; and
 request(&quot;sunsign&quot;) &lt;&gt; &quot;virgo&quot; and
 request(&quot;sunsign&quot;) &lt;&gt; &quot;libra&quot; and
 request(&quot;sunsign&quot;) &lt;&gt; &quot;scorpio&quot; and
 request(&quot;sunsign&quot;) &lt;&gt; &quot;sagittarius&quot; and
 request(&quot;sunsign&quot;) &lt;&gt; &quot;capricorn&quot; and
 request(&quot;sunsign&quot;) &lt;&gt; &quot;aquarius&quot; and
 request(&quot;sunsign&quot;) &lt;&gt; &quot;pisces&quot; then %&gt;
  &lt;% response.redirect(&quot;horoscope.asp&quot;) %&gt;
  &lt;% end if %&gt;
</PRE>
<P>The first line of Horoscope.asp checks for the value of the variable <i>sunsign</i>. If <i>sunsign</i> is blank, as will be the case when the user connects the first time, Horoscope.asp displays a standard HTML drop-down form from which the user can choose their sign. Note that the &lt;ACTION&gt; tag has a value of "Horoscope.asp", which references the same page. It is standard practice in ASP for a program to call itself to action. Thus, after the user chooses the zodiac sign and selects Submit, Horoscope.asp is called again. This time, however, <i>sunsign</i> will contain the sign preference of the user, and the else condition will execute, which checks to make sure <i>sunsign</i> is a valid astrological sign. If it isn't, Horoscope.asp redirects the browser back to itself again and re-starts the process from the beginning.
<P>The next code fragment (shown below) is the last and trickiest piece of Horoscope.asp. The first line checks to see if <i>sunsign</i> is empty. If it isn't (which it shouldn't be, since to get to this point a valid sign had to be chosen), the application redirects the browser to Horoscopecdf.asp and passes the <i>sunsign</i> value by attaching the &quot;?sunsign=&quot; syntax to the URL. Internet Explorer identifies Horoscopecdf.asp as a CDF file (see below), that it's an Active Desktop Item, provides background on the subscription, and so forth.
<P>
<PRE class=clsCode> &lt;% if request.form(&quot;sunsign&quot;) &lt;&gt; &quot;&quot; then %&gt;
  &lt;% response.redirect(&quot;horoscopecdf.asp?sunsign=&quot;
     &amp; request(&quot;sunsign&quot;)) %&gt;
 &lt;% else %&gt;
  &lt;% Set horoscopeObject = server.createobject(&quot;Aslan.Horoscope&quot;)%&gt;
  &lt;% horoscopeObject.sunsign = request(&quot;sunsign&quot;) %&gt;
  &lt;% response.write(&quot;&lt;HTML&gt;&quot;) %&gt;
  &lt;% response.write(&quot;&lt;TITLE&gt;&quot; &amp; ucase(request(&quot;sunsign&quot;))
  &amp; &quot; - Horoscope for the day&lt;/TITLE&gt;&quot;) %&gt;
  .
  .
  .
  &lt;% response.write (horoscopeObject.GetHoroscope) %&gt;
  .
  .
  .
 &lt;% end if %&gt;
&lt;% end if%&gt;
</PRE>
<P>The second part of the above code, which instantiates the <b>Aslan.Horoscope</b> ActiveX&#174; control, will be executed if Horoscope.asp has been called by the Active Desktop component. The remaining code returns some HTML formatting statements and calls the <A HREF="acthoro.htm#gethoroscope"><b>GetHoroscope()</b> method</A>, which will connect to the InfoSpace site and fetch the horoscope content.
<P>
<A HREF="acthoro.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<p>
<a name="key2"></a><h2>Key File #2:  Horoscopecdf.asp
</h2>
<P>As we mentioned above, Horoscopecdf.asp is a dynamically generated CDF file that configures the Active Desktop component on the user's machine. It is called by Horoscope.asp once for each subscriber.
<P>
<PRE class=clsCode>&lt;?XML version=&quot;1.0&quot;?&gt;

&lt;% MyURL = &quot;http://&quot; &amp; Request.ServerVariables(&quot;SERVER_NAME&quot;)
&amp; &quot;/horoscope/horoscope.asp?sunsign=&quot;
&amp; request(&quot;sunsign&quot;)%&gt;
&amp; request(&quot;sunsign&quot;)%&gt;
&lt;Channel HREF=&quot;&lt;% =MyURL%&gt;&quot;&gt;

    &lt;SCHEDULE&gt;
        &lt;IntervalTime DAY=&quot;1&quot; /&gt;
        &lt;EarliestTime HOUR=&quot;12&quot; /&gt;
        &lt;LatestTime HOUR=&quot;18&quot; /&gt;
    &lt;/SCHEDULE&gt;

        &lt;ITEM HREF=&quot;&lt;% =MyURL%&gt;&quot;&gt;
        &lt;Title&gt;The A3 Horoscope&lt;/Title&gt;
        &lt;USAGE VALUE=&quot;DesktopComponent&quot;&gt;
            &lt;OpenAs VALUE=&quot;html&quot; /&gt;
            &lt;Width VALUE=&quot;623&quot; /&gt;
            &lt;Height VALUE=&quot;404&quot; /&gt;
        &lt;/USAGE&gt;
        &lt;/ITEM&gt;

&lt;/Channel&gt;
</PRE>
<P>The first line of the Horoscopecdf.asp identifies it as an XML file (CDF is a subset of  <A HREF="../../../xml/pg00271.htm" TARGET="_top">XML</A> or, in XML parlance, a vocabulary) and is treated differently from standard HTML. Internet Information Server treats it as a regular ASP file because of the .asp extension, which allows us to use standard ASP code in it as well.
<P>The section of the Horoscopecdf.asp within the &lt;SCHEDULE&gt; tags informs Internet Explorer about the schedule for updating the desktop component, while the &lt;USAGE&gt; tags relate that it's an Active Desktop component with some formatting information. Follow this link for more information on the  <A HREF="http://www.microsoft.com/msdn/sdk/inetsdk/help/delivery/references/desktop_items/desktop_items.htm#ch_aditems_ref" TARGET="_top">structure of Active Desktop CDF files</A>.
<P>
<A HREF="acthoro.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<p>
<a name="key3"></a><h2>Key File #3:  Horoscope.cls
</h2>
<P>To be precise, the Daily Horoscope component is a class within the OLE server component Aslan.dll. The most important piece of code in the Daily Horoscope OLE server is the Horoscope<b> </b>class module, <b>Horoscope.cls</b>. <b>Horoscope.cls</b> uses the Internet Server API, which opens a whole new world of potential applications beyond Daily Horoscope (see, for example,  <A HREF="http://www.microsoft.com/msj/0498/iis/iis.htm" TARGET="_top">Take IIS Customization to the Next Level by Writing ISAPI Filters and Script Interpreters</A> <IMG SRC="../../../sitebuilder/graphics/leave-site.gif" WIDTH="17" HEIGHT="11" BORDER="0" ALT="Non-SBN link">,  <A HREF="http://www.microsoft.com/mind/0197/isapi.htm" TARGET="_top">Taking the Splash:  Diving into ISAPI Programming</A> <IMG SRC="../../../sitebuilder/graphics/leave-site.gif" WIDTH="17" HEIGHT="11" BORDER="0" ALT="Non-SBN link">, or even  <A HREF="http://www.microsoft.com/isapi/goprem.asp?TARGET=/msdn/library/devprods/vc++/progsguide/f26/d2b/s2671.htm" TARGET="_top">ISAPI:  Extending Web Servers</A> <IMG SRC="../../../sitebuilder/graphics/leave-site.gif" WIDTH="17" HEIGHT="11" BORDER="0" ALT="Non-SBN link">).
<P>First we have to make our <A HREF="horopop3.htm" TARGET="_blank"
ONCLICK="return showSample('/workshop/server/feature/horopop3.htm')">Daily Horoscope server declarations</A>. The first three declarations are required to use the Internet Server API, and include function declarations for initializing an Internet connection, closing an open Internet connection handle, opening an Internet URL, and reading a file from a URL after a connection has been established.
<P>
We then declare all the constants for the various flag options we will use when we call the Internet functions and the variables we will use within the ActiveX component.
<P>
<PRE class=clsCode>Private Const INTERNET_OPEN_TYPE_PRECONFIG = 0
' indicates to use config info from registry
Private Const INTERNET_FLAG_EXISITING_CONNECT = &amp;H20000000
Private Const scBlankStr = &quot;&quot;
' blank string constant

Private zodiac              As String
Private hInternetSession    As Long
' internet session handle
Private bInitialized        As Boolean
' object initialization flag
Private hUrlFile            As Long
' utl handle
Private sContents           As String
' html page contents
Private sUserAgent          As String
' user agent in HTTP protocol
</PRE>

<P>
<h3><A NAME="GETHOROSCOPE"></A>The GetHoroscope() Method
</H3>
<P>
Next, we expose the <b>GetHoroscope()</b> method. As should be evident from the code snippet below, <b>GetHoroscope()</b> does not take in any parameters. Instead, it calls several functions that access the appropriate InfoSpace URL, strip out extraneous HTML, and interpret error-handling codes.
<P>First, <b>GetHoroscope()</b> declares <b>objHoroscope</b> a "Horoscope object" and <b>sUrl</b> a character string. It then checks to see if the <b>zodiac</b> property of the control has been set; if not, it assigns "Scorpio". (This is just additional bounds-checking, because Horoscope.asp should pass a valid <b>zodiac</b> property.) We then initialize the <b>Horoscope</b> object using <b><A HREF="acthoro.htm#init">Init()</A></b>, and set <b>sUrl</b> to download the horoscope content by appending the value of <b>zodiac</b> to a base InfoSpace URL (InfoSpace devotes one page to each sign). The <b>ReadUrl()</b> <A HREF="acthoro.htm#readurl"> method</A> is called (see below) which, if <b>True</b> (successfully read), sets a global variable pointing to the downloaded horoscope content, which itself has been parsed by <b><A HREF="acthoro.htm#getparsedhtml">GetParsedHTML()</A></b>. If false (not read successfully), the code generates a specific error message generated by <b><A HREF="acthoro.htm#translateerrorcode">TranslateErrorCode()</A></b>.

<p>
<PRE class=clsCode>Public Function GetHoroscope()

' Declare Horoscope object variable
Dim objHoroscope       As New Horoscope
Dim sUrl            As String
' Set default Zodiac sign to Scorpio -
' (A little bit of narcissism shouldn't hurt)
If zodiac = &quot;&quot; Then
    zodiac = &quot;scorpio&quot;
End If

'Instantiate Horoscope object
objHoroscope.Init
' Create the URL to connect to, using the zodiac property of the object
sUrl = &quot;http://in-100.infospace.com/_1_165483437__info/Horo/&quot;
&amp; zodiac &amp; &quot;.html&quot;
' Fetch the HTML File from the URL
If objHoroscope.ReadUrl(sUrl) = True Then
    ' Set the return string to the stripped down HTML File
    GetHoroscope = objHoroscope.GetParsedHTML(zodiac)

Else

    ' if ReadUrl method returned false, get error message and display
    GetHoroscope = &quot;&lt;h2&gt;Error - &quot; &amp; TranslateErrorCode(Err.LastDllError)
    &amp; &quot;! Please contact Sys Admin.&lt;/H2&gt;&quot;

End If
' Return control
End Function
</PRE>


<P>
<A NAME="INIT"></A><A HREF="horopop2.htm" TARGET="_blank"
    ONCLICK="return showSample('/workshop/server/feature/horopop2.htm')">The <b>Init()</b> function</a> carries out the initialization routines for the <b>Horoscope</b> object. Since <b>Horoscope</b> goes out onto the Web to fetch content, it qualifies as a Web browser application and thus requires an identification when it communicates with a Web server. <b>Horoscope</b> identifies itself as "Horoscope component v1.0" via the <b>sUserAgent</b> variable. The call to <b>InternetOpen()</b> returns a handle which sets the <b>bInitialized</b> variable to <b>True</b> or <b>False</b>. <b>InternetOpen()</b> is a function of the Internet Server API that establishes an Internet session based on parameters such as the Agent Identification, Access Type, Proxy server names, and more. (For a good starting point to learn about the Internet Server API, check out  <A HREF="http://www.microsoft.com/isapi/goprem.asp?TARGET=/msdn/library/techart/msdn_innetget.htm" TARGET="_top">The Internet Server API (or How to Get There from Here</A>, by Robert Coleridge.)
<P>
<A NAME="READURL"></A>Once <b>Init()</b> has done its stuff, <A HREF="horopop1.htm" TARGET="_blank"
    ONCLICK="return showSample('/workshop/server/feature/horopop1.htm')"><b>ReadURL()</b></a> is called. <b>ReadURL()</b> calls the Internet Server API function <b>InternetOpenURL()</b>, and instructs it to use an existing Internet connection (rather than open a new one). <b>ReadURL()</b> begins downloading content from the InfoSpace URL 2,048 bytes at a time (storing each pass into <i>sReadBuffer</i>), and continues until no more content is available (by checking whether <i>sReadBuffer</i> is blank).
    <p>
    Each iteration through the loop appends <i>sReadBuffer</i>'s content to the global variable <i>sContents</i><b> </b>and increments the <i>lTotalBytesRead</i> variable with the number of bytes read in each pass. The value parameter <i>lNumberOfBytesRead</i> is set when <b>InternetReadFile()</b> is called. The Binary variable <i>bDoLoop</i> is used as a flag to see if <b>InternetReadFile()</b> returns <b>True</b> (which means the end of the file has been reached). If the whole process of connecting to the URL and downloading its content is successful, <b>ReadURL()</b> returns <b>True</b>. <b>GetHoroscope()</b> uses this return value determine whether to parse the content (using <b>GetParsedHTML()</b>) or display an error message (using <b>TranslateErrorCode()</b>).
<P>
Because the Daily Horoscope is implemented as a class module within Aslan.dll, it will have a <b>Terminate</b> event associated with it (as all class modules do). It is good programming practice to execute other clean-up code (releasing resources, resetting variables, and so forth) within this event, which will be called every time a particular class (in our case, <b>Horoscope.cls</b>) is terminated.
<P>
<PRE class=clsCode>Private Sub Class_Terminate()
Term
End Sub
</PRE>
<P><b>Term</b> is where we store our clean-up code. It closes the Internet handle created when we initialized our Internet connection. It uses the Internet Server API function <b>InternetCloseHandle()</b>, and resets the <b>bInitialized</b> variable to False.
<P>
<PRE class=clsCode>Public Sub Term()
On Error Resume Next
If InternetCloseHandle(hInternetSession) Then
    bInitialized = False
End If
End Sub
</PRE>
<P><A NAME="GETPARSEDHTML"></A>If <b>ReadURL()</b> successfully accesses and downloads the content of the InfoSpace URL, <b>GetParsedHTML()</b> is called to take that content and prep it for display on the desktop. <b>GetParsedHTML()</b> takes in the <i>zodiac</i> parameter (remember that?), but as a string, and uses standard Visual Basic string-manipulation functions to extract the horoscope content from <i>sContents</i>. For example, we know that in the downloaded page, the horoscope content starts from the HTML tag &lt;H1&gt;. <b>GetParsedHTML()</b> searches for the string "&lt;H1&gt;" and returns all content from that point on. In the event that the page format has changed and it can't find &lt;H1&gt;, it returns the entire page.
<P>
<PRE class=clsCode>Property Get GetParsedHTML(zodiac As String) As String
' strip off the first part of the HTML
' and start from the zodiac heading
tokenToCheckFor = &quot;Horoscope for &quot; &amp; zodiac
startPos = InStr(1, sContents, tokenToCheckFor)
' if error, then start from the beginning
If startPos = 0 Then startPos = 1
' strip off last part of HTML
tokenToCheckFor = &quot;[&quot;
endPos = InStr(startPos, sContents, tokenToCheckFor)
' if error, then show till the end
If endPos = 0 Then
 GetParsedHTML = Mid(sContents, startPos)
Else
 GetParsedHTML = Mid(sContents, startPos, endPos - startPos)
End if
End Property
</PRE>
<P>The beauty of server objects lay in the fact that they expose properties and methods to the applications that call them. For example, Daily Horoscope exposes the <b>GetHoroscope()</b> method. We can create a property for our component using the Visual Basic <b>Property</b> declaration. In our case, the astrological sign is exposed as a property of Daily Horoscope . This allows pages that call Daily Horoscope to set <i>zodiac</i> as the desired sign and invoke the <b>GetHoroscope()</b> method to retrieve its associated horoscope. When the calling application sets the property, we use the Visual Basic command <b>Property Let</b>. In our case, we use <b>Let</b> to assign the zodiac value to <i>zodiac</i> when we instantiate the object.
<P>
<PRE class=clsCode>Property Let SunSign(sunsignFromObjectCall As String)
    ' Get the sunSign property from the call to the object
    ' in calling app and set zodiac variable
    zodiac = sunsignFromObjectCall
End Property
</PRE>
<P><A NAME="TRANSLATEERRORCODE"></A>The final portion of our Visual Basic code is the <A HREF="horopop5.htm" TARGET="_blank"
ONCLICK="return showSample('/workshop/server/feature/horopop5.htm')"><b>TranslateErrorCode()</b> function</a>. Because the Internet Server API responds with terse error numbers when calls do not go as planned, we need to translate those numbers into phrases that have meaning for users. <b>TranslateErrorCode()</b> returns a descriptive error message for all the possible error codes generated by the various ISAPI calls.
<P>
<A HREF="acthoro.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<p>
<a name="adapt"></a><h2>Adapting Daily Horoscope to Other Uses
</h2>
<P>As much as you might enjoy having a horoscope delivered to your site, lots of other uses of the Daily Horoscope Desktop are possible. The most obvious is a "Message of the Day" for corporate intranets. Many CEOs would enjoy the opportunity to broadcast a message about company activities, news, or even their own thoughts, quotes, or exhortations (remember, somebody's buying all the motivational stuff advertised on those in-flight catalogs).
<P>Adapting the Daily Horoscope code for the Message Of The Day application is straightforward. The crux of the application is the Internet API component that fetches content from any given URL and extracts any HTML text that lies within specified text tags.
To create your own Message of the Day, place the message within an HTML-style tags (such as &lt;!--MOTD and &lt;!--/MOTD) and tell the ISAPI functions to search for those tags. Also, you need to replace the URL in the component code to point to the intranet server that contains the Message Of The Day. Pretty simple, huh?
<P>
<A HREF="acthoro.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<p>
<a name="moreinfo"></a><h2>For More Information
</h2>
<P>If you're interested in learning more about the Active Desktop, a good place to start is another Site Builder Network article,  <A HREF="../../../workshop/delivery/desktop/actdeskie4/actdeskie4.htm">The Active Desktop for Internet Explorer 4.0</A>. It also covers lots of related topics such as Active Channels, the Information Delivery API, as well as the integration issues of the browser and the Windows&#174; shell.
<P>For more information on ASP, there's a whole section devoted to it in Site Builder's <A HREF="../../../workshop/server/default.htm">Server</A> area.
<P>I covered  <A HREF="acthoro.htm#key3">links to ISAPI articles</A> earlier.
<P>
<A HREF="acthoro.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<p>
<a name="summary"></a><h2>Summary
</h2>
<P>Daily Horoscope is a simple application that illuminates the possible interplay between Internet Explorer, Active Desktop, Active Server Pages, Visual Basic, and the Internet Server API. Daily horoscope delivery is just one of its uses. It is an interesting application that serves to demonstrate the power, flexibility, and ease-of-use of the Active Desktop Technology in developing and implementing applications that deliver information of interest directly to your virtual doorstep.
<P>Remember that error-checking and recovery are as important in a Web application as they are to any &quot;traditional&quot; application. The error-handling routines implemented in this example are quite basic. Before you deploy the application in a production environment, I would recommend some more error-checking and recovery using VBScript's error-trapping features (such as ON ERROR). Also bear in mind that the horoscope content appears courtesy of InfoSpace.com. The format of the page may change, or the site may cease operation.
<P>Please send comments and suggestions about the Daily Horoscope Application to kanna@servi.net. I would also like to hear about other modifications and feature additions that you decide to make to the application.
<P><i>Kannan Ramasubramanian graduated from the Government College of Technology, India, with a BS in Computer Technology. He currently works with <a href="http://www.servi.net" TARGET="_top">Servinet Consulting Group</a> <IMG SRC="../../../sitebuilder/graphics/leave-ms.gif" WIDTH="33" HEIGHT="11" BORDER="0" ALT="Non-MS link"> of San Francisco, CA, as a Technical Program Manager, where he provides Internet/intranet, E-Commerce, and Web-related development tools and services to clients.</i>
<P>
<A HREF="acthoro.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<p>
<h2><A NAME="appendix"></A>Appendix:  Installing the Daily Horoscope Application
</h2>
<P>Follow these steps to install Daily Horoscope on your system (you need to be running IIS 3.0 or later).
<OL>

<LI>    <A HREF="http://www.aslaninc.com/horoscope/horoscope.zip" TARGET="_top"><IMG SRC="../../../sitebuilder/graphics/icodownl.gif" WIDTH=16 HEIGHT=20 BORDER=0 ALT="Download"> Download the self-extracting archive</A> (zipped, 1,650K).
<LI>   Create a directory called Horoscope in the Web root of your server.
<LI>   Copy the downloaded file to that directory and execute the file.
<LI>   The setup will expand the .ASP files and create two subdirectories, \Object and \Source. The Object directory will contain the installation files for the ActiveX server object, and the Source directory the Visual Basic project source files.
<LI>   From the Object directory, run setup.exe. This will install Aslan<b>.</b>DLL on your server.
<LI>   Launch the MS-DOS Command prompt and navigate to your Windows NT&#174; System32 directory.
<LI>   Type &quot;regsvr32 aslan.dll&quot; and click Enter to register Aslan.DLL on your server.

</OL>You're ready to roll. To test the application, enter the URL in the address bar of Internet Explorer (http://<i>your_server_URL/</i>horoscope/horoscope.asp).
<P>


<P><P>
<P>







<!-- DOCUMENT CONTENT END -->

</DIV>

<DIV CLASS="clsDocBody">
<HR SIZE="1" />
<P><I>Did you find this article useful? Gripes? Compliments? Suggestions for other articles? <A TITLE="Go ahead. Make our day! Send us your thoughts." HREF="../../../sitebuilder/pg00270.htm" TARGET="_top">Write us!</A></I></P>
<P ID="pBackTop"><A HREF="acthoro.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif" WIDTH="18" HEIGHT="8" BORDER="0" ALT="Back to top">Back to top</A></P>

<P CLASS="clsIncCpyRt">

</P>

&copy; <A CLASS="clsIncCpyRt" HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">1998 Microsoft Corporation. All rights reserved. Terms of use</A>.

<P>&nbsp;</P>
</DIV>
<SCRIPT LANGUAGE="JavaScript"><!--

function CheckToTop()
{
var eBody = document.body;
if (eBody.scrollHeight > eBody.offsetHeight) pBackTop.style.display = 'block';
}

//--></SCRIPT>

<DIV ID="divMenu1" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="../../../sitebuilder/magazine/default.htm">Magazine Home</DIV>
<DIV expURL="../../../sitebuilder/magazine/jane.htm">Ask Jane</DIV>
<DIV expURL="../../../sitebuilder/magazine/dude.htm">DHTML Dude</DIV>
<DIV expURL="../../../sitebuilder/magazine/xml.htm">Extreme XML</DIV>
<DIV expURL="../../../sitebuilder/magazine/starters.htm">For Starters</DIV>
<DIV expURL="../../../sitebuilder/magazine/hess.htm">More or Hess</DIV>
<DIV expURL="../../../sitebuilder/magazine/server.htm">Servin' It Up</DIV>
<DIV expURL="../../../sitebuilder/magazine/site.htm">Site Lights</DIV>
<DIV expURL="../../../sitebuilder/magazine/webmen.htm">Web Men Talking</DIV>
</DIV>
<DIV ID="divMenu2" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="http://www.microsoft.com/sbnmember/default.asp">Member Community Home</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/freebies/default.asp">Benefits: Freebies &amp; Discounts</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/promote/default.asp">Benefits: Promote Your Site</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/connect/default.asp">Benefits: Connect with Your Peers</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/glance-lev.asp">Benefits at a Glance</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/osig/default.asp">Online Special-Interest Groups</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/levels/member.asp">Your Membership</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/freebies/stores.asp">SBN Stores</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/apply/registration.asp">Join Now</DIV>
</DIV>
<DIV ID="divMenu3" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="../../../workshop/default.htm">Workshop Home</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/essentials/default.htm">Essentials</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/delivery/default.htm">Content &amp; Component Delivery</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/components/default.htm">Component Development</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/database/default.htm">Data Access &amp; Databases</DIV>
<DIV expURL="../../../workshop/design/default.htm">Design</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/author/default.htm">DHTML, HTML &amp; CSS</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/xml/default.htm">Extensible Markup Language (XML)</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/languages/default.htm">Languages &amp; Development Tools</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/messaging/default.htm">Messaging &amp; Collaboration</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/networking/default.htm">Networking, Protocols &amp; Data Formats</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/browser/default.htm">Reusing Browser Technology</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/security/default.htm">Security &amp; Cryptography</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/server/default.htm">Server Technologies</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/imedia/default.htm">Streaming &amp; Interactive Media</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/management/default.htm">Web Content Management</DIV>
<DIV expURL="../../../workshop/index/default.htm">Workshop Index</DIV>
</DIV>
<DIV ID="divMenu4" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="../../../gallery/default.htm">Tools &amp; Samples Home</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/gallery/tools/default.htm">Tools</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/gallery/samples/default.htm">Samples, Headers, Libs</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/gallery/images/default.htm">Images</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/gallery/sounds/default.htm">Sounds</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/gallery/stylesheets/default.htm">Style Sheets</DIV>
<DIV expURL="http://www.microsoft.com/typography/fontpack/win.htm">Web Fonts</DIV>
</DIV>
<DIV ID="divMenu5" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="../../../devtraining/default.htm">Training Home</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/seminars/default.htm">SBN Live Seminars</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/chat/default.htm">SBN Live Chats</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/atec.htm">Courses</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/peer/default.htm">Peer Support</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/mastering.htm">CD-ROM Training</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/books_kits.htm">Books & Training Kits</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/mscert/default.htm">Certification</DIV>
</DIV>
<DIV ID="divMenu6" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="../../../sitebuilder/default.htm">SBN Home</DIV>
<DIV expURL="../../../sitebuilder/siteinfo/newtosite.htm">New to SBN?</DIV>
<DIV expURL="../../../sitebuilder/whatsnew.htm">What's New on SBN</DIV>
<DIV expURL="../../../sitebuilder/siteinfo/sitemap.htm">Site Map</DIV>
<DIV expURL="http://www.microsoft.com/isapi/gosearch.asp?TARGET=/dev/web/default.asp">Site Search</DIV>
<DIV expURL="../../../sitebuilder/siteinfo/glossary/default.htm">Glossary</DIV>
<DIV expURL="../../../sitebuilder/write-us.htm">Write Us</DIV>
<DIV expURL="../../../sitebuilder/siteinfo/about.htm">About This Site</DIV>
</DIV>
<SCRIPT LANGUAGE="JavaScript" SRC="../../../sitebuilder/shared/js/navbar.js"></SCRIPT> 
<SCRIPT LANGUAGE="JavaScript" SRC="../../../sitebuilder/shared/js/navlinks.js"></SCRIPT>


</BODY>
</HTML>