<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML><HEAD><TITLE>Example 7</TITLE>
<META NAME="ROBOTS" CONTENT="NOINDEX">

</HEAD>
<!--DocHeaderStart-->
<BODY TOPMARGIN=0 LEFTMARGIN=10 BGCOLOR="#FFFFFF" LINK="#000066" VLINK="#666666" TEXT="#000000">
<!--TOOLBAR_START-->
<!--TOOLBAR_EXEMPT-->
<!--TOOLBAR_END-->

<FONT FACE="verdana,arial,helvetica" SIZE="2">
<!--DocHeaderEnd-->
<P>&nbsp;
<P><b>Code to print a list of all users viewing the current page</b>
<P>
<P>
<PRE><FONT FACE="COURIER" SIZE="2">
set conn = CreateObject(&quot;ADODB.Connection&quot;)
conn.Provider = &quot;ADsDSOObject&quot;
conn.Open &quot;ADs Provider&quot;

queryString = &quot;&lt;LDAP://myserver:389/o=microsoft/ou=<b>SessionStateData</b>&gt;;(&amp;(objectClass=SessionState)(currentPath=&quot; &amp; Request(&quot;SCRIPT_NAME&quot;) &amp;&quot;));ADsPath,cn;SubTree&quot;

Set rs = conn.Execute( queryString, numRecords, 1 )

Do While Not rs.EOF
 Response.Write rs(&quot;cn&quot;) &amp; &quot;&lt;br&gt;&quot;

 rs.MoveNext
Loop
</FONT></PRE><P>&nbsp;

</BODY></HTML>

