
<HTML>
<HEAD>


<TITLE>Site Server 3.0: Creating a Search Catalog for Your Site</TITLE>

<META NAME="Description" CONTENT="Site Server 3.0 feature articles" />
<META NAME="Keywords" CONTENT="Site Server" />
<META NAME="Robots" CONTENT="All" />

<META NAME="Author" CONTENT="Dina Berry" />
<META NAME="Posted" CONTENT="" />
<META NAME="Updated" CONTENT="07/27/1998" />

<META NAME="MS.LOCALE" CONTENT="EN-US" />
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1" />

<LINK REL="stylesheet" TYPE="text/css" HREF="../../../sitebuilder/shared/css/navbar.css" />
<LINK REL="stylesheet" TYPE="text/css" HREF="../../../sitebuilder/shared/css/ie4-wks.css" />


<SCRIPT LANGUAGE="JavaScript"><!--

// -----------------------------------------------------------
// Client-side BrowserData constructor
// Populated using data from server-side oBD object to avoid redundancy
// -----------------------------------------------------------

function BrowserData()
{
this.userAgent = "Mozilla/4.0 (compatible; MSIE 4.01; Windows NT)";
this.browser = "MSIE";
this.majorVer = "4";
this.minorVer = "01";
this.betaVer = 0;
this.platform = "NT";
this.getsNavBar = true;
this.doesActiveX = true;

}
var oBD = new BrowserData();

//--></SCRIPT>

<SCRIPT LANGUAGE="Javascript"><!--

// -----------------------------------------------------------
// window_load()
// Container function for load.
// -----------------------------------------------------------

function window_load()
{
if (oBD.getsNavBar)
{
if ("function" == typeof(InitNavLinks)) InitNavLinks();
if ("function" == typeof(CheckToTop)) CheckToTop();
}
}
window.onload = window_load;

//--></SCRIPT>

<SCRIPT LANGUAGE="JavaScript"><!--

  function showSample(sURL) {
    sFeatures = "width=520,height=400,left=10,top=10,toolbar=0,statusbar=0,scrollbars=1,resizable=1";
    newWin = window.open (sURL, "_blank", sFeatures);
    return false;
  }

//--></SCRIPT>


</HEAD>

<BODY TOPMARGIN="0" LEFTMARGIN="0" MARGINHEIGHT="0" MARGINWIDTH="0" BGCOLOR="#FFFFFF">


<TABLE WIDTH="100%" CELLPADDING="0" CELLSPACING="0" BORDER="0">
<TR>
<TD ROWSPAN="2" WIDTH="460" VALIGN="top"><NOBR><A HREF="http://www.microsoft.com/" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/home.gif" WIDTH="103" HEIGHT="21" ALT="Microsoft Home" BORDER="0"></A><A HREF="http://www.microsoft.com/PRODUCTS/DEFAULT.asp?DIVISIONID="10"" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/prod.gif" WIDTH="81" HEIGHT="21" ALT="products" BORDER="0"></A><A HREF="http://www.microsoft.com/search/default.asp" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/search.gif" WIDTH="68" HEIGHT="21" ALT="search" BORDER="0"></A><A HREF="http://www.microsoft.com/ISAPI/GOSUPPORT.asp?TARGET=/SUPPORT/" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/support.gif" WIDTH="74" HEIGHT="21" ALT="support" BORDER="0"></A><A HREF="http://www.microsoft.com/referral/default.asp" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/shop.gif" WIDTH="55" HEIGHT="21" ALT="shop" BORDER="0"></A><A HREF="http://www.microsoft.com/ISAPI/GOREGWIZ.asp?TARGET=/REGWIZ/REGWIZ.asp" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/write.gif" WIDTH="78" HEIGHT="21" ALT="Write Us" BORDER="0"></A><IMG SRC="../../../library/images/gifs/toolbar/spacer.gif" WIDTH="1" HEIGHT="21" ALT="" BORDER="0"></NOBR></TD>
<TD BGCOLOR="#000000" WIDTH="100%" HEIGHT="20">&nbsp;</TD>
<TD ROWSPAN="2" WIDTH="91" ALIGN="right" VALIGN="top"><A HREF="http://www.microsoft.com/" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/msft.gif" WIDTH="91" HEIGHT="21" ALT="Microsoft Home" BORDER="0"></A></TD>
</TR>
<TR>
<TD COLSPAN="3" BGCOLOR="#FFFFFF" WIDTH="100%" HEIGHT="1"></TD>
</TR>
</TABLE>

<TABLE ID="tblNavBar" BORDER="0" CELLPADDING="0" CELLSPACING="0">
<TR VALIGN="top">
<TD CLASS="clsSBNLogo" TITLE="SBN Home" HEIGHT="34" WIDTH="90"><A HREF="/sitebuilder/default.htm" TARGET="_top" expNoTOC="true"><IMG HEIGHT="34" WIDTH="90" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/sbnbrand2.gif" ALT="SBN Home" /></A></TD>
<TD CLASS="clsNavBarItem" expItemNum="1">Magazine<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD>&nbsp;|&nbsp;</TD>
<TD CLASS="clsNavBarItem" expItemNum="2">Community<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD>&nbsp;|&nbsp;</TD>
<TD CLASS="clsNavBarItem" expItemNum="3">Workshop<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD>&nbsp;|&nbsp;</TD>
<TD CLASS="clsNavBarItem" expItemNum="4">Tools&nbsp;&amp;&nbsp;Samples<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD>&nbsp;|&nbsp;</TD>
<TD CLASS="clsNavBarItem" expItemNum="5">Training<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD>&nbsp;|&nbsp;</TD>
<TD CLASS="clsNavBarItem" expItemNum="6">Site&nbsp;Info<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD WIDTH="100%"></TD>
</TR>
</TABLE>


<TABLE ID="tblNavLinks" CLASS="clsNavLinks" CELLPADDING="0" CELLSPACING="0" BORDER="0" WIDTH="100%">
<TR>
<TD COLSPAN="2" HEIGHT="8"><IMG WIDTH="1" HEIGHT="8" SRC="../../../sitebuilder/shared/graphics/trans.gif"></TD>
<TD ROWSPAN="2"><A HREF="../../../workshop/default.htm" TARGET="_top"><IMG ALIGN="right" HEIGHT="30" WIDTH="106" BORDER="0" ALT="Click to return to the Workshop home page" SRC="../../../workshop/graphics/wrkbrand2.gif" /></A><BR /></TD>
</TR>
<TR>
<TD ROWSPAN="2">
<A HREF="../../../workshop/server/pg00164.htm"><IMG HEIGHT="32" WIDTH="31" HSPACE="25" BORDER="0" ALT="Click to return to the Server Technologies home page" SRC="../../../workshop/graphics/icons//server.gif" /></A>
</TD>
<TD>
<TABLE CELLPADDING="3" CELLSPACING="0" BORDER="0">
<TR>

<TD><A ID="lnkShowImg" HREF="../../../workshop/server/toc.htm" TARGET="_top"><IMG ID="imgShow" CLASS="clsLeftMenu" HEIGHT="15" WIDTH="18" BORDER="0" SRC="../../../workshop/graphics/icons/nl-show-0.gif" ALT="" /></A><BR></TD>
<TD NOWRAP><A ID="lnkShowText" CLASS="clsLeftMenu" HREF="../../../workshop/server/toc.htm" TARGET="_top">show toc</A> &nbsp;&nbsp; </TD>

<TD><A ID="lnkSyncImg" HREF="../../../workshop/pg07280.htm#/workshop/server/nextgen/searchcatalog.htm" TARGET="_top"><IMG ID="imgSync" CLASS="clsLeftMenu" HEIGHT="15" WIDTH="18" BORDER="0" SRC="../../../workshop/graphics/icons/nl-sync-0.gif" ALT="" /></A><BR></TD>
<TD NOWRAP><A ID="lnkSyncText" CLASS="clsLeftMenu" HREF="../../../workshop/pg07280.htm#/workshop/server/nextgen/searchcatalog.htm" TARGET="_top">sync toc</A> &nbsp;&nbsp; </TD>

<TD><A ID="lnkSearchImg" HREF="http://www.microsoft.com/isapi/gosearch.asp?TARGET=/dev/web/default.asp" TARGET="_top"><IMG ID="imgSearch" CLASS="clsLeftMenu" HEIGHT="15" WIDTH="18" BORDER="0" SRC="../../../workshop/graphics/icons/nl-search-0.gif" ALT="" /></A><BR></TD>
<TD NOWRAP><A ID="lnkSearchText" CLASS="clsLeftMenu" HREF="http://www.microsoft.com/isapi/gosearch.asp?TARGET=/dev/web/default.asp" TARGET="_top">search</A> &nbsp;&nbsp; </TD>

<TD><A ID="lnkIndexImg" HREF="../../../workshop/index/pg00001.htm"><IMG ID="imgIndex" CLASS="clsLeftMenu" HEIGHT="15" WIDTH="18" BORDER="0" SRC="../../../workshop/graphics/icons/nl-index-0.gif" ALT="" /></A><BR></TD>
<TD NOWRAP><A ID="lnkIndexText" CLASS="clsLeftMenu" HREF="../../../workshop/index/pg00001.htm">index</A> &nbsp;&nbsp; </TD>

</TR>
</TABLE>
</TD>
</TR>
<TR>
<TD COLSPAN="2" WIDTH="100%">
<TABLE CELLPADDING="2" CELLSPACING="0" BORDER="0">
<TR>
<TD>&nbsp;</TD>
</TR>
</TABLE>
</TD>
</TR>
</TABLE>

<BR CLEAR="all" />
<DIV CLASS="clsBucketBranch"><A HREF="../../../workshop/pg00004.htm" TARGET="_top">Workshop</A>&nbsp;&nbsp;|&nbsp;&nbsp;<A HREF="../../../workshop/pg07280.htm#/workshop/server/pg00164.htm" TARGET="_top">Server Technologies</A></DIV>

<DIV CLASS="clsDocBody">

<!-- DOCUMENT CONTENT START -->

<H1><a name="top" IDX_TYPES="sbngen" IDX_CONCEPT="stopindex; Site Server, creating a search catalog for your site">Creating a Search Catalog for Your Site with Site Server 3.0</A></H1>
<HR SIZE="1" />
<P>Dina Berry<br>15 Seconds
<P>June 19, 1998

<P><a href="searchcatalog.zip"><IMG SRC="../../../sitebuilder/graphics/icodownl.gif" WIDTH=16 HEIGHT=20 BORDER=0 ALT="Download"> Download this document in Microsoft Word (.DOC) format (zipped, 379K)</a>.
<P>
<b>Contents</b>
<br> <A HREF="searchcatalog.htm#topic1">Introduction</A>
<BR> <A HREF="searchcatalog.htm#topic2">How Search Uses Index Server</A>
<BR> <A HREF="searchcatalog.htm#topic3">Content Sources You Can Search</A>
<BR> <A HREF="searchcatalog.htm#topic4">Creating a Search Catalog</A>
<BR> <A HREF="searchcatalog.htm#topic5">Searching the Catalog</A>
<BR> <A HREF="searchcatalog.htm#topic6">Performance Issues</A>
<BR> <A HREF="searchcatalog.htm#topic7">Summary</A>
<P><b>Return to Site Server 3.0 Feature pages</b>
<br><a href="siteservfeat.htm">Go to SBN Overview page</a>
<br><A HREF="http://www.microsoft.com/msdn/news/feature/042798/ssummary.htm" TARGET="_top">Go to MSDN Summary page</a> <A HREF="http://www.microsoft.com/msdn/" TARGET="_top"><IMG src="/msdn/art/msdn50x25.gif" border="0" width="50" height="25" alt="MSDN Online"></A>

<br><A HREF="http://www.microsoft.com/msdn/news/feature/042798/default.htm" TARGET="_top">Go to MSDN Overview page</a> <A HREF="http://www.microsoft.com/msdn/" TARGET="_top"><IMG src="/msdn/art/msdn50x25.gif" border="0" width="50" height="25" alt="MSDN Online"></A>



<P>


<a name="topic1"></a><h2>Introduction</h2>
<P>With the glut of information available on the Internet, a Web site must have a superior searching mechanism to help users quickly find what they are looking for and encourage return visits. Microsoft Index Server was the first step in that direction. <A HREF="http://www.microsoft.com/siteserver/default.asp" TARGET="_top">Site Server 3.0 Search </a> <IMG SRC="../../../sitebuilder/graphics/leave-site.gif" WIDTH="17" HEIGHT="11" BORDER="0" ALT="Non-SBN link"> enables a Web site to gather and catalog information from just about anywhere and make it available to customers through an effective search page. </P>
<P>This article assumes that you have a working knowledge of Web site administration and server hardware and software. No previous knowledge of Site Server Search is assumed, but I recommend that you download the <A HREF="http://www.microsoft.com/siteserver/intranet/Update/sdk.asp?A=5&amp;B=1" TARGET="_top">Site Server SDK</A>  <IMG SRC="../../../sitebuilder/graphics/leave-site.gif" WIDTH="17" HEIGHT="11" BORDER="0" ALT="Non-SBN link"> for more detailed information and examples on Site Server and Site Server Search.
<h3>How Search Works</h3>
<P>Implementing Search on your site consists of two primary tasks. </P>
<P>The first step is to define the catalog. The <I>catalog</I> is a searchable unit of information that is defined by where that information is originally stored, what subset of the entire information is indexed, and how often the information is re-crawled. </P>
<P>Once you have defined the catalog, you need to get the catalog built so that it can be propagated. <I>Propagation </I>is the ability to have a single machine gather new or updated  information and duplicate that information onto many machines for your customers to search. The process of building the catalog requires the crawler to go through your set of information, index the information, and then propagate it to other Search servers. After the catalog has been propagated, it is available to your users to search from an Active Server Pages (ASP) page. </P>

<P> <A HREF="searchcatalog.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>

<a name="topic2"></a><h2>How Search Uses Index Server</h2>
<P>Index Server, available in Microsoft Internet Information Server 4.0, provides elementary search capabilities for your Web site. Index Server works by tracking file changes in specified directories. When a file is added to one of those directories, Index Server looks at the file for file properties and adds those properties to its catalog. The index is then searchable from an ASP page.</P>
<h3>Differences Between Site Server Search and Index Server</h3>
<P>Site Server Search uses Index Server features to find file properties and store them in the catalog. Index Server can only monitor a file system location. The Search server  retrieves the file or information from its original location and uses the Index Server functionality to index the files. Once the catalog is built, Search propagates the catalog to other Search servers. Search doesn’t use Index Server itself, just its features. You can stop Index Server while building a catalog to reduce the requests the machine has to fulfill while building the catalog.</P>
<h3>File Properties: A Key Concept</h3>
<P><i>File properties</i> are key pieces of information such as the title, text, size, and date of a document. All files have similar properties, but properties are stored in different locations depending on the file type. Some files have properties that only make sense for that file type. For example, a title in HTML is within the &lt;TITLE&gt; tag while a Microsoft Office document keeps the title in the document properties. An image document will have information about the compression type while Office and HTML documents do not need compression type properties. Index Server uses the <b>IFilter</b> interface to find those properties. <b>IFilter</b> is a specification for how to write filters and return file property information. Index Server chooses the <b>IFilter</b> to use based on the file’s extension. Search lets you define what type of files to gather or ignore by the file extension as well. </P>

<P> <A HREF="searchcatalog.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>

<a name="topic3"></a><h2>Content Sources You Can Search</h2>
<P>The strength of Site Server Search is its ability to gather information from very different data stores. With Search, you can catalog information from a file system, a Web site, a Microsoft Exchange Server, or from an open database connectivity (ODBC) data source. Each of these data stores may require authentication so the Search crawler must be configured to have the necessary permissions to those data stores. </P>

<P> <A HREF="searchcatalog.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>

<a name="topic4"></a><h2>Creating a Search Catalog</h2>
<P>To illustrate how easy it is to create a Search catalog, you need to see it for yourself. In the following example, we will create a catalog of both Web- and file-based content, build the catalog, and verify that the catalog is propagated.</P>
<P>&nbsp;</P>
<B><P>Step 1. Open the Site Server Administration tool for MMC (Microsoft Management Console). </P>
</B>
<P>To open this application, go to the Start menu and choose Programs, Microsoft Site Server, Administration, and Site Server Service Admin (MMC). Open the tree at the Search node until the machine name is visible. If you double-click the machine name, you'll see two nodes called Catalog Definition and Search Server. The default installation of Site Server defines two catalogs for you. These appear in Figure 1. Because these catalogs are built and propagated to this machine, the catalogs show up in both the Catalog Definition node and the Search Server node. </P>
<P><IMG SRC="searchfigure1.gif" ALT="*">
<P><b>Figure 1. Site Server Search Administration in MMC</b>
<br>&nbsp;
<B><P>Step 2. Create the catalog</P>
</B><P>Right-click the Catalog Definition node, and choose New Catalog Definition. A dialog box will appear and ask for the catalog name. In this example, the catalog is <b>SBN1</b>. The next window in the catalog definition process is displayed in Figure 2. The figure shows two sources to search. The first is a file location and the second is a Web address.</P>
<P><IMG SRC="searchfigure2.gif" ALT="*">
<P><B>Figure 2. General tab of Catalog Definition property sheet</b></P>
<br>&nbsp;
<P><B>Step 3. Configure an information location
</B><P>The properties for a file or Web crawl are set on the same tab and displayed in Figure 3. The properties for the file location can be set to search all subdirectories or to crawl to a specified depth. The properties for the Web location can be set to the entire site (default), a certain number of pages, or a certain number of Web-site hops. ( If you link to another site, and that site links to another site and so on, the number of hops is the number of links Serach should follow.) If you want to search a portion of your site, set the virtual directories to be included and excluded on the Sites tab of the Catalog Definition property sheet. </P>
<P><IMG SRC="searchfigure3.gif" ALT="*"><P><b>Figure 3. File/Web crawl properties</b></P>
<br>&nbsp;
<B><P>Step 4. Propagation</B>
<P>The next step is to choose what server will receive the built catalog. Figure 4 shows the Propagation tab of the Catalog Definition property sheet. In this example, I have one machine name (the local machine) in the list. For a site hosted by multiple machines, where each machine needs to provide access to the search catalog, the propagation list should contain all the servers. </P>
<P><IMG SRC="searchfigure4.gif" ALT="*"><P><b>Figure 4. Propagation properties</b></P>
<br>&nbsp;
<B><P>Step 5. Building the catalog</B>
<P>At this point, the catalog is defined with enough information that it can be built. Go to the Status tab. On the arrow to the right of the status box in Figure 5, choose the Build option from the list of options. The status will tell you how many files have been crawled and when the process started. </P>
<P><IMG SRC="searchfigure5.gif" ALT="*"><P><b>Figure 5. Building the catalog</b></P>
<br>&nbsp;
<B><P>Step 6. Searching the catalog</B>
<P>Once the catalog is propagated, you can test the catalog by searching for a keyword or phrase from the Search Server’s catalog node in the MMC. <A HREF="searchcatex01.htm" TARGET="_blank"
    ONCLICK="return showSample('/workshop/server/nextgen/searchcatex01.htm')">Figure 6</a> illustrates using the search feature for the term "cab." The right-hand side of the MMC shows the location of the  search page that my customers can use. I can also search for a term and see the results.</P>
 <P>&nbsp;</P>
<h3>Other Options</h3>
</B><P>The example above describes a simple search catalog. There are more options available to you when defining your catalog. On the Schedule Builds tab of the Catalog Definition properties, you can schedule either a full build or an incremental build. A full build looks at every file even if it hasn't changed since the last build. An incremental build looks for new files or files that have changed since the last build and only indexes those files. Use the incremental build to decrease the time the build takes. After several incremental builds, schedule a full build.</P>
<P>You can also use the scheduler to define when the content should be rebuilt. If you want to build your catalog from a staging server, you will need to map from the staging server location to the live server location. Use the URLs tab of the Catalog Definition for this feature. If you want to crawl or ignore certain file extensions, use the File Types tab of the Catalog Definition for this feature. The default file types include: ASP, DOC, EXCH, HTM, HTML, PPT, TXT, and XLS.</P>
<h3><P>Notifications
</h3><P>You may want a file crawled immediately after it is changed or added, instead of looking for file changes at a regularly scheduled time. To do this, notify the Search server of those changes. This is the second catalog type of Notification shown in Figure 2. This is a powerful feature because it will save machine resources by doing only the work required instead of looking at every file on the schedule. For more information about notification sources, look at the DirMon sample in the <A HREF="http://www.microsoft.com/siteserver/intranet/Update/sdk.asp?A=5&amp;B=1" TARGET="_top">Site Server 3.0 SDK</A> <IMG SRC="../../../sitebuilder/graphics/leave-site.gif" WIDTH="17" HEIGHT="11" BORDER="0" ALT="Non-SBN link">. </P>


<P> <A HREF="searchcatalog.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>

<a name="topic5"></a><h2>Searching the Catalog</h2>
<P>Now that we have built the catalog and searched it from the Site Server Admin MMC, you need to let your customers search it. The quick, easy way is to use the Search page provided for you, which is listed on the right-hand side of Figure 6.

<P>Figure 7 shows the default Search page available for all propagated catalogs on this server. The search can be limited to a specific catalog by choosing the catalog name in the drop-down list or include all catalogs on the server. You don’t need to change anything on the page for search to work.
<P>
<P><IMG SRC="searchfigure7.gif" ALT="*"><P><b>Figure 7. Default Search page</b></P>


<A HREF="searchcatex03.htm" TARGET="_blank"
    ONCLICK="return showSample('/workshop/server/nextgen/searchcatex03.htm')">Figure 8</a> shows the results of the same query used in Figure 6. </P>

<P>At this point, you won’t have to write a single line of code. All the work has been in defining the catalog. The ability to search the catalog was available as part of the installation of Site Server.</P>
<h3>Searching with ASP</h3>
<P>The Search page in Figure 7 was developed using the Search object model (documented in the Site Server 3.0 SDK). This object model enables programmers to create their own search pages. To develop your own search page, I’ll assume you understand the ActiveX&reg; Database Objects (ADO) provided with Internet Information Server (IIS) 4.0. These objects enable you to define a query, run the query, and return a result set in ASP. Site Server Search uses these objects to query the search catalog. </P>
<P>To search the catalog, you should know the name of the catalog, the columns you want to display, the sort order, and the term to search for. There are a lot more properties you can set but these are the basic properties to set for a simple search. Once you set these properties, you execute the query and display the results of the record set.</P>
<h3>Developing the Search Page</h3>
<P>The following code illustrates how simple it is to write a search page. The Search object is created, a few properties are set, the query is executed, and the result set is displayed. The list of columns available to search and display is noted in the product documentation. There are over ten samples of Search ASP pages (from simple to complex) provided in the product documentation. You can develop search ASP pages to deal with issues such as duplicate entries, sorting, grouping, and limiting the number of records to return. You can alter the noise words (such as "the," "is," and "to") to ignore words that are ubiquitous in your site's content. By adding words to the noise list, you can speed up the query time. </P>
<P>Simple Search</P>
<pre class=clsCode>
set Q = Server.CreateObject("MSSearch.Query")
Q.SetQueryFromURL(Request.QueryString)
Q.Catalog = Request("ct")
Q.Columns = "DocTitle, DocAddress, FileName"
set RS = Q.CreateRecordSet("sequential")
Do while not RS.EOF
Response.Write "&lt;a href = " &amp; RS("DocAddress") &amp; "&gt;"
Response.Write RS("DocTitle") &amp; ", "
Response.Write RS("FileName")
Response.Write RS "&lt;/a&gt;"
RS.MoveNext
Loop
Set RS = nothing
Set Q = nothing

</pre>

<h3>Capturing Search Queries in the Log Files </h3>
<P>As a Web site administrator, you may want to use the IIS log file to store information about customers’ searches. Once the information is in the log, you can use Site Server's built-in Analysis features to generate a report about how your customers used the search page. </P>
<P>The IIS 4.0 Response object’s <b>AppendToLog</b> method is required to add search information to your log file. Search provides four variables to add information to the log file: the catalog, the query, the start hit, and the number of results found. Because some of these values may have commas and/or spaces, you will need to programmatically change these. A comma should be converted to a "+" sign. A space should be converted to "%20". Once these are converted, the information can be added to the log file. The code below shows how to add search information to a log file. The code uses the "&amp;" (ampersand) to append parameters to the query string. The listing assumes that the search term is passed to the search page with a parameter name of "qu". </P>
<P>Adding Search information to a log file.</P>
<pre class=clsCode>

LogInfo = "&amp;MSS.request.Search Catalog=" &amp; Q.Catalog
LogInfo = "&amp;MSS.request.Search Start Hit=" &amp; Q.StartHitLog
LogInfo = "&amp;MSS.request.Search Query=" &amp; Request("qu")
LogInfo = "&amp;MSS.request.Search Row Count="&amp; RS.Properties("RowCount")
LogInfo = Replace(LogInfo, ",", "+")
Loginfo = Replace(LogInfo, " ", "%20")
Response.AppendToLog InfoToLog

</pre>
<P> <A HREF="searchcatalog.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>

<a name="topic6"></a><h2>Performance Issues</h2>
<P>Building and searching the catalog are both computer-intensive tasks. If you have the physical machines available, you should separate the processes by using different machines for each. A single machine can build the catalogs and propagate the catalogs to the live search servers. </P>
<P>When building the catalog, you can set the time between the request for each file. For an Internet site, you may want to set more time between each requested document so that you don’t overwhelm the Internet server. On a local network, you can set a shorter time between each document. You will also want to adjust the timeout value based on the local or Intranet server. The timeout value means how long the crawler will wait for a file before going on to the next file request. </P>
<P>Because building the catalog is very computer-intensive, you may want to control how many system resources the crawler uses. If the machine is used for more than the building of the catalogs, you would want to lower the amount of resources used. If the machine is dedicated to building the catalog, you could configure the crawler to use more of the system resources. </P>
<P>When the Search server finds files that match the query, it needs to compare the files against a lot of columns in each row of the configuration table. Some of these columns may not be interesting and could be removed. Removing columns from the search schema will decrease the time required to answer most queries. </P>

<P> <A HREF="searchcatalog.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>

<a name="topic7"></a><h2>Summary</h2>
<P>Site Server Search is a great tool for any Web site. Search is so easy to use that you don’t even have to know how to program ASP to use it. But for those who need to customize their gathering and searching tasks, all the features and programming objects are available to give your customers the information they are looking for when they visit your site. </P>
<P>Dina Berry is a developer and writer for <a href="http://www.signmeup.com/" TARGET="_top">http://www.signmeup.com</a> <IMG SRC="../../../sitebuilder/graphics/leave-ms.gif" WIDTH="33" HEIGHT="11" BORDER="0" ALT="Non-MS link">, an Internet
Marketing company. She is also a frequent contributing author to
<a href="http://www.15seconds.com/" TARGET="_top">http://www.15seconds.com</a> <IMG SRC="../../../sitebuilder/graphics/leave-ms.gif" WIDTH="33" HEIGHT="11" BORDER="0" ALT="Non-MS link">. She can be reached at <a href="mailto:dina@signmeup.com">dina@signmeup.com</a>.



<P><P>
<P>







<!-- DOCUMENT CONTENT END -->

</DIV>

<DIV CLASS="clsDocBody">
<HR SIZE="1" />
<P><I>Did you find this article useful? Gripes? Compliments? Suggestions for other articles? <A TITLE="Go ahead. Make our day! Send us your thoughts." HREF="../../../sitebuilder/pg07279.htm" TARGET="_top">Write us!</A></I></P>
<P ID="pBackTop"><A HREF="searchcatalog.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif" WIDTH="18" HEIGHT="8" BORDER="0" ALT="Back to top">Back to top</A></P>

<P CLASS="clsIncCpyRt">

</P>

&copy; <A CLASS="clsIncCpyRt" HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">1998 Microsoft Corporation. All rights reserved. Terms of use</A>.

<P>&nbsp;</P>
</DIV>
<SCRIPT LANGUAGE="JavaScript"><!--

function CheckToTop()
{
var eBody = document.body;
if (eBody.scrollHeight > eBody.offsetHeight) pBackTop.style.display = 'block';
}

//--></SCRIPT>

<DIV ID="divMenu1" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="../../../sitebuilder/magazine/default.htm">Magazine Home</DIV>
<DIV expURL="../../../sitebuilder/magazine/jane.htm">Ask Jane</DIV>
<DIV expURL="../../../sitebuilder/magazine/dude.htm">DHTML Dude</DIV>
<DIV expURL="../../../sitebuilder/magazine/xml.htm">Extreme XML</DIV>
<DIV expURL="../../../sitebuilder/magazine/starters.htm">For Starters</DIV>
<DIV expURL="../../../sitebuilder/magazine/hess.htm">More or Hess</DIV>
<DIV expURL="../../../sitebuilder/magazine/server.htm">Servin' It Up</DIV>
<DIV expURL="../../../sitebuilder/magazine/site.htm">Site Lights</DIV>
<DIV expURL="../../../sitebuilder/magazine/webmen.htm">Web Men Talking</DIV>
</DIV>
<DIV ID="divMenu2" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="http://www.microsoft.com/sbnmember/default.asp">Member Community Home</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/freebies/default.asp">Benefits: Freebies &amp; Discounts</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/promote/default.asp">Benefits: Promote Your Site</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/connect/default.asp">Benefits: Connect with Your Peers</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/glance-lev.asp">Benefits at a Glance</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/osig/default.asp">Online Special-Interest Groups</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/levels/member.asp">Your Membership</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/freebies/stores.asp">SBN Stores</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/apply/registration.asp">Join Now</DIV>
</DIV>
<DIV ID="divMenu3" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="../../../workshop/default.htm">Workshop Home</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/essentials/default.htm">Essentials</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/delivery/default.htm">Content &amp; Component Delivery</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/components/default.htm">Component Development</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/database/default.htm">Data Access &amp; Databases</DIV>
<DIV expURL="../../../workshop/design/default.htm">Design</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/author/default.htm">DHTML, HTML &amp; CSS</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/xml/default.htm">Extensible Markup Language (XML)</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/languages/default.htm">Languages &amp; Development Tools</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/messaging/default.htm">Messaging &amp; Collaboration</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/networking/default.htm">Networking, Protocols &amp; Data Formats</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/browser/default.htm">Reusing Browser Technology</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/security/default.htm">Security &amp; Cryptography</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/server/default.htm">Server Technologies</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/imedia/default.htm">Streaming &amp; Interactive Media</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/management/default.htm">Web Content Management</DIV>
<DIV expURL="../../../workshop/index/default.htm">Workshop Index</DIV>
</DIV>
<DIV ID="divMenu4" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="../../../gallery/default.htm">Tools &amp; Samples Home</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/gallery/tools/default.htm">Tools</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/gallery/samples/default.htm">Samples, Headers, Libs</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/gallery/images/default.htm">Images</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/gallery/sounds/default.htm">Sounds</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/gallery/stylesheets/default.htm">Style Sheets</DIV>
<DIV expURL="http://www.microsoft.com/typography/fontpack/win.htm">Web Fonts</DIV>
</DIV>
<DIV ID="divMenu5" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="../../../devtraining/default.htm">Training Home</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/seminars/default.htm">SBN Live Seminars</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/chat/default.htm">SBN Live Chats</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/atec.htm">Courses</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/peer/default.htm">Peer Support</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/mastering.htm">CD-ROM Training</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/books_kits.htm">Books & Training Kits</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/mscert/default.htm">Certification</DIV>
</DIV>
<DIV ID="divMenu6" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="../../../sitebuilder/default.htm">SBN Home</DIV>
<DIV expURL="../../../sitebuilder/siteinfo/newtosite.htm">New to SBN?</DIV>
<DIV expURL="../../../sitebuilder/whatsnew.htm">What's New on SBN</DIV>
<DIV expURL="../../../sitebuilder/siteinfo/sitemap.htm">Site Map</DIV>
<DIV expURL="http://www.microsoft.com/isapi/gosearch.asp?TARGET=/dev/web/default.asp">Site Search</DIV>
<DIV expURL="../../../sitebuilder/siteinfo/glossary/default.htm">Glossary</DIV>
<DIV expURL="../../../sitebuilder/write-us.htm">Write Us</DIV>
<DIV expURL="../../../sitebuilder/siteinfo/about.htm">About This Site</DIV>
</DIV>
<SCRIPT LANGUAGE="JavaScript" SRC="../../../sitebuilder/shared/js/navbar.js"></SCRIPT> 
<SCRIPT LANGUAGE="JavaScript" SRC="../../../sitebuilder/shared/js/navlinks.js"></SCRIPT>


</BODY>
</HTML>