
<HTML>
<HEAD>


<TITLE>SBN Server: Site Server Personalization and Membership Tutorial</TITLE>

<META NAME="Description" CONTENT="Site Server feature: Tutorials on creating and configuring your membership server, and adding personalization features to it" />
<META NAME="Keywords" CONTENT="Site Server, Site Server 3.0, personalization, membership" />
<META NAME="Robots" CONTENT="All" />

<META NAME="Author" CONTENT="Robert Carter" />
<META NAME="Posted" CONTENT="" />
<META NAME="Updated" CONTENT="09/01/1998" />

<META NAME="MS.LOCALE" CONTENT="EN-US" />
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1" />

<LINK REL="stylesheet" TYPE="text/css" HREF="../../../sitebuilder/shared/css/navbar.css" />
<LINK REL="stylesheet" TYPE="text/css" HREF="../../../sitebuilder/shared/css/ie4-wks.css" />


<SCRIPT LANGUAGE="JavaScript"><!--

// -----------------------------------------------------------
// Client-side BrowserData constructor
// Populated using data from server-side oBD object to avoid redundancy
// -----------------------------------------------------------

function BrowserData()
{
this.userAgent = "Mozilla/4.0 (compatible; MSIE 4.01; Windows NT)";
this.browser = "MSIE";
this.majorVer = "4";
this.minorVer = "01";
this.betaVer = 0;
this.platform = "NT";
this.getsNavBar = true;
this.doesActiveX = true;

}
var oBD = new BrowserData();

//--></SCRIPT>

<SCRIPT LANGUAGE="Javascript"><!--

// -----------------------------------------------------------
// window_load()
// Container function for load.
// -----------------------------------------------------------

function window_load()
{
if (oBD.getsNavBar)
{
if ("function" == typeof(InitNavLinks)) InitNavLinks();
if ("function" == typeof(CheckToTop)) CheckToTop();
}
}
window.onload = window_load;

//--></SCRIPT>

</HEAD>

<BODY TOPMARGIN="0" LEFTMARGIN="0" MARGINHEIGHT="0" MARGINWIDTH="0" BGCOLOR="#FFFFFF">


<TABLE WIDTH="100%" CELLPADDING="0" CELLSPACING="0" BORDER="0">
<TR>
<TD ROWSPAN="2" WIDTH="460" VALIGN="top"><NOBR><A HREF="http://www.microsoft.com/" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/home.gif" WIDTH="103" HEIGHT="21" ALT="Microsoft Home" BORDER="0"></A><A HREF="http://www.microsoft.com/PRODUCTS/DEFAULT.asp?DIVISIONID="10"" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/prod.gif" WIDTH="81" HEIGHT="21" ALT="products" BORDER="0"></A><A HREF="http://www.microsoft.com/search/default.asp" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/search.gif" WIDTH="68" HEIGHT="21" ALT="search" BORDER="0"></A><A HREF="http://www.microsoft.com/ISAPI/GOSUPPORT.asp?TARGET=/SUPPORT/" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/support.gif" WIDTH="74" HEIGHT="21" ALT="support" BORDER="0"></A><A HREF="http://www.microsoft.com/referral/default.asp" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/shop.gif" WIDTH="55" HEIGHT="21" ALT="shop" BORDER="0"></A><A HREF="http://www.microsoft.com/ISAPI/GOREGWIZ.asp?TARGET=/REGWIZ/REGWIZ.asp" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/write.gif" WIDTH="78" HEIGHT="21" ALT="Write Us" BORDER="0"></A><IMG SRC="../../../library/images/gifs/toolbar/spacer.gif" WIDTH="1" HEIGHT="21" ALT="" BORDER="0"></NOBR></TD>
<TD BGCOLOR="#000000" WIDTH="100%" HEIGHT="20">&nbsp;</TD>
<TD ROWSPAN="2" WIDTH="91" ALIGN="right" VALIGN="top"><A HREF="http://www.microsoft.com/" TARGET="_top"><IMG SRC="../../../library/images/gifs/toolbar/msft.gif" WIDTH="91" HEIGHT="21" ALT="Microsoft Home" BORDER="0"></A></TD>
</TR>
<TR>
<TD COLSPAN="3" BGCOLOR="#FFFFFF" WIDTH="100%" HEIGHT="1"></TD>
</TR>
</TABLE>

<TABLE ID="tblNavBar" BORDER="0" CELLPADDING="0" CELLSPACING="0">
<TR VALIGN="top">
<TD CLASS="clsSBNLogo" TITLE="SBN Home" HEIGHT="34" WIDTH="90"><A HREF="/sitebuilder/default.htm" TARGET="_top" expNoTOC="true"><IMG HEIGHT="34" WIDTH="90" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/sbnbrand2.gif" ALT="SBN Home" /></A></TD>
<TD CLASS="clsNavBarItem" expItemNum="1">Magazine<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD>&nbsp;|&nbsp;</TD>
<TD CLASS="clsNavBarItem" expItemNum="2">Community<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD>&nbsp;|&nbsp;</TD>
<TD CLASS="clsNavBarItem" expItemNum="3">Workshop<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD>&nbsp;|&nbsp;</TD>
<TD CLASS="clsNavBarItem" expItemNum="4">Tools&nbsp;&amp;&nbsp;Samples<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD>&nbsp;|&nbsp;</TD>
<TD CLASS="clsNavBarItem" expItemNum="5">Training<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD>&nbsp;|&nbsp;</TD>
<TD CLASS="clsNavBarItem" expItemNum="6">Site&nbsp;Info<BR><IMG HEIGHT="4" WIDTH="7" BORDER="0" SRC="../../../sitebuilder/shared/navbar/graphics/arrow.gif"></TD>
<TD WIDTH="100%"></TD>
</TR>
</TABLE>


<TABLE ID="tblNavLinks" CLASS="clsNavLinks" CELLPADDING="0" CELLSPACING="0" BORDER="0" WIDTH="100%">
<TR>
<TD COLSPAN="2" HEIGHT="8"><IMG WIDTH="1" HEIGHT="8" SRC="../../../sitebuilder/shared/graphics/trans.gif"></TD>
<TD ROWSPAN="2"><A HREF="../../../workshop/default.htm" TARGET="_top"><IMG ALIGN="right" HEIGHT="30" WIDTH="106" BORDER="0" ALT="Click to return to the Workshop home page" SRC="../../../workshop/graphics/wrkbrand2.gif" /></A><BR /></TD>
</TR>
<TR>
<TD ROWSPAN="2">
<A HREF="../../../workshop/server/pg00164.htm"><IMG HEIGHT="32" WIDTH="31" HSPACE="25" BORDER="0" ALT="Click to return to the Server Technologies home page" SRC="../../../workshop/graphics/icons//server.gif" /></A>
</TD>
<TD>
<TABLE CELLPADDING="3" CELLSPACING="0" BORDER="0">
<TR>

<TD><A ID="lnkShowImg" HREF="../../../workshop/server/toc.htm" TARGET="_top"><IMG ID="imgShow" CLASS="clsLeftMenu" HEIGHT="15" WIDTH="18" BORDER="0" SRC="../../../workshop/graphics/icons/nl-show-0.gif" ALT="" /></A><BR></TD>
<TD NOWRAP><A ID="lnkShowText" CLASS="clsLeftMenu" HREF="../../../workshop/server/toc.htm" TARGET="_top">show toc</A> &nbsp;&nbsp; </TD>

<TD><A ID="lnkSyncImg" HREF="../../../workshop/pg06325.htm#/workshop/server/nextgen/perstutor.htm" TARGET="_top"><IMG ID="imgSync" CLASS="clsLeftMenu" HEIGHT="15" WIDTH="18" BORDER="0" SRC="../../../workshop/graphics/icons/nl-sync-0.gif" ALT="" /></A><BR></TD>
<TD NOWRAP><A ID="lnkSyncText" CLASS="clsLeftMenu" HREF="../../../workshop/pg06325.htm#/workshop/server/nextgen/perstutor.htm" TARGET="_top">sync toc</A> &nbsp;&nbsp; </TD>

<TD><A ID="lnkSearchImg" HREF="http://www.microsoft.com/isapi/gosearch.asp?TARGET=/dev/web/default.asp" TARGET="_top"><IMG ID="imgSearch" CLASS="clsLeftMenu" HEIGHT="15" WIDTH="18" BORDER="0" SRC="../../../workshop/graphics/icons/nl-search-0.gif" ALT="" /></A><BR></TD>
<TD NOWRAP><A ID="lnkSearchText" CLASS="clsLeftMenu" HREF="http://www.microsoft.com/isapi/gosearch.asp?TARGET=/dev/web/default.asp" TARGET="_top">search</A> &nbsp;&nbsp; </TD>

<TD><A ID="lnkIndexImg" HREF="../../../workshop/index/pg00001.htm"><IMG ID="imgIndex" CLASS="clsLeftMenu" HEIGHT="15" WIDTH="18" BORDER="0" SRC="../../../workshop/graphics/icons/nl-index-0.gif" ALT="" /></A><BR></TD>
<TD NOWRAP><A ID="lnkIndexText" CLASS="clsLeftMenu" HREF="../../../workshop/index/pg00001.htm">index</A> &nbsp;&nbsp; </TD>

</TR>
</TABLE>
</TD>
</TR>
<TR>
<TD COLSPAN="2" WIDTH="100%">
<TABLE CELLPADDING="2" CELLSPACING="0" BORDER="0">
<TR>
<TD>&nbsp;</TD>
</TR>
</TABLE>
</TD>
</TR>
</TABLE>

<BR CLEAR="all" />
<DIV CLASS="clsBucketBranch"><A HREF="../../../workshop/pg00004.htm" TARGET="_top">Workshop</A>&nbsp;&nbsp;|&nbsp;&nbsp;<A HREF="../../../workshop/pg06325.htm#/workshop/server/pg00164.htm" TARGET="_top">Server Technologies</A></DIV>

<DIV CLASS="clsDocBody">

<!-- DOCUMENT CONTENT START -->

<H1><a name="title" IDX_TYPE="sbngen" IDX_CONCEPT="stopindex; Site Server, Personalization and Membership features; Personalization, setting up with Site Server; Membership, setting up with Site Server">Site Server Personalization and Membership Tutorial</A></H1>
<HR SIZE="1" />
<h6><a name="title2" IDX_TYPE="task" IDX_CONCEPT="Set up personlization and membership with Site Server"></a></h6>
<P>Rob Lefferts, Program Manager, Site Server
<BR>Robert Carter, Site Builder Network Writer
<BR>Microsoft Corporation
<P>June 8, 1998
<P><a href="perstutor.zip"><IMG SRC="../../../sitebuilder/graphics/icodownl.gif" WIDTH=16 HEIGHT=20 BORDER=0 ALT="Download"> Download this document in Microsoft Word (.DOC) format (zipped, 469K</a>.
<P><a href="persample.zip"><IMG SRC="../../../sitebuilder/graphics/icodownl.gif" WIDTH=16 HEIGHT=20 BORDER=0 ALT="Download"> Download the sample ASP files (zipped, 7K)</a>.

<P> <a name="top"></a><b>Contents</b>
<br> <A HREF="perstutor.htm#topicA">Introduction</A>
<BR> <A HREF="perstutor.htm#topicB">About the Site Vocabulary</A>
<BR> <A HREF="perstutor.htm#tut">Tutorials</A>
<BR> <A HREF="perstutor.htm#topicC">Create and Configure a Membership Server</A>
<BR> <A HREF="perstutor.htm#topicD">Create a Visual InterDev Project</A>
<BR> <A HREF="perstutor.htm#topicE">Collect User Information</A>
<BR> <A HREF="perstutor.htm#topicF">View the Registration Page</A>
<BR> <A HREF="perstutor.htm#topicG">Target Personalized Content</A>
<BR> <A HREF="perstutor.htm#topicH">Conclusion</A>
<P>
            <P><b>Return to Site Server 3.0 Feature pages</b>
<br><a href="siteservfeat.htm">Go to SBN Overview page</a>
<br><A HREF="http://www.microsoft.com/msdn/news/feature/042798/ssummary.htm" TARGET="_top">Go to MSDN Summary page</a> <A HREF="http://www.microsoft.com/msdn/" TARGET="_top"><IMG src="/msdn/art/msdn50x25.gif" border="0" width="50" height="25" alt="MSDN Online"></A>

<br><A HREF="http://www.microsoft.com/msdn/news/feature/042798/default.htm" TARGET="_top">Go to MSDN Overview page</a> <A HREF="http://www.microsoft.com/msdn/" TARGET="_top"><IMG src="/msdn/art/msdn50x25.gif" border="0" width="50" height="25" alt="MSDN Online"></A>

<P>

<h2><A NAME="topicA"></A>Introduction
</h2>
<P>With the release of Microsoft&#174; Site Server 3.0, Microsoft is introducing a suite of tools that ease the task of personalizing visits by specific users to an Internet or intranet site. Broadly speaking, personalization is the process of tailoring the information visitors encounter when perusing a site. The customized information displayed reflects interests the user has revealed in past visits. Sites can explicitly gather profiles of visitors by requesting (or, less elegantly, requiring) them to fill out forms, by tracking the areas of the site they tend to visit, or even recording their choices within pages using advanced features such as hidden forms. Based on the profiles, the site dynamically provides additional information, navigation choices, discounts, or whatever material site authors feel may tickle that visitor's fancy.
<P>This article will first describe the concept of a <i>site vocabulary</i> as the central organizing principle for collecting, displaying, and disseminating information on a site. We'll then cover several processes that enable a simple personalization scheme based on a sample site vocabulary.
<P>Throughout the article, we'll try to provide concrete, easy-to-follow directions. We'll be covering only a subset of the personalization methods possible. We'll also be making assumptions about how a site is configured. (So if you are unable to duplicate our examples,  <A HREF="mailto:a-robcar@microsoft.com">let us know</A>.) This tutorial's examples are compatible with the other samples included with Site Server.
<P>All the examples we present are available either as part of the Site Server documentation or  <A HREF="persample.zip">this download</A>.  If you want to faithfully recreate the steps we outline, you'll need to install Visual InterDev&#153; and the FrontPage&#174; Server Extensions.
<P> <A HREF="perstutor.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h2><A NAME="topicB"></A>About the Site Vocabulary
</h2>
<P>A site vocabulary is a set of key terms and functions around which a site is organized. It can be a set of practices, sections, divisions, topics, pages, and capabilities used throughout the site. The site vocabulary is a classification system that Site Server relies on to perform specific tasks or guide visitors to specific information or services. Figure 1 displays the site vocabulary included with Site Server:
<P><b><img src="pers01.gif" WIDTH="184" HEIGHT="285" ALT="[PER3482B  9585 bytes ]">
<P>Figure 1. Sample site vocabulary </b>
<P>What's interesting about this vocabulary is the range of views it affords. One section of the vocabulary is clearly about the company itself: general information, employment information, and the products and services it offers. Another section of the vocabulary describes the characteristics of the users that access the site: their experience level, age, gender, job classification, and member type. The classification possibilities are unlimited.
<P>Personalization and membership services use a site vocabulary to customize content linking characteristics of the site visitor (which adhere to a particular user information profile) to characteristics of the site. For example, we could create a user category called "employee." When a visitor to the site falls in the category of employee, the Web server could send that visitor special content about workplace events. This prevents non-employees from viewing material that they shouldn't see for security reasons and/or don't interest them.
<P>The linking possibilities are unlimited as well. The key is to use these classification and linking capabilities to guide site visitors as efficiently as possible to the information they want or that you want to provide them.
<P>This tutorial does not show you how to modify the site vocabulary. For more information on setting up a site vocabulary, see  <A HREF="kmpaper.htm">Getting the Most Out of Site Server Knowledge Manager</A>.

<P>Incidentally, personalization and membership features are but one application of the site vocabulary. Other Site Server services that rely on it include the Analysis, Content Manager, Search, Push, and Knowledge Manager toolsets. For more information on each, load the Site Server documentation by clicking <b>Start</b>, <b>Programs</b>, <b>Microsoft Site Server</b>, and then <b>Site Server Documentation</b>, or mosey on over to the  <A HREF="http://www.microsoft.com/siteserver/default.asp" TARGET="_top">Site Server Web site</A> <IMG SRC="../../../sitebuilder/graphics/leave-site.gif" WIDTH="17" HEIGHT="11" BORDER="0" ALT="Non-SBN link">.
<P> <A HREF="perstutor.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h2><A NAME="tut"></A>Tutorials
</h2>
<P>We'll cover the following procedures for creating, configuring, and implementing personalization on our sample membership server. We recommend that you print out the Microsoft Word version of this article and use it as a checklist. Each procedure builds on capabilities that are set up in the previous procedure. To configure your own server in the same manner, perform them in this sequence:
<P><b>Create and Configure a Membership Server:</b>
<BR> <A HREF="perstutor.htm#topic1">Create a New Membership Server</A>
<BR> <A HREF="perstutor.htm#topic2">Create and Configure Two New Web Servers</A>
<BR> <A HREF="perstutor.htm#topic3">Map the Web Server to the Membership Instance</A>
<BR> <A HREF="perstutor.htm#topic4">Configure the Sites</A>
<BR> <A HREF="perstutor.htm#topic5">Create and Manage Membership Users and Groups</A>
<BR> <A HREF="perstutor.htm#topic6">Add FrontPage Server Extensions to Your Sites</A>
<P><b><A HREF="perstutor.htm#topicD">Create a Visual InterDev Project</A></b>
<P><b>Collect User Information:</b>
<BR> <A HREF="perstutor.htm#topic7">Add an Attribute to the Membership Directory Manager</A>
<BR> <A HREF="perstutor.htm#topic8">Insert Design-Time Controls into the Registration page</A>
<BR> <A HREF="perstutor.htm#topic9">Add a cn Attribute</A>
<BR> <A HREF="perstutor.htm#topic10">Add a Password Attribute</A>
<BR> <A HREF="perstutor.htm#topic11">Add a Mail Attribute</A>
<BR> <A HREF="perstutor.htm#topic12">Add a PersonalProduct Attribute </A>
<P><b><A HREF="perstutor.htm#topicF">View the Registration Page</A></b>
<P><b>Target Personalized Content:</b>
<BR> <A HREF="perstutor.htm#topic13">A Simple Example:  Adding AUO Script</A>
<BR> <A HREF="perstutor.htm#topic14">Create and Target a Content Source</A>
<BR> <A HREF="perstutor.htm#topic15">Create a Targeting Rule</A>
<BR> <A HREF="perstutor.htm#topic16">Insert the Rule into a Web Page</A>
<P>
<h2><A NAME="topicC"></A>Create and Configure a Membership Server
</h2>
<P>The first set of tasks we'll cover is building a membership server. Membership servers house the site vocabulary and a host of controls and features that facilitate tracking site visitors and their preferences, and map that information to different capabilities of the site. A membership server runs parallel to the Web site, gathering information from visitors at specified points and in turn feeding the site with personalized information. It can also control access to areas of the site if it has different membership levels.
<P>Site Server offers two versions of the same administration tool to create and configure membership servers. The first is based on the Microsoft Management Console.  The second uses an HTML front-end. While the HTML version has a smaller set of features, it's more straightforward to use. This tutorial uses both to give you a feel for their respective interfaces and features.

<P>
<h3><A NAME="topic1"></A>Create a New Membership Server
</h3>
<P><b>Create the Web directory.</b>
<OL>

<LI>   Using Windows NT&#174; 4.0 Explorer (click the <b>Start</b> button, select <b>Programs</b>, and then select Windows NT Explorer), create a new directory in the Inetpub folder. We named our directory &quot;personalroot&quot; to make it easy to remember that it contains files for the personalization tutorial.

</OL><b>Create a new membership instance.</b>
<OL>

<LI>   From the <b>Start</b> menu, select <b>Programs</b>, <b>Microsoft</b> <b>Site Server</b>, and then <b>Site Server Service Administrator (MMC)</b>.
<LI>   Once the management console appears, open the Personalization and Membership folder, right-click the name of the server, and select <b>New</b> followed by <b>Membership Server Instance</b>. (<b>Note</b>  Once any task is outlined in these processes, continue by clicking the <b>Next</b> button, unless instructed otherwise.)
<LI>   Select the <b>Complete Configuration</b> radio button. Then select <b>Create a new Membership Directory</b>, followed by <b>Membership Authentication</b>.
<LI>   Type "PersonalDemo" when prompted for a membership directory name, and choose a password. For future reference (and we mean it),
<BR>
<BR><b>Write the password here:</b>
<P>
<LI>   Choose <b>Access Database</b> as the database type, and accept the default filename Site Server generates. The Wizard will then display a box asking for an IP address and Port #.
<LI>   Accept <b>[All Unassigned]</b> for the default <b>IP Address</b>. If this is a fresh system installation, the port number selected by Site Server will most likely be 1003. We will refer to this as the Membership Instance IP Port, and you will need to enter the port number to access it.
<BR>
<BR><b>Write the Personal Demo Membership Instance IP Port number here:</b>
<P>
<LI> You will then be prompted to enter the name of an SMTP Server. The Wizard may supply a default name for you, which should be acceptable (especially if it provides an SMTP server name that matches your machine name). You can specify the name of any SMTP server available on your network, or use the SMTP server installed with the Windows NT 4.0 Option Pack by default. To use this SMTP server, enter "localhost" or the name of your server.
<LI>   After following these steps (and clicking the <b>Finish</b> button), you should soon see <b>Membership Instance #</b><i><B>x</b></i> appear in the Site Server Administration Console. If this is your first time working with Site Server, you will see <b>Membership Instance #2</b>. We renamed it &quot;PersonalDemo Membership Server&quot;; we advise renaming it for your site.
<LI>   If you right-click the <b>PersonalDemo Membership Server</b> and select <b>Properties</b>, you should see a dialog box similar to this:

</OL><ADDRESS><img src="pers02.gif" WIDTH="413" HEIGHT="292" ALT="[PER3482C  8658 bytes ]"></ADDRESS>
<P><b>Figure 2. New membership instance with Properties dialog box</b>
<P> <A HREF="perstutor.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h3><A NAME="topic2"></A>Create and Configure Two New Web Servers
</h3>
<P>Now that we've created a membership server, we need to create the site people will visit. In this procedure, we'll create two sites. The Viewing site will be the site visitors see when they are surfing. The Editing site where authors edit and build content before posting it to the Viewing site. We'll configure a few settings differently to enable the Editing site to work with Visual InterDev&#153;.
<P><b>Create a new Web server.</b>
<OL>

<LI>   From the <b>Management Console</b>, open the <b>Internet Information Server</b> folder and right-click the name of your server (in our case <b>BEASTIEBOY</b>). (<b>Note </b> You can perform the same steps by highlighting the <b>BEASTIEBOY</b> server and clicking the <b>Action</b> button (with the down-pointing arrow) just below the menu bar in the console.)
<LI>   Select <b>New</b> and follow the arrow to <b>Web Site</b>. You will start the New Web Site Wizard.
<LI>   In the first dialog box of the wizard, enter "Viewing Site" as the name of your <b>Web Server</b>. Accept the default <b>[All Unassigned] IP Address</b> the Wizard provides.
<LI>   Type "5295" for the <b>TCP port number</b>. (If 5295 is not accepted, it is already in use. Keep trying different numbers until you find one that is acceptable.)
<BR>
<BR><b>Write down the Viewing Site's port number here:</b>
<LI> Enter the address of the directory (the home directory path) you just created in the box provided. To be doubly safe, use the <b>Browse</b> button, because future steps we perform will reference this address, which must exactly match the actual Windows NT directory address.
<LI>   Accept the default access options the Wizard displays: <b>Allow Read Access</b> and <b>Allow Script Access</b>. (<b>Allow Execute Access</b> would be appropriate if we were setting up a site that activated DLL or EXE applications, <b>Allow Write Access</b> would give an anonymous user the ability to change or add content, and <b>Allow Directory Browsing</b> enables a feature of Internet Information Server [IIS] that displays a list of files in a directory when a user does not provide a complete URL.)
<LI>   After clicking <b>Finish</b>, you will see a new entry labeled <b>Viewing Site (stopped)</b> appear under the Administration Web site entry.
<LI>   Repeat the steps above for another site we will call the Editing site. We suggest using port number 5296 for the Editing site.
<BR>
<BR><b>Write down the Editing site's port number here:</b>
<P>
</OL>

<P>&nbsp;
<b><img src="pers03.gif" WIDTH="578" HEIGHT="438" ALT="[PER3482D  19572 bytes ]">
<P>Figure 3. Management Console showing new Viewing site, Editing site, and membership instance</b>



<P> <A HREF="perstutor.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h3><A NAME="topic3"></A>Map the Web Server to the Membership Instance
</h3>
<P>Mapping the Editing and Viewing sites to the membership instance establishes connections between the servers so we can implement personalization. As discussed in the section on site vocabulary, we're enabling the new Web site(s) to access the existing schema of the site, and apply the existing user categories or create our own.
<P><b>Map the Viewing site to the PersonalDemo membership server. </b>
<OL>

<LI>   From the Site Server Management Console, open the Internet Information Server folder (double-click it or single-click the "+" that appears to its left). Select the <b>Viewing Site</b> icon and right-click it.
<LI>   In the dialog box that appears, select <b>Task</b> and point to what is probably the only task listed, <b>Membership Server Mapping</b>. From the dialog box drop-down list that appears, select <b>PersonalDemo Membership Server</b>.
<LI>   Repeat this process for the Editing site. Depending on the speed of your machine, the process might take a few seconds.

</OL><b><img src="pers04.gif" WIDTH="376" HEIGHT="308" ALT="[PER3482E  9309 bytes ]">
<P>Figure 4. Activating Membership server mapping via the Action button</b>
<P> <A HREF="perstutor.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h3><A NAME="topic4"></A>Configure the Sites
</h3>
<P>Before we get to play with the sample Web pages, we need to configure them for two types of authentication. Think of authentication as a bouncer checking your ID before you can enter a club.
<P><b>Set the authentication method for your sites. </b>
<OL>

<LI>   From the <b>Site Server Management Console</b>, open the <b>Internet Information Server</b> folder. Locate and right-click the <b>Viewing site</b> icon and select <b>Properties</b>. A dialog box will appear. (The default tab that appears should show some of the properties you entered earlier for the site, such as port number and host directory.)
<LI>   Select the <b>Membership Authentication</b> tab, which was created when you mapped the site to the new membership server.
<LI>   Make sure the <b>Allow Anonymous</b> box is checked, and select the <b>HTML Forms Authentication</b> radio button. Click <b>OK</b>. The Membership Authentication dialog box should look something like Figure 5.
<P>

<img src="pers05.gif" WIDTH="323" HEIGHT="327" ALT="[PER3482F  8937 bytes ]">
<P><b>Figure 5. Viewing site with Automatic Cookie Authentication setting activated</b>
<P>
<LI>   Repeat the process for the Editing site, but this time select the <b>Other Password Authentication</b> radio button, and check the box next to <b>Clear Text/Basic Authentication</b>. Finally, start both Web sites by right-clicking the icon for each in the IIS folder and selecting <b>Start</b>.

</OL>
<P> <A HREF="perstutor.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h3><A NAME="topic5"></A>Create and Manage Membership Users and Groups
</h3>
<P>Site Server enables you to control who can access specific membership servers. In our case, we're going to create a group called Developers, and a user called SiteEditor, that will be able to access the PersonalDemo membership server (and the sites it maps to).
<P>We're adding this step because later on, when we want to build a project in Visual InterDev that will create and edit the pages of the Editing site, we will be asked to register as a valid user. If, at that point, we haven't already created a set of approved users for our PersonalDemo, we will have to log on as a global administrator, which is a bit of overkill (assuming you even have that level of access). Besides, it's simply good administrative practice to create user groups that are tied to particular sites and privileges.
<P><b>Start the HTML-based Site Server Service Administration tool.</b>
<OL>


<LI>Select <b>Start</b>, <b>Programs</b>, <b>Microsoft Site Server</b>, <b>Administration</b>, and then select <b>Site Server Service Admin (HTML)</b>. Internet Explorer 4.0 (or your default browser) should start and display a page that looks like
Figure 6.

<P>&nbsp;
<b><img src="pers06.gif" WIDTH="583" HEIGHT="461" ALT="[PER3482G  16381 bytes ]">
<P>Figure 6. Site Server Service Administration (HTML) default page</b>


<P>
<LI>   If Internet Explorer gives you an error message, and you use a proxy server to access the Internet, you may need to configure it to display local pages. In Internet Explorer, select <b>Internet Options</b> from the <b>View</b> menu. Click the <b>Connection</b> tab. In the <b>Proxy server</b> section of the <b>Connection</b> tab, make sure the check box next to <b>Bypass proxy server for local (intranet) access</b> is checked.

</OL>
<P><b>Create a new User and Group.</b>

<OL>

<LI>   On the page that appears, select the <b>Membership Directory Manager</b> section, and select the server you want to monkey with from the drop-down list (which is, of course, the PersonalDemo membership server). Also enter your <b>User name</b> (&quot;Administrator&quot;) and <b>password</b> (the same password you entered when you created the server).
<LI>   A new page will appear. Select <b>Users</b> from the left pane of the page, and then select the <b>User Management</b> hotlink. A page appears like the one in Figure 7.

</OL><b><img src="pers07.gif" WIDTH="498" HEIGHT="381" ALT="[PER3482H  14550 bytes ]">
<P>Figure 7. User Management screen of HTML-based Site Server Administration tool</b>
<OL>

<LI>   Click the <b>Create</b> button. You will be presented with an HTML form page. Fill out the form as much as you like, but make sure to fill out the <b>User name</b>, <b>Password</b>, and <b>Verify password</b> fields. (For <b>User name</b>, we chose SiteEditor.)

<LI>   Click the <b>Submit</b> button.
<BR>
<BR><b>Write down the SiteEditor password here:</b>
<P>
<LI>   Return to the Users home page by selecting <b>Users</b> in the left pane again.
<LI>   This time through, select the <b>Group Management</b> hyperlink. You will encounter a page similar to that for entering Users. Again select <b>Create.</b>
<LI>   Fill out the form for <b>Group name</b> (we chose &quot;Developers&quot;) and, if you wish, a <b>Description</b> (for example, "Those who can post content to the PersonalDemo Editing Site,"). Then click the <b>Members</b> button.
<LI>   You will be sent to a page that lists all the members of the Developers group (presently nobody). Click the <b>Add Users</b> button at the bottom of the page to see a list of the users eligible to be added to your group. The SiteEditor user category you just created should appear in the list.
<LI>   Select <b>SiteEditor</b> and click the <b>Submit</b> button. You will be bounced back to the previous page, but now SiteEditor will appear as a member of Developers.

</OL><b><img src="pers08.gif" WIDTH="499" HEIGHT="381" ALT="[PER3482I  14087 bytes ]">
<P>Figure 8. Developers group with SiteEditor User added</b>
<P><b>Verify your new group.</b>
<OL>

<LI>   To make sure your entries to the membership server have been reflected throughout the system, we'll use another tool in the Windows NT toolkit, the User Manager for Domains. From the <b>Start</b> menu, select <b>Programs</b>, <b>Administrative Tools (Common)</b>, and <b>User Manager for Domains</b>. By default, it will start by loading the domain your machine is on, so it may take a while before you see anything (especially if your computer is on a large company network).
<LI>   When your domain finally loads, select the <b>User</b> tab on the <b>Command</b> menu and highlight <b>Select Domain</b>.
<LI>   In the dialog box that appears, type the name of your <i>machine</i> (it should load a lot more quickly than your entire network).
<LI>   In the lower pane of the <b>User Manager for Domains</b> dialog box, use the scrollbar to locate the group you just added. If you followed our naming convention, it should look something like <b>Site_PersonalDemo_Developers</b>, as in Figure 9.

</OL><b><img src="pers09.gif" WIDTH="462" HEIGHT="323" ALT="[PER3482J  14499 bytes ]">
<P>Figure 9. User Manager for Domains with recently added groups</b>
<P>If your groups don't appear immediately, that doesn't mean they weren't registered. Sometimes it takes a while for them to appear. If you want, get a cup of coffee, stretch your legs, come back again in a few minutes and try again. It's not critical, though. We point this out only as an error-checking mechanism.
<P> <A HREF="perstutor.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h3><A NAME="topic6"></A>Add FrontPage Server Extensions to Your Sites
</h3>
<P>Now that we've got our servers up and running, pointing to content directories, and the access privileges set, we're going to add FrontPage Server Extensions, Microsoft's mechanism for publishing pages to Web sites.
 The extensions are enable Visual InterDev and other applications to access and publish pages on Web servers. For example, with the extensions enabled, you can display pages on a server by simply copying files into a server's root folder.
<P><b>Start the FrontPage Server Administrator.</b>
<OL>

<LI>   From the <b>Start</b> button on the taskbar, select <b>Programs</b>, <b>Windows NT 4.0 Option Pack</b>, <b>Microsoft Internet Information Server</b>, and, finally, <b>FrontPage Server Administrator</b>. A dialog box similar to the one in Figure 10 will appear.

<P><img src="pers10.gif" WIDTH="371" HEIGHT="271" ALT="[PER3482K  8468 bytes ]">
<P><b>Figure 10. FrontPage Server Administrator dialog box</b>


<P>
<LI>Click the <b>Install</b> button. A dialog box will appear and ask what type of server to configure; select <b>Microsoft Internet Information Server</b> from the drop-down list.

<P><img src="pers11.gif" WIDTH="246" HEIGHT="246" ALT="[PER3482L  5642 bytes ]">
<P><b>Figure 11. Selecting servers to apply FrontPage extensions</b>
<P>
<LI>   Another dialog box will appear listing the sites available to configure. Select the <b>Editing site</b> and <b>Viewing Site</b> (using the CTRL key) and click <b>OK</b>. If you see, "This port already has a root Web. Click OK to upgrade to most recently installed FrontPage Server Extensions," click <b>OK</b> (as if you had another choice!).
<LI>   You may get a prompt asking you to provide a password, with your alias as a default name. Change the <b>User name</b> entry to &quot;Administrator,&quot; and in the password box enter the password you chose when setting up the membership server. You should then see an "Install Completed Successfully" message.
<LI>   Click <b>OK</b> to return to the original dialog box.

</OL>If you are unable to install the FrontPage Server Extensions, and get an "Unable to open port" message, delete and reinstall the server, making doubly sure that the address you enter for the server exactly matches that in the Windows NT directory. This is the point of accuracy we talked about earlier, and we emphasize it because your humble narrator made this error.
<P><b>Create additional administrator privileges. </b>
<OL>

<LI>   To complete the configuration process, select the Editing site entry in the box in the upper left of the window, and click the <b>Security</b> button.
<LI>   At the prompt, type "Developers" (or whatever group you added using the <b>Group Management</b> tool of the Site Server Administration console) in the <b>Name</b> text box and click <b>OK</b>.
<LI>   After a few moments, you should see a message indicating that "Developers" has been added to administrators for the root Web. Close the FrontPage Server Administrator.

</OL>Congratulations. Your servers are now ready to have content posted to them.
<P> <A HREF="perstutor.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h2><A NAME="topicD"></A>Create a Visual InterDev Project
</h2>
<P>Now that our servers are ready, we'll start a Visual InterDev project for editing their content and posting to them.
<P><b>Set up a new Web project in Visual InterDev.</b>
<OL>

<LI>   From the <b>Start</b> button, select <b>Programs</b>, <b>Microsoft Visual InterDev</b>, and <b>Visual InterDev</b>.
<LI>   From the Visual InterDev default workspace, select <b>New</b> from the <b>File</b> menu. A dialog box appears.
<LI>   Select the <b>Projects</b> tab if it isn't selected by default. Select the <b>Web Project Wizard</b>, type "personalization" as the name of your new project, and click <b>OK</b>.

</OL><b>Identify the Editing site server.</b>
<OL>

<LI>   You will now be prompted to identify a specific server and port. Type in the appropriate <i>server</i>:<i>port</i> combination, which in our case is <b>BEASTIEBOY:5296</b> (don't forget that we're setting up access to the Editing site server). You will get an error message stating that the server is not available. Don't panic. Try again. You should successfully access the server on the second try. Visual InterDev generates this message on the first attempt to access any server not on default port 80.
<LI>   If you continue running into trouble getting the server recognized, try using all caps in the name (technically, servers aren't supposed to be case-sensitive, but it worked for me), or even  &quot;localhost&quot; as in "localhost:5296".
<LI>   If you've forgotten what your server settings are, go to the <b>Management Console</b>, right-click the Editing site icon, and select <b>Properties</b>; the <b>Web Site</b> tab will provide a description and port number information.

</OL><b>Create a new Web. </b>
<OL>

<LI>   You are then asked whether to create a new Web or map to an existing one.
<LI>   Select <b>Create a new Web</b>. Click <b>Finish</b>. If you are prompted to authenticate the site, you should log in as "SiteEditor," or whatever user you created that was part of the Developers group. For a password, use the one that you provided when creating the membership instance.

</OL><b>Add the sample tutorial files to your project.</b>
<OL>

<LI>   From the <b>Project</b> menu, select <b>Add to Project</b>, and then select <b>Files</b>.
<LI>   Use the <b>File</b> dialog box to navigate to the folder where you stored the files you downloaded earlier, and select all five project files (reg.asp, press.asp, userpref.asp, default.asp, and menubar.asp). You can use the SHIFT or CTRL keys to select multiple files at once, if you wish.
<LI>   Click <b>OK</b>, and they should be added to the list of project files in the left-hand pane.

</OL><b>Set access privileges for the pages.</b>
<OL>

<LI>   From the MMC version of the Site Server Administration tool, double-click the <b>Viewing Site</b> entry, and then do the same for the personalization (or whatever you named your Visual InterDev project) subfolder. Right-click the userpref.asp page and select <b>Properties</b>.
<LI>   Select the <b>Membership Authentication</b> tab again, as you did earlier. Set authentication to <b>Allow Anonymous</b> and <b>Automatic Cookie Authentication</b>.
<LI>   Repeat for the reg.asp and press.asp pages. Also repeat this process for the Editing site, but select <b>Other Authentication</b> and <b>Clear Text/Basic Authentication</b> as the preferred access methods.

</OL>At first, I confess to being a bit confused about all these different settings for the Editing site versus the Viewing site. The pages each site accesses are identical (reg.asp, userpref.asp, and so forth), but the servers they are being accessed <i>from</i> are used for different purposes by different audiences, and require different settings to function correctly. The Editing site is set up for people who will be adding content or editing files via Visual InterDev, which at present doesn't support HTML Forms authentication. So while both servers may request reg.asp, Editing site users (&quot;Developers&quot;) are allowed to do so using Clear Text/Basic authentication, which is supported by Visual InterDev. Visitors accessing the Viewing site, who won't be posting content or editing files (other than submitting their personalization info) access reg.asp through Internet Explorer, which supports cookies. In any event, feel free to preview how the files look before we modify them: Select a file in the left pane of the Visual InterDev project, right-click, and then select <b>Preview in Browser</b>.
<P> <A HREF="perstutor.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h2><A NAME="topicE"></A>Collect User Information
</h2>
<P>This section discusses one way of collecting information from site visitors that can then be used to provide some basic personalization features. This process breaks down into four mini-processes:
<UL>


<LI> Modify the Membership Directory Manager to recognize the information.
<LI> Select and implement an information-collection scheme in your Web pages.
<LI> Construct a set of rules to determine when and how to insert personalized information.
<LI> Modify your Web pages to display the personalized information.

</UL>As you can see, these processes are neatly divided into back- and front-end processes, with the back end referring to the Site Server functions, and the front end our manipulation of Web pages using Visual InterDev.
<P>Before we modify our sample pages, you might want to preview what happens when you visit them now (in short: not much).
<P> <A HREF="perstutor.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h3><A NAME="topic7"></A>Add an Attribute to the Membership Directory Manager
</h3>
<P>Our personalization "scheme" is to display information about a product that a visitor to the site selects from a list of options when they register. So our first step in constructing the scheme is to create an attribute in our PersonalDemo server that will represent the visitor's selection.
<P><b>Set the Membership Directory Administrator to the PersonalDemo server. </b>
<OL>

<LI>   From the <b>Site Server Administration Console</b>, right-click the <b>Membership Directory Manager</b> folder and select <b>Properties</b>.
<LI>   In the <b>Directory</b> tab of the <b>Properties</b> dialog, set the <b>Port</b> text box to the <b>Membership Instance IP Port Number</b> that you wrote down earlier. (If you didn't write it down, right-click the <b>Personal Demo Membership Server</b> icon, select <b>Properties</b>, and review the <b>Authentication Service</b> tab; your port listing should appear there.)
<LI>   Depending on the access level you have been assigned, a dialog box may appear asking you to log on. Simply click <b>OK</b> to log on anonymously.

</OL><b>Add a new attribute. </b>
<OL>

<LI>   Double-click the <b>Membership Directory Manager</b> folder, and then double-click the <b>ou=Admin</b> subfolder.
<LI>   Right-click the <b>cn=Schema</b> node, then select <b>New</b> and <b>Attribute</b>. The New Attribute Wizard will start.
<LI>   Type in &quot;PersonalProduct&quot; as the name of the attribute. Feel free to embellish the name of the attribute with a display name ("Personal Demo Products") and a description ("Products of interest to site visitors based on selection from list").
<LI>   The next dialog box presents a set of radio buttons. Because we'll be storing particular product names, select <b>String</b>.

</OL><b>Specify the string syntax constraints.</b>
<OL>

<LI>   Because this attribute is meant to store a value corresponding to a product the visitor selects, and the list of products available are already stored in the site vocabulary, select the <b>Site Vocabulary</b> radio button and click <b>Select</b>.
<LI>   In the <b>Category Selection</b> dialog box that appears (which shows your site's vocabulary), open the <b>Root</b> node, then <b>Sample Site</b>, and finally <b>Products</b>.
<LI>   Click <b>OK</b>.
<LI>   The string <b>\SampleSite\Products</b> should appear in the <b>Category</b> text box.
<LI>   Click <b>OK</b> and then <b>Finish</b> to register the attribute.

<P><img src="pers12.gif" WIDTH="184" HEIGHT="285" ALT="[PER3482M  4513 bytes ]">
<P><b>Figure 12. Sample site vocabulary schema</b>
<P>

<LI>   To verify that your new attribute has been created, double-click <b>cn=Schema</b> in the <b>Membership Directory Manager</b> folder (which you were returned to after adding the attribute).
<LI>   Scroll down the right pane until you encounter your new entry, <b>cn=PersonalProduct</b>. Double-clicking it will produce a dialog box similar to the one in
    Figure 13.
<P>&nbsp;
<P><b><img src="pers13.gif" WIDTH="617" HEIGHT="461" ALT="[PER3482N  20331 bytes ]">
<P>Figure 13. Screen shot of newly added PersonalProduct attribute</b>



</OL>

<P>
<P><b>Add PersonalProduct to the member class.</b>
<OL>

<LI>   Double-click the <b>cn=Schema</b> node again from the <b>Membership Directory Manager</b> folder.
<LI>   In the right-hand pane, scroll down to the <b>cn=Member</b> object and double-click it.
<LI>   On the <b>Class Attributes</b> tab, push the <b>Add</b> button and, in the <b>Add Attribute</b> dialog box, scroll down to the <b>PersonalProduct</b> attribute.
<LI>   Click <b>PersonalProduct</b> and click <b>OK</b>. Click <b>OK</b> once more to finish.

</OL>
<P> <A HREF="perstutor.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h3><A NAME="topic8"></A>Insert Design-Time Controls into the Registration Page
</h3>
<P>If you previewed the reg.asp page earlier, you saw that although it talked about collecting information from you, there were no forms, check boxes, or anything for visitors to provide that information. We'll remedy that by inserting ActiveX&#174; Design-time Controls directly into the page's HTML. (For more information on Design-time Controls, go to <A HREF="http://premium.microsoft.com/msdn/library/sdkdoc/dnplatf/d4/overview.htm" TARGET="_top">http://premium.microsoft.com/msdn/library/sdkdoc/dnplatf/d4/overview.htm</A> <IMG SRC="../../../sitebuilder/graphics/leave-site.gif" WIDTH="17" HEIGHT="11" BORDER="0" ALT="Non-SBN link">) If you still have your workspace in Visual InterDev open from earlier, fine. If not, start Visual InterDev, select <b>Open Workspace</b> from the <b>Files</b> menu, and select the <b>Personalization</b> project.
<P><b>Insert the Membership.Header Design-time Control. </b>
<OL>

<LI>   Double-click the reg.asp page. The right pane in Visual InterDev should show the multi-colored HTML and ASP code of reg.asp. Scroll to this comment in the right pane:
<BR>
<BR>&lt;!--Insert Membership.Header DTC here --&gt;
<P>
<LI>   Position the cursor underneath the comment. Right-click and select <b>Insert ActiveX Control</b> from the dialog box that appears.
<LI>   Select the <b>Design-time</b> tab and scroll down to the <b>Membership</b> and <b>Personalization</b> objects.
<LI>   Select the <b>Membership Header Design-time Control</b> and click <b>OK</b>.

</OL><b><img src="pers14.gif" WIDTH="245" HEIGHT="175" ALT="[PER3482O  5596 bytes ]">
<P>Figure 14. Pre-installed Design-time Controls dialog box </b>
<P><b>Configure the Membership.Header Design-time Control.</b>
<OL>

<LI>   When you select the Membership Header Design-time Control, the right pane will display a gray screen with a Membership Header icon, and a dialog box will offer two radio-button choices. Select <b>Create a New User and ensure that it is unique</b>.
<LI>   Click the <b>Variables</b> tab. Select <b>Script ID</b>. In the <b>Value</b> text box, change the <b>o=microsoft</b> value to <b>o=PersonalDemo</b>.
<LI>   The <b>Value</b> box should now contain <b>cn=administrator</b>, <b>ou=members</b>, <b>o=PersonalDemo</b>. It is very important that you set this value correctly. To double-check, return to the <b>Site Server Management Console</b>, select the <b>Personalization and Membership</b> folder, and open the <b>PersonalDemo Membership Server</b> (either by double-clicking on the entry or right-clicking on the &quot;<b>+</b>&quot;. Right-click the <b>LDAP</b> item and select <b>Properties</b>. The <b>Root Distinguished Name</b> of the membership server is on the top of the <b>Directory Properties</b> tab; this is the value that you should enter in the <b>Membership.Header Design-Time Control</b> in place of &quot;Microsoft.&quot;
<P><img src="pers15.gif" WIDTH="477" HEIGHT="310" ALT="[PER3482P  11073 bytes ]">
<P><b>Figure 15. Locating the PersonalDemo LDAP server</b>
<P><img src="pers16.gif" WIDTH="281" HEIGHT="326" ALT="[PER3482Q  7949 bytes ]">
<P><b>Figure 16. Finding the &quot;o=&quot; value from the LDAP dialog box</b>

<P>
<LI>   Next, select the <b>Script password</b> variable so that the name and value appear in the text boxes.
<LI>   Change the value so that it uses the administrator password that you wrote down above.
<LI>   Change the <b>Script ID</b> value to read <b>o=PersonalDemo</b>. Close the dialog box by clicking the <b>x</b> in its upper right corner.
<LI>   Do the same for the pane with the <b>Membership Header</b> icon. You should now see your original HTML with a new section inserted.

</OL>
<P> <A HREF="perstutor.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h3><A NAME="topic9"></A>Add a cn Attribute
</h3>
<P>We've already performed several tasks where we skipped around the <i>cn=</i> attribute; cn stands for <i>common name</i>, and is used, unsurprisingly, to give names to objects in the Membership Directory. We'll add a cn membership attribute that will require visitors to enter their name, which will be stored as a unique entry in the membership database.
<P><b>Insert the Membership.Attribute Design-time Control. </b>
<OL>

<LI>   Scroll through reg.asp to this comment:
<BR>
<BR>&lt;-- Insert Membership.Attribute : CN Here --&gt;
<P>
<LI>   Insert the control as above. Position the cursor under the comment, right-click, and select <b>Insert ActiveX control</b>.
<LI>   Select the <b>Design-time control</b> tab and scroll down in the right pane to the <b>Membership.Attribute DTC</b> listing. Another dialog box will appear.

</OL><b>Activate the attribute-configuration dialog.</b>
<OL>

<LI>   Make sure that the <b>Application Server</b> box in the <b>Attribute</b> tab is pointed at the <b>Editing site port</b>, which in our case is <b>localhost:5296</b>.  Do not use "localhost" without specifying a port, otherwise you'll be connected to the default Web root. If you're unsure about which port to enter, look at the port number in the left pane of the Visual InterDev display, which shows the Personal Demo workspace and the server connection.
<LI>   Once you've accessed the <b>Editing site</b>, click the <b>Get Attributes</b> button. A list of attributes will appear. You may get prompted to log on; use <b>SiteEditor</b> as a user name and the password that you've entered several times by now. (If you want to make sure you're accessing the right server, scroll down in the right pane until you see the <b>PersonalProduct</b> attribute you entered earlier.)

</OL><b><img src="pers17.gif" WIDTH="283" HEIGHT="168" ALT="[PER3482R  5100 bytes ]">
<P>Figure 17. Selecting and assigning properties to attributes</b>
<P><b>Assign properties to the cn attribute.</b>
<OL>

<LI>   Select <i>cn</i> from the list of attributes. The <b>Attribute</b>, <b>Syntax</b>, and <b>Attribute Description</b> boxes will be filled.
<LI>   Click the <b>Options</b> tab. Select <b>Username</b> from the <b>UI Type</b> drop-down menu, and <b>Update</b> from the <b>Action</b> drop-down menu.
<LI>   Move to the <b>Validation</b> tab and check the check box next to <b>Input Required</b>. Close the <b>Membership Attribute Design-time Control</b>.

</OL>
<P> <A HREF="perstutor.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h3><A NAME="topic10"></A>Add a Password Attribute
</h3>
<P>The password attribute requires a user logging on to a page to enter a password of their choosing (subject to the constraints you set). It is very useful for services like personalization, because you can personalize even when users access your site from different machines (when cookies they were assigned in previous sessions are not available).
<P><b>Insert the Membership.Attribute password Design-time Control.</b>
<OL>

<LI>   Scroll further down the reg.asp page until you see this comment:
<BR>
<BR>&lt;-- Insert Membership.Attribute : userPassword Here --&gt;
<P>
<LI>   As above, position the cursor under the comment. Right-click and select <b>Insert ActiveX control</b>. From the dialog box that appears, select the <b>Design-time control</b> tab. Scroll down the list and highlight the <b>Membership.Attribute DTC</b> and click <b>OK</b>. This time, though, when the attribute list appears, select <b>userPassword</b>.
<LI>   Go to the <b>Options</b> tab again, and select <b>Specify Password</b> from the <b>UI Type</b> drop-down menu and <b>Update</b> from the <b>Action</b> drop-down menu.
<LI>   Go the <b>Validation</b> tab. The control will automatically select a form of password validation for you. In our case, it selected a text string input with a minimum of one character and a maximum of sixteen. Feel free to modify the password validation option to one that works best for you (we made the minimum password length four digits, just for grins). Close the <b>Design-time Control</b>.

</OL>
<P> <A HREF="perstutor.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h3><A NAME="topic11"></A>Add a Mail Attribute
</h3>
<P>Mail is a special entry field that can access information in Internet Explorer 4.0's  <A HREF="perstutor.htm#topicF">Profile Assistant</A> to prompt the registered e-mail name (if any) by default.
<P><b>Insert Membership.Attribute mail Design-time Control. </b>
<OL>

<LI>   Scroll down reg.asp to this comment:
<BR>
<BR>&lt;-- Insert Membership.Attribute : mail Here --&gt;
<P>
<LI>   Because we're dealing with another membership attribute, you should know the routine by now. Position the cursor under the comment. Right-click and select <b>Insert ActiveX control</b>. From the dialog box that appears, select the <b>Design-time control</b> tab. Scroll down the list and highlight the <b>Membership.Attribute DTC</b> and click <b>OK</b>. When the <b>Membership Attribute</b> dialog appears, select the <i>mail</i> attribute.
<LI>   In the <b>Options</b> tab, select <b>Single Line Text</b> as the <b>UI Type</b> and <b>Update</b> as the <b>Action</b>.
<LI>   Go to the <b>Variables</b> tab and select <b>HTML inserted before the field</b>, which should then appear under <b>Variable Name</b>.
<LI>   Type &quot;Email Address:&quot; in the <b>Value</b> text box. Close the <b>Design-time Control</b> as before by successively clicking the <b>x</b> in the upper right corner of the dialog box and the attribute display pane.

</OL>
<P> <A HREF="perstutor.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h3><A NAME="topic12"></A>Add a PersonalProduct Attribute
</h3>
<P>Now we get to insert the attribute we created into the Membership Directory Manager of the Management Console.  This whole section, &quot;Insert Design-time Controls...&quot;, refers to a set of processes that are substantially alike, which quickly becomes apparent if you follow along duplicating the steps -- except that we'll link directly to aspects of the site vocabulary.
<P><b>Activate the Membership.Attribute PersonalProduct Design-time Control. </b>

<OL>

<LI>Scroll through reg.asp until you find this comment:
<BR>
<BR>&lt;-- Insert Membership.Attribute : PersonalProduct Here --&gt;
<P>
<LI>   Follow the steps to insert an ActiveX Design-time Control. When the <b>Membership Attribute</b> dialog box appears, select <b>PersonalProduct</b> from the <b>Attribute</b> tab.
<LI>   In the <b>Options</b> tab, select the <b>Site Vocabulary List Box Single Select</b> for the <b>UI Type</b> and <b>Update</b> for <b>Action</b>.
<LI>   You will not need to modify the <b>Validation</b> tab. You might want to explore it to see how the control will get information from the site vocabulary.
<LI>   Go to the <b>Variables</b> tab and select the <b>HTML inserted before the field</b> variable. Type <b>Personal Product:</b> into the <b>Value</b> text box. Close the <b>Design-time Control</b>.

</OL><b>Insert the Membership.Footer Design-time Control. </b>
<OL>

<LI>   Scroll through reg.asp to this comment:
<BR>
<BR>&lt;!--Insert Membership.Footer DTC here --&gt;
<P>
<LI>   Select the <b>Membership.Footer</b> Design-time Control. Close the control (no modifications are necessary).
<LI>    Click the <b>Save All</b> button in the Visual InterDev toolbar, and you will be ready to preview the new registration page.

</OL><b>Add a Membership.Attribute to userpref.asp.</b>
<P>Finally, add one more Design-time Control to the userpref.asp page. This attribute presents a slightly different take on the <b>PersonalProduct </b>attribute we added to the reg.asp page. Instead of choosing <b>Update</b> for the <b>Action</b>, we'll choose <b>DisplayUpdate</b>.
<P>Because the user has already indicated a preference in the registration page, the user-preference page should reflect that choice. <b>DisplayUpdate</b> presents the same drop-down menu, with the visitor's previous choice selected.
<OL>

<LI>   To add the control, open userpref.asp and scroll to this comment:
<BR>
<BR>&lt;-- Insert Membership.Attribute : PersonalProduct Here --&gt;
<P>
<LI>   Follow the directions for inserting the <b>PersonalProduct</b> <A HREF="perstutor.htm#topic12"> attribute</A> above, but use <b>DisplayUpdate</b> rather than <b>Update</b>. You have finished all of the modifications needed to implement a full user registration with Profile Assistant integration.

</OL>
<P> <A HREF="perstutor.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h2><A NAME="topicF"></A>View the Registration Page
</h2>
<OL>

<LI>   In Internet Explorer version 4.0 or later, view your page by entering the address &quot;http://localhost:5295/personalization/&quot; in the address box (note that you're entering the address of the Viewing site, not the Editing site).
<LI>   Follow the link to <b>Register as a Member</b>. If you have filled out the Profile Assistant information for Internet Explorer 4.0, you will first see a dialog box checking to see whether it's okay to insert the checked information in a list. (To configure the Profile Assistant in your own copy of Internet Explorer, open the <b>View</b> menu, select <b>Internet Options</b>, select the <b>Content</b> tab, and click the <b>Edit Profile</b> button.)

<p><img src="pers18.gif" WIDTH="289" HEIGHT="329" ALT="[PER3482S  4343 bytes ]">
<P><b>Figure 18.  Internet Explorer Profile Assistant</b>
<P>

<LI>   If you click the <b>Allow</b> button, you will see the full registration page:

<p><img src="pers19.gif" WIDTH="478" HEIGHT="363" ALT="[PER3482T  7202 bytes ]">
<P><b>Figure 19.  Complete Registration page</b>
<P>

<LI>   You can easily modify the HTML formatting of the various Design-time Controls. As mentioned above, you can choose different settings in the <b>Options</b> and <b>Validation</b> tabs, or insert HTML text or formatting through the <b>Variables</b> tab or directly on the page (although you should avoid adding HTML within the code added by the Design-time Controls). For some interesting settings, you might refer to the sample registration pages in the Inspired Technologies Sample Site, which can be found in your Site Server documentation at <i>Site Server Root</i>\Sites\samples\knowledge\membership\inspired\reg.asp.

<LI> If you type in a user name and password, the page will attempt to register you to the system. Note that this registration page already incorporates a great deal of error-checking. For example, if you type in a user name that is already in the database, the page will return an error and ask you to select another name. The text of this error message can also be modified by settings on the <b>Variables </b>tab of the control.

</OL>
<P> <A HREF="perstutor.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h2><A NAME="topicG"></A>Target Personalized Content
</h2>
<P>Now that we've enabled a mechanism for collecting data on preferences of users (the <b>PersonalProduct</b> attribute), we can start using it to change what the server displays to that user on subsequent visits. We will demonstrate two forms of personalization:
<UL>


<LI> Insert script accessing an Active User Object (AUO) to display the user object (user name).
<LI> Use the Rule Builder and Format Ruleset Design-time Controls to retrieve news releases from the News data source.

</UL>
<P>
<h3><A NAME="topic13"></A>A Simple Example:  Adding AUO Script
</h3>
<P>AUO is an interface that provides access to member data sources from script. In the following example, we will use AUO to implement a simple personalization scheme, inserting a user's name to welcome them to a page.
<P><b>Instantiate the Active User Object (AUO).</b>
<OL>

<LI>   Open the press.asp file in your Visual InterDev project. Scroll down until you locate this comment:
<BR>
<BR> &lt;-- Instantiate AUO Here --&gt;
<P>
<LI>   Place the cursor immediately below the comment, and type this line:

<BR>
<BR>&lt;% set user = server.createobject("Membership.UserObjects") %&gt;
</OL>
<b>Fetch and print the user name.</b>
<OL>

<LI>   Next, scroll down the page until you find the string "username" in this line:
<BR>
<BR>Welcome, &lt;!-- Insert username script here --&gt;, to your Press Releases
<LI>   Place this following statement immediately next to the username comment:
<BR>
<BR>&lt;%= user.cn %&gt;
<P>
<LI>   Save the file. Preview it by clicking the <b>View Press Releases</b> link in the <b>PersonalDemo</b> site. The welcome line at the top of the page should now contain your user name.

</OL>
<P> <A HREF="perstutor.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h3><A NAME="topic14"></A>Create and Target a Content Source
</h3>
<P>Now we'll initiate a procedure that enables you to target custom content to the user. Our example will:
<UL>


<LI> Create a content source
<LI> Write a rule to determine which content gets displayed
<LI> Insert the rule into a Web page

</UL>The first thing we need to do is create an object that describes the content you wish to retrieve. In Site Server parlance, you are creating a metadata object called a content source. This object will choose between a set of content options based on input provided by the user (in our case, the <b>PersonalProduct</b> attribute). It is fairly easy to link to a content source using the HTML version of the Site Server Administration tool. The content source we'll access is an open database connectivity (ODBC) database source that already classifies itself by the product types listed in the site vocabulary.
<P><b>Initiate the Membership Directory Manager.</b>
<OL>

<LI>   Start the HTML version of the Site Server Administration service. Select <b>Membership Directory Manager</b> from the home page. On the page that follows, log on to the membership server you created for this project by selecting <b>PersonalDemo Membership Server</b> from the drop-down list.
<LI>   Enter <b>SiteEditor</b> as the <b>User name</b>, and enter the password you gave earlier.

</OL><b>Activate the Content Source wizard.</b>
<OL>

<LI>   Select <b>Content</b> from the left navigation frame, and then the <b>Content Sources</b> hyperlink on the page that appears.
<LI>   A new page will appear that includes a Java applet that displays any previously created content sources, and three buttons labeled <b>Create</b>, <b>Delete</b>, and <b>Properties</b>. Select the <b>Create</b> button to activate the wizard.

</OL><b>Configure the Content Source. </b>
<OL>

<LI>   Type &quot;News&quot; as the name of the content source. Select the <b>ODBC Database</b> radio button, and select <b>Next</b>.
<LI>   Type &quot;news&quot; in the <b>ODBC datasource</b> box, and leave the remaining two blank. Select <b>Next</b>.
<LI>   Type "Documents" in the <b>Tables</b> text box. Leave the <b>Join clause</b> text box blank. A list of attributes will appear that specify different ODBC attributes in the news data source.
<LI>   Accept them all by selecting the <b>Next</b> button. With any luck, you should now see a summary screen similar to the one in Figure 20.
<P><img src="pers20.gif" WIDTH="583" HEIGHT="460" ALT="[PER3482U  20803 bytes ]">
<P><b>Figure 20. New Content Source wizard summary page</b><P>

<P>
<LI>   Select <b>Finish</b> to process the content source. If you are successful, you will be bounced back to the original <b>Content Source</b> page, with your news content source added.

</OL><b>Verify the &quot;news&quot; ODBC provider.</b>
<P>Although we don't modify the ODBC provider, or the Microsoft Access database that it uses, you may wish to explore each to get a sense of how they work or look. The ODBC data source name (DSN) may be accessed from the ODBC item in the Control Panel. Select <b>Start</b>, <b>Settings</b>, <b>Control Panel</b>, and then double-click the <b>ODBC</b> icon. The Microsoft Access database may be found in the Site Server documentation at <i>Site Server Root</i>\Sites\samples\knowledge\membership\inspired\database\content.mdb.
<P> <A HREF="perstutor.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h3><A NAME="topic15"></A>Create a Targeting Rule
</h3>
<P>Now that we have a content source, we can configure it to conditionally display the content it contains. The condition trigger will be the option the visitor selected when asked about which products interest him or her. We'll use the Site Server Rule Manager to set the condition(s), and create a file that we can incorporate into the press.asp file using Visual InterDev.
<P><b>Activate and set up Rule Manager. </b>
<OL>

<LI>   From <b>Start</b>, select <b>Programs</b>, <b>Microsoft Site Server</b>, <b>Tools</b>, and <b>Rule Manager</b>. A two-pane dialog box will appear.
<LI>   From the <b>Rules</b> menu, select <b>Add New Rule</b> (or simply select the <b>Add New Rule</b> icon).
<LI>   You will be prompted with a log-on dialog box; click <b>OK</b> to log on anonymously (make sure the Server box refers to the appropriate server, which in our case is BEASTIEBOY:1003). You should see something like the following:

</OL><b><img src="pers21.gif" WIDTH="494" HEIGHT="372" ALT="[PER3482V  7983 bytes ]"></b>
<P>
<H5>Figure 21. Introductory Rule Manager screen
</H5>
<P><b>Activate the Rule Builder. </b>
<OL>

<LI>   The first dialog box asks for a description of the rule you are building. Type in something like "Show articles or news items based on a user's response to a question or their product interests."
<LI>   Make sure the content source displayed in the drop-down box under <b>Select the News Content Source</b> reads <b>news</b>, and click <b>OK</b>.

</OL><b>Build a rule. </b>
<OL>

<LI>   You will now be presented with a Rule Builder dialog box. Click the <b>Conditions</b> tab and select <b>Where user property has been set</b>.
<LI>   Now click the <b>Add</b> button, and watch that option appear in the bottom pane of the rule builder. Click <b>user property</b> in the lower pane, and scroll down the dialog box that appears to the <b>PersonalProduct</b> attribute we added. Click <b>OK</b>.

<P><img src="pers22.gif" WIDTH="226" HEIGHT="208" ALT="[PER3482W  4640 bytes ]">
<P><b>Figure 22. User Property Selection dialog box</b>
<p>

<LI>   In the <b>Content</b> tab of the Rule Builder, select <b>where content property contains user property </b>from the list in the top pane of the box.
<LI>   Select the <b>And Selection</b> button, which will cause the lower plane to display the following message:

<LI>   <i>Content property</i> refers to an attribute we will select from our content source, and <i>user property</i> refers to an attribute that applies to the visitor. Double-click <b>content property</b>.
<LI>   The list of content attributes we included when setting up the content source will appear. Select the <b>Product</b> attribute and click <b>OK</b>.
<LI>   Now click the <b>user property</b>. A dialog box similar to that for the content property will appear, except that its possible values come from the list of attributes applicable to the site user.
<LI>   Scroll down the list and select the <b>PersonalProduct</b> attribute. Select it and click <b>OK</b>. You should now see a screen that looks something like Figure 23.

</OL><b><img src="pers23.gif" WIDTH="254" HEIGHT="285" ALT="[PER3482X  4284 bytes ]">
<P>Figure 23.  Rule Builder screen showing first rule</b>
<P>Pretty cool, eh? Now, whenever a user who has indicated a product preference accesses a page that installs this rule, they will get served some information on that product. But what about those visitors who don't go to the trouble of registering? Because we want to give them product information, too, we'll install another rule that will serve something up for them.
<P><b>Add the backup rule. </b>
<OL>

<LI>   From the <b>Rule Manager</b> (which we returned to after selecting <b>OK</b> from the final <b>Rule Builder</b> dialog), select <b>Add New Rule</b> again.
<LI>   The Rule Builder will appear, this time with a default prompt of <b>Rule 2</b>. Note the Rule priority box immediately underneath, which has been set to <b>1</b>. Change the priority to <b>2</b>. We're assigning this rule a lower priority than the previous rule because we want it to occur only when users haven't registered.
<LI>   Navigate to the <b>Content</b> tab of the <b>Rule Builder</b>, and select <b>content property is exactly equal to string</b>.
<LI>   Select the <b>And Selection</b> button again to send it to the lower pane.
<LI>   Double-click <b>content property</b> and select the <b>Product</b> attribute again.
<LI>   Click the <b>string</b> phrase, type "Default" in the box provided, and click <b>OK</b>. Click <b>OK</b> to close the <b>Rule Builder</b>.

</OL><b>Save the ruleset. </b>
<OL>

<LI>   Save the ruleset by selecting <b>Save</b> from the <b>File</b> menu item.
<LI>   Name the file something meaningful (such as "selectProduct.prf") and save to a directory where you can easily find it later.

</OL>
<P> <A HREF="perstutor.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h3><A NAME="topic16"></A>Insert the Rule into a Web Page
</h3>
<P>The rule we've just created isn't any good off on its lonesome. To make it accessible within a Web page, we'll reference it using another Design-time Control in Visual InterDev.
<P><b>Add the ruleset to your Visual InterDev project.</b>
<OL>

<LI>   From the Visual InterDev <b>Project</b> menu, select <b>Add to Project</b> and then <b>Files</b>.
<LI>   In the <b>File Open</b> dialog box, navigate to the PRF file you just saved in the Rule Manager. Remember to set the <b>Files of type</b> box to <b>All Files (*.*)</b>. Select <b>selectProduct.prf </b>and click <b>OK</b>.

</OL><b>Insert the ruleset into a page.</b>
<OL>

<LI>   Now we'll simply insert the rules embedded in our PRF file into a Design-time Control. Activate the <b>press.asp</b> file by double-clicking it.
<LI>   Scroll down the file to this comment:
<BR>
<BR>&lt;!-- Insert Membership.FormatRuleset here --&gt;
<P>
<LI>   Place the cursor immediately after the comment, right-click and select <b>Insert ActiveX control. </b>Navigate to the <b>Design-time Control</b> tab and select the <b>Membership.FormatRuleset DTC</b>.
<LI>   Choose the <b>Display all options</b> radio button, and close the dialog box.
<LI>   Another dialog box will appear in the Visual InterDev right pane.

<P><img src="pers24.gif" WIDTH="397" HEIGHT="403" ALT="[PER3482Y  13517 bytes ]">
<P><b>Figure 24. Rule Set formatting dialog in Visual InterDev</b>
<P>

<LI>   Click the <b>Browse</b> button and navigate to where the file created by the Rule Manager (selectProduct.prf) is stored in Visual InterDev. It should appear immediately in the default directory: c:\Program files\DevStudio\MyProjects\personalization\.
<LI>   After the path to the rule file appears in the box, click <b>OK</b>.

</OL><b>Insert the HTML and ASP code.</b>
<OL>

<LI>   Click the <b>Insert Field</b> button. (You may be prompted with a log-on dialog box again, so just log on again.) You will be presented with another dialog box of the news content source.
<LI>   Select the <b>Title</b> attribute and click <b>OK</b>. This will insert code that retrieves the title for a press release. Include some formatting tags around the ASP code to offset it on the page (we added bold tags and a line break):
<BR>
<BR>&lt;b&gt;&lt;%= MemRecordSet("Title")%&gt;&lt;/b&gt;&lt;br&gt;
<LI>   Follow the same steps to insert the <b>Body </b>attribute into the display. Insert two line breaks after the ASP generated by the <b>Insert Fields</b> command to separate articles on the page:
<BR>
<BR>&lt;%= MemRecordSet("Body") %&gt;&lt;br&gt;&lt;br&gt;
<LI>   Close the <b>Design-time Control</b> dialog box, and save the <b>press.asp</b> file. You will return to the press.asp page, which will now show more fun code that processes and formats the conditional display.

</OL><b>View the press releases.</b>
<OL>

<LI>   Take a look at your handiwork! Go to the PersonalDemo site and click <b>View Press Releases</b>. You may be required to log on as the user that you created using the registration page. You should see a welcome banner that shows your name, as well as a list of press releases, if available, that correspond to the product you chose when you registered.
<LI>   You may change your selected product by clicking the <b>Set My Preferences</b> link, selecting a different product, and clicking <b>Submit</b>.

</OL>
<P> <A HREF="perstutor.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif"  WIDTH="18" HEIGHT="8" BORDER="0" ALT="Top">Back to top</A>
<P>
<h2><A NAME="topicH"></A>Conclusion
</h2>
<P>As you have hopefully surmised by now, personalization can be a powerful tool, although not trivial to implement. As we mentioned in the introduction, a successful personalization scheme collects (or even better, infers) information on the preferences of site visitors and, using that information, provides additional pages, applications, news, products, or resources that the visitor <i>may not find on their own</i>. That last point is particularly important. Certainly, personalization at the level we've described is overkill if the visitor already goes to the same information the personalization scheme reveals.
<P>For a commerce site, the potential benefit is obvious:  Visitors might buy more products. (In a similar vein, if personalization can ease the purchase process, especially by eliminating the need for a visitor to re-enter information, visitors have one less obstacle to purchasing.) Other sites benefit as well, because personalization offers the ability to select individuals, like-minded groups, or even visitors that arrive from specific destinations (an ad on another site, for example), track them, and give them a richer experience of your site.
<P>To succeed, a personalization scheme needs to be fully integrated with your site. The samples we provided demonstrate the value of linking personalization to a site vocabulary. If your content extends from a well-classified vocabulary, personalizing it is much easier. Maintaining a site vocabulary enforces a worthwhile design discipline that a personalization scheme can take advantage of, and makes for a more cohesive user experience of your site.
<P>I hope we've given you enough information to start experimenting with your own personalization ideas. We've only scratched the surface of what personalization can deliver, and would like to hear your ideas of where to go from here.

<P>


<P>







<!-- DOCUMENT CONTENT END -->

</DIV>

<DIV CLASS="clsDocBody">
<HR SIZE="1" />
<P><I>Did you find this article useful? Gripes? Compliments? Suggestions for other articles? <A TITLE="Go ahead. Make our day! Send us your thoughts." HREF="../../../sitebuilder/pg06324.htm" TARGET="_top">Write us!</A></I></P>
<P ID="pBackTop"><A HREF="perstutor.htm#top" CLASS="clsBackTop"><IMG SRC="../../../workshop/graphics/top.gif" WIDTH="18" HEIGHT="8" BORDER="0" ALT="Back to top">Back to top</A></P>

<P CLASS="clsIncCpyRt">

</P>

&copy; <A CLASS="clsIncCpyRt" HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">1998 Microsoft Corporation. All rights reserved. Terms of use</A>.

<P>&nbsp;</P>
</DIV>
<SCRIPT LANGUAGE="JavaScript"><!--

function CheckToTop()
{
var eBody = document.body;
if (eBody.scrollHeight > eBody.offsetHeight) pBackTop.style.display = 'block';
}

//--></SCRIPT>

<DIV ID="divMenu1" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="../../../sitebuilder/magazine/default.htm">Magazine Home</DIV>
<DIV expURL="../../../sitebuilder/magazine/jane.htm">Ask Jane</DIV>
<DIV expURL="../../../sitebuilder/magazine/dude.htm">DHTML Dude</DIV>
<DIV expURL="../../../sitebuilder/magazine/xml.htm">Extreme XML</DIV>
<DIV expURL="../../../sitebuilder/magazine/starters.htm">For Starters</DIV>
<DIV expURL="../../../sitebuilder/magazine/hess.htm">More or Hess</DIV>
<DIV expURL="../../../sitebuilder/magazine/server.htm">Servin' It Up</DIV>
<DIV expURL="../../../sitebuilder/magazine/site.htm">Site Lights</DIV>
<DIV expURL="../../../sitebuilder/magazine/webmen.htm">Web Men Talking</DIV>
</DIV>
<DIV ID="divMenu2" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="http://www.microsoft.com/sbnmember/default.asp">Member Community Home</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/freebies/default.asp">Benefits: Freebies &amp; Discounts</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/promote/default.asp">Benefits: Promote Your Site</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/connect/default.asp">Benefits: Connect with Your Peers</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/glance-lev.asp">Benefits at a Glance</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/osig/default.asp">Online Special-Interest Groups</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/levels/member.asp">Your Membership</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/freebies/stores.asp">SBN Stores</DIV>
<DIV expURL="http://www.microsoft.com/sbnmember/apply/registration.asp">Join Now</DIV>
</DIV>
<DIV ID="divMenu3" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="../../../workshop/default.htm">Workshop Home</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/essentials/default.htm">Essentials</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/delivery/default.htm">Content &amp; Component Delivery</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/components/default.htm">Component Development</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/database/default.htm">Data Access &amp; Databases</DIV>
<DIV expURL="../../../workshop/design/default.htm">Design</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/author/default.htm">DHTML, HTML &amp; CSS</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/xml/default.htm">Extensible Markup Language (XML)</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/languages/default.htm">Languages &amp; Development Tools</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/messaging/default.htm">Messaging &amp; Collaboration</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/networking/default.htm">Networking, Protocols &amp; Data Formats</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/browser/default.htm">Reusing Browser Technology</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/security/default.htm">Security &amp; Cryptography</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/server/default.htm">Server Technologies</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/imedia/default.htm">Streaming &amp; Interactive Media</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/workshop/management/default.htm">Web Content Management</DIV>
<DIV expURL="../../../workshop/index/default.htm">Workshop Index</DIV>
</DIV>
<DIV ID="divMenu4" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="../../../gallery/default.htm">Tools &amp; Samples Home</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/gallery/tools/default.htm">Tools</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/gallery/samples/default.htm">Samples, Headers, Libs</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/gallery/images/default.htm">Images</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/gallery/sounds/default.htm">Sounds</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/gallery/stylesheets/default.htm">Style Sheets</DIV>
<DIV expURL="http://www.microsoft.com/typography/fontpack/win.htm">Web Fonts</DIV>
</DIV>
<DIV ID="divMenu5" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="../../../devtraining/default.htm">Training Home</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/seminars/default.htm">SBN Live Seminars</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/chat/default.htm">SBN Live Chats</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/atec.htm">Courses</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/peer/default.htm">Peer Support</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/mastering.htm">CD-ROM Training</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/books_kits.htm">Books & Training Kits</DIV>
<DIV expURL="../../../workshop/c-frame.htm#/devtraining/mscert/default.htm">Certification</DIV>
</DIV>
<DIV ID="divMenu6" CLASS="clsMenu" ONMOUSEOVER="Menu_hover();" ONMOUSEOUT="Menu_hover();" ONCLICK="Menu_click();">
<DIV expURL="../../../sitebuilder/default.htm">SBN Home</DIV>
<DIV expURL="../../../sitebuilder/siteinfo/newtosite.htm">New to SBN?</DIV>
<DIV expURL="../../../sitebuilder/whatsnew.htm">What's New on SBN</DIV>
<DIV expURL="../../../sitebuilder/siteinfo/sitemap.htm">Site Map</DIV>
<DIV expURL="http://www.microsoft.com/isapi/gosearch.asp?TARGET=/dev/web/default.asp">Site Search</DIV>
<DIV expURL="../../../sitebuilder/siteinfo/glossary/default.htm">Glossary</DIV>
<DIV expURL="../../../sitebuilder/write-us.htm">Write Us</DIV>
<DIV expURL="../../../sitebuilder/siteinfo/about.htm">About This Site</DIV>
</DIV>
<SCRIPT LANGUAGE="JavaScript" SRC="../../../sitebuilder/shared/js/navbar.js"></SCRIPT> 
<SCRIPT LANGUAGE="JavaScript" SRC="../../../sitebuilder/shared/js/navlinks.js"></SCRIPT>


</BODY>
</HTML>