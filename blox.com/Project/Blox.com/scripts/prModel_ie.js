//Copyright (C) 1999-2000 AlphaBlox Corporation, Inc. All rights reserved.
var kSlidesName="Slides Folder";var kMastersName="Masters Folder";var kTitleName="Title Frame";var kItemsName="Items Frame";var kTextboxName="Textbox Frame";var gModel=null;var gStore=new Object();var gIndex=1;var gChangeList=new Object();var haveOutline=false;var haveDrawing=false;var haveSorting=false;var haveShowing=false;var gStandardKeys={"fontFamily":true,"fontSize":true,"fontStyle":true,"fontWeight":true,"fontVariant":true,"textDecoration":true,"fontColor":true,"textAlign":true,"verticalAlign":true,"borderWidth":true,"borderStyle":true,"borderColor":true,"backgroundColor":true,"color":true,"bounds":true};var gFontKeys={"fontFamily":true,"fontSize":true,"fontStyle":true,"fontWeight":true,"fontVariant":true,"textDecoration":true,"fontColor":true,"textAlign":true};var gFontKeysPlain={"fontFamily":true,"fontSize":true,"fontColor":true,"textAlign":true};function setupModel(Z){;var Y=null;if(Z!=null){gModel=Z;Y=becomeModel(gModel);if(gModel.highIndex){if(gModel.highIndex>gIndex)gIndex=gModel.highIndex;delete(gModel.highIndex);}convertModel(gModel);}else gModel=createModel("root","root");haveOutline=(typeof(setupOutline) !="undefined") &&(setupOutline() !=false);haveDrawing=(typeof(setupDrawing) !="undefined") &&(setupDrawing() !=false);haveSorting=(typeof(setupSorting) !="undefined") &&(setupSorting() !=false);haveShowing=(typeof(setupShowing) !="undefined") &&(setupShowing() !=false);return Y;}function finishModel(){if(haveOutline)finishOutline();if(haveDrawing)finishDrawing();if(haveSorting)finishSorting();if(haveShowing)finishShowing();gModel=disposeModel(getModel());}function becomeModel(Z){var Y=null,X=null;gStore[Z.index]=Z;var W=parseInt(Z.index.substring(1));if(W>=gIndex)gIndex=W+1;if(Z.selected){Y=Z.index;Z.selected=false;}var V=countModel(Z);for(var U=0;U<V; ++U){var T=childModel(Z,U);if(T){T.parent=Z;X=becomeModel(T);if(Y==null)Y=X;}}switch(kindModel(Z)){case"text":case"slide":case"textbox":if(Z.entry)delete(Z.text);break;}return Y;}function prepareModel(Z,Y){delete(Z.selected);for(var X=0;X<countModel(Z); ++X){var W=childModel(Z,X);W.parent=Z;if(Y)prepareModel(W,true);}switch(kindModel(Z)){case"slide":case"text":case"textbox":if(Z.entry)delete(Z.text);break;}}function convertModel(Z){if(gAppVersion==1.00)convertFrom100(Z);}function convertFrom100(Z){for(var Y=countModel(Z)-1;Y>=0; --Y)convertFrom100(childModel(Z,Y));switch(kindModel(Z)){case"picture":if(Z.entry==null)entryModel(Z,Z.text);if(Z.entry=="http://demo.halfbrain.com:8080/demo/image/bar.gif"){Z.entry=Z.seenUrl="http://www.halfbrain.com/open?id=002dee21_bee4";Z.text="olivebar.gif";if(Z.style==null)Z.style=new Object();Z.style.fileInfo={name:"olivebar.gif",id:"002dee21_bee4"};}else if(Z.entry=="http://demo.halfbrain.com:8080/demo/image/watermark.gif"){Z.entry=Z.seenUrl="http://www.halfbrain.com/open?id=003d3c06_24a9";Z.text="hbwatermark.gif";if(Z.style==null)Z.style=new Object();Z.style.fileInfo={name:"hbwatermark.gif",id:"003d3c06_24a9"};}else if(Z.entry=="http://demo.halfbrain.com:8080/demo/image/logo.gif"){Z.entry=Z.seenUrl="http://www.halfbrain.com/open?id=002dee20_b18a";Z.text="hblogo.gif";if(Z.style==null)Z.style=new Object();Z.style.fileInfo={name:"hblogo.gif",id:"002dee20_b18a"};}if(Z.style&&Z.style.bounds){Z.style.bounds.right=Z.style.bounds.left+Z.style.bounds.width;Z.style.bounds.bottom=Z.style.bounds.top+Z.style.bounds.height;}break;case"slide":var X=descendModel(Z,"frame",kItemsName);if(X){count=countModel(Z);for(Y=count-1;Y>=0; --Y){child=childModel(Z,Y);if(child&&child.kind=="text"){removeModel(child);insertModel(child,X,true);}}}if(Z.style){if(Z.style.background=="http://demo.halfbrain.com:8080/demo/image/wood3.jpg")Z.style.background="http://www.halfbrain.com/open?id=001eabc3_4c2c";else if(Z.style.background=="http://demo.halfbrain.com:8080/demo/image/ruled.jpg")Z.style.background="http://www.halfbrain.com/open?id=003d3c07_2f4a";}break;case"frame":var W,V;W=Z.master?index2model(Z,W):null;if(W&&W.style==null)W=null;if(textModel(Z)==kItemsName){if(ascendModel(Z,"folder",kMastersName) !=null&&countModel(Z)==0){var U=Z;count=5;for(Y=1;Y<=count; ++Y){var T=createModel("text","style for level "+Y);insertModel(T,U,false);U=T;}}if(Z.style&&Z.style.fontFamily){V=retrieveModel(Z,"fontFamily");if(V!=null){decorateChildren(Z,"text","fontFamily",V,true);delete(Z.style.fontFamily);if(W)delete(W.style.fontFamily);}V=retrieveModel(Z,"fontSize");if(V!=null){decorateChildren(Z,"text","fontSize",V,true);delete(Z.style.fontSize);if(W)delete(W.style.fontSize);}V=retrieveModel(Z,"fontWeight",true);if(V!=null){decorateChildren(Z,"text","fontWeight",V,true);delete(Z.style.fontWeight);if(W)delete(W.style.fontWeight);}V=retrieveModel(Z,"fontStyle",true);if(V!=null){decorateChildren(Z,"text","fontStyle",V,true);delete(Z.style.fontStyle);if(W)delete(W.style.fontStyle);}V=retrieveModel(Z,"fontVariant",true);if(V!=null){decorateChildren(Z,"text","fontVariant",V,true);delete(Z.style.fontVariant);if(W)delete(W.style.fontVariant);}V=retrieveModel(Z,"textDecoration",true);if(V!=null){decorateChildren(Z,"text","textDecoration",V,true);delete(Z.style.textDecoration);if(W)delete(W.style.textDecoration);}V=retrieveModel(Z,"fontColor",true);if(V!=null){decorateChildren(Z,"text","fontColor",V,true);delete(Z.style.fontColor);if(W)delete(W.style.fontColor);}}if(Z.style&&Z.style.textAlign){V=retrieveModel(Z,"textAlign");if(V!=null){decorateChildren(Z,"text","textAlign",V,true);delete(Z.style.textAlign);if(W)delete(W.style.textAlign);}}}else if(textModel(Z)==kTitleName){var S=Z.parent;if(Z.style&&S.kind=="slide"){V=retrieveModel(Z,"fontFamily");if(V!=null){decorateModel(S,"fontFamily",V);delete(Z.style.fontFamily);if(W)delete(W.style.fontFamily);}V=retrieveModel(Z,"fontSize");if(V!=null){decorateModel(S,"fontSize",V);delete(Z.style.fontSize);if(W)delete(W.style.fontSize);}V=retrieveModel(Z,"fontWeight",true);if(V!=null){decorateModel(S,"fontWeight",V);delete(Z.style.fontWeight);if(W)delete(W.style.fontWeight);}V=retrieveModel(Z,"fontStyle",true);if(V!=null){decorateModel(S,"fontStyle",V);delete(Z.style.fontStyle);if(W)delete(W.style.fontStyle);}V=retrieveModel(Z,"fontVariant",true);if(V!=null){decorateModel(S,"fontVariant",V);delete(Z.style.fontVariant);if(W)delete(W.style.fontVariant);}V=retrieveModel(Z,"textDecoration",true);if(V!=null){decorateModel(S,"textDecoration",V);delete(Z.style.textDecoration);if(W)delete(W.style.textDecoration);}V=retrieveModel(Z,"fontColor",true);if(V!=null){decorateModel(S,"fontColor",V);delete(Z.style.fontColor);if(W)delete(W.style.fontColor);}V=retrieveModel(Z,"textAlign");if(V!=null){decorateModel(S,"textAlign",V);delete(Z.style.fontFamily);if(W)delete(W.style.textAlign);}}}break;case"textblock":if(Z.master!=null){var R=gStore[Z.master];if(R==null||(Z.style==null&&Z.text==R.text)){removeModel(Z);disposeModel(Z);}else{var Q=cloneObject(R.style);if(Z.style==null)Z.style=Q;else for(var P in Q)if(Z.style[P]==null)Z.style[P]=Q[P];}delete(Z.master);}Z.kind="textbox";var O=createModel("frame",kTextboxName);var N=Z.style;for(var M in N)decorateModel(O,M,N[M]);insertModel(O,Z,false);break;}}function getModel(){return gModel;}function incrementModel(){return"x"+gIndex++;}function conformModel(Z){prepareModel(Z,true);remapModel(Z);}function mergeModel(Z,Y,X){conformModel(Z);var W=descendModel(Z,"folder",kMastersName);var V=descendModel(Z,"folder",kSlidesName);var U=null;if(X==null)X=getModel();var T=descendModel(X,"folder",kSlidesName);if(Y&&V&&T){var S=countModel(V);for(var R=0;R<S; ++R){var Q=childModel(V,0);Q.opened=false;removeModel(Q);restoreModel(Q);insertModel(Q,T,false);if(U==null)U=Q.index;}}var P=descendModel(X,"folder",kMastersName);if(W&&P){S=countModel(W);for(R=0;R<S; ++R){var O=childModel(W,0);O.opened=false;removeModel(O);restoreModel(O);insertModel(O,P,false);if(U==null)U=O.index;}}return U;}function remapModel(Z){var Y=descendModel(Z,"folder",kMastersName);var X=descendModel(Z,"folder",kSlidesName);if(Y)for(var W=0;W<countModel(Y); ++W)remapMaster(childModel(Y,W),X);if(X)for(W=0;W<countModel(X); ++W)remapSlide(childModel(X,W));}function remapMaster(Z,Y){var X=incrementModel();for(var W=0;W<countModel(Y); ++W)remapSlave(Z,X,childModel(Y,W));Z.index=X;for(W=0;W<countModel(Z); ++W)remapMaster(childModel(Z,W),Y);}function remapSlave(Z,Y,X){if(X.master==Z.index)X.master=Y;for(var W=0;W<countModel(X); ++W)remapSlave(Z,Y,childModel(X,W));}function remapSlide(Z){Z.index=incrementModel();for(var Y=0;Y<countModel(Z); ++Y)remapSlide(childModel(Z,Y));}function kindModel(Z){return(Z!=null)?Z.kind:null;}function parentModel(Z){return Z.parent;}function countModel(Z){return(Z&&Z.child)?Z.child.length:0;}function childModel(Z,Y){if(Y<Z.child.length)return Z.child[Y];return null;}function textModel(Z,Y){if(Z==null)return null;if(Z.entry!=null&&Z.entry!="")if(Z.text==null)entryModel(Z,Z.entry);if(!Y&&Z.text!=null&&Z.text!="")return Z.text;if(Z.entry!=null&&Z.entry!="")return Z.entry;return Z.text;}function entryModel(Z,Y){Z.entry=Y;return deriveModel(Z);return Z.text;}function deriveModel(Z,Y){if(Z.entry==null)return;delete(Z.text);if(Z.entry!=""){var X;switch(kindModel(Z)){case"picture":var W=retrieveModel(Z,"fileInfo");if(W)W=W.name;if(W==null){X=new Object();if(urlString(Z.entry,X))W=X.fileName?X.fileName:Z.entry;}Z.text=W;break;case"slide":case"text":case"textbox":if(Y&&Z._expression){Z.text=resolveExpression(Z._expression);}else{Z._expression=new Object();if(stringExpression(Z.entry,Z.index,Z._expression))Z.text=resolveExpression(Z._expression);else delete(Z._expression);}break;}}if(Z.text==null){Z.text=Z.entry;delete(Z.entry);}return Z.text;}function createModel(Z,Y){var X="x"+gIndex++;var W={"parent":null,"child":[],"kind":Z,"selected":false,"opened":true,"index":X};entryModel(W,Y);gStore[X]=W;return W;}function disposeModel(Z){if(Z==null)return;;for(var Y=0;Y<Z.child.length;Y++)disposeModel(Z.child[Y]);delete gStore[Z.index];return null;}function restoreModel(Z){if(Z==null)return;for(var Y=0;Y<Z.child.length;Y++)restoreModel(Z.child[Y]);gStore[Z.index]=Z;return null;}function uniqueModel(Z,Y,X){var W=X.match(/(.+) (\d)$/);var V=W?W[1]:X;if(descendModel(Z,Y,V)==null)return V;var U=null;var T=1;while(T<100){var S=V+" "+( ++T);if(descendModel(Z,Y,S)==null)return S;}return null;}function updateModel(Z){if(haveOutline)selectedOutline(Z);if(haveDrawing)selectedDrawing(Z);if(haveSorting)selectedSorting(Z);if(haveShowing)selectedShowing(Z);updateGUI(Z);}function deselectModel(Z,Y){if(Z==null)return;if(Z.selected){Z.selected=false;if(!Y)updateModel(Z);}for(var X=0;X<Z.child.length;X++)deselectModel(Z.child[X],Y);}function selectModel(Z,Y){if(Z!=null){if(Z.selected)return;Z.selected=true;}if(!Y)updateModel(Z);}function targetModel(Z){if(Z==null)Z=getModel();if(Z==null)return;if(Z.selected)return Z;for(var Y=0;Y<Z.child.length;Y++){var X=targetModel(Z.child[Y]);if(X!=null)return X;}return null;}function openModel(Z,Y,X,W){if(X){for(var V=0;V<Z.child.length;V++)openModel(Z.child[V],Y,X,W);}var U=Z.opened;if(U==null)U=false;if((Z!=getModel()) &&(U!=Y)){Z.opened=Y;if(kindModel(Z)=="frame")Z.opened=true;if((Y==false) &&(kindModel(Z)=="folder") &&X)Z.opened=true;if(haveOutline&&!W){changedOutline(Z);displayOutline(Z,true);}}}function revealModel(Z){var Y=Z.parent;while(Y!=null){openModel(Y,true,false,false);Y=Y.parent;}}function toggleModel(Z){var Y;if(Z.opened==null){Y=true;}else{Y=!Z.opened;}openModel(Z,Y,false,false);}function firstSibling(Z){var Y=parentModel(Z);return Y.child[0];}function lastSibling(Z){var Y=parentModel(Z);return Y.child[Y.child.length-1];}function nextSibling(Z){var Y=parentModel(Z);if(Y)for(var X=0;X<Y.child.length-1;X++)if(Y.child[X]==Z)return Y.child[X+1];return null;}function prevSibling(Z){var Y=parentModel(Z);if(Y)for(var X=1;X<Y.child.length;X++)if(Y.child[X]==Z)return Y.child[X-1];return null;}function isAncestor(Z,Y){while(Y!=null){if(Y==Z)return true;Y=parentModel(Y);}return false;}function masterModel(Z,Y,X,W,V){var U=Z?Z.master:null;var T=node2slide(Z);if(T==null||(T.master==null&&X==null) ||Z==null||parentModel(Z)==null)return U;if(W=="frame"&&containsString(V,kItemsName,"prefix")){var S=index2model(T.master);var R=descendModel(S,"frame",V);if(R)return R.index;R=descendModel(S,"frame",kItemsName);if(R)return R.index;return U;}if(kindModel(Z) !="text")if(!Y||kindModel(Z) !="frame")return U;var Q=0;var P=Z;while(P.kind!="frame"){P=P.parent; ++Q;if(P==null)return U;}if(Y) ++Q;if(P.master==null)return U;var O=X?X:index2model(P.master);if(O==null)return U;var N=null;for(var M=0;M<Q; ++M){O=descendModel(O,"text",null,null,true);if(O==null)break;N=O;}if(O==null)O=N;if(O!=null)return O.index;return U;}function adjustMasters(Z,Y,X){var W=masterModel(Z,false,Y);if(W!=Z.master){if(X){if(X[Z.index]==null)X[Z.index]=cloneObject(Z,{'index':true});X[Z.index].master=W;}else Z.master=W;}var V=countModel(Z);for(var U=0;U<V; ++U)adjustMasters(Z.child[U],Y,X);}function moveModel(Z,Y,X){var W=null;var V=false;var U=false;switch(Y){case"up":W=prevSibling(Z);V=false;U=true;break;case"down":W=nextSibling(Z);V=false;U=false;break;case"left":W=parentModel(Z);V=false;U=false;break;case"right":W=prevSibling(Z);V=true;U=false;break;default:break;}if(W==null)return false;if(!allowModel(Z,W,V))return false;if(Z==W)return true;if(X){removeModel(Z);if(V)insertModel(Z,W,U);else appendModel(Z,W,U);if(kindModel(Z)=="text"&&Z.master!=null)adjustMasters(Z);}return true;}function dropModel(Z,Y,X){var W=false;switch(kindModel(Z)){case"root":case"folder":break;case"slide":if((kindModel(Y)=="folder") &&(X==false)){W=true;X=true;}break;case"group":case"text":case"textbox":case"vline":case"hline":case"grid":case"shape":case"blend":case"picture":case"table":case"chart":if((kindModel(Y)=="slide") &&(X==false)){W=true;X=true;}break;default:break;}if(!allowModel(Z,Y,W))return null;return W?"child":"parent";}function folderModel(Z){var Y=ascendModel(Z,"folder",null);if(Y==null)return null;return textModel(Y);}function ascendModel(Z,Y,X,W,V){if(V){if(Z==null||parentModel(Z)==null)return null;Z=parentModel(Z);}if(W==null)W="equal";while(Z!=null){if((Y==null) ||(Y==kindModel(Z)))if((X==null) ||containsString(textModel(Z),X,W))return Z;Z=parentModel(Z);}return null;}function descendModel(Z,Y,X,W,V){if(Z==null)return null;if(W==null)W="equal";if(!V&&((Y==null) ||(Y==kindModel(Z))))if((X==null) ||containsString(textModel(Z),X,W))return Z;for(var U=0;U<Z.child.length;U++){var T=descendModel(Z.child[U],Y,X);if(T!=null)return T;}return null;}function findModel(Z,Y){if(Z==null||!haveOutline)return null;var X;switch(Y){case"up":X=model2outline(Z);if(X==null)return null;do{X=prevOutline(X);if(X==null)return null;}while(X.style.display=="none");return outline2model(X);case"down":X=model2outline(Z);if(X==null)return null;do{X=nextOutline(X);if(X==null)return null;}while(X.style.display=="none");return outline2model(X);case"left":do{Z=parentModel(Z);if((Z==null) ||(Z==getModel()))return null;X=model2outline(Z);}while((X==null) ||(X.style.display=="none"));return outline2model(X);case"right":if(Z.child.length>0){if(kindModel(Z.child[0])=="frame")return findModel(Z,"down");else return Z.child[0];}default:break;}return null;}function jumpModel(Z,Y){while((Z!=null) &&(kindModel(Z) !="slide"))Z=parentModel(Z);var X;switch(Y){case"slides":X=descendModel(getModel(),"folder",kSlidesName);if(X.child.length>0)return X.child[0];break;case"masters":X=descendModel(getModel(),"folder",kMastersName);if(X.child.length>0)return X.child[0];break;case"first":if(Z!=null)return firstSibling(Z);break;case"last":if(Z!=null)return lastSibling(Z);break;case"prev":if(Z!=null)return prevSibling(Z);break;case"next":if(Z!=null)return nextSibling(Z);break;default:return index2model(Y);break;}return null;}function allowModel(Z,Y,X){if(!X)Y=parentModel(Y);if(!Y)return false;var W="";switch(typeof(Z)){case"string":W=Z;break;case"object":W=kindModel(Z);break;}switch(kindModel(Y)){case"root":return W=="folder";case"folder":return W=="slide";case"frame":return W=="text";case"slide":case"group":switch(W){case"group":case"frame":case"shape":case"blend":case"textbox":case"vline":case"hline":case"grid":case"picture":case"table":case"chart":return true;default:break;}break;case"text":switch(W){case"text":return true;default:break;}break;case"shape":case"vline":case"hline":case"grid":case"textbox":case"blend":case"picture":case"table":case"chart":return false;default:break;}return false;}function removeModel(Z){;var Y=Z.parent;var X=Y.child;for(var W=0;W<X.length;W++){if(X[W]==Z){for(var V=W;V<X.length-1;V++)X[V]=X[V+1];X.length-=1;Z.parent=null;return Z;}};return null;}function insertModel(Z,Y,X){;var W=Y.child;if(X){for(var V=W.length;V>0;V--)W[V]=W[V-1];W[0]=Z;}else{W[W.length]=Z;}Z.parent=Y;}function appendModel(Z,Y,X){;;var W=Y.parent;var V=W.child;for(var U=0;U<V.length;U++)if(V[U]==Y)break;;if(!X)U+=1;for(var T=V.length;T>U;T--)V[T]=V[T-1];V[U]=Z;Z.parent=W;}function fixedModel(Z){if(Z==null)return true;switch(kindModel(Z)){case"other":case"root":case"folder":return true;default:break;}return false;}function slaveModel(Z){var Y=createModel(kindModel(Z),textModel(Z,true));Y.master=Z.index;for(var X=0;X<Z.child.length;X++)switch(Z.child[X].kind){case"frame":insertModel(slaveModel(Z.child[X]),Y,false);break;default:break;}return Y;}function cloneModel(Z,Y){var X=cloneObject(Z,{'parent':true,'child':true},true);X.index="x"+gIndex++;X.child=new Array();X.selected=false;if(Z.kind=="slide")X.open=true;gStore[X.index]=X;if(!Y)for(var W=0;W<Z.child.length;W++)insertModel(cloneModel(Z.child[W],Y),X,false);return X;}function dependsModel(Z,Y){if(Z==null||Y==null)return false;if(Z.master&&Z.master==Y.index)return true;for(var X=countModel(Z)-1;X>=0; --X)if(dependsModel(childModel(Z,X),Y))return true;}function enlightenModel(Z,Y){enlightenOne(getModel(),Z,Y);for(var X=0;X<Z.child.length;X++)enlightenModel(Z.child[X],Y);return Z;}function enlightenOne(Z,Y,X){if(Z.master==Y.index)independentModel(Z,Y,false,X);for(var W=0;W<Z.child.length;W++)enlightenOne(Z.child[W],Y,X);}function emancipateModel(Z,Y,X){emancipateOne(Z,Y,X);return Z;}function emancipateOne(Z,Y,X){if(Z.master!=null){var W=index2model(Z.master);independentModel(Z,W,Y,X);}for(var V=0;V<Z.child.length;V++)emancipateModel(Z.child[V],Y,X);}function enslaveModel(Z,Y,X){enslaveOne(Z,Y,X);for(var W=0;W<Y.child.length;W++)enslaveModel(Z,Y.child[W],X);return Z;}function enslaveOne(Z,Y,X){switch(Z.kind){case"slide":if(Y.kind==Z.kind)dependentModel(Z,Y,X);break;case"frame":var W=textModel(Z);if((Y.kind==Z.kind) &&(textModel(Y)==W)){dependentModel(Z,Y,X);if(W!=kTitleName)adjustMasters(Z,Y,X)}break;default:break;}for(var V=0;V<Z.child.length;V++)enslaveOne(Z.child[V],Y,X);}function independentModel(Z,Y,X,W){if(W){var V=X?{'index':true}:{'index':true,'style':true,'softStyles':true};W[Z.index]=cloneObject(Z,V);W[Z.index].master=null;}else delete Z.master;var U=Y.style;if(X||U==null)return;for(var T in U){var S=retrieveModel(Z,T,true);if(S==null){var R=cloneObject(retrieveModel(Y,T));decorateModel(W?W[Z.index]:Z,T,R,true);}}}function dependentModel(Z,Y,X){if(X){X[Z.index]=cloneObject(Z,{'index':true,'style':true,'softStyles':true});X[Z.index].master=Y.index;}else Z.master=Y.index;var W=Z,V;if(X)W=X[Z.index];V=W.style;if(V==null)return;for(var U in V){var T=retrieveModel(Z,U,true);var S=retrieveModel(Y,U);if(equalObject(T,S) ||softStyle(Z,U)){if(W==Z)delete V[U];else V[U]=null;}}}function swapModel(Z,Y,X,W){if(W==null){W=new Array();for(var V in Y)if(V!='index')W[W.length]=V;}for(var U=0;U<W.length;U++)swapOne(Z,Y,W[U]);}function swapOne(Z,Y,X){if((Z[X] !=null) &&(Y[X] !=null) &&(typeof(Z[X])=='object')){for(var W in Y[X])swapOne(Z[X],Y[X],W);}else{var V=Z[X];if(Y[X] !=null)Z[X]=Y[X];else delete Z[X];Y[X]=V;}}function overrideModel(Z,Y){for(var X in Z)delete Y[X];}function retrieveModel(Z,Y,X){if(Z==null)return null;var W=Z.style;if(W!=null){var V=W[Y];if(V!=null)return V;}var U=Z.master;if((X!=true) &&(U!=null)){Z=index2model(U);if(Z!=null)return retrieveModel(Z,Y);}return null;}function retrieveDefault(Z,Y,X){var W=retrieveModel(Z,Y);if(W!=null)return W;return X;}function retrieveRecursive(Z,Y,X,W){var V;if(X){V=retrieveModel(Z,Y,W);if(V==null)return null;}else{if(countModel(Z)==0)return V;}for(var U=0;U<Z.child.length;U++){var T=retrieveRecursive(Z.child[U],Y,true,W);if(T==null)return null;if(typeof(V)=="undefined")V=T;else if(T!=V)return null;}if(typeof(V)=="undefined")V=null;return V;}function deleteModel(Z,Y){if(Z.style!=null)delete(Z.style[Y]);}function shouldDecorateChildren(Z,Y){if(Z==null)return false;if(kindModel(Z)=="frame"&&((Z.text!=kTitleName) &&(Z.text!=kTextboxName))){switch(Y){case"fontFamily":case"fontSize":case"fontWeight":case"fontStyle":case"fontVariant":case"textDecoration":case"fontColor":case"textAlign":return true;}}return false;}function alternateModel(Z,Y){var X=kindModel(Z);var W=null;switch(X){case"text":switch(Y){case"backgroundColor":case"verticalAlign":case"borderWidth":case"borderStyle":case"color":W=ascendModel(Z,"frame");break;}break;case"textbox":switch(Y){case"backgroundColor":case"verticalAlign":case"borderWidth":case"borderStyle":case"color":W=descendModel(Z,"frame",kTextboxName);break;}break;case"slide":switch(Y){case"verticalAlign":case"borderWidth":case"borderStyle":case"color":W=descendModel(Z,"frame",kTitleName);break;}break;case"frame":switch(Y){case"fontFamily":case"fontSize":case"fontWeight":case"fontStyle":case"fontVariant":case"textDecoration":case"fontColor":case"textAlign":if(Z.text==kTitleName)W=ascendModel(Z,"slide");else if(Z.text==kTextboxName)W=ascendModel(Z,"textbox");break;}}return W?W:Z;}function decorateModel(Z,Y,X,W){Z=alternateModel(Z,Y);var V=kindModel(Z);if(V!=null){switch(V){case"slide":case"textbox":case"text":switch(Y){case"pictureMode":case"tiling":case"fileInfo":if(V=="slide")break;case"fontFamily":case"fontSize":case"fontWeight":case"fontStyle":case"fontVariant":case"textDecoration":case"color":case"backgroundColor":case"background":case"fontColor":case"textAlign":break;case"bullet1":if(V=="text")break;default:;return null;}break;case"vline":case"hline":switch(Y){case"bounds":case"color":case"borderWidth":case"borderStyle":break;case"backgroundColor":case"fontColor":Y="color";break;default:return null;}break;case"grid":switch(Y){case"color":case"backgroundColor":case"borderWidth":case"borderStyle":case"bounds":case"fileInfo":break;default:return null;}break;case"shape":switch(Y){case"bounds":case"color":case"backgroundColor":case"borderWidth":case"borderStyle":break;default:return null;}break;case"blend":switch(Y){case"bounds":case"color":case"backgroundColor":case"blendStyle":case"blendDirection":break;default:return null;}break;case"frame":switch(Y){case"fontFamily":case"fontSize":case"fontWeight":case"fontStyle":case"fontVariant":case"textDecoration":case"fontColor":case"textAlign":if(containsString(Z.text,kItemsName,"prefix"))return null;;break;case"verticalAlign":case"bounds":case"color":case"backgroundColor":case"borderWidth":case"borderStyle":case"bullets":break;default:;return null;}break;case"picture":switch(Y){case"bounds":case"textAlign":case"verticalAlign":case"color":case"backgroundColor":case"borderWidth":case"borderStyle":case"pictureMode":case"tiling":case"fileInfo":break;default:;return null;}break;default:;return null;}}var U=Z.style;if(U==null){U=new Object();Z.style=U;}if(X==null){delete(U[Y]);W=false;}else U[Y]=X;softModel(Z,Y,W);return Z;}function decorateChildren(Z,Y,X,W,V){var U=countModel(Z);for(var T=0;T<U; ++T){var S=childModel(Z,T);if(S&&((Y==null) ||(Y==S.kind))){decorateModel(S,X,W);if(V)decorateChildren(S,Y,X,W,true);}}}function softModel(Z,Y,X){if(Z==null||Y==null)return;if(X){if(Z.softStyles==null)Z.softStyles=new Object();Z.softStyles[Y]=true;}else if(Z.softStyles){delete(Z.softStyles[Y]);deleteEmptyObject(Z,"softStyles");}}function softStyle(Z,Y){if(Z==null||Z.softStyles==null)return false;return(Z.softStyles[Y]==true);}function childrenModel(Z){if(Z.kind!="slide")return Z.child;var Y=new Array;var X=0;var W,V;var U=index2model(Z.master);if(U){W=U.child;V=W.length;for(i=0;i<W.length; ++i)if(W)switch(W[i].kind){case"slide":case"frame":case"text":break;default:Y[X++]=W[i];break;}}W=Z.child;V=W.length;for(var T=0;T<W.length; ++T)Y[X++]=W[T];return Y;}function stripModel(Z,Y){if((Z.master!=null) &&(Z.style!=null))delete Z.style;if(Y)for(var X=0;X<node.child.length;X++)stripModel(node.child[X],true);}function mapModel(Z,Y,X){if(Z==null)return;if(equalBounds(Y,X))return;var W=retrieveModel(Z,"bounds");if(W==null)return;decorateModel(Z,"bounds",mapBounds(W,Y,X));}function transferModel(Z,Y){if(Z==null||Z.style==null)return;var X=cloneObject(Z.style);for(var W in X)decorateModel(Y,W,X[W]);}function changedModel(Z,Y){if(Z==null)gChangeList["x0"]=true;else gChangeList[Z.index]=true;if(Y)flushModel();}function flushModel(){if(gChangeList["x0"])outputModel();else{var Z=haveOutline;var Y=haveDrawing;var X=haveSorting;var W=haveShowing;for(var V in gChangeList){var U=index2model(V);if(!U)continue;if(Z&&changedOutline(U))Z=false;if(Y&&changedDrawing(U))Y=false;if(X&&changedSorting(U))X=false;if(W&&changedShowing(U))W=false;}updateModel(targetModel());}gChangeList=new Object();}function outputModel(Z){if(haveOutline&&!Z)outputOutline();if(haveDrawing)outputDrawing();if(haveSorting)outputSorting();if(haveShowing)outputShowing();updateGUI(targetModel());}function index2model(Z){return gStore[Z];}function index2slide(Z){return ascendModel(gStore[Z],"slide");}function node2slide(Z){return ascendModel(Z,"slide");}if(typeof JSIncludeDoneLoading!="undefined")JSIncludeDoneLoading();