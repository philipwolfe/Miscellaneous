//Copyright (C) 1999-2000 AlphaBlox Corporation, Inc. All rights reserved.
var kIconKind={other:0,closed:1,opened:2,root:3,folder:4,slide:5,group:6,text:7,shape:8,blend:9,picture:10,table:11,chart:12,frame:13,block:14,currentMaster:15};var kIconSize=16;var gOutline=null;function setupOutline(){gOutline=getElement("outline");return(gOutline!=null);}function finishOutline(){}function getOutline(){return gOutline;}function focusOutline(){if(gOutline)gOutline.focus();}function outputOutline(){if(gPageMode!=kEditMode||gOutline==null){if(gOutline)writeDocumentContents(gOutline,"");return;}var Z=node2slide(targetModel(getModel()));writeDocumentContents(gOutline,writeOutline(getModel(),gOutline.style.pixelWidth-kScrollWidth,0,null,Z?Z.master:null));}function updateOutline(Z){var Y=kindModel(Z);if(gOutline==null||gPageMode!=kEditMode||Z==null||Y=="frame")return false;var X=model2outline(Z);if(X==null)return true;var W=getChild(X,"spot");var V=getChild(X,"icon");var U=getChild(X,"text");;;;writeDocumentContents(U,textOutline(Z));var T=1*-kIconSize;var S=0*-kIconSize;if((Z.child.length==0) ||(allChildrenAreEmptyFrames(Z)))T=0*-kIconSize;else if(Z.opened)T=2*-kIconSize;W.style.backgroundPositionX=T;W.style.backgroundPositionY=S;var R;if(Y=="textbox"){R=kIconKind["frame"]*-kIconSize;}else if(Y=="vline"||Y=="hline"){R=kIconKind["shape"]*-kIconSize;}else if(Y=="grid"){R=kIconKind["table"]*-kIconSize;}else{if(kIconKind[Y]==null)R=kIconKind["other"]*-kIconSize;else R=kIconKind[Y]*-kIconSize;}var Q=0*-kIconSize;if(Z.selected)Q=2*-kIconSize;if(Z==getCurrentMaster())R=kIconKind["currentMaster"]*-kIconSize;V.style.backgroundPositionX=R;V.style.backgroundPositionY=Q;var P=node2slide(Z);if(P){if(Z!=getCurrentMaster()){V=getChild(model2outline(P),"icon");V.style.backgroundPositionX=(isAncestor(Z,targetModel())?kIconKind["currentMaster"]:kIconKind["slide"])*-kIconSize;V.style.backgroundPositionY=(P.selected?2:0)*-kIconSize;}if(P.master)updateOutline(index2model(P.master));}return false;}function selectedOutline(Z){var Y=node2slide(Z);var X=model2outline(Y);if(X){icon=getChild(X,"icon");icon.style.backgroundPositionX=(Z.selected?kIconKind["currentMaster"]:kIconKind["slide"])*-kIconSize;icon.style.backgroundPositionY=(Y.selected?2:0)*-kIconSize;if(Z.selected)revealChild(gOutline,X);}updateOutline(Z);}function changedOutline(Z){if(gOutline==null)return true;if(updateOutline(Z)){outputOutline();return true;}return false;}function allChildrenAreEmptyFrames(Z){if(!Z.child)return false;var Y=true;for(var X=0;X<Z.child.length;X++){if((Z.child[X].kind!="frame") ||((Z.child[X].child!=null) &&(Z.child[X].child.length>0))){Y=false;break;}}return Y;}function textOutline(Z){var Y=kindModel(Z);var X=(Y=="slide"||Y=="text"||Y=="textbox");return mungeString(textModel(Z,X),kMungeRawText);}function writeOutline(Z,Y,X,W,V){var U="";if(X>0){var T=(X-1)*kIconSize;var S=kIconSize;var R=kIconSize;var Q=Y-(T+S+R);var P="none";if(W!="none"){if(parentModel(Z)==null){P="block";}else if(kindModel(Z) !="text"||kindModel(parentModel(Z)) !="frame"){if(parentModel(Z).opened)P="block";}else{if(Z.parent.parent&&Z.parent.parent.opened)P="block";}}if(kindModel(Z) !="frame"){U+="<div class=line name='"+Z.index+"' ";U+="style='display: "+P+"; padding-left:"+T+";'>";var O=1*-kIconSize;var N=0*-kIconSize;if((Z.child.length==0) ||(allChildrenAreEmptyFrames(Z)))O=0*-kIconSize;else if(Z.opened)O=2*-kIconSize;U+="<span class=spot style='background-position: "+O+" "+N+";'></span>";var M;var L=kindModel(Z);if(L=="textbox"){M=kIconKind["frame"]*-kIconSize;}else if(L=="vline"||L=="hline"){M=kIconKind["shape"]*-kIconSize;}else if(L=="grid"){M=kIconKind["table"]*-kIconSize;}else{if(kIconKind[L]==null)M=kIconKind["other"]*-kIconSize;else M=kIconKind[L]*-kIconSize;}if(V&&(V==Z.index))M=kIconKind["currentMaster"]*-kIconSize;if(L=="slide"){if(isAncestor(Z,targetModel())){M=kIconKind["currentMaster"]*-kIconSize;}}var K=0*-kIconSize;if(Z.selected)K=2*-kIconSize;U+="<span class=icon style='background-position: "+M+" "+K+";'></span>";U+="<span class=text style='width: "+Q+"; ";if(fixedModel(Z))U+="cursor:default; ";U+="'>"+textOutline(Z)+"</span>";U+="</div>";}}for(var J=0;J<Z.child.length;J++){var I=(kindModel(Z)=="frame")?X:X+1;U+=writeOutline(Z.child[J],Y,I,P,V);}return U;}function getCurrentMaster(){var Z=node2slide(targetModel(getModel()));if(Z&&Z.master)return index2model(Z.master);return null;}function hiliteOutline(Z,Y,X){var W=outline2model(Z);var V=0;if(W==null||W.selected==true)return;if(Y)V=1;if(X)V=2;Z.style.backgroundPositionY=V*-kIconSize;}function displayOutline(Z,Y){if(gPageMode!=kEditMode)return;if(kindModel(Z) !="frame"){var X=model2outline(Z);if(X){if(Y)X.style.display="block";else X.style.display="none";}}var W=Z.opened;if(W==null)W=false;if(W==false)Y=false;for(var V=0;V<Z.child.length;V++)displayOutline(Z.child[V],Y);}function dropOutline(Z,Y,X,W){if(Y==null)return false;var V=Y.element;var U=element2outline(Z);var T=element2outline(V);if((U==null) ||(T==null))return false;if(U==T)return false;var S=outline2model(U);var R=outline2model(T);return dropCommand(S,R,Y.first,W,X);}function prevOutline(Z){if(gOutline!=null){Z=element2outline(Z);var Y=gOutline.children;for(var X=1;X<Y.length;X++)if(Y[X]==Z)return Y[X-1];}return null;}function nextOutline(Z){if(gOutline!=null){Z=element2outline(Z);var Y=gOutline.children;for(var X=0;X<Y.length-1;X++)if(Y[X]==Z)return Y[X+1];}return null;}function insideOutline(Z){if(gOutline!=null){while(Z!=null){if(Z==gOutline)return true;Z=Z.parentElement;}}return false;}function outline2model(Z){Z=element2outline(Z);;return index2model(deUniqueIndexName(Z.name));}function model2outline(Z){if(Z==null||gOutline==null)return null;var Y=gOutline.children;for(var X=0;X<Y.length;X++)if(Y[X].name==Z.index)return Y[X];return null;}function point2outline(Z,Y){var X=gDocument.elementFromPoint(Z,Y);if(X==null)return null;X=element2outline(X);if(X==null)return null;var W=getBounds(X);var V=(W.top+W.bottom)/2;return{"element":X,"first":(Y<V)};}function element2outline(Z){while((Z!=null) &&(Z.className!="line"))Z=Z.parentElement;return Z;}if(typeof JSIncludeDoneLoading!="undefined")JSIncludeDoneLoading();