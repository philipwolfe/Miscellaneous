require=function(){function e(t,r,n){function i(o,s){if(!r[o]){if(!t[o]){var l="function"==typeof require&&require;if(!s&&l)return l(o,!0);if(a)return a(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var u=r[o]={exports:{}};t[o][0].call(u.exports,function(e){var r=t[o][1][e];return i(r||e)},u,u.exports,e,t,r,n)}return r[o].exports}for(var a="function"==typeof require&&require,o=0;o<n.length;o++)i(n[o]);return i}return e}()({"/lib/capability.js":[function(e,t,r){"use strict";function n(e){var t={};switch(e){case c.HTML5_HLS:t={acceptedProtocols:["http"],preferredFormats:["m3u8"],acceptedFormats:["m3u8","m3u8_playlist","m3u8:fmp4"]};break;case c.HTML5_HLS_360:t={acceptedProtocols:["http"],preferredFormats:["m3u8"],acceptedFormats:["m3u8","m3u8_playlist"],is360Renderer:!0};break;case c.HTML5_RAW:t={acceptedProtocols:["http"],preferredFormats:f,acceptedFormats:v};break;case c.HTML5_RAW_360:t={acceptedProtocols:["http"],preferredFormats:f,acceptedFormats:v,is360Renderer:!0};break;case c.HTML5_TV:case c.HTML5_TV_TIZEN:case c.HTML5_TV_ORSAY:t={acceptedProtocols:["http"],preferredFormats:["m3u8","mp4"],acceptedFormats:["m3u8","m3u8_playlist","mp4"]};break;case c.EXTERNAL:t={acceptedProtocols:[],preferredFormats:[],acceptedFormats:[]}}return t}function i(e){return"probably"===e}t.exports=n;var a,o=e("./user-agent"),s=e("../nextgen/src/util"),l=document.createElement("video"),c=e("../nextgen/src/renderers/type");try{if(a=!1,l.canPlayType){var u=l.canPlayType('application/vnd.apple.mpegURL; codecs="avc1.42E01E, mp4a.40.2"');a=o.android?!!u:i(u),!a&&o.tv&&(a=i(l.canPlayType("application/vnd.apple.mpegurl")))}}catch(e){a=!1}o.tv&&(window.noHLS&&(a=!1),window.hls&&(a=!0));var p;try{p=!!l.canPlayType&&i(l.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"'))}catch(e){p=!1}var d;try{d=!!l.canPlayType&&i(l.canPlayType('video/webm; codecs="vp8, vorbis"'))}catch(e){d=!1}o.tv&&(d=!1);var f=[];o.android&&f.push("mp4b"),(a||o.android&&s.isAndroidVersionAbove4())&&f.push("m3u8"),p&&f.push("mp4"),d&&f.push("webm");var v=f.slice(),m=v.indexOf("mp4b");m>-1&&v.splice(m+1,0,"mp4"),v.push("")},{"../nextgen/src/renderers/type":44,"../nextgen/src/util":"/nextgen/src/util.js","./user-agent":2}],"/lib/event-bus.js":[function(e,t,r){"use strict";function n(e){var t=this;t.name=e?e:"unnamed",t.a={},t.e={"controls-bar-change":1,"cc-position-float":1,beaconSend:1,"seek-bar-mouseover":1,"seek-bar-mouseout":1,"volume-hover":1,"playback-info":1,"ad-metrics":1,"ad-opportunity":1}}t.exports=n;var i=e("./logger");n.prototype.once=function(e,t,r){function n(){a&&a()}var i=this,a=i.subscribe(e,function(){t.apply(r,Array.prototype.slice.call(arguments,0)),a()},i);return n},n.prototype.subscribe=function(e,t,r){function n(){i.i(e,a)}var i=this;if(i.a){i.a[e]||(i.a[e]=[]);var a={subscriber:r,cb:t};return i.a[e].push(a),n.detach=n,n}},n.prototype.i=function(e,t){var r=this;if(r.a&&e in r.a){var n=r.a[e].indexOf(t);n>-1&&r.a[e].splice(n,1)}},n.prototype.publish=function(e){var t=this;if(t.a){var r=Array.prototype.slice.call(arguments,1);if(e in t.a){var n=t.a[e].slice(0);t.j(e,n.length,r);for(var a=0;a<n.length;a++)try{n[a].cb.apply(n[a].subscriber,Array.prototype.slice.call(arguments,1))}catch(e){i.error("error in event handler:",e.message||e,e.stack)}}else t.j(e,0,r)}},n.prototype.j=function(e,t,r){var n=this,a=e.toLowerCase();if(a.indexOf("timeupdate")===-1&&a.indexOf("progress")===-1&&!(e in n.e)){var o=["["+n.name+" bus][event]["+e+"]["+t+" subscribers]",r];!r.length&&o.pop(),i.log.apply(i,o)}},n.prototype.destroy=function(){var e=this;e.a=e.e=e.name=null}},{"./logger":"/lib/logger.js"}],"/lib/index.js":[function(e,t,r){function n(e){return Object.prototype.toString.call(e)}r.isArray=function(e){return Array.isArray(e)},r.isBoolean=function(e){return"boolean"==typeof e},r.isNullOrUndefined=function(e){return null==e},r.isNumber=function(e){return"number"==typeof e&&!isNaN(e)},r.isString=function(e){return"string"==typeof e},r.isObject=function(e){return"[object Object]"===n(e)},r.isFunction=function(e){return"function"==typeof e}},{}],"/lib/logger.js":[function(e,t,r){var n=e("./index"),i=e("./user-agent");r.keepConsoleLogs="undefined"==typeof false||false,i.phantomJS&&(r.keepConsoleLogs=!1),function(){var e=function(){},t=["log","error","warn"];t.forEach(function(t){if(n.isNullOrUndefined(window.console)||"log"===t&&!r.keepConsoleLogs)r[t]=e;else if(console[t].apply)r[t]=function(){window.console[t].apply(console,arguments)};else{var i=Function.prototype.bind.apply(console[t],console);r[t]=function(){i.apply(console,arguments)}}})}()},{"./index":"/lib/index.js","./user-agent":2}],"/nextgen/src/cc.js":[function(e,t,r){"use strict";function n(e,t,r){var n=this;n.k=e,n.l=t,n.m=r,n.n=n.l.userPreferences.closedCaptions,n.o(),n.k.subscribe(s.Video.PLAYING,n.p,n),n.k.subscribe(s.PLAYBACK_STARTED,n.p,n),l.tv||(n.k.subscribe(s.AD_PLAYBACK_STARTED,n.u,n),n.k.subscribe(s.Ad.PLAYING,n.u,n),n.k.subscribe(s.AD_BREAK_STARTED,n.u,n),n.k.subscribe(s.AD_BREAK_ENDED,n.p,n)),n.k.subscribe(s.PLAYBACK_ENDED,n.disable,n),n.k.subscribe(s.PLAYBACK_PROGRESS,n.A,n),n.k.subscribe(s.AD_PLAYBACK_PROGRESS,n.B,n),n.k.subscribe(s.FULLSCREEN_CHANGE,n.C,n),n.k.subscribe(s.API.PLAYER_VIEWPORT_CHANGE,n.C,n),n.k.subscribe(s.MEDIA_ITEM_LOADED,n.D,n),n.k.subscribe(s.VTT_SEGMENT_LOADED,n.F,n),n.k.subscribe(s.CC.REQUEST_UI_DATA_FOR_MEDIA_ITEM,n.D,n),n.k.subscribe(s.CC.LANGUAGE_CHANGE,n.G,n),n.k.subscribe(s.CC.UI_TOGGLE,n.H,n),n.k.subscribe(s.CC.UPDATE_STYLE,n.I,n),n.k.subscribe(s.CC.POSITION_CHANGE,n.J,n),n.k.subscribe(s.CC.POSITION_FLOAT,n.K,n),n.k.subscribe(s.CC.SAVE_TO_LOCAL_STORAGE,n.L,n),n.k.subscribe(s.CC.USER_STYLE_PREFERENCES_CHANGE,n.M,n),n.k.subscribe(s.SUBTITLE_TRACK_RECEIVED,n.N,n),n.O=[],n.P=null,n.Q=null,n.R=d,n.S={},n.T=document.createElement("div"),a.classList(n.T).add("cc-element"),n.U=document.createElement("span"),n.T.appendChild(n.U),n.V=n.n.fontSize,n.I(),n.m.getMainElement()&&n.m.getMainElement().appendChild(n.T),l.tv&&(n.W=new c(n.k,n.l)),n.X=!1,n.l.ui.ccOnMute&&n.l.getMute()&&(n.X=!0),n.Y=""}var i=e("xhr"),a=e("./util"),o=e("../../lib"),s=(e("../../lib/logger"),e("./event")),l=e("user-agent").userAgent,c=e("./vtt-fetcher"),u=e("./renderers/type"),p=e("./yvap/common/Constants");t.exports=n;var d="en-us",f="text/vtt",v="application/ttml+xml",m="yvpCC",y={none:"",dropshadow:"2px 1px 1px rgba(0, 0, 0, 1)",raised:"3px 3px 4px rgba(0, 0, 0, 0.75)",depressed:"0px -4px 4px rgba(0, 0, 0, 0.54)",uniform:"-2px -2px 0 #000, -2px 2px 0 #000, -2px 0 0 #000, 2px -2px 0 #000, 2px 2px 0 #000, 2px 0 0 #000, 0 -2px 0 #000, 0 2px 0 #000"},h=Math.floor((Math.pow(2,33)-1)/90);n.prototype.N=function(e){var t=this;if(e&&e.itemId){var r=e.itemId,n=t.S[r];n||(n={ccAvailable:!1,vttPresent:!1,parsedCaptions:null,tracks:[]},t.S[r]=n);var i=e.track;i&&(i.mode="hidden",n.ccAvailable=!0,n.tracks||(n.tracks=[]),n.tracks.push(i));var a=t.Z();a&&a===r&&t.$()}},n.prototype.A=function(e,t,r){var n=this,i=n.P&&n.P.id||null;i&&(n._?n.aa(i,t):n.ba(i,t,r))},n.prototype.B=function(e,t,r){var n=this;if(n.Q){var i=n.Q.adId||null;i&&n.ba(i,t,r)}},n.prototype.ca=function(e){var t=this;e!==t.Y&&(t.Y=e,e?t.U.innerHTML=l.tv?e:t.ea(e):t.U.innerHTML="")},n.prototype.ba=function(e,t,r){var n=this;if(e){var i=n.S[e];if(i&&i.hasNonNativeCC&&n.fa(i),!(i&&i.ccAvailable&&i.parsedCaptions&&i.parsedCaptions.length))return void n.ca("");for(var a=t/r,o=i.parsedCaptions.length,s=Math.floor(a*o);s>0&&s<o&&t<i.parsedCaptions[s].begin;)s--;for(;s<o&&t>i.parsedCaptions[s].end;)s++;var l=s>=0&&s<o;if(l=l&&i.parsedCaptions[s].begin<=t&&t<=i.parsedCaptions[s].end&&!!i.parsedCaptions[s].text){var c=i.parsedCaptions[s].text||"";n.ca(c)}else n.ca("")}},n.prototype.ea=function(e){var t,r=this;if(e){var n=e.split("<br/>");if(n.length>1){for(t=0;t<n.length;t++)n[t].trim()&&(n[t]="&nbsp;"+n[t]+"&nbsp;",t<n.length-1&&(n[t]+="<br/>"));return n.join("")}e=e.trim(),r.U.innerHTML=e;var i,a=Math.floor(r.U.offsetHeight/(r.V+2)),o=[],s=0;for(t=0;t<a;t++){if(i=t===a-1)l=e.length;else{var l=Math.floor(e.length/a*(t+1));/\s/.test(e.charAt(l))||(l=e.indexOf(" ",e.lastIndexOf(" ",l)))}l>s&&o.push("&nbsp;"+e.substring(s,l)+"&nbsp;"+(i?"":"<br/>")),s=l+1}return o.join("")}return e},n.prototype.fa=function(e){var t=e&&e.tracks||[];t.forEach(function(e){e.mode="hidden"})},n.prototype.aa=function(e,t){var r=this;if(e){var n=r.S[e];if(n&&n.hasNonNativeCC&&r.fa(n),n&&n.parsedCaptions&&n.parsedCaptions.length){for(var i=0;i<n.parsedCaptions.length&&n.parsedCaptions[i].end<t;)i++;if(i>0){var a=setTimeout(function(){n.parsedCaptions.splice(0,i),a=null},100);if(i>=n.parsedCaptions.length)return}var o=!1;if(n.parsedCaptions[i]&&(o=t>=n.parsedCaptions[i].begin&&t<=n.parsedCaptions[i].end),o){var s=n.parsedCaptions[i].text||"";r.ca(s)}else r.ga||(r.ga=setTimeout(function(){r.ca(""),clearTimeout(r.ga),r.ga=null},1e3))}else""!==r.U.innerHTML&&r.ca("")}},n.prototype.o=function(){var e=this,t=a.localStorage.get(m),r=t&&t.ccSettings;if(r)for(var n in r)r.hasOwnProperty(n)&&!o.isNullOrUndefined(r[n])&&(e.n[n]=r[n])},n.prototype.M=function(){var e=this;e.I()},n.prototype.C=function(){var e=this,t=e.m.getMainElement()&&e.m.getMainElement().offsetWidth,r=Math.ceil(e.n.fontSize*(t/640));t>640?r=Math.ceil(.8*r):t<640?r<10&&(r=10):r=e.n.fontSize,e.V=r,e.T.style.fontSize=e.V+"px"},n.prototype.G=function(e){var t=this;t.enableAndPersist(e)},n.prototype.H=function(e,t){var r=this;t===!1?e?r.enable():r.disable():e?r.enableAndPersist():r.disableAndPersist()},n.prototype.enableAndPersist=function(e){var t=this;t.ha(e,!0)},n.prototype.enable=function(e){var t=this;t.ha(e,!1)},n.prototype.disableAndPersist=function(){var e=this;e.ia(!0)},n.prototype.disable=function(){var e=this;e.ia(!1)},n.prototype.ka=function(e){var t=this;t.k.publish(s.CC.TOGGLE_SIMPLE_MODE,e)},n.prototype.p=function(){var e=this;e.Q=null;var t=e.P?e.S[e.P.id]:null;t&&t.ccAvailable&&e.$()},n.prototype.u=function(){var e=this;window.setTimeout(function(){var t=e.l.playbackState.ad,r=t&&t.adObj,n=t&&t.adId;if(e.Q=t,n===p.STANDALONE_GEMINI_NATIVE&&r&&"m3u8"===r.mtype){var i=e.S[n];i&&i.ccAvailable&&e.$()}else e.la()},0)},n.prototype.la=function(e){var t=this;if(t.k.publish(s.CC.SHOW_CONTROLS,!1),t.ma=null,t.na=null,t.disable(),e){var r=t.Z(),n=r?t.S[r]:null;n&&(n.ccAvailable=!1),t.O=[],t.k.publish(s.CC.REMOVED)}},n.prototype.Z=function(){var e,t,r=this,n=r.l.playbackState;return n.ad?e=n.ad.adId:(t=r.l.playlist.getCurrentItem(),e=t&&t.id),e},n.prototype.F=function(e,t){var r=this;if(e){var n=e.itemId;if(n){var i=r.S[n];if(i||(i={ccAvailable:!1,vttPresent:!1,parsedCaptions:null},r.S[n]=i),i.hasNonNativeCC=!0,!i.parsedCaptions||!i.ccAvailable){i.parsedCaptions=i.parsedCaptions||[],i.vttPresent=!0,i.ccAvailable=!0;var a=r.l.playlist.getMediaItemById(n);a&&a.setCCAvailability(!0);var o=r.Z();o&&o===n&&r.$()}if(i.vttPresent){var s=e.adjustedTime?e.adjustedTime:0,l=r.oa(e.data,s,t);i.parsedCaptions=r.pa(i.parsedCaptions,l)}}}},n.prototype.pa=function(e,t){if(e&&t){if(!e.length)return t;for(var r=0;r<t.length;){for(var n=e.length-1;n>=0;){if(e[n].begin===t[r].begin){e.splice(n,1,t[r]);break}if(!(e[n].begin>t[r].begin)){e.splice(n+1,0,t[r]);break}n--}n===-1&&e[0].begin>t[r].begin&&e.unshift(t[r]),r++}return e}},n.prototype.$=function(){var e,t=this,r=[d],n=t.Z(),i=n?t.S[n]:null;if(t.O&&t.O.length&&(r=t.O.map(function(e){return e.lang})),e=t.ma&&t.ma.lang||t.n.lang,t.ka(!1),i&&!i.hasNonNativeCC){var a=i&&i.tracks||null;a&&a.length&&(r=a.map(function(e){return e.language}),e=t.na&&t.na.language||t.n.lang,t.ka(!0))}t.k.publish(s.CC.FETCHED,{langList:r,selectedLang:e}),t.k.publish(s.CC.SHOW_CONTROLS,!0),(t.n.show||t.X)&&t.enable()},n.prototype.D=function(e){var t=this;if(e&&(t.P&&t.P.id!==e.id&&delete t.S[t.P.id],t.P=e,t._=e.isLive(),!t.S[e.id])){var r={ccAvailable:!1,vttPresent:!1,parsedCaptions:null};t.S[e.id]=r,t.qa(e)?(r.vttPresent=!0,t.la(!0)):(r.ccAvailable=!0,r.vttPresent=!1,t.ma=null,t.k.publish(s.CC.SHOW_CONTROLS,!0),t.ra(e.closedCaptions))}},n.prototype.qa=function(e){var t=this;if(!e)return!1;if(t._||!t._&&e.rendererType===u.HTML5_HLS){var r=e.getSubtitleStreams();if(r&&r.length>0)return!0}return!e.closedCaptions||!e.closedCaptions.length},n.prototype.ra=function(e){var t=this,r=function(e){t.O=e,t.O.length>0?(l.mobile?t.k.publish(s.CC.FETCH_MOBILE,{langList:t.O,selectedLang:t.n.lang}):(t.k.publish(s.CC.FETCHED,{langList:t.O.map(function(e){return e.lang}),selectedLang:t.n.lang}),t.P.setCCAvailability(!0)),t.n.show||t.X?t.enable(t.n.lang):t.disable()):t.la(!0)};t.sa(r,e,l.desktop||l.tv)},n.prototype.va=function(e,t){var r=this,n=!1,i=[],a=function(r){i.push(r),i.length===t.length&&e(i)};t.forEach(function(t){r.wa(t.url,function(r){r?(t.url=r,a(t)):(!n&&e(i),n=!0)})})},n.prototype.wa=function(e,t){var r=this,n={url:e};l.ie&&l.ie<10&&(n.cors=!0),i(n,function(n,i,a){if(n)return void t(null);try{var o=e.indexOf("ttml")>-1?r.xa(a):a,s=new Uint8Array(r.ya(o)),l=URL.createObjectURL(new Blob([s],{type:"text/vtt"}));t(l)}catch(e){t(null)}})},n.prototype.sa=function(e,t,r){var n,i=this,a=function(e){return e.content_type===n};if(r)n=v,e(t.filter(a));else{n=f;var o=t.filter(a);0===o.length?i.va(e,t):e(o)}},n.prototype.ya=function(e){for(var t=[],r=0;r<e.length;r++){var n=e.charCodeAt(r);if(n<=127)t.push(n);else{var i=r;n>=55296&&n<=57343&&r++;for(var a=encodeURIComponent(e.slice(i,r+1)).substr(1).split("%"),o=0;o<a.length;o++)t.push(parseInt(a[o],16))}}return t},n.prototype.xa=function(e){var t="WEBVTT\n\n",r=new window.DOMParser,n=r.parseFromString(e,"application/xml"),i=n.documentElement.querySelectorAll("p");return Array.prototype.forEach.call(i,function(e){var r=e.getAttribute("id"),n=e.getAttribute("begin"),i=e.getAttribute("end"),a="";Array.prototype.forEach.call(e.childNodes,function(e){""!==e.textContent&&(a+=e.textContent+" ")}),a=a.replace(/<br.*?\/\>/," "),t+=r+"\n",t+=n+" --> "+i+"\n",t+=a+"\n\n"}),t},n.prototype.za=function(e){for(var t=this,r=[],n=new window.DOMParser,i=n.parseFromString(e,"application/xml"),a=i.documentElement.querySelectorAll("p"),o=0;o<a.length;o++){var s={};if(s.begin=t.Aa(a[o].getAttribute("begin")),s.end=t.Aa(a[o].getAttribute("end")),!s.end&&(s.end=t.Aa(a[o].getAttribute("dur"))&&t.Aa(a[o].getAttribute("begin"))+t.Aa(a[o].getAttribute("dur")),!s.end)){r=null,t.la(!0);break}""!==a[o].textContent&&(s.text=a[o].textContent),r.push(s)}return r},n.prototype.oa=function(e,t,r){for(var n,i,a,o,s=this,c=/\r\n|\r|\n/,u=e.split(c),p=u.length,d=/((?:\d{2,}:)?\d{2}:\d{2}\.\d{2,3})\s+.+\s+((?:\d{2,}:)?\d{2}:\d{2}\.\d{2,3})/,f=[],v=0,m=0,y=0;y<p;y++)if(d.test(u[y])){if(m>0){for(i=y-1,a=u[i]&&u[i].trim(),o=u[i-1]&&u[i-1].trim(),""!==a&&""===o&&i--,n=m;n<=i;n++)f[v].text+=u[n]+(n+1<=i?"<br/>":"");v++}var E=u[y].match(d);!r||s.Ba||l.tizen||(s.Ba=1e3*s.Aa(E[1]));var g=1e3*s.Aa(E[1]),b=1e3*s.Aa(E[2]);r&&!l.tizen?(g-=s.Ba,b-=s.Ba):(g=g%h+t,b=b%h+t),f[v]={begin:g/1e3,end:b/1e3,text:""},m=y+1}if(m>0&&m<p)for(n=m;n<p;n++)f[v].text+=u[n]+(n+2<p?"<br/>":"");return f},n.prototype.Aa=function(e){var t,r,n=0;if(e){t=e.split(":"),r=t.length;for(var i=r-1;i>=0;i--)n+=t[r-1-i]*Math.pow(60,i)}return n},n.prototype.Ca=function(e,t){var r,n,i=this;e||(e={}),r=e&&e.show,n=e&&e.lang,i.k.publish(s.CC.TOGGLE,r),t&&(o.isBoolean(r)&&(i.n.show=r,i.X=r),n&&o.isString(n)&&(i.n.lang=n),i.k.publish(s.CC.SAVE_TO_LOCAL_STORAGE,{ccSettings:i.n}))},n.prototype.Da=function(e,t){var r=this,n=r.Z(),a=n?r.S[n]:null;if(!a||!e)return void(t&&t(!1));var o={url:e.url};l.ie&&l.ie<10&&(o.cors=!0),e.parsedCC?t&&t(!0):i(o,function(n,i,o){return n?(r.la(),void(t&&t(!1))):(a.parsedCaptions=e.parsedCC=r.za(o),void(a.parsedCaptions&&(a.hasNonNativeCC=!0,r.P.setCCAvailability(!0),t&&t(!0))))})},n.prototype.Ea=function(e,t){var r,n=this,i=e&&e.tracks||[],a=function(e){i.some(function(t){var n=t.language;if(n&&e&&n.toLowerCase()===e.toLowerCase())return r=t,!0})};return t=t||n.n.lang||d,a(t),!r&&n.n.lang&&a(n.n.lang),!r&&i[0]&&(r=i[0]),r},n.prototype.ha=function(e,t){var r=this,n=r.Z(),i=n?r.S[n]:null;if(!i||!i.ccAvailable)return!1;if(i.vttPresent){if(a.classList(r.T).remove("yvp-hide"),a.classList(r.T).add("yvp-show"),r._&&a.classList(r.T).add("yvp-live-cc"),i&&i.hasNonNativeCC)return r.Ca({show:!0,lang:d},t),!0;var o=i.tracks||[];if(o&&o.length>0)return r.na=r.Ea(i,e),!!r.na&&(o.forEach(function(e){e===r.na?e.mode="showing":e.mode="hidden"}),r.Ca({show:!0,lang:r.na.language},t),!0)}else if(r.ma=r.Fa(e),r.ma||(r.ma=r.Fa(r.n.lang)||r.O[0]),l.desktop||l.tv)return r.Da(r.ma,function(n){if(n)i.parsedCaptions=r.ma.parsedCC,a.classList(r.T).remove("yvp-hide"),a.classList(r.T).add("yvp-show"),r.Ca({show:!0,lang:r.ma.lang},t);else{var o=i.tracks||[];if(o&&o.length>0)return r.na=r.Ea(i,e),!!r.na&&(o.forEach(function(e){e===r.na?e.mode="showing":e.mode="hidden"}),r.Ca({show:!0,lang:r.na.language},t),!0)}}),!0;return!1},n.prototype.ia=function(e){var t=this,r=t.Z(),n=r?t.S[r]:null;return this.Ca({show:!1},e),t._&&!t.l.playbackState.ad||!n||n.vttPresent||(n.parsedCaptions=null),n&&n.tracks&&n.tracks.forEach(function(e){e.mode="hidden"}),a.classList(t.T).remove("yvp-show"),a.classList(t.T).add("yvp-hide"),!0},n.prototype.Fa=function(e){for(var t,r=this,n=0;n<r.O.length;n++){if(e&&r.O[n].lang.toLowerCase()===e.toLowerCase().replace("_","-"))return r.O[n];r.O[n].lang===d&&(t=r.O[n])}return t},n.prototype.I=function(){var e=this;if(e.T){var t=a.cssHexToRgb(e.n.bgColor)||{r:0,g:0,b:0},r=0===e.n.bgOpacity?"transparent":"rgba("+t.r+","+t.g+","+t.b+","+e.n.bgOpacity+")",n=y[e.n.fontEffect];e.T.style.fontFamily=e.n.fontName,e.C(),e.T.style.color=e.n.fontColor,e.U.style.backgroundColor=r,e.T.style.textShadow=n,l.tv&&(l.samsung&&e.Ga(),e.T.style.position="absolute",e.T.style.width="100%",e.T.style.textAlign="center",e.T.style.bottom="14%",e.T.style.zIndex="30")}},n.prototype.K=function(e){var t=this,r=t.T,n=t.Z(),i=n?t.S[n]:null;if(i&&i.ccAvailable&&!a.classList(r).contains("yvp-hide")){var o=t.n.ccPos;"bottom"===o&&(e?(a.classList(r).remove("float"),a.classList(r).remove("bottom")):(a.classList(r).add("float"),a.classList(r).add("bottom")))}},n.prototype.J=function(e){var t=this,r=t.T;e?(a.classList(r).remove("bottom"),a.classList(r).add("top")):(a.classList(r).add("bottom"),a.classList(r).remove("top"))},n.prototype.destroy=function(){var e=this;e.S=null},n.prototype.L=function(e){var t=a.localStorage.get(m)||{};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);a.localStorage.put(m,t)},n.prototype.Ga=function(){var e=this,t=y[e.n.fontEffect],r=a.cssHexToRgb(e.n.windowBgColor)||{r:0,g:0,b:0},n=0===e.n.windowBgOpacity?"transparent":"rgba("+r.r+","+r.g+","+r.b+","+e.n.windowBgOpacity+")";e.T.style.backgroundColor=n;var i=a.cssHexToRgb(e.n.fontColor)||{r:255,g:255,b:255},o=0===e.n.fontOpacity?"transparent":"rgba("+i.r+","+i.g+","+i.b+","+e.n.fontOpacity+")";e.U.style.color=o;var s=a.cssHexToRgb(e.n.fontEdgeColor);switch(e.n.fontEffect){case"dropshadow":case"raised":case"depressed":t=t.replace("rgba(0, 0, 0","rgba("+s.r+", "+s.g+", "+s.b);break;case"uniform":t=t.replace(/#000/g,e.n.fontEdgeColor)}e.T.style["text-shadow"]=t},n.prototype.getLanguageForCode=function(e){e=e.toLowerCase().split("-"),e.length>1&&(e.pop(),e=e.join("-"));var t={id:"Bahasa Indonesia",ms:"Bahasa Melayu",cs:"čeština",da:"dansk",de:"Deutsch",et:"eesti",en:"English",es:"español",fil:"Filipino",fr:"français",hr:"hrvatski",it:"italiano",lv:"latviešu",lt:"lietuvių",hu:"magyar",nl:"Nederlands",nb:"norsk bokmål",pl:"polski",pt:"português",ro:"română",sk:"slovenčina",sl:"slovenščina",fi:"suomi",sv:"svenska",vi:"Tiếng Việt",tr:"Türkçe",el:"Ελληνικά",bg:"български",ru:"русский","sr-cyrl":"Српски",uk:"українська",he:"‎עברית‏‎",ar:"‎العربية‏‎",mr:"मराठी",hi:"हिन्दी",bn:"বাংলা",gu:"ગુજરાતી",ta:"தமிழ்",te:"తెలుగు",kn:"ಕನ್ನಡ",ml:"മലയാളം",th:"ไทย",ur:"اردو زبان",ko:"한국어","zh-hans":"简体中文","zh-hant":"繁體中文",ja:"日本人"};return t[e]}},{"../../lib":"/lib/index.js","../../lib/logger":"/lib/logger.js","./event":"/nextgen/src/event.js","./renderers/type":44,"./util":"/nextgen/src/util.js","./vtt-fetcher":139,"./yvap/common/Constants":99,"user-agent":233,xhr:248}],"/nextgen/src/event.js":[function(e,t,r){"use strict";r.API={PLAYER_RENDERED:"render",PLAYER_READY:"playerReady",PLAYER_ERROR:"playerError",PLAYER_FULLSCREEN_CHANGE:"fullscreenChange",PLAYER_VOLUME_CHANGE:"volumeChange",PLAYER_MUTE_CHANGE:"muteChange",PLAYBACK_ERROR:"playbackError",PLAYBACK_READY:"playbackReady",PLAYBACK_START:"playbackStart",DURATION_CHANGE:"durationChange",BITRATE_CHANGE:"bitrateChange",PLAYBACK_PAUSE:"playbackPause",PLAYBACK_RESUMED:"playbackResumed",PLAYBACK_TIME_UPDATE:"playbackTimeUpdate",PLAYBACK_SEEK_COMPLETE:"playbackSeek",PLAYBACK_COMPLETE:"playbackComplete",AD_PLAYBACK_START:"adStart",AD_PLAYBACK_PAUSE:"adPause",AD_PLAYBACK_RESUME:"adResume",AD_PLAYBACK_PROGRESS:"adProgress",AD_PLAYBACK_STOP:"adComplete",AD_NONE:"adNone",AD_ERROR:"adError",PLAYLIST_COMPLETE:"playlistComplete",PLAYLIST_POSITION_CHANGE:"playlistPositionChange",UI_INTERACT:"uiInteract",BEACON_SEND:"beaconSend",LOADING_BEGIN:"loading-begin",LOADING_END:"loading-end",PLAYBACK_TIMEOUT:"playback-timeout",VIDEO_STARTED:"video-started",METADATA_READY:"metadata-ready",CC_AVAILABLE:"media-item-cc-available",AIRPLAY_AVAILABILITY_CHANGE:"airplay-availability-change",AIRPLAY_CONNECTION_STATE_CHANGE:"airplay-connection-state-change",CAST_AVAILABILITY_CHANGE:"cast-availability-change",CAST_CONNECTED_STATE_CHANGE:"cast-connected-state-change",OPSS_VISIBILITY_CHANGED:"opss-visibility-changed",CUEPOINT_STARTED:"cuepointStarted",CUEPOINT_STOPPED:"cuepointStopped",CUEPOINT_DETECTED:"cuepointDetected",PLAYER_VIEWPORT_CHANGE:"player-viewport-change",PLAYER_DOCKED_CHANGE:"player-docked-change",BUFFERING_START:"bufferingStart",BUFFERING_END:"bufferingEnd",MULTI_AUDIO_AVAILABLE:"multi-audio-available"},r.TIMED_METADATA_RECEIVED="timed-metadata-received",r.ERROR="player-error",r.WARNING="player-warning",r.INFO="player-info",r.KEYDOWN="keydown",r.WINDOW_ON_FOCUS="focus",r.WINDOW_ON_BLUR="blur",r.START_SCREEN_RENDERED="start-screen-rendered",r.START_SCREEN_CLICK="start-screen-click",r.END_SCREEN_RENDERED="end-screen-rendered",r.CTRL_ENDSCREEN_VID="selected-endscreen-video",r.RELATED_ITEM_CLICK="related-item-click",r.FETCH_MORE_RELATED_ITEMS="fetch-more-related-items",r.UP_NEXT_PG_CLICK="upnext-pg-click",r.SEEK_BAR_MOUSEOVER="seek-bar-mouseover",r.SEEK_BAR_MOUSEOUT="seek-bar-mouseout",r.TOGGLE_PLAY_PAUSE="toggle-play-pause",r.CONTROLS_SEEK_START="controls-seek-start",r.CONTROLS_SEEK_END="controls-seek-end",r.CONTROLS_SEEKING="controls-seeking",r.CONTROLS_SET_VOLUME="controls-set-volume",r.CONTROLS_SET_MUTE="controls-set-mute",r.FULLSCREEN_CHANGE="fullscreen-change",r.PLAYER_DIMENSION_CHANGE="player-dimension-change",r.CONTROLS_BAR_CHANGE="controls-bar-change",r.METADATA_AVAILABLE="metadata-available",r.RELATED_ITEMS_LOADED="related-items-loaded",r.RENDERER_SWITCHED="renderer-switched",r.RENDERER_PP_NEXT="renderer-prepare-preload-next",r.TOUCH_TO_PLAY_RESTRICTION_REMOVED="mobile-touch-play-restriction-removed",r.BROWSER_BLOCKED_PLAYBACK_START="browser-blocked-playback-start",r.RENDER_PLAYLIST_FIRST_BATCH="render-playlist-first-batch",r.MEDIA_ITEM_LOADED="media-item-loaded",r.CAST={TOGGLE_PLAYING:"cast-toggle-playing",BUFFERING:"cast-buffering",MEDIA_CHANGED:"cast-media-changed",PLAYBACK_PROGRESS:"cast-playback-progress",VIDEO_ENDED:"cast-video-ended",PLAYLIST_ENDED:"cast-playlist-ended",CONNECTION_STATUS_CHANGED:"cast-connection-changed",VOLUME_CHANGED:"cast-receiver-volume-changed",MUTE_CHANGED:"cast-receiver-mute-changed",CAPTION_AVAILABILITY_CHANGED:"cast-captions-availability-changed"},r.CONTROLS_AUDIO_CHANGE="controlsAudioChange",r.REQUEST_GEO_POSITION="geoPositionRequest",r.MULTI_LANGUAGES_AVAILABLE="multiLanguagesAvailable",r.THREE_SIXTY_READY="360-ready",r.THREE_SIXTY_INTERACT="360-interact",r.THREE_SIXTY_PIE_INTERACT="360-pie-interact",r.SWF_READY="swf-ready",r.SWF_READY_TIMEOUT="swf-ready-timeout",r.PAUSE_VPAID="pause-vpaid",r.RESUME_VPAID="resume-vpaid",r.PLAYER_RESIZE="player-resize",r.SELECTED_STREAM_CHANGE="selectedStreamChange",r.SELECTED_STREAM_URL_CHANGE="selectedStreamUrlChange",r.RENDERER_PLUGIN_LOADED="rendererPluginLoaded",r.RENDERER_PLUGIN_LOAD_FAILED="rendererPluginLoadFailed",r.RENDERER_PLUGIN_LOAD_TIMED_OUT="rendererPluginLoadTimedOut",r.VTT_SEGMENT_LOADED="vttSegmentLoaded",r.SEGMENT_FIRST_BYTE_LOADED="segmentFirstByteLoaded",r.MEDIA_RELOAD_BEGIN="mediaReloadBegin",r.MEDIA_RELOAD_END="mediaReloadEnd",r.MEDIA_PLAYLIST_LOADED="mediaPlaylistLoaded",r.MEDIA_PLAYLIST_UPDATED="mediaPlaylistUpdated",r.SUBTITLE_PLAYLIST_UPDATED="subtitlePlaylistUpdated",r.QUALITY_CHANGE="qualityChange",r.QUALITY_SELECTED="qualitySelected",r.BITRATE_LIST_CHANGED="bitrateListChanged",r.ABR_DATA_UPDATE="abrDataUpdate",r.FRAG_LOAD_RETRY_FAILURE="fragLoadRetryFailure",r.LIVE_MEDIA_PLAYLIST_LOAD_RETRY_FAILURE="liveMediaPlaylistLoadRetryFailure",r.LIVE_LOADING_LATE="liveLoadingLate",r.RECOVERY_START="recoveryStart",r.RECOVERY_METADATA_READY="recoveryMetadataReady",r.ER_READY="erReady",r.ER_ERROR="erError",r.ERR_NO_RECOVERY="errNoRecovery",r.CONVIVA_READY_FOR_SESSION_CREATION="convivaReadyForSessionCreation",r.PLAYBACK_INFO="playback-info",r.USER_AUTHENTICATED="user-authenticated",r.CC_HOVER="cc-hover",r.VOLUME_HOVER="volume-hover",r.PTS_DISCONTINUITY="PTSDiscontinuity",r.RELOAD_FRAGMENT="ReloadFragment",r.SUBTITLE_TRACK_RECEIVED="subtitle-track-received",r.PAGE_VISIBILITY_CHANGED="page-visibility-changed",r.LIVE_RELOAD_MEDIA="reloadMedia",r.PRELOAD_START="preloadStart",r.PRELOAD_PROGRESS="preloadProgress",r.PRELOAD_COMPLETE="preloadComplete",r.PLAY_CALLED_ON_RENDERER="playCalledOnRenderer",r.nativeVideoEvents=["ended","error","loadedmetadata","loadeddata","pause","stalled","loadstart","play","playing","seeking","seeked","timeupdate","volumechange","waiting"],r.html5HlsEvents=["infoUpdate","segmentFirstByteLoaded","vttSegmentLoaded","streamSwitched","liveLoadingLate","streamUpdated","hlsWaiting","cuepointDetected","cuepointStarted","subtitleStreamUpdated","abrDataUpdated","preloadStart","preloadProgress","preloadComplete","segInfoMetricsAvailable","contentLoadFinished","bufferGrowthDetected","bufferGapDetected","ccVttAvailable","multiLanguagesAvailable","timedMetadataReady"],r.SEG_INFO_AVAILABLE="segInfoAvailable",r.CONTENT_LOAD_FINISHED="contentLoadFinished",r.BUFFER_GROWTH_DETECTED="bufferGrowthDetected",r.Video={CLICK:"video-click",SWITCHING:"switching",SWITCHED:"switched",WARNING:"warning"},r.Ad={CLICK:"ad-click",NO_AD:"ad-no-ad",NO_PLAYABLE_STREAM:"ad-no-playable-stream",CANCELED:"ad-canceled",BREAK_CANCELLED:"ad-break-cancelled",ERROR:"ad-error",ENDED:"ad-ended",IFRAME_LOAD:"ad-iframe-load",IFRAME_LOADED:"ad-iframe-loaded"},r.nativeVideoEvents.forEach(function(e){r.Video[e.toUpperCase()]="video-"+e,r.Ad[e.toUpperCase()]="ad-"+e}),r.VIDEO_REQUEST="video-request",r.PLAYBACK_REQUEST="playback-request",r.PLAYBACK_STARTED="playback-started",r.PLAYBACK_RESUMED="playback-resumed",r.PLAYBACK_PROGRESS="playback-progress",r.PLAYBACK_STALLED="playback-stalled",r.PLAYBACK_ENDED="playback-ended",r.PLAYBACK_ERROR="playback-error",r.API_CALLED="api-called",r.HLS_FIRST_TS_LOAD_START="hls-first-ts-load-start",r.HLS_FIRST_TS_FIRST_BYTE_ARRIVE="hls-first-ts-first-byte-arrive",r.CTRL_PLAYPAUSE="ctrl-play-pause",r.CTRL_SEEK="ctrl-seek",r.CTRL_VOLUME="ctrl-volume",r.CTRL_FULLSCREEN="ctrl-fullscreen",r.CTRL_SETTINGS="ctrl-settings",r.CTRL_AGEGATE_BDAY="ctrl-agegate-bday",r.CTRL_REPLAY="ctrl-replay",r.CTRL_TIMER="ctrl-timer",r.CTRL_PLAYREQUEST="ctrl-playrequest",r.UI_LOGIN="ui-login",r.AD_PLAYBACK_REQUEST="ad-playback-request",r.AD_PLAYBACK_STARTED="ad-playback-started",r.AD_PLAYBACK_PAUSED="ad-playback-paused",r.AD_PLAYBACK_RESUMED="ad-playback-resumed",r.AD_PLAYBACK_PROGRESS="ad-playback-progress",r.AD_PLAYBACK_ENDED="ad-playback-ended",r.AD_BREAK_STARTED="ad-break-started",r.AD_BREAK_INFO="ad-break-info",r.AD_BREAK_ENDED="ad-break-ended",r.CUEIN_DETECTED="cue-in-detected",r.AD_PLAYBACK_ERROR="ad-playback-error",r.AD_VIEW_CLICK="ad-view-click",r.AD_CLICK="ad-exposed-click",r.UPDATE_AD_COUNT="update-ad-count",r.UPDATE_AD_BREAKS="update-ad-breaks",r.ADS_OBJS_UPDATE="ads-object-update",r.ADS_READY="ads-ready",r.AD_BREAK_TIMELINE="ad-break-timeline",r.YVAP_INFO_UPDATE="yvap-info-update",r.YVAP_MIDROLL_CACHE_UPDATE="yvap-midroll-cache-update",r.AD_METRICS="ad-metrics",r.CC={SETTINGS:"cc-settings",TOGGLE:"cc-toggle",UI_TOGGLE:"cc-ui-toggle",FETCHED:"cc-fetched",FETCH_MOBILE:"cc-fetche-mobile",REQUEST_UI_DATA_FOR_MEDIA_ITEM:"cc-request-ui-data-for-media-item",REMOVED:"cc-destroy",SHOW_CONTROLS:"cc-show-controls",LANGUAGE_CHANGE:"cc-language-change",CC_OPTIONS_LANGUAGE_CHANGE:"cc-options-language-change",FONT_SIZE_CHANGE:"cc-font-size-change",FONT_FACE_CHANGE:"cc-font-face-change",BG_OPACITY_CHANGE:"cc-bg-opacity-change",USER_STYLE_PREFERENCES_CHANGE:"cc-user-style-preferences-change",SAVE_TO_LOCAL_STORAGE:"cc-save-to-local-storage",UPDATE_STYLE:"cc-update-style",POSITION_CHANGE:"cc-position-change",POSITION_FLOAT:"cc-position-float",TOGGLE_SIMPLE_MODE:"cc-toggle-simple-mode"},r.CTV={GET_BITRATE_FOR_OPSS:"ctv-get-bitrate-for-opss"},r.BEFORE_PROGRESS_BEACON="before-progress-beacon",r.BEFORE_INCOMPLETE_EXIT="before-incomplete-exit",r.Metrics={INIT_TO_STARTSCREEN:{type:"titssc",desc:"VideoPlayer init to StartScreen Rendered"},HLS_FIRST_TS_LOAD_START:{type:"hftls",desc:"First ts loading starts in HLS"},HLS_FIRST_TS_FIRST_BYTE_ARRIVE:{type:"hftfba",desc:"First byte arrives for the first ts loading in HLS"},CLICK_TO_START:{type:"ttsapf",desc:"Player click to playback start"},INIT_TO_START:{type:"ttsapt",desc:"Init to playback start (autoplay)"},PLAYBACK_START:{type:"tpb",desc:"Playback request to playback start"},INIT_CONT_PLAY_START:{type:"tcps",desc:"Time difference between video-end and next video start"},PLAYBACK_STALLED:{type:"tps",desc:"Playback buffering start to buffering end"},LOAD_TO_LOADED_DATA:{type:"tltld",desc:"Time from load() to loaded data"},SAPI_REQUEST:{type:"tsapic",desc:"SAPI request to SAPI response"},SWF_READY:{type:"tswfr",desc:"Player SWF is ready"},SWF_OBJECT_TO_INIT_START:{type:"tobtswfinit",desc:"Time from creation of object tag to call of swf constructor"},INIT_RENDER_GAP:{type:"tirg",desc:"Time gap between end of construction and beginning of render"},INIT_TO_SAPI:{type:"titsc",desc:"Time from beginning of construction to first updateMetaData"},RENDER_TO_SWF:{type:"trtswf",desc:"Time from init to object tag creation"},DRM_METADATA_IS_SET:{type:"tdmds",desc:"Time interval from play to drm meta data is set"},DRM_AUTH_COMPLETE:{type:"ttauth",desc:"Time to complete DRM authentication after drm metadata is set"},SET_WATCH_HISTORY:{type:"tsetwh",desc:"YQL+ call to save watch history"},VP_CONSTRUCTOR:{type:"tcons",desc:"VideoPlayer Constructor"},GET_USER_PREFS:{type:"tgetcc",desc:"YQL+ call to get captions preferences"},SAPI_LOADCLIPS:{type:"tsapiclips",desc:"SAPI request for clips"},CREATE_RENDERER:{type:"trcreate",desc:"Creating the renderer (swf/html)"},YVAP_READY:{type:"tyvapr",desc:"VideoAdPlugin is ready"},YVAP_NOAD:{type:"tyvapadn",desc:"Ad None"},YVAP_ADSTARTED:{type:"tyvapads",desc:"Ad Started"},STREAM_REQUEST_TO_RENDER:{type:"treqtr",desc:"Stream Latency (From request to render)"},STREAM_PLAY_TO_RENDER:{type:"tsltps",desc:"Media playback start to video render"},SAPI_LOADRELATED:{type:"tsapilr",desc:"SAPI Get for related videos"}},r.Device={ORIENTATION_CHANGE:"device-orientation-change"},r.Iframe={MessageType:{EVENT:"EVENT",CLEAR_IFRAME_NAME:"CLEAR_IFRAME_NAME",PLAYER_DIMENSION_CHANGE:"PLAYER_DIMENSION_CHANGE",IFRAME_WINDOW_EVENT:"IFRAME_WINDOW_EVENT"},ON_FOCUS:"IframeFocus",ON_BLUR:"IframeBlur"}},{}],"/nextgen/src/metadata-fetcher.js":[function(e,t,r){function n(e,t,r){var n=this;n.l=e,n.k=t,n.Ha=r,n.Ia=new s(n.l,t,r),n.Ja=!1,n.Ka=n.l.mediaStore.registerFinished(n.k)}var i=e("./error"),a=e("./event"),o=e("./media-store"),s=e("./sapi"),l=e("./util"),c=e("../../lib"),u=e("./navigator-info").network,p=e("../../lib/logger");e("user-agent").userAgent;
t.exports=n,n.prototype.La=function(){var e=this,t=[],r=e.l.mediaStore.getAll();for(var n in r)if(r.hasOwnProperty(n)){var i=r[n];i.state===o.ItemState.HAS_DATA&&t.push(n)}t.length&&e.k.publish(a.METADATA_AVAILABLE,t)},n.prototype.updateMetadata=function(e,t,r){var n=this;n.Ja||(n.La(),n.Ja=!0,n.Ha.setEndTime(a.Metrics.INIT_TO_SAPI));var i=[],s=n.l.mediaStore.getAll();for(var l in s)if(s.hasOwnProperty(l)){var c=s[l];(c.state===o.ItemState.ERROR&&c.geoRequired===!0||c.state===o.ItemState.NO_DATA||c.recoveryStatus===o.ItemRecoveryStatus.RECOVERING)&&(i.push(l),c.state=o.ItemState.FETCHING)}n.Ma(i,e,t,r)},n.prototype.getRawMediaObjResponse=function(e,t){var r=this;if(e&&"function"==typeof t){var n=r.Na();if(n.uuids=[e],r.l.playlist){var i=r.l.playlist.getCurrentItem();i&&i.id===e&&(n.ps=i.videoSession)}r.Ia.loadClips(n,r.l.capabilities,function(e,r,n){if(e)return t(e,null);if(!r)return t(null,null);var i;try{return i=r.query.results.mediaObj,t(null,i[0])}catch(e){return t(null,null)}},!1)}},n.prototype.Na=function(){var e=this,t=e.l.YVAP.standaloneAd;return{width:e.l.ui.thumbnailDimensions.width||e.l.uiState.width,height:e.l.ui.thumbnailDimensions.height||e.l.uiState.height,site:e.l.baseConfig.site,expb:e.l.baseConfig.experienceBucket,expn:e.l.baseConfig.experienceName,lang:e.l.baseConfig.lang,region:e.l.baseConfig.region,synd:e.l.baseConfig.syndication,pspid:e.l.CMS.suppressAdContext?"":e.l.baseConfig.pageSpaceId,acctid:e.l.YVAP.accountId,topic:e.l.YVAP.cTopic,rt:e.l.rendererTypes,autoplay:e.l.playback.autoplay,showPlaylist:e.l.ui.playlistUI&&e.l.ui.playlistUI.show,plid:e.l.guid,standaloneAdMode:!(!t||!(t.xml||t.gemini||t.brxd))}},n.prototype.Ma=function(e,t,r,n){var i=this;t=t||function(){};var o=i.Na();if(o.uuids=e,e.length>0){if(i.l.playlist){var s=i.l.playlist.getCurrentItem();s&&s.id===e[0]&&(o.ps=s.videoSession)}i.Ha.add(a.Metrics.SAPI_LOADCLIPS),i.Ia.loadClips(o,i.l.capabilities,function(a,o,s){t(i.Oa(a,o,e,s,r,n))},n)}else t(null)},n.prototype.Oa=function(e,t,r,n,o,s){var p=this;o=!c.isNullOrUndefined(o)&&o,s=!c.isNullOrUndefined(s)&&s;var d=null;if(e){d=e;var f,v=o?a.WARNING:a.ERROR,m=o?i.E_WARNING:i.E_PLAYER;f=e.message===l.JSONP_ERROR?o?i.PLAYER_CODES.E_CMS_JSONP_REQUEST_SILENT_FAIL:i.PLAYER_CODES.E_CMS_JSONP_REQUEST_FAILURE:e.message===l.JSONP_TIMED_OUT?o?i.PLAYER_CODES.E_CMS_JSONP_REQ_TIMEOUT_SILENT_FAIL:i.PLAYER_CODES.E_CMS_JSONP_REQ_TIMEOUT:e.subcategory,d=l.createErr("S",p.l.playbackState,m,f,null,n+"; "+d.debugMessage,s),p.k.publish(v,d)}else{var y;try{y=t.query.results.mediaObj,p.Ha.setEndTime(a.Metrics.SAPI_LOADCLIPS)}catch(e){d=l.createErr("S",p.l.playbackState,i.E_PLAYER,i.PLAYER_CODES.E_CMS_RESPONSE),p.k.publish(a.ERROR,d)}if(!d){var h=[];p.l.mediaStore.fillFromSapi(y,p.l.rendererTypes,p.l.capabilities,h),h.length}var E=t.query&&t.query.results;p.l.CMS.colo=E&&E.colo||"none",E&&E.connectionType&&!u.available&&u.update(E.connectionType.mobile,E.connectionType.raw),p.l.mediaStore.notifyFetchFinished(r,d?d.subcategory:null)}return d},n.prototype.fillFromER=function(e){var t=this,r=e.query.results.mediaObj,n=[];t.l.mediaStore.fillFromSapi(r,t.l.rendererTypes,t.l.capabilities,n),n.length,t.l.CMS.colo=e.query?e.query.results.colo:"none"},n.prototype.prefetch=function(e,t){for(var r=this,n=!0,i=0,o=e.length;i<o;i++){var s=r.l.mediaStore.get(e[i]);if(!s||"has-data"!==s.state){n=!1;break}}return n?void r.k.publish(a.API.METADATA_READY,e):(e.forEach(function(e){r.l.mediaStore.updateItemFromRaw({id:e})}),void r.updateMetadata(function(){},t,!0))},n.prototype.updateUserPreferences=function(e){var t=this;t.Ia.updateUserPreferences(function(){},e)},n.prototype.getUserPreferences=function(){var e=this;if(e.l.userPreferences.isAuthenticated){if(e.l.userPreferences.closedCaptions.isAvailable&&!c.isNullOrUndefined(e.l.userPreferences.isAdult))return;var t=l.getSingleton("userPrefs");if(!c.isNullOrUndefined(t))return void e.Pa(t);e.Ha.add(a.Metrics.GET_USER_PREFS),e.Ia.getUserPreferences(function(t,r){return t?void p.error("User preferences failed on SAPI call.",t):void(r.userprefs&&(e.Ha.setEndTime(a.Metrics.GET_USER_PREFS),e.Pa(r.userprefs,!0)))})}},n.prototype.Pa=function(e){var t=this,r=null,n=null,i=null;if(e.length){if(e.forEach(function(e,a){e.closedcaptionprefs&&(n=e.closedcaptionprefs,r=a),c.isNullOrUndefined(e.isAdult)||(t.l.userPreferences.isAdult=e.isAdult),e.err&&(i=e.err)}),!n&&"Invalid_GUID"===i)return t.l.userPreferences.isAuthenticated=!1,void t.k.publish(a.USER_AUTHENTICATED);if(t.l.userPreferences.isAuthenticated=!0,t.k.publish(a.USER_AUTHENTICATED),n&&!n.err){var s;e[r].closedcaptionprefs.show=t.l.userPreferences.closedCaptions.show,o.fillFromConfig(t.l.getModelSchema().userPreferences.closedCaptions,e[r],t.l.userPreferences.closedCaptions,s),s||(t.l.userPreferences.closedCaptions.isAvailable=!0,t.k.publish(a.CC.USER_STYLE_PREFERENCES_CHANGE),l.setSingleton("userPrefs",e))}}},n.prototype.getRelatedVideosChannel=function(e,t,r){var n=this;r=r||function(){},n.Ia.loadRelatedVideosChannel({count:t.count||12,start:t.start||0,region:n.l.baseConfig.region,site:n.l.baseConfig.site,lang:n.l.baseConfig.lang,expn:n.l.baseConfig.experienceName,expb:n.l.baseConfig.experienceBucket,videoUuid:t.videoUuid,playlistId:t.playlistId||"",playlistAlias:t.playlistAlias||""},function(e,t){if(e)return void r(e);var i;try{if(i=t.channel.result[0].videos,c.isNullOrUndefined(i))return void r(null);i.forEach(function(e){e.credits&&!e.credits.mainArtists&&delete e.credits})}catch(e){return void r(e)}var a=[],o=n.l.mediaStore.fillFromSapi(i,n.l.rendererTypes,n.l.capabilities,a);n.updateMetadata(function(e){e?r(e):r(null,o)})})},n.prototype.destroy=function(){var e=this;e.Ka(),e.Ia.cancelAll()}},{"../../lib":"/lib/index.js","../../lib/logger":"/lib/logger.js","./error":12,"./event":"/nextgen/src/event.js","./media-store":18,"./navigator-info":26,"./sapi":45,"./util":"/nextgen/src/util.js","user-agent":233}],"/nextgen/src/stream.js":[function(e,t,r){"use strict";function n(e,t){return t.some(function(t){return e===t})}function i(e,t){var r=!1;return t.forEach(function(t){e.indexOf(t)>-1&&(r=!0)}),r}var a=function(e,t,r){var n=null;return e&&e.forEach(function(e){n?e[r]<=t&&(n=e):n=e}),n};r.findAcceptedStreams=function(e,t){return e.filter(function(e){return n(e.format,t.acceptedFormats)&&i(e.Qa(),t.acceptedProtocols)})},r.findStreamByProperty=function(e,t,n,i){return e=r.findAcceptedStreams(e,i).sort(function(e,r){return e[t]-r[t]}),"resolution"===t&&(t="height"),a(e,n,t)},r.filterStreamByResolution=function(e,t,r){return e.filter(function(e){var n=e&&e.height;if(n){if(t&&n<t)return!1;if(r&&n>r)return!1}return!0})},r.isHlsLive=function(e){return e.url.match(/\.m3u8/)&&e.live||!1},r.BITRATE="bitrate",r.RESOLUTION="resolution"},{}],"/nextgen/src/strings.js":[function(e,t,r){"use strict";r.i18n={MENU:"Menu",ELAPSED_TIME:"elapsed time",REMAINING_TIME:"remaining time",NUM_SECONDS:"{num-seconds} seconds",NUM_SECOND:"{num-seconds} second",EMBED:"Embed",NOW_PLAYING:"Now Playing",WATCHED:"watched",LIVE:"Live",PLAY_VIDEO:"Play Video",BACK:"Back",CONTENT_RESTRICTED:"Content Restricted",AGE_GATE_DESC:"This content is intended for mature audiences. Viewer discretion advised.",SIGN_IN_TO_VIEW_ACTION:"Sign-in to view",CONTINUE_ACTION:"Continue",AGE_GATE_BDAY_DESC:"This content is intended for mature audiences. Please enter your date of birth below to continue.",SUBMIT_ACTION:"Submit",AGE_GATE_NOT_ALLOWED_DESC:"Sorry. This content is intended for mature audiences.",MATURE:"Mature",SETTINGS:"Settings",VIDEO_QUALITY:"Video Quality",QUALITY:"QUALITY",AUTO:"Auto",LOW:"Low",MEDIUM:"Medium",HIGH:"High (HD)",LOGIN_MESSAGE:"Please sign in to use this feature.",EMBED_NOT_ALLOWED:"This video cannot be embedded due to provider license restrictions.",TOP:"Top",BOTTOM:"Bottom",ON:"On",OFF:"Off",CC_PREVIEW:"Bottom",CC_PREVIEW_MESSAGE:"Captions will look like this",BACKGROUND:"background",EFFECTS:"effects",RAISED:"raised",NO_ITEM_AVAILABLE:"No item available",CC:"Closed Captions",LANGUAGE:"Language",POSITION:"Position",ERR_ANDROID_LIVE_CHROME_REQUIRED:'This video requires Android 4.0 or above and the latest version of the Google Chrome browser.<br>You can get the latest version of Chrome from the <a href="https://play.google.com/store/apps/details?id=com.android.chrome">Google Play store</a>.',ERR_LIVE_PLAYBACK_COMPLETE:"This live event has ended.",ERR_NETWORK_ISSUE:"Videos cannot play due to a network issue. Please check your Internet connection and try again.",ERR_DEVICE:"Due to license restrictions, this video cannot be viewed on this device.",ERR_DRM_BAD_LICENSE_FILE:"The video license file must be reset to watch this video. See the <a href='http://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager08.html'> Flash Settings Manager support</a> page for details.",ERR_DRM_INCOGNITO_MODE:"This video cannot be played in incognito or private browsing mode. Play it in a regular browser tab instead.",ERR_DRM_RESTRICTED:"Please download the Yahoo! <a href='https://yho.com/5xx'>Screen App</a> to watch this video.",ERR_EMBED:"Due to license restrictions, this video can only be viewed on Yahoo.",ERR_FLASH_IS_BLOCKED:"This video requires Flash. Verify Flash is not disabled or blocked, then <a href='javascript:window.location.reload();'>reload</a> the page.",ERR_COOKIE_DISABLED:"This video cannot be played due to a browser settings issue. Enable third party cookies in your browser, then <a href='javascript:window.location.reload();'>reload</a> the page.",ERR_FLASH_LATEST_DOWNLOAD:"The latest version of Adobe Flash is required to play this video. <a class='yvp-error-flash-download-wrapper' href='http://get.adobe.com/flashplayer/'>Download the free Flash player here.</a>",ERR_GEO:"Unfortunately, this video is not available in your region.",ERR_BLACKOUT:"Due to local blackout restrictions, this live event cannot be viewed in your area.",ERR_GEO_REQUIRED:"Geo position is required to watch this video.",ERR_RESTRICTED_NETWORK_TYPE:"Due to rights restrictions, this live stream is only available on cellular data. Turn off wifi to watch.",ERR_TECH_DIFFICULTIES:"If this error is occurring repeatedly, we may be experiencing technical difficulties. We apologize for the inconvenience. <a class='yvp-browser-refresh' href='javascript:window.location.reload();'>Refresh Browser</a>",ERR_UNAUTHORIZED:"You must be a paid subscriber to view this video.",ERR_UNAVAILABLE:"Unfortunately, this video is no longer available.",ERR_MISSING_OR_DAMAGED:"Unfortunately, this video is missing or damaged and cannot be played.",ERR_DRM_CHROME_SETTING:"You must adjust your Chrome browser settings to watch this secure video. Open chrome://settings/content in Chrome browser, then check 'Allow identifiers for protected content' checkbox.",ERR_BROWSER_UNSUPPORTED:"This browser is unsupported. To view this video, try another browser.",ERR_BROWSER_UNSUPPORTED_SKIP_IN_10:"This browser is unsupported. To view this video, try another browser. In few seconds, we will go to the next video.",ERR_GENERAL_ERROR:"Unfortunately, an error occurred. To try again, <a href='javascript:window.location.reload();'>refresh the browser</a>.",ERR_LIVE_IOS_PLAYBACK:"Unfortunately, an error occurred. To try again, either <a href='javascript:window.location.reload();'>refresh</a> the browser or download the <a class='yvp-browser-refresh' href='https://mobile.yahoo.com/sports'>Yahoo Sports app</a>",E_EME_MISSING:"This video cannot be viewed in this web browser. Try another browser.",E_CONFIG:"This video cannot be viewed in this web browser. Enable playback for protected content in settings, or try another browser.",ERR_IE_LIVE_NOT_AVAILABLE:"This live event cannot be viewed with Internet Explorer.To watch the event, use a <a href='https://www.google.com/chrome'>Chrome</a> or  or <a href='https://www.mozilla.org/firefox'>Firefox</a> web browser",ERR_TITLE_CANNOT_PLAY_VIDEO:"Cannot Play Video",ERR_TITLE_CANNOT_PLAY_360_VIDEO:"Cannot Play 360 Video",ERR_TITLE_SOMETHING_WENT_WRONG:"Something Went Wrong",ERR_TITLE_VIDEO_NOT_AVAILABLE:"Video Not Available",ERR_TITLE_LOCATION_REQUIRED:"You must turn on device location to watch this video",CHROMECAST:"Chromecast",DISCONNECT:"Disconnect",CAST_PLAYING_RECEIVER:"Playing on {device-name}",AIRPLAY:"Airplay",PAUSE_VIDEO:"Pause Video",GO_TO_FULLSCREEN:"Go to full screen",GO_TO_NORMAL_SCREEN:"Go to normal screen",UNMUTE:"Unmute",MUTE:"Mute",SEEK_SLIDER:"Seek slider",UP_NEXT:"Up next",FULLSCREEN_SPACE:"Full Screen",PRESETS:"Presets",CC_SETTINGS:"Closed Caption Settings",CC_TYPE_SIZE:"Type Size",SUBMIT_FEEDBACK:"Submit Feedback",ADV_SHORT:"Ad:",TEXT:"Text",STYLE_OPTIONS:"Style Options",PLAIN:"Plain",SHADOW:"Shadow",LOWERED:"Lowered",OUTLINE:"Outline",CAPTIONS_ON:"Captions On",CAPTIONS_OFF:"Captions Off",CAPTIONS_AVAILABLE:"Captions Available",MULTI_AUDIO:"Select Audio Language",CAPTIONS_NOT_AVAILABLE:"Captions Not Available",EXIT_FULLSCREEN:"Exit Full Screen",MORE_MARKERS:"+{count_markers} more"}},{}],"/nextgen/src/tap.js":[function(e,t,r){"use strict";function n(e,t,r){var n=this;e=i.isString(e)?document.getElementById(e):e,n.element=e,n.moved=!1,n.mouseDown=!1,i.isFunction(t)?(n.onTap=t,n.shouldPropagate=!!i.isBoolean(r)&&r):(n.onTap=function(){},n.shouldPropagate=!!i.isBoolean(t)&&t),e.addEventListener("tap",n.onTap,!1),a.forEach(function(t){e.addEventListener(t,n,!1)})}t.exports=n;var i=e("../../lib"),a=["touchstart","touchmove","touchend","touchcancel","mousedown","mouseup"];n.isTouchDevice=!1,n.prototype.Ra=function(e){var t=this,r="touchstart"===e.type;if(r){n.isTouchDevice=!0;var i=e.touches[0]}t.mouseDown=!0,t.startX=r?i.clientX:e.clientX,t.startY=r?i.clientY:e.clientY,t.lastPageX=r?i.pageX:e.pageX,t.lastPageY=r?i.pageY:e.pageY,t.moved=!1},n.prototype.Sa=function(e){var t=this,r=e.touches[0];t.lastPageX=r.pageX,t.lastPageY=r.pageY,(Math.abs(r.clientX-t.startX)>10||Math.abs(r.clientY-t.startY)>10)&&(t.moved=!0)},n.prototype.Ta=function(e){var t,r=this;!r.moved&&r.mouseDown&&(r.mouseDown=!1,void 0!==document.CustomEvent?t=new document.CustomEvent("tap",{bubbles:!0,cancelable:!0}):(t=document.createEvent("Event"),t.initEvent("tap",!0,!0)),t.pageX=e.pageX||r.lastPageX,t.pageY=e.pageY||r.lastPageY,t.eventSource=e.srcElement,t.eventTarget=e.target,e.handled&&!r.shouldPropagate||r.element.dispatchEvent(t),e.handled=!0)},n.prototype.Ua=function(){var e=this;e.moved=!1},n.prototype.destroy=function(){var e=this,t=e.element;t&&(t.removeEventListener("tap",e.onTap,!1),a.forEach(function(r){t.removeEventListener(r,e,!1)}),e.element=null)},n.prototype.handleEvent=function(e){var t=this;switch(e.type){case"mousedown":if(n.isTouchDevice)return;case"touchstart":t.Ra(e);break;case"touchmove":t.Sa(e);break;case"mouseup":if(n.isTouchDevice)return;case"touchend":t.Ta(e);break;case"touchcancel":t.Ua(e)}}},{"../../lib":"/lib/index.js"}],"/nextgen/src/util.js":[function(e,t,r){"use strict";function n(e,t,r){var n,i=e+t+"=",a=r.indexOf(i);if(a!==-1){var o=r.substring(a+i.length,r.length),s=o.indexOf("&");n=s!==-1?o.substring(0,s):o}return n}function i(e){return s.isString(e)?e:s.isBoolean(e)?e.toString():s.isNumber(e)&&isFinite(e)?e.toString():""}function a(e,t){var n,i={"www.yahoo.com":!0,"news.yahoo.com":!0,"sports.yahoo.com":!0,"finance.yahoo.com":!0,"answers.yahoo.com":!0,"www.tumblr.com":!0,"beta.finance.yahoo.com":!0,"au.yahoo.com":!0,"be.yahoo.com":!0,"fr-be.yahoo.com":!0,"br.yahoo.com":!0,"ca.yahoo.com":!0,"de.yahoo.com":!0,"espanol.yahoo.com":!0,"es.yahoo.com":!0,"fr.yahoo.com":!0,"gr.yahoo.com":!0,"hk.yahoo.com":!0,"id.yahoo.com":!0,"ie.yahoo.com":!0,"in.yahoo.com":!0,"it.yahoo.com":!0,"my.yahoo.com":!0,"nz.yahoo.com":!0,"ro.yahoo.com":!0,"se.yahoo.com":!0,"sg.yahoo.com":!0,"tw.yahoo.com":!0,"uk.yahoo.com":!0,"us.yahoo.com":!0,"ve.yahoo.com":!0,"vn.yahoo.com":!0,"maktoob.yahoo.com":!0,"en-maktoob.yahoo.com":!0,"za.yahoo.com":!0,"qc.yahoo.com":!0,"att.yahoo.com":!0,"espanol.att.yahoo.com":!0,"frontier.yahoo.com":!0,"verizon.yahoo.com":!0,"ca.rogers.yahoo.com":!0,"fr-ca.rogers.yahoo.com":!0,"tatadocomo.yahoo.com":!0,"tikona.yahoo.com":!0,"ideanetsetter.yahoo.com":!0,"mtsindia.yahoo.com":!0,"smartfren.yahoo.com":!0,"tournament.fantasysports.yahoo.com":!0,"baseball.fantasysports.yahoo.com":!0,"football.fantasysports.yahoo.com":!0,"hockey.fantasysports.yahoo.com":!0,"basketball.fantasysports.yahoo.com":!0,"uk.news.yahoo.com":!0,"uk.sports.yahoo.com":!0,"fr.news.yahoo.com":!0,"fr.sports.yahoo.com":!0,"de.nachrichten.yahoo.com":!0,"de.sports.yahoo.com":!0,"it.notizie.yahoo.com":!0,"uk.style.yahoo.com":!0,"de.style.yahoo.com":!0,"fr.style.yahoo.com":!0,"es.vida-estilo.yahoo.com":!0,"it.style.yahoo.com":!0,"uk.movies.yahoo.com":!0,"de.kino.yahoo.com":!0,"m6info.yahoo.com":!0,"es.noticias.yahoo.com":!0},a=/.*mg\d*\.mail\.yahoo\.com$/,s=r.getWindow(),l=s.location.protocol,c=s.location.hostname,u="https:"===l?r.assetDomainHttps:r.assetDomainHttp,p=u+"/rx/builds/"+e+"/assets/"+t;return o.chrome&&(s.parent!==s&&(n=r.parseDomain(s.document.referrer),n&&(c=n)),i[c]?p=l+"//"+c+"/sy/rx/builds/"+e+"/assets/"+t:a.test(c)&&(p=l+"//"+c+"/lyimg/videoinmail/"+e+"/assets/"+t)),p}var o=e("user-agent").userAgent,s=e("../../lib"),l=(e("../../lib/logger"),e("xhr")),c=e("./error"),u=e("./renderers/type"),p=e("./metrics/metrics-constants"),d=e("./constants"),f=!1;r.assetDomainHttp="http://l.yimg.com",r.assetDomainHttps="https://s.yimg.com",r.extractValueFromUrl=function(e,t){var r=n("?",e,t);return r||(r=n("&",e,t)),r},r.setSingleton=function(e,t){window.YAHOO=window.YAHOO||{},window.YAHOO.VideoPlatform=window.YAHOO.VideoPlatform||{},window.YAHOO.VideoPlatform[e]=t,window.YUI&&!f&&(f=!0,window.YUI.add("videoplayer",function(e){Object.keys(window.YAHOO.VideoPlatform).forEach(function(t){var r=window.YAHOO.VideoPlatform[t];e.namespace("VideoPlatform")[t]=r})}))},r.getSingleton=function(e){return window.YAHOO&&window.YAHOO.VideoPlatform&&window.YAHOO.VideoPlatform[e]?window.YAHOO.VideoPlatform[e]:null},r.createErr=function(e,t,r,n,i,a,s){return new c.Error(e,r,n,{playbackState:t,msg:i,debugMsg:a,prefetch:s},o)},r.extend=function(e){s.isObject(e)||(e={});var t=Array.prototype.slice.call(arguments,1);return t.forEach(function(t){if(t)for(var r in t)e[r]=t[r]}),e},r.deepMerge=function(e,t){var r=JSON.parse(JSON.stringify(e));if(t&&Object.keys(t).length){var n=[];for(var i in t)if(t.hasOwnProperty(i)){var a={key:i,dest:e,src:t};n.push(a)}for(;n.length;){var o=n.shift(),s=o.dest,l=o.src,c=o.key,u=l[c];if("object"==typeof u){if(s[c]||(s[c]={}),typeof s[c]!=typeof l[c])return void(e=r);var p=s[c],d=l[c];for(var f in u)if(u.hasOwnProperty(f)){var v={key:f,dest:p,src:d};n.push(v)}}else s[c]=l[c]}}},r.once=function(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments),t.value)};return t.called=!1,t},r.noop=function(){},r.stringToArray16=function(e){for(var t=new ArrayBuffer(2*e.length),r=new Uint16Array(t),n=0,i=e.length;n<i;n++)r[n]=e.charCodeAt(n);return r},r.array16ToString=function(e){var t=new Uint16Array(e.buffer);return String.fromCharCode.apply(null,t)},r.base64DecodeUint8Array=function(e){for(var t=window.atob(e),r=t.length,n=new Uint8Array(new ArrayBuffer(r)),i=0;i<r;i++)n[i]=t.charCodeAt(i);return n},r.base64EncodeUint8Array=function(e){for(var t,r,n,i,a,o,s,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="",u=0;u<e.length;)t=e[u++],r=u<e.length?e[u++]:Number.NaN,n=u<e.length?e[u++]:Number.NaN,i=t>>2,a=(3&t)<<4|r>>4,o=(15&r)<<2|n>>6,s=63&n,isNaN(r)?o=s=64:isNaN(n)&&(s=64),c+=l.charAt(i)+l.charAt(a)+l.charAt(o)+l.charAt(s);return c},r.querystring=function(e,t,r,n){return t=t||"&",r=r||"=",n=n||encodeURIComponent,s.isObject(e)&&(e=[e]),e.map(function(e){return Object.keys(e).map(function(a){var o=n(i(a));return null===e[a]?o:(o+=r,s.isArray(e[a])?e[a].map(function(e){return o+n(i(e))}).join(t):o+n(i(e[a])))}).join(t)}).join(t)},r.getCookie=function(e,t){t=t||{},e+="=";for(var r=document.cookie.split(/;\s*/),n=r.length-1;n>=0;n--)if(!r[n].indexOf(e)){var i=r[n].replace(e,"");return t.raw?i:decodeURIComponent(i)}},r.extractID3Data=function(e){if(!e||!e.length)return null;for(var t=0;t<e.length&&!(e[t]>31);t++);for(var r=e.length-1;r>=0&&!(e[r]<=31);r--);return r=r<0?e.length:r,String.fromCharCode.apply(null,e.subarray(t,r))},r.setCookie=function(e,t,r){r=r||{},r.raw||(t=encodeURIComponent(t));var n=e+"="+t,i=r.expires?r.expires.toGMTString():"Thu, 01-Jan-1970 00:00:01 GMT";r.session||(n+="; expires="+i);var a=r.path;a&&(n+="; path="+a);var o=r.domain;o&&(n+="; domain="+o),document.cookie=n},r.generateGuid=function(){return Math.floor(4294967295*Math.random()).toString()},r.sanitizeAndUnescape=function(e){if(s.isNullOrUndefined(e))return"";var t=e.toString().replace(/<\/?[^>]+>/g,""),r=document.createElement("div");return r.innerHTML=t,r.textContent},r.getHostUrl=function(){var e=document.referrer;try{window.top.location.href&&(e=window.top.location.href)}catch(e){}return e},r.generateLoginUrl=function(e,t,n){var i="https://login.yahoo.com",a={".src":"vp",".intl":e,".lang":t,".done":n||r.getHostUrl()};return r.fillUrl(i,a)},r.fillUrl=function(e,t){return e+"?"+r.querystring(t)},r.isOffNetwork=function(e){e=e||r.getHostUrl();var t=r.parseDomain(e),n=["yahoo.com","yahoo.co.jp","yahoo.net","yahoo.fr","yimg.com","rivals.com","tumblr.com","txmblr.com","flickr.com","maktoob.com","grindtv.com","thepostgame.com","nfl.com","nfljapan.com","movie.yahoo-leisure.hk","mmovie.yahoo-leisure.hk","beta.cricket.yahoo.sportz.io","cricket.yahoo.net","aol.com","ads.pictela.net","ads-us.pictela.net","cdn.cmp.advertising.com","test.player.vdms.io","publishing.oath.com","dpk0sergzlt6z.cloudfront.net","verizon.com","localhost"],i=["cdn.ampproject.org","amp.cloudflare.com","bing-amp.com"],a=[];return i.forEach(function(e){n.forEach(function(t){if("localhost"!==t){var r=t.replace(/-/g,"--").replace(/\./g,"-");a.push(r+"."+e)}})}),a=a.concat(n),!!e&&(!o.samsung&&(!t||!a.some(function(e){return t.indexOf(e,t.length-e.length)!==-1})))},r.isIFrame=function(){try{return window.top!==window.self}catch(e){return!0}},r.render=function(e,t,r){var n=document.createElement("div");return n.innerHTML=e.render(t,r),n.children[0]},r.createVideoNode=function(){var e=document.createElement("div");return o.tv?e.innerHTML='<video preload="meta" crossorigin="anonymous"><source/></video>':e.innerHTML="<video preload></video>",e.children[0]},r.inherits=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})},r.getTextFromNode=function(e){return e?e.textContent.trim():null},r.findClosest=function(e,t,r){r=r||document;for(var n=e.matches||e.msMatchesSelector||e.webkitMatchesSelector;e&&e!==r;e=e.parentNode)if(n.call(e,t))return e;return null},r.parseDomain=function(e){var t=/^https?:\/\/([A-Za-z0-9\.\-]*)(?:$|\/|:)/.exec(e);return t?t[1]:null},r.parseRootHost=function(e){var t=r.parseDomain(e),n=null;if(t){var i=t.split(".");n=i.length>=2?i[i.length-2]:t}return n},r.localStorage={get:function(e){var t=null;try{t=JSON.parse(localStorage.getItem(e))}catch(e){t=null}return t},put:function(e,t){if(!e||!t)return!1;try{return t=JSON.stringify(t),localStorage.setItem(e,t),!0}catch(e){return!1}},remove:function(e){try{localStorage.removeItem(e)}catch(e){return}},getAllKeys:function(){try{for(var e=[],t=0,r=localStorage.length;t<r;++t)e.push(localStorage.key(t));return e}catch(t){return e}}},r.sendImageBeacon=function(e){function t(){n.onload=n.onabort=n.onerror=null,n=null}e=r.fixProtocol(e);var n=new Image;n.onload=n.onabort=n.onerror=t,n.src=e},r.sendIframeBeacon=function(e){var t=this;e=r.fixProtocol(e);var n,i=Math.random(),a="vp-beacons",o=document.querySelector("#"+a),s=a+"-"+i;return o||(o=t.createBeaconsIframe(document,a),document.body.appendChild(o)),n=t.createBeaconsIframe(o.contentDocument,s),n.src=e,"complete"===o.contentDocument.readyState?o.contentDocument.body.appendChild(n):o.contentDocument.body.onload=function(){o.contentDocument.body.appendChild(n)},!0},r.sendUnloadBeacon=function(e){e=r.fixProtocol(e),navigator&&navigator.sendBeacon?navigator.sendBeacon(e,null):r.sendImageBeacon(e)},r.createBeaconsIframe=function(e,t){var r=e.createElement("iframe");return r.frameBorder=0,r.width=0,r.height=0,r.marginwidth=0,r.marginheight=0,r.hspace=0,r.vspace=0,r.frameborder=0,r.scrolling="no",r.id=t,r.style.display="none",r.title="",r},r.getWindow=function(){return window},r.getFullscreenElement=function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitCurrentFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement},r.getAssetUrl=function(e,t,n){var i,o=(r.getWindow(),r.assetDomainHttps);return i=e?"/assets/"+n:"player.swf"===n||"simpleplayer.swf"===n?a(t,n):o+"/rx/builds/"+t+"/assets/"+n},r.getCssBuildUrl=function(e,t,n){var i,a="yvp-video-player",o=a+".css",s=(r.getWindow(),r.assetDomainHttps);return n&&(o=a+"-"+n+".css"),i=e?"/"+o:s+"/rx/builds/"+t+"/"+o},r.getScriptUrl=function(e,t,n){var i,a="min";a||(a="min");var o="-"+a+".js";if(e)i="/"+n+o;else{var s="https:"===document.location.protocol?r.assetDomainHttps:r.assetDomainHttp;i=s+"/rx/builds/"+t+"/"+n+o}return i},r.classList=function(e){function t(t){return function(r){var n=e&&s.isString(e.className)?e.className.split(/\s+/):[],i=n.indexOf(r),a=t(n,i,r);return e&&s.isString(e.className)&&(e.className=n.join(" ")),a}}if(e&&e.classList)return e.classList;var r={add:t(function(e,t,r){~t||e.push(r)}),remove:t(function(e,t){~t&&e.splice(t,1)}),toggle:t(function(e,t,r){~t?e.splice(t,1):e.push(r)}),contains:t(function(e,t){return!!~t})};return r},r.forceDOMRedrawOnElement=function(e){e&&e.offsetHeight},r.uniquifyArray=function(e){return e.filter(function(e,t,r){return r.indexOf(e)===t})},r.isInternalUser=function(){var e=r.getSingleton("PlayerHosting");return e&&"stage"===e.env},r.strSubstitute=function(e,t){return e.replace(/\{([^\{\}]*)\}/g,function(e,r){var n="function"==typeof t?t(r):t[r];return s.isNullOrUndefined(n)?e:n})},r.showUserAuthPage=function(e){var t="https://login.yahoo.com/?.src=vp&.intl={region}&.lang={language}&.done={referrer}",n=r.strSubstitute(t,{region:e.baseConfig.region,language:e.baseConfig.lang,referrer:encodeURI(r.getHostUrl())});r.redirect(n)},r.lazyLoad=function(e,t,r,n){function i(t){a.loadedScripts[e]&&a.loadedScripts[e].forEach(function(e){e(t)}),a.loadComplete[e]=t,clearTimeout(l)}var a=this,o=document.createElement("script");if(s.isNullOrUndefined(a.loadedScripts)&&(a.loadedScripts={},a.loadComplete={}),s.isNullOrUndefined(a.loadedScripts[e])&&(a.loadedScripts[e]=[],a.loadComplete[e]=!1),a.loadedScripts&&a.loadedScripts.hasOwnProperty(e)){if(a.loadComplete[e]!==!1)return r(a.loadComplete[e]);if(a.loadedScripts[e].push(r),a.loadedScripts[e].length>1)return}o.async=!0,o.src=e;var l=window.setTimeout(function(){a.loadedScripts[e]&&a.loadedScripts[e].forEach(function(e){e("Script load timeout")}),a.loadComplete[e]="Script load timeout"},t);return o.onload=function(){i(null)},o.onerror=function(){i("Failed to load script")},n&&i("Cancelling script execution"),document.body.appendChild(o),function(){i("Cancelling script execution")}},r.loadCssAsset=function(e,t,r,n){var i=document.createElement("link");i.setAttribute("rel","stylesheet"),i.setAttribute("type","text/css"),i.setAttribute("id",e),i.setAttribute("href",t),r&&i.addEventListener("load",r),n&&i.addEventListener("error",n),document.head.appendChild(i)},r.insertCssIntoHead=function(e){var t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e)),t.appendChild(r)},r.XHR_ERROR="XHR error",r.XHR_TIMEOUT="XHR request timed out",r.ajax=function(e,t){e=r.fixProtocol(e);var n=2,i=t.context,a=t.responseTypeJson,c=t.withCookie,u=t.timeout,p=r.once(t.successHandler),d=r.once(t.failureHandler),f=(s.isNullOrUndefined(t.earlyRetries)?n:t.earlyRetries,!1),v=null,m={url:e,cors:o.ie&&o.ie<10||c,withCredentials:c,timeout:u||3e3,body:t.body,method:t.method,headers:t.headers,responseType:t.responseType,beforeSend:t.beforeSend};if(i&&p&&d){var y=(new Date).getTime(),h=new l(m,function(n,o,l){if(!f)if(t.collectPerfData&&(v={},s.isFunction(h.getResponseHeader)&&(v.resp_len=h.getResponseHeader("Content-Length")||"na"),window.performance&&window.performance.getEntriesByName&&(v.resourceTiming=window.performance.getEntriesByName(location.protocol+e).pop(),v.resourceTimingEntries=window.performance.getEntries()),v.http_code=o.status),n){o.timeDiff=(new Date).getTime()-y;var c=null;s.isFunction(h.getResponseHeader)&&(c=h.getResponseHeader("Access-Control-Allow-Origin"));var m=window.location.protocol+"//"+window.location.host;if(c&&c!==m)d.call(i,new Error(r.XHR_ERROR),"default","cors");else{var E=o.timeDiff>=u?r.XHR_TIMEOUT:r.XHR_ERROR;d.call(i,new Error(E),o.previousState,o.status,o.timeDiff,v)}}else p.call(i,a?JSON.parse(l):l,!1,v,h)});t.beforeSend&&t.beforeSend(h),h.previousState=h.readyState;var E=h.onreadystatechange;h.onreadystatechange=function(){4===h.readyState?E.call(h):h.previousState=h.readyState}}return function(){f=!0}},r.JSONP_ERROR="jsonp error",r.JSONP_TIMED_OUT="jsonp request timed out",r.jsonp=function(e,t){function n(e){}function i(e){s.removeChild(u),e?delete window[o]:window[o]=function(){},clearTimeout(p)}function a(){n("cancelled"),window[o]&&i(!1)}e=r.fixProtocol(e);var o,s=document.getElementsByTagName("head")[0],l=r.once(t.jsonpHandler);do o="_callback"+Math.round(1e7*Math.random());while(void 0!==window[o]);var c=e+(e.indexOf("?")+1?"&":"?");c+="callback="+o;var u=document.createElement("script");u.type="text/javascript",u.src=c;var p=window.setTimeout(function(){n("timeout"),i(!1),l(new Error(r.JSONP_TIMED_OUT),null,r.fetchJsonpPerfData(e,o,t.collectPerfData))},2e4);return u.onerror=function(){i(!0),l(new Error(r.JSONP_ERROR),null,r.fetchJsonpPerfData(e,o,t.collectPerfData))},window[o]=function(n){i(!0),l(null,n,r.fetchJsonpPerfData(e,o,t.collectPerfData,n))},s.appendChild(u),a},r.fetchJsonpPerfData=function(e,t,r,n){var i={};if(r){if(i.resp_len="na",window.performance&&window.performance.getEntriesByName,n){var a=location.protocol+e+"&callback="+t;i.resourceTiming=window.performance.getEntriesByName(a).pop(),i.resourceTimingEntries=window.performance.getEntries()}n&&(i.http_code=n.status||"na",i.resp_len=n.length||"na")}return i},r.isFlashInstalled=function(){if(void 0!==r.isFlashInstalledMem)return r.isFlashInstalledMem;var e=null;if(o.ie)try{var t=new window.ActiveXObject("ShockwaveFlash.ShockwaveFlash");e=t.GetVariable("$version").replace(/[A-Za-z\s]+/g,"").split(",")}catch(e){}else{var n=navigator.mimeTypes["application/x-shockwave-flash"];if(n){var i=n.enabledPlugin;i&&(e=i.description.replace(/\s[rd]/g,".").replace(/[A-Za-z\s]+/g,"").split("."))}}return e?r.isFlashInstalledMem="0"!==e[0]:r.isFlashInstalledMem=!1,r.isFlashInstalledMem},r.isDrmSupported=function(){return!(!o.safari||!window.WebKitMediaKeys)||!(!navigator||!navigator.requestMediaKeySystemAccess)},r.getMediaCDNName=function(e,t,n){var i,a,o,s,l="unknown";if(t&&t.length>0){if(a=t[0],a.cdn&&a.cdn.length>0)return a.cdn;a.url?i=a.url:(o=a.host,s=a.path,i=o+s),!e.isLive()&&a.hlsInfo&&(i=a.hlsInfo.ts_url)}else n&&n.length>0&&(i=n);return i&&i.length>0&&(l=i.indexOf("akamai")>-1||0===i.indexOf("rtmp")&&e.isLive()?"akamai":i.indexOf("yahoo.com")>-1||i.indexOf("yimg.com")>-1?"atlas":i.indexOf("llnwd.net")>-1?"limelight":i.indexOf("fastly.com")>-1?"fastly":r.parseRootHost(i)),l},r.redirect=function(e,t){try{t?window.top.location.replace(e):window.top.location.assign(e)}catch(e){typeof e===window.DOMException}},r.showHide=function(e,t){e.style.display=t?"block":"none"},r.formatTime=function(e){var t=Math.floor(e/3600),r=Math.floor((e-3600*t)/60),n=Math.floor(e-3600*t-60*r),i="";return n<10&&(n="0"+n),t>0?(r<10&&(r="0"+r),t+":"+r+":"+n):s.isNumber(r)?r+":"+n:i},r.getOffsetTopFromEl=function(e,t){for(var n=0;e;)isNaN(e.offsetTop)||(n+=e.offsetTop),
e=e.offsetParent,t&&r.classList(e).contains(t)&&(e=null);return n},r.getOffsetTopFromDocument=function(e){var t=document.body,r=document.documentElement,n=0,i=window.pageYOffset||r.scrollTop||t.scrollTop,a=r.clientTop||t.clientTop||0;try{var o=e.getBoundingClientRect();n=o?o.top:0}catch(e){}return Math.round(n+i-a)},r.setupMouseWheelListener=function(e){var t=function(t){var r=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail)),n=r>0,i=e.scrollHeight>e.offsetHeight,a=n&&e.scrollTop<1,o=!n&&e.scrollTop>=e.scrollHeight-e.offsetHeight;i&&(a||o)&&t.preventDefault()};return e&&(e.addEventListener("mousewheel",t),e.addEventListener("DOMMouseScroll",t)),t},r.destroyMouseWheelListener=function(e,t){e&&s.isFunction(t)&&(e.removeEventListener("mousewheel",t),e.removeEventListener("DOMMouseScroll",t))},r.bucketize=function(){return Math.floor(100*Math.random())},r.cssHexToRgb=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},r.getElementViewability=function(e){try{var t=e.getBoundingClientRect();if(!t)return 0;var r,n=window.innerHeight;return r=t.top>=0?t.bottom>n?n-t.top>0?n-t.top:0:t.height:t.bottom>n?n:t.bottom<0?0:t.bottom,Math.round(r/t.height*100)}catch(e){return 0}},r.noPropagation=function(e){s.isFunction(e.stopPropagation)&&e.stopPropagation()},r.getHostname=function(e){var t=document.createElement("a");return t.href=e,t.hostname},r.getFormat=function(e){var t=["mpd","mp4","m3u8","webm","flv","f4m","mp4b","m3u8_playlist","m3u8_master"],r=null;return t.forEach(function(t){e.indexOf(t)!==-1&&(r=t)}),r},r.mapStreamsToQualities=function(e){var t=1,r=2,n=1500,i=2500,a=null,o=null,s=null;if(e.bitrates){for(var l=[],c=0;c<e.bitrates[c];c++)l.push({bitrate:e.bitrates[c],height:e.heights[c]});e=l}for(c=0;c<e.length;c++){var u,p=e[c],d=t*p.bitrate+r*p.height;d<=n?a?(u=a.bitrate+2*a.height,d>u&&(a=p)):a=p:d<=i?o?(u=o.bitrate+2*o.height,d>u&&(o=p)):o=p:s?(u=s.bitrate+2*s.height,d>u&&(s=p)):s=p}return{low:a,medium:o,high:s}},r.getUrlStatus=function(e,t){var r=new XMLHttpRequest;r.open("GET",e,!0),r.onreadystatechange=function(){4===r.readyState&&t(r.status)},r.send()},r.isPlayerInBackground=function(){return this.hidden||("undefined"!=typeof document.hidden?this.hidden="hidden":"undefined"!=typeof document.mozHidden?this.hidden="mozHidden":"undefined"!=typeof document.msHidden?this.hidden="msHidden":"undefined"!=typeof document.webkitHidden?this.hidden="webkitHidden":this.hidden="unsupported"),"unsupported"===this.hidden?!document.hasFocus():document[this.hidden]},r.shouldEnableQualitySelector=function(e){var t=[u.HTML5_HLS,u.HTML5_HLS_360,u.FLASH],r=e.playbackState.rendererType,n=e.playlist.getCurrentItem();if(t.indexOf(r)>-1&&n){if(r!==u.FLASH)return n.streams.length>1||n.streamProfiles.length>1;if("hls"===n.streams[0].getType())return!!n.isLive()||n.streams.length>1}return!1},r.replaceStrParam=function(e,t,r){return e.replace(new RegExp(t+"=\\w*"),t+"="+r)},r.isAndroidVersionAbove4=function(){if(o.androidVersion){var e=parseInt(o.androidVersion);return e>=4}return!1},r.isHtmlRenderer=function(e){return e===u.HTML5_HLS||e===u.HTML5_RAW},r.preconnect=function(e,t){if(document&&!document.head.querySelector("#"+e)){var r=document.createElement("link");r.setAttribute("rel","preconnect"),r.setAttribute("id",e),r.setAttribute("href",t);var n=document.getElementsByTagName("head")[0];n&&n.appendChild(r)}},r.fixProtocol=function(e){return o.samsung&&0===e.indexOf("//")?"https:"+e:e},r.resolvePath=function(e,t){if(e&&t)return t.split(".").reduce(function(e,t){return e?e[t]:void 0},e)},r.hasUnwatchedClips=function(e){return e.some(function(e){return"function"==typeof e.isWatched?!e.isWatched():!e.isWatched})},r.isValidRequestAction=function(e){return[null,p.CLICK,p.AUTOPLAY,p.HOVER,p.PLAY,p.PAUSE,p.SCROLL,p.SWIPE,p.BACKGROUND].indexOf(e)>-1},r.isValidRequestType=function(e){return[null,p.CLICK,p.AUTOPLAY,p.API,p.CONTINUOUS].indexOf(e)>-1},r.isThemeSupported=function(e){return d.SUPPORTED_THEMES.indexOf(e)>-1},r.initIframeCmp=function(){if(!window.__cmp){for(var e,t=window;!e;){try{t.frames.__cmpLocator&&(e=t)}catch(e){}if(t===window.top)break;t=t.parent}var r={};window.__cmp=function(t,n,i){if(!e)return void i({msg:"CMP not found"},!1);var a=Math.random()+"",o={__cmpCall:{command:t,parameter:n,callId:a}};r[a]=i,e.postMessage(o,"*")},window.addEventListener("message",function(e){var t="string"==typeof e.data,n=e.data;if(t)try{n=JSON.parse(e.data)}catch(e){}if(n.__cmpReturn){var i=n.__cmpReturn;r[i.callId](i.returnValue,i.success),delete r[i.callId]}},!1)}},r.detectRegexPattern=function(e,t){var r=new RegExp(e),n=r.exec(t);return n&&n[0]?n[0]:null},r.getPageParameterByName=function(e){var t=RegExp("[?&]"+e+"=([^&]*)").exec(window.location.search);return t&&decodeURIComponent(t[1].replace(/\+/g," "))},r.shouldDisable3PMetricSystem=function(){var e=r.getHostUrl(),t=r.parseDomain(e);if("localhost"===e||!e||!t)return!1;var n=t.split("."),i=["tumblr","txmblr"];return n.some(function(e){return i.some(function(t){return e.indexOf(t)>-1})})},r.getPlayerHostingConfig=function(e){var t={},n=r.getSingleton("PlayerHosting"),i=n&&n.ver&&n.ver===e;return i&&(t.bucket=n.bucket,t.env=n.env,t.colo=n.colo,t.config=n.config&&"object"==typeof n.config?n.config:null,t.log=n.req&&n.req.usm&&n.req.usm.config&&n.req.usm.config.log||""),t},r.getBckt=function(e){var t=r.getPlayerHostingConfig(e),n=t.bucket,i=t.env;return!n&&i&&(n=i),n||""}},{"../../lib":"/lib/index.js","../../lib/logger":"/lib/logger.js","./constants":7,"./error":12,"./metrics/metrics-constants":21,"./renderers/type":44,"user-agent":233,xhr:248}],1:[function(e,t,r){"use strict";function n(e){var t=this;t.Va=e,t.Wa=[]}t.exports=n;var i=e("./index");n.prototype.destroy=function(){var e=this;e.flush(!1)},n.prototype.enQueue=function(e,t){var r=this;r.Wa.push({commandName:e,args:t})},n.prototype.flush=function(e){var t=this;i.isNullOrUndefined(e)&&(e=!1);var r=t.Wa;t.Wa=[],e&&r.forEach(function(e){if(t.Va){var r=e.commandName,n=e.args;r.apply(t.Va,n)}})},n.prototype.deQueue=function(e,t){var r=this;if(e){i.isNullOrUndefined(t)&&(t=!1);for(var n=0;n<r.Wa.length;n++){var a=r.Wa[n],o=a.commandName,s=a.args;if(o===e){t&&r.Va&&o.apply(r.Va,s),r.Wa.splice(n,1);break}}}},n.prototype.getLength=function(){var e=this;return e.Wa.length}},{"./index":"/lib/index.js"}],2:[function(e,t,r){"use strict";t.exports=e("user-agent").userAgent},{"user-agent":233}],3:[function(e,t,r){"use strict";function n(e,t,r,n){var i=this,a=r.YVAP,l=r.isLocal();if(!a)return i.Xa=!1,void n.createAdsInfoPanel(null);i.Xa=!0,i.Ya={},i.k=e,i.l=r,i.m=n,i.Za=[],i.$a=[],i._a=!1;var c=i.m.rootElem.querySelector(".yvp-content");c.setAttribute("id","yvp-content-node-"+Math.floor(1e4*Math.random())),t.skipNormalAd=function(){var e=i.l.playbackState.isAdPlaying(),t=e&&i.l.playbackState.ad.type===o.ADTYPES.NORMAL;return!!(i.Xa&&i.bb&&e&&t)&&(i.cancelAd(),i.db(),!0)},t.createAdsInfoPanel=i.m.createAdsInfoPanel,t.updateAdDiagnostics=i.m.updateAdDiagnostics.bind(i.m),a.volume=r.getVolume(),a.mute=r.getMute(),i.m.Ha.add(s.Metrics.YVAP_READY),i.fb=new v({yvap:a,isLocal:l},i.k,c,t,i.m.adsOverlay?i.m.adsOverlay.node:null),i.m.Ha.setEndTime(s.Metrics.YVAP_READY),i.gb=i.l.playback.desiredBitrate,i.Xa&&(i.hb=i.m.initAdsView()),i.k.subscribe(s.ADS_OBJS_UPDATE,i.jb,i),i.k.subscribe(s.ADS_READY,i.kb,i),i.k.subscribe(s.AD_BREAK_TIMELINE,i.lb,i),i.k.subscribe(s.AD_PLAYBACK_STARTED,i.u,i),i.k.subscribe(s.AD_PLAYBACK_ENDED,i.mb,i),i.k.subscribe(s.Ad.PLAYING,i.pb,i),i.k.subscribe(s.Ad.PAUSE,i.qb,i),i.k.subscribe(s.Ad.TIMEUPDATE,i.rb,i),i.k.subscribe(s.Ad.ENDED,i.sb,i),i.k.subscribe(s.Ad.ERROR,i.tb,i),i.k.subscribe(s.Ad.CLICK,i.ub,i),i.k.subscribe(s.CONTROLS_SEEK_END,i.vb,i),i.k.subscribe(s.AD_PLAYBACK_PROGRESS,function(e,t,r){i.Ya[i.bb].playbackProgress=t}),i.k.subscribe(s.BEFORE_INCOMPLETE_EXIT,function(){i.l.playbackState.isAdPlaying()&&(i.l.playbackState.isVpaidAdPlaying()&&(i.l.incompleteExitData.vpaidLatencies=i.fb.getVPAIDLatencies()),i.wb&&(i.l.incompleteExitData.adBreakStats=i.wb()))}),i.k.subscribe(s.AD_VIEW_CLICK,i.xb,i)}function i(e,t){return!d.isNullOrUndefined(a(e,t))}function a(e,t){for(var r=Object.keys(e),n=0;n<r.length;n++){var i=r[n],a=e[i];if(t(a))return i}return null}t.exports=n;var o=e("./yvap/ads-json"),s=e("./event"),l=e("./states"),c=e("./stream"),u=e("user-agent").userAgent,p=e("./media-store"),d=e("../../lib"),f=e("../../lib/logger"),v=e("./yvap/video-ad-plugin"),m=e("./renderers/type"),y=e("./constants"),h=e("./perf");n.prototype.prepare=function(e){var t=this;if(h&&h.startDebugMode(y.PERF.VP_AD_FETCH),t.Xa){t.Ya={},t.yb=e,t.$a=e.progress.adbreaks;try{t.zb=!1,t.fb.beginAdExperience(e.id,e.progress.position)}catch(e){f.error("[yvap] prepare error",e.message||e,e.stack),t.Xa=!1}}h&&h.endDebugMode(y.PERF.VP_AD_FETCH)},n.prototype.Ab=function(){var e=this;if(h&&h.startDebugMode(y.PERF.VP_AD_SETUP_TIMEOUT),h&&h.startDebugMode(y.PERF.VP_AD_WAIT_FOR_AD_READY),!e.zb){var t=e.l.YVAP&&e.l.YVAP.timeout;t?(clearTimeout(e.Bb),e.Bb=setTimeout(function(){h&&h.endDebugMode(y.PERF.VP_AD_SETUP_TIMEOUT),e.Cb()},1e3*t)):(e.zb=!0,e.db())}},n.prototype.Cb=function(){var e=this;e.zb=!0,e.Bb&&(clearTimeout(e.Bb),e.Bb=null,e.db())},n.prototype.maybePlay=function(e,t){var r=this;if(!r.Xa)return void t(!1);if(h&&h.startDebugMode(y.PERF.VP_AD_MAYBE_PLAY),r.Db=t,"start"===e)r.Eb=o.POSITION.bumper,r.Ab();else{if("end"!==e)return void r.Db(!1);r.Eb=o.POSITION.postroll}r.Fb(),r.Gb(),r.Bb||r.db()},n.prototype.Hb=function(e,t){var r,n,i,a=this,s=a.Ya,l=Object.keys(s),c=function(e,t){return e.some(function(e){return t===e})},u=0;if(!s||!e||"object"!=typeof s)return u;"string"==typeof e&&(e=[e]),l=Object.keys(s);for(var p=0;p<l.length;p++)r=l[p],n=s[r].pos,t&&s[r].type===o.ADTYPES.NO_AD||(i=c(e,n),i&&u++);return u},n.prototype.db=function(e){var t=this,r=t.Ib>0;if(h&&h.endDebugMode(y.PERF.VP_AD_MAYBE_PLAY),t.Eb!==o.POSITION.bumper||i(t.Ya,function(e){return e.pos===o.POSITION.bumper})||(t.Eb=o.POSITION.preroll),t.bb=a(t.Ya,function(e){return e.pos===t.Eb}),t.bb){var n=t.Ya[t.bb];n.playbackProgress=0,t.l.playbackState.ad=n,t.hb.reset(n),t.Eb===o.POSITION.midroll?n.type!==o.ADTYPES.NO_AD&&(t.Jb++,t.k.publish(s.UPDATE_AD_COUNT,n,t.Jb,t.Kb)):t.k.publish(s.UPDATE_AD_COUNT,n),t.k.publish(s.AD_PLAYBACK_REQUEST,n.playbackId),t.Lb(n)}else t.l.playback.adPlaybackOnly||t.Db(r,e)},n.prototype.Gb=function(){var e=this;e.bb=null,e.l.playbackState.ad=null,e.Mb=!1},n.prototype.Fb=function(){var e=this;e.Ib=0,e.Nb=0,e.Ob=0,e.Pb=0,e.Qb=0,e.Rb=0,e.Sb=0,e.Tb=[],e.Ub=0,e.Vb="na",e.Wb="na"},n.prototype.Lb=function(e){var t,r=this,n=r.l.adsRendererTypes;if(e.type===o.ADTYPES.VPAID)r.Ib++,t=m.EXTERNAL,h&&h.startDebugMode(y.PERF.VP_AD_VPAID_PREPARE_RENDERER),r.m.prepareNextRenderer({rendererType:t,ad:e},function(t){if(h&&h.endDebugMode(y.PERF.VP_AD_VPAID_PREPARE_RENDERER),t)return r.Xb(),void r.db(t);h&&h.startDebugMode(y.PERF.VP_AD_PREPARE_START);try{r.m.switchToNextRendererAndStartExternal(function(t){r.Yb(e,t.container)})}catch(e){return void r.mb(r.bb,e)}});else if(e.type===o.ADTYPES.NO_AD)r.k.publish(s.Ad.NO_AD,r.bb),r.mb();else{var i,a,u=r.l.adsCapabilities;if(e.streams.length)for(var p=0;p<n.length&&(t=n[p],a=u[t],!(i=c.findStreamByProperty(e.streams,"bitrate",r.gb,a)));p++);i?(r.Ib++,r.Zb=i.bitrate,r.$b=Date.now(),e&&e.adObj&&(e.adObj.mtype=i.format),r.l.setState(l.VIDEO),h&&h.startDebugMode(y.PERF.VP_AD_NORMAL_PREPARE_RENDERER),r.m.prepareNextRenderer({rendererType:t,ad:e},function(n){h&&h.endDebugMode(y.PERF.VP_AD_NORMAL_PREPARE_RENDERER),r.m.preloadNextAdRenderer({bestStream:i,mediaItem:r.yb,rendererType:t,ad:e}),h&&h.startDebugMode(y.PERF.VP_AD_PREPARE_START),r.m.switchAndPlayNextRenderer(),r.l.playback.fullscreen&&r.m.setFullscreen(!0)})):(r.k.publish(s.Ad.NO_PLAYABLE_STREAM,r.bb),r.sb())}},n.prototype.Yb=function(e,t){var r=this,n=r.m.getMainElement(),i=r.l.uiState&&r.l.uiState.videoWidth?r.l.uiState.videoWidth:n.clientWidth,a=r.l.uiState&&r.l.uiState.videoHeight?r.l.uiState.videoHeight:n.clientHeight;!r.l._b||!r.l._b.YVAP||i&&a||(i=r.l._b.YVAP.width,a=r.l._b.YVAP.height),!r.l._b||"sidekicktvbrxd"!==r.l._b.expName||i&&a||(i=r.l.uiState.width,a=r.l.uiState.height),r.l.setState(l.VIDEO),r.l.setLoading(!0),r.m.syncViewState(),r.l.isPaused()||r.m.pause(),r.fb.renderVPAIDAd(e.playbackId,r.gb,i,a,t)},n.prototype.updateYVAPData=function(e){var t=this;if(t.Xa)try{t.fb.updatePlayerData(e)}catch(e){f.error("[yvap] updatePlayerData error",e.message||e,e.stack),t.Xa=!1}},n.prototype.jb=function(e){var t=this;e.forEach(function(e){var r=e.playbackId;if(t.Ya[r]?Object.keys(e).forEach(function(n){t.Ya[r][n]=e[n]}):t.Ya[r]=e,e.streams){var n=e.streams.map(function(e){return new p.Stream(e)});t.Ya[r].streams=n}})},n.prototype.kb=function(){var e=this;e.l.YVAP&&(e.l.YVAP.adsReady=!0),h&&h.endDebugMode(y.PERF.VP_AD_WAIT_FOR_AD_READY),e.Cb()},n.prototype.qb=function(){var e=this;e.l.setPaused(!0),e.k.publish(s.AD_PLAYBACK_PAUSED),e.m.syncViewState()},n.prototype.pb=function(){var e=this;if(e.Mb)e.k.publish(s.AD_PLAYBACK_RESUMED,e.bb);else{e.Mb=!0;var t=Date.now()-e.$b;e.k.publish(s.AD_PLAYBACK_STARTED,e.bb,e.Zb,t)}e.l.setPaused(!1),e.m.syncViewState()},n.prototype.rb=function(e,t,r){var n=this;n.k.publish(s.AD_PLAYBACK_PROGRESS,n.bb,e,t,r)},n.prototype.cancelAd=function(){var e=this;e.Xa&&(e.k.publish(s.Ad.CANCELED,e.bb),e.Xb(),e.m.syncViewState())},n.prototype.bc=function(e){var t=this;if(t.bb){var r=t.Ya[t.bb],n=r.duration-r.playbackProgress,i=[],a=[],o=Object.keys(t.Ya);t.Ub+=n>0?n:0;for(var l=0;l<o.length;l++){var c=o[l],u=t.Ya[c];u.pos===t.Eb&&c!==t.bb&&(i.push(u.adObj.creativeId),a.push(u.playbackId),t.Ub+=u.duration,delete t.Ya[c])}t.fb.skipAd(),t.Ub=Math.round(t.Ub),t.Vb=e||t.Vb,t.k.publish(s.Ad.BREAK_CANCELLED,{currentPlaybackId:t.bb,position:t.Eb,unplayedCreativeIds:i,unplayedPlaybackIds:a,unplayedDuration:t.Ub,reason:t.Vb})}},n.prototype.dc=function(e){var t=this;if(window.clearTimeout(t.ec),t.ec=null,e.adDuration){var r=5;t.ec=window.setTimeout(function(){window.clearTimeout(t.ec),t.ec=null,t.bc("timeout")},1e3*(e.adDuration+r))}},n.prototype.Xb=function(){var e=this;e.bb&&(delete e.Ya[e.bb],e.Gb())},n.prototype.sb=function(e){var t=this;t.k.publish(s.AD_PLAYBACK_ENDED,t.bb,e)},n.prototype.u=function(e,t,r,n,i,a){var o=this,s=o.Ya[o.bb];h&&h.endDebugMode(y.PERF.VP_AD_PREPARE_START),o.l.setLoading(!1),o.m.syncViewState(),s&&(o.fc(),o.gc(r,a))},n.prototype.fc=function(){var e=this,t=e.Ya[e.bb],r=[o.POSITION.bumper,o.POSITION.preroll],n=!0;t&&r.indexOf(t.pos)!==-1&&1===e.Hb(r,n)&&e.k.publish(s.RENDERER_PP_NEXT,e.yb)},n.prototype.gc=function(e,t){var r=this,n=r.Ya[r.bb],i=r.bb,a=r.k.subscribe(s.AD_PLAYBACK_PROGRESS,function(e,t,o){a(),i===r.bb&&(r.Rb+=o,r.Qb+=n.duration)},r);if(r.Nb++,n.type!==o.ADTYPES.NO_AD){n.adObj&&n.adObj.creativeId&&r.Tb.push(n.adObj.creativeId);var l=n.type===o.ADTYPES.VPAID?t:e;r.Sb+=l,r.hc&&r.hc(l)}},n.prototype.mb=function(e,t){var r=this;r.hb.reset(),r.Xb(),r.db(t)},n.prototype.tb=function(e,t){var r=this;f.error("Ad errored out",e),r.k.publish(s.AD_PLAYBACK_ERROR,r.bb,e,t);var n=r.Ya[r.bb];r.Ob++,r.Pb+=n&&n.duration||0,r.sb(e)},n.prototype.ic=function(e,t,r){var n=this;e&&(n.m.pause(),n.k.publish(s.AD_CLICK,t,r),window.open(e,"_blank"))},n.prototype.ub=function(e){var t=this;if(t.bb){var r=t.Ya[t.bb];t.ic(r.clickUrl,t.bb,e)}},n.prototype.xb=function(e){var t=this;if(t.bb){var r=t.Ya[t.bb];t.ic(r.ctaUrl,t.bb,e)}},n.prototype.hasOccured=function(e){var t=(new Date).getTime(),r=t-e;return r<36e5},n.prototype.lb=function(e){var t=this;u.mobile||(t.Za=e.map(function(e,r){return{time:e,occurred:t.hasOccured(t.$a[r]||0)}}),t.k.publish(s.UPDATE_AD_BREAKS,t.Za))},n.prototype.jc=function(e,t,r){var n=this;if(n.Fb(),n.Gb(),n.Eb=o.POSITION.midroll,t.occurred=!0,n.kc=null,void 0!==t.adDuration&&n.k.publish(s.UPDATE_AD_BREAKS,n.Za),n.Db=function(e,t){if(window.clearTimeout(n.ec),n.ec=null,e){var i=(new Date).getTime(),a=n.k.subscribe(s.Video.PLAYING,function(){a();var e=(new Date).getTime()-i;n.lc&&n.lc(e)});n.mc=window.setTimeout(n.lc,5e3,"TO")}else n.lc&&n.lc();r(e,t)},t.adBreakMeta){var i=t.adBreakMeta,a=n.nc.bind(n,e,t);n.fb.playMidRolls(i.adLabel,i.duration,i.adId,i.adBreakNumber,a)}else{var l=n.fb.getMidrollAds(t.breakId,t.adDuration);n.nc(e,t,l)}},n.prototype.nc=function(e,t,r){var n=this;n.k.publish(s.AD_BREAK_STARTED,e,t.time);var i=r.filter(function(e){return e.type!==o.ADTYPES.NO_AD});n.oc(e,t,r,i),r.length>0?(n.Kb=i.length,n.Jb=0,n.k.publish(s.ADS_OBJS_UPDATE,r),n.Kb>0?(n.pc=window.setTimeout(n.hc,5e3,"TO"),n.dc(t)):n.hc(),n.db()):(n.hc(),n.Db(!1))},n.prototype.maybeAdBreak=function(e,t){var r=this,n=e.currentTime,i=e.isLive,a=e.adDuration;if(i||!(n<10)){if(!r.Xa)return void t(!1);if(!r.l.isSeeking()){if(i){var o={time:n,adDuration:a,adBreakMeta:e.adBreakMeta};return e.adBreakMeta&&e.adBreakMeta.command===y.CUEOUT_COMMANDS.PLAY&&r.l.playbackState.isAdPlaying()?void t(!1):void r.jc(n,o,t)}r.kc||(r.kc=r.qc(n,r.Za.filter(function(e){return!e.occurred})));var s=function(e,r){t(e,r,c)};if(r._a){r._a=!1,r.kc=null;var l=r.rc(n,r.Za),c=r.Za.indexOf(l);l&&!l.occurred&&r.jc(n,l,s)}else r.kc&&r.kc.time<n?r.jc(n,r.kc,s):t(!1)}}},n.prototype.maybeEndAdBreak=function(e,t){var r=this;r.Wb="number"==typeof t?t:"unknown",r.bc(e)},n.prototype.cueLoadAds=function(e){var t=this;t.Xa&&t.fb.cueMidRolls(e.adLabel,e.duration,e.adId,e.adBreakNumber)},n.prototype.oc=function(e,t,r,n){var i=this;window.clearTimeout(i.pc),window.clearTimeout(i.mc),i.pc=null,i.mc=null;var a=0;n.forEach(function(e){a+=e.duration});var o=i.fb.isAdBlockerDetected(),l=t.adBreakMeta||{};i.hc=function(c){window.clearTimeout(i.pc),i.pc=null,i.hc=null;var u=n.map(function(e){return e.adObj.creativeId});i.k.publish(s.AD_BREAK_INFO,{adStartLatency:c||"na",creativeIds:u,numMidrollsTotal:r.length,numMidrollsValid:n.length,readyAdsDuration:Math.round(a),adBlockerDetected:o,adBreakDuration:t.adDuration,contentTime:e,time:t.time,adBreakLabel:l.adLabel,adBreakNum:l.adBreakNumber,adBreakId:l.adId})},i.lc=function(r){window.clearTimeout(i.mc),i.mc=null,i.lc=null,i.wb=null,i.k.publish(s.AD_BREAK_ENDED,{videoStartLatency:r||"na",creativeIds:i.Tb,adsStartedCount:i.Nb,readyAdsDuration:Math.round(a),adsPlayDurationExpected:Math.round(i.Qb),adsPlayDurationActual:Math.round(i.Rb),adsErrorCount:i.Ob,erroredAdsDuration:i.Pb,adBlockerDetected:o,unplayedDuration:i.Ub,adsStartLatency:i.Sb,adBreakCueInTime:i.Wb,adBreakDuration:t.adDuration,contentTime:e,time:t.time,adBreakLabel:l.adLabel,adBreakNum:l.adBreakNumber,adBreakId:l.adId})},i.wb=function(){var r=i.Ya[i.bb];return r?{adsStartedCount:i.Nb,readyAdsDuration:Math.round(a),adsPlayDurationActual:Math.round(i.Rb-r.playbackProgress),adsErrorCount:i.Ob,adBlockerDetected:o,adBreakDuration:t.adDuration,contentTime:e,time:t.time,adBreakLabel:l.adLabel,adBreakNum:l.adBreakNumber,adBreakId:l.adId}:null}},n.prototype.qc=function(e,t){var r=null;return t.forEach(function(t){t.time>e&&(!r||t.time<r.time)&&(r=t)}),r},n.prototype.rc=function(e,t){var r=null;return t.forEach(function(t){t.time<e&&(!r||t.time>r.time)&&(r=t)}),r},n.prototype.vb=function(){var e=this;e._a=!0},n.prototype.destroy=function(){var e=this;e.fb&&e.fb.destroy()}},{"../../lib":"/lib/index.js","../../lib/logger":"/lib/logger.js","./constants":7,"./event":"/nextgen/src/event.js","./media-store":18,"./perf":29,"./renderers/type":44,"./states":46,"./stream":"/nextgen/src/stream.js","./yvap/ads-json":95,"./yvap/video-ad-plugin":135,"user-agent":233}],4:[function(e,t,r){"use strict";function n(e,t,r,n,i){var a=this;a.k=e,a.m=r,a.l=t,a.tc=n,a.uc=i}t.exports=n,t.exports.AGE_GATE_SCREEN_TYPES=l;var i=e("./util"),a=e("../../lib"),o=e("./event"),s=e("./strings"),l={login:"login",birthday:"birthday",warning:"warning",block:"block"},c="vpReleaseTime",u=864e5,p="WAIT";n.prototype.vc=function(e){var t=this;t.m.destroyAgeGateScreen(),t.m.renderAgeGateScreen(t.wc(e),t),t.xc=e,t.k.publish(o.API.UI_INTERACT,{srcElement:"age-"+t.yc}),t.l.ui.showAgeGate=!0,t.zc&&clearTimeout(t.zc)},n.prototype.run=function(){var e=this,t=e.l.userPreferences.isAuthenticated,r=!e.l.offNetwork,n=e.l.userPreferences.isAdult,i=e.Ac();e.yc=e.l.playlist.getCurrentItem()&&e.l.playlist.getCurrentItem().ageGate;var a=e.Bc(t,r,n,i);a&&"none"!==e.yc?a===p?e.zc=setTimeout(function(){e.l.ui.showAgeGate||this.vc(l.warning)},1e4):this.vc(a):e.Cc()},n.prototype.Bc=function(e,t,r,n){var i=this;return e||n?!n&&r?null:a.isNullOrUndefined(i.l.userPreferences.isAdult)&&!n?(i.uc.getUserPreferences(),p):l.block:t?l[i.yc]:i.yc===l.birthday?l[i.yc]:l.warning},n.prototype.wc=function(e){var t=this,r={title:t.Dc("CONTENT_RESTRICTED"),desc:"",button:"",isBirthday:!1,isBlock:!1};e===l.login?(r.desc=t.Dc("AGE_GATE_DESC"),r.button=t.Dc("SIGN_IN_TO_VIEW_ACTION")):e===l.warning?(r.desc=t.Dc("AGE_GATE_DESC"),r.button=t.Dc("CONTINUE_ACTION")):e===l.birthday?(r.desc=t.Dc("AGE_GATE_BDAY_DESC"),r.button=t.Dc("SUBMIT_ACTION"),r.isBirthday=!0):e===l.block&&(r.desc=t.Dc("AGE_GATE_NOT_ALLOWED_DESC"),r.isBlock=!0);var n=t.l.playlist.getCurrentItem();return r.imageSrc=n.images.defaultThumbnail,r.width=t.l.uiState.width,r.height=t.l.uiState.height,r},n.prototype.Ac=function(){var e=this;if(!e.Ec){var t=i.localStorage.get(c);isNaN(parseInt(t))||(e.Ec=(new Date).getTime()-t<0)}return e.Ec},n.prototype.Cc=function(){var e=this;e.l.ui.showAgeGate=!1,e.m.destroyAgeGateScreen(),e.xc=null,e.zc&&clearTimeout(e.zc),e.tc.play()},n.prototype.Dc=function(e){return s.i18n[e]},n.prototype.Fc=function(){var e=this;e.k.publish(o.UI_LOGIN,"ui_agebl"),i.showUserAuthPage(e.l)},n.prototype.Gc=function(e,t){if(t){var r=this,n=r.Hc(t.inputMonth.value,t.inputDay.value,t.inputYear.value);i.classList(t.inputMonth).remove("validate-error"),i.classList(t.inputDay).remove("validate-error"),i.classList(t.inputYear).remove("validate-error");for(var a=r.Ic(t.inputMonth,t.inputDay,t.inputYear),o=0;o<a.length;o++)i.classList(a[o]).add("validate-error");if(!n||a.length>0)return;r.Jc(new Date(t.inputYear.value,t.inputMonth.value-1,t.inputDay.value),r.l.baseConfig.region)?r.Cc():(r.vc(l.block),i.localStorage.put(c,(new Date).getTime()+u))}},n.prototype.Kc=function(){var e=this;e.Cc()},n.prototype.handleClickEvent=function(e,t){var r=this;r.xc===l.login?r.Fc(e):r.xc===l.birthday?(r.k.publish(o.CTRL_AGEGATE_BDAY),r.Gc(e,t)):r.xc===l.warning&&r.Kc(e),r.k.publish(o.API.UI_INTERACT,{srcElement:"age-"+r.xc+"-btn"})},n.prototype.Hc=function(e,t,r){var n=/^\d{1,2}$/,i=/^\d{4}$/;if(!(n.test(e)&&n.test(t)&&i.test(r)))return!1;var a=parseInt(t),o=parseInt(e),s=parseInt(r);if(s<1e3||s>3e3||0===o||o>12)return!1;var l=[31,28,31,30,31,30,31,31,30,31,30,31];return(s%400===0||s%100!==0&&s%4===0)&&(l[1]=29),a>0&&a<=l[o-1]},n.prototype.Ic=function(e,t,r){var n,i,a,o,s,l,c=[];try{n=parseInt(e.value),o=n>=1&&n<=12}catch(e){o=!1}try{i=parseInt(t.value),s=i>=1&&i<=31}catch(e){s=!1}try{a=parseInt(r.value),l=a>=1900&&a<=(new Date).getFullYear()}catch(e){l=!1}return o||c.push(e),s||c.push(t),l||c.push(r),c},n.prototype.Jc=function(e,t){if(a.isNullOrUndefined(e))return!1;var r=new Date((new Date).getTime()-e.getTime()).getUTCFullYear()-1970;return t.toLowerCase()in["kr","sg","th"]?r>=21:r>=18},n.prototype.filterNonDigitInput=function(e){var t,r,n,i,a=[9,37,39];return!!e&&(n=e.keyCode,i=e.shiftKey,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,t=n>=48&&n<=57||n>=96&&n<=105||8===n||46===n,r=a.indexOf(n)>-1,!!(!i&&t||r)||(e.preventDefault?e.preventDefault():e.returnValue=!1,!1))},n.prototype.isWaitingAuthentication=function(){var e=this;return!a.isNullOrUndefined(e.zc)},n.prototype.getPlayerWidth=function(){var e=this;return e.l.uiState.width},n.prototype.getPlayerHeight=function(){var e=this;return e.l.uiState.height},n.prototype.destroy=function(){var e=this;e.l.ui.showAgeGate=!0}},{"../../lib":"/lib/index.js","./event":"/nextgen/src/event.js","./strings":"/nextgen/src/strings.js","./util":"/nextgen/src/util.js"}],5:[function(e,t,r){"use strict";function n(e,t,r,n){function i(e,t){return e-t}var a=this;a.Lc=e,a.Mc=t?t.sort(i):[],a.reservoirLength=r||s,a.cushionLength=n||l,a.currentBitrate=0,a.Nc={},a.Mc.forEach(function(e){a.Nc[e]=0}),e&&e.addEventListener("waiting",function(){a.Nc[a.currentBitrate]=a.Nc[a.currentBitrate]+1},!1)}t.exports=n;var i=e("./util"),a="yvpTargetBitrate",o=900,s=10,l=20;n.prototype.setTargetBitrate=function(e){i.localStorage.put(a,e)},n.prototype.getTargetBitrate=function(){var e=this,t=i.localStorage.get(a);return t||(t=o,e.setTargetBitrate(o)),t},n.prototype.getBufferOccupancy=function(){for(var e=this,t=e.Lc.buffered,r=e.Lc.currentTime,n=0;n<t.length;n++){var i=t.start(n),a=t.end(n);if(i<=r&&a>=r){var o=a-r;if(o>=e.Lc.length-r)return Number.MAX_VALUE}return o}return 0},n.prototype.Oc=function(e,t){var r=this;if(t===Number.MAX_VALUE)return r.currentBitrate;var n=e[0];if(t>r.reservoirLength){var i=e[0],a=e[e.length-1],o=(a-i)/r.cushionLength;n=(t-r.reservoirLength)*o+i}return n},n.prototype.Pc=function(e,t){for(var r=e.length-1;r>=0;r--){var n=e[r];if(n<=t)return n}return e[0]},n.prototype.Qc=function(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n>=t)return n}return e[e.length-1]},n.prototype.getRecommendedBitrate=function(e,t,r){var n=this;t=t||n.Mc,r=void 0===r?n.getBufferOccupancy():r,e=void 0===e?t.indexOf(n.currentBitrate):e;var i=t[e],a=t[0],o=t[t.length-1],s=i===o?o:t[e+1],l=i===a?a:t[e-1],c=n.Oc(t,r),u=i;return c>=s?u=n.Pc(t,c):c<=l&&(u=n.Qc(t,c)),u},n.prototype.getNumberOfBufferingsForBitrate=function(e){var t=this;return t.Nc[e]}},{"./util":"/nextgen/src/util.js"}],6:[function(e,t,r){"use strict";function n(e,t){var r=this;r.l=e,r.k=t,s=window.chrome,r.playerType="nextgen-desktop",r.Rc=null,r.Sc=null,r.Tc=null,r.Uc=null,r.Vc=null,r.Wc=!1,r.Xc=null,s.cast?s.cast.isAvailable?r.Yc():setTimeout(r.Yc.bind(r),1e3):window.__onGCastApiAvailable||(window.__onGCastApiAvailable=function(e,t){e&&r.Yc()},c.lazyLoad(v,1e4,function(e){})),r.k.subscribe(l.MEDIA_ITEM_LOADED,r.Zc,r)}function i(e){return{onSuccess:function(){var t=Array.prototype.slice.call(arguments,1);a("[media command executed]",e,t.length?t:"")},onError:function(){var t=Array.prototype.slice.call(arguments,1);o("[media command failed]",e,t.length?t:"")}}}function a(){p.log.apply(console,["[cast]"].concat(Array.prototype.slice.call(arguments)))}function o(){p.warn.apply(console,["[cast]"].concat(Array.prototype.slice.call(arguments)))}t.exports=n;var s,l=e("./event"),c=e("./util"),u=e("../../lib"),p=e("../../lib/logger"),d=e("./error"),f=e("./constants"),v="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js",m=1e3,y="urn:x-cast:com.yahoo.video.custom",h={hls:"application/vnd.apple.mpegurl",mp4:"video/mp4"};n.prototype.Yc=function(){var e=this,t={CUSTOM:f.CHROMECAST_RECEIVER_ID,DEFAULT:s.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID},r=new s.cast.SessionRequest(t.CUSTOM),n=e.$c.bind(e),i=e._c.bind(e),o=s.cast.AutoJoinPolicy.PAGE_SCOPED,c=new s.cast.ApiConfig(r,n,i,o),u=function(){a("cast sender-api initialization: Successful"),e.bd=!0,e.cd(),e.k.subscribe(l.API.UI_INTERACT,e.dd,e),e.k.subscribe(l.API.PLAYER_MUTE_CHANGE,e.setMute,e),e.k.subscribe(l.CONTROLS_SET_VOLUME,e.setVolume,e),e.k.subscribe(l.API.PLAYER_VOLUME_CHANGE,e.setVolume,e),e.k.subscribe(l.CONTROLS_SEEKING,e.seek,e),e.k.subscribe(l.TOGGLE_PLAY_PAUSE,e.ed,e),e.k.subscribe(l.CC.TOGGLE,e.fd,e)},p=function(t){a("cast sender-api initialization: Error",t),e.bd=!1};s.cast.initialize(c,u,p)},n.prototype.cd=function(){var e=this;e.l.castState={connected:!1,mediaLoaded:!1,paused:!1,playerState:s.cast.media.PlayerState.IDLE,progress:null,volume:{level:null,muted:null},items:{},currentItemId:null,currentItemYVPUUID:null,captionsOn:!1,captionsAvailable:!1},e.l.castState.getCurrentCastingYVPMediaItem=function(){return e.l.playlist.getMediaItemById(this.currentItemYVPUUID)}},n.prototype._c=function(e){a("receiverStatus",e);var t=this;t.Wc=e===s.cast.ReceiverAvailability.AVAILABLE,t.gd(),!t.Wc&&t.Rc&&t.hd(null)},n.prototype.ed=function(){var e=this;if(e.Rc)if(e.isCastMediaLoaded()){var t=e.l.castState.playerState;t===s.cast.media.PlayerState.PLAYING?e.pause():e.play()}else e.jd()},n.prototype.fd=function(e){var t=this;t.isCastMediaLoaded()&&(e?t.kd():t.ld())},n.prototype.gd=function(){var e=this,t=e.Wc&&e.md(e.Uc);e.k.publish(l.API.CAST_AVAILABILITY_CHANGE,t),a("Is receiver available: %s. Is casting available = %s",e.Wc,t)},n.prototype.$c=function(e){a("sessionListener found pre-existing session for auto-joining with numMediaItems="+e.media.length);var t=this;t.hd(e),0!==e.media.length&&(t.nd("Auto-Joining exisiting session",e.media[0]),t.od())},n.prototype.qd=function(){var e=this;a("requesting new casting session"),s.cast.requestSession(e.rd.bind(e),e.sd.bind(e))},n.prototype.rd=function(e){a("new casting session request: success");var t=this;t.hd(e),t.jd()},n.prototype.sd=function(e){var t=this;a("new casting session request: error",e),t.td(d.CAST_CODES.E_CONNECTION_REQUEST_FAILED,e)},n.prototype.hd=function(e){a("updateSession",{session:e});var t=this;if(t.Rc=e,!e){var r=t.l.castState.items[t.l.castState.currentItemId];return t.ud(null),void t.vd(!1,r)}t.Rc.addUpdateListener(t.wd.bind(t)),t.wd(),t.Rc.addMediaListener(function(e){a("** Session.Medialistener **** A sender from current session changed a media on cast device",e)}),t.Rc.addMessageListener(y,function(e,t){var r=JSON.parse(t);a("** cast msg received **",r)})},n.prototype.wd=function(){var e=this,t=s.cast.SessionStatus;if(a("_sessionUpdateListener, status=",e.Rc.status,{s:e.Rc}),e.Sc!==e.Rc.status)switch(e.Sc=e.Rc.status,e.Rc.status){case t.STOPPED:e.hd(null);break;case t.CONNECTED:e.vd(!0);break;case t.DISCONNECTED:}e.Rc&&(e.l.castState.volume.level!==e.Rc.receiver.volume.level&&(e.l.castState.volume.level=e.Rc.receiver.volume.level,e.k.publish(l.CAST.VOLUME_CHANGED,e.Rc.receiver.volume.level)),e.l.castState.volume.muted!==e.Rc.receiver.volume.muted&&(e.l.castState.volume.muted=e.Rc.receiver.volume.muted,e.k.publish(l.CAST.MUTE_CHANGED,e.Rc.receiver.volume.muted)))},n.prototype.xd=function(){var e=this,t=function(e){a("end session success")},r=function(){a("end session error",arguments)};e.Rc.stop(t,r)},n.prototype.Zc=function(e){var t=this;t.Uc=e,t.gd()},n.prototype.dd=function(e){var t=this;switch(e.srcElement){case"ctrl-cast-start":case"ctrl-cast-stop":a("chromecast icon clicked"),t.isCastConnected()?t.xd():t.qd();break;case"ctrl-cast-disconnect":t.xd();break;case"ctrl-cast-overlay":t.k.publish(l.TOGGLE_PLAY_PAUSE)}},n.prototype.jd=function(){var e=this;if(a("sending request for media-load"),e.Rc&&!e.yd){var t=e.l.playlist.position,r=e.zd(e.Uc),n=new s.cast.media.LoadRequest(r);n.autoplay=!0,n.currentTime=e.Uc.progress.position||0,n.customData={media_uuid:r.customData.uuid,playlist_pos:t>-1?t:"unknown",videoSession:e.Uc.videoSession,pageSpaceId:e.l.baseConfig.pageSpaceId,site:e.l.baseConfig.site,pls:e.l.guid,senderType:"desktop"};var i=function(t){e.yd=!1,e.nd("loadMedia request",t)},o=function(){e.yd=!1,a("receiver cast device media load request errored",arguments)};e.yd=!0,e.Rc.loadMedia(n,i,o)}},n.prototype.nd=function(e,t){var r=this;if(a("New casting media discovered via:",e),r.Tc===t)return void a("same mediasession as before, therefore not updating it");r.ud(t);var n=r.od.bind(r);r.Tc.addUpdateListener(n),t.currentTime&&t.items&&t.items.length&&r.k.publish(l.CAST.PLAYBACK_PROGRESS,t.media.customData.uuid,t.currentTime,t.media.duration),setTimeout(function(){var e=r.Tc;e&&e.playerState!==r.l.castState.playerState&&(o("playerState not synced. _onMediaStatusUpdate() was not called. calling _checkReceiverPlayerStatus"),r.Bd())},2e3)},n.prototype.od=function(){var e=this,t=e.l.castState.currentItemId;if(a("_onMediaStatusUpdate.",e.Tc.playerState,{mediasession:e.Tc}),e.Cd()&&(e.Dd=!0,e.Ed(e.Tc.media.customData)),e.l.castState.currentItemId=e.Tc.currentItemId,e.l.castState.playerState!==e.Tc.playerState){e.Fd();var r=e.l.castState.playerState;switch(e.l.castState.playerState=e.Tc.playerState,r===s.cast.media.PlayerState.BUFFERING&&e.Gd(!1),e.Tc.playerState){
case s.cast.media.PlayerState.PLAYING:e.Xc=setInterval(e.Hd.bind(e),m),e.Dd&&(e.Dd=!1,e.Id(!0));break;case s.cast.media.PlayerState.PAUSED:e.Dd=!0,e.Id(!1);break;case s.cast.media.PlayerState.BUFFERING:e.Gd(!0);break;case s.cast.media.PlayerState.IDLE:e.Tc.idleReason===s.cast.media.IdleReason.FINISHED&&e.Jd(t),e.Kd()&&(e.Ed(null),e.Ld(),e.ud(null))}}},n.prototype.Cd=function(){var e=this,t=e.Tc.currentItemId,r=null!==t&&t!==e.l.castState.currentItemId;return r},n.prototype.Kd=function(){var e=this;return null===e.Tc.items},n.prototype.ud=function(e){var t=this;t.Tc=e,t.Tc||(t.Vc=null,t.l.castState.currentItemId=null,t.l.castState.currentItemYVPUUID=null,t.l.castState.paused=!1,t.l.castState.mediaLoaded=!1,t.Fd(),t.l.castState.captionsAvailable=!1),t.yd=!1,t.Md()},n.prototype.vd=function(e,t){if("boolean"==typeof e){var r=this,n=r.l.castState;if(e!==n.connected){var i={};e?i.receiverName=r.Rc.receiver.friendlyName:t&&(i.uuid=t.media_uuid,i.playlist_pos=t.playlist_pos),r.l.castState.connected=e,r.k.publish(l.CAST.CONNECTION_STATUS_CHANGED,e,i),!e&&r.cd()}}},n.prototype.Ed=function(e){var t=this;if(t.l.castState.mediaLoaded=!!e,e?(t.l.castState.currentItemYVPUUID=e.uuid,t.Vc=t.l.castState.getCurrentCastingYVPMediaItem()):t.l.castState.currentItemYVPUUID=null,t.k.publish(l.CAST.MEDIA_CHANGED,e),e){var r=t.Tc.media&&t.Tc.currentItemId||null,n=null!==r?t.l.castState.items[r]:null;t.l.castState.captionsAvailable=!!(n&&n.captions&&n.captions.length)}else t.l.castState.captionsAvailable=!1;t.k.publish(l.CAST.CAPTION_AVAILABILITY_CHANGED,t.l.castState.captionsAvailable),t.l.castState.captionsAvailable&&t.l.userPreferences.closedCaptions.show&&t.kd()},n.prototype.Id=function(e){var t=this;t.l.castState.paused=!e,t.k.publish(l.CAST.TOGGLE_PLAYING,e)},n.prototype.Gd=function(e){var t=this;t.k.publish(l.CAST.BUFFERING,e)},n.prototype.Jd=function(e){var t=this;t.l.castState.mediaLoaded=!1,t.l.castState.paused=!1,t.Vc&&(t.Vc.progress.position=0);var r=t.l.castState.items[e];t.k.publish(l.CAST.VIDEO_ENDED,r.media_uuid)},n.prototype.Ld=function(e){var t=this;t.k.publish(l.CAST.PLAYLIST_ENDED)},n.prototype.Bd=function(){var e=this,t=i("get-status");e.Tc&&e.Tc.getStatus(null,t.onSuccess,t.onError)},n.prototype.Hd=function(){var e=this;if(e.Rc&&e.Tc){var t,r=e.Tc.media;r&&null!==r.duration?(t=e.Tc.getEstimatedTime(),e.k.publish(l.CAST.PLAYBACK_PROGRESS,r.customData.uuid,t,r.duration)):(t=0,e.Fd()),e.Vc&&(e.Vc.progress.position=t),e.l.castState.progress=t}},n.prototype.Fd=function(){var e=this;e.Xc&&(clearInterval(e.Xc),e.Xc=null)},n.prototype.Md=function(){var e=this;e.l.castState.items={};var t=e.Tc&&e.Tc.items;t&&t.forEach(function(t){var r=[];t.media.tracks&&t.media.tracks.forEach(function(e){e.type===s.cast.media.TrackType.TEXT&&r.push(e)}),e.l.castState.items[t.itemId]=t.customData,e.l.castState.items[t.itemId].captions=r})},n.prototype.Nd=function(e){var t=this,r=t.l.playlist,n=[],i=r.items.length-r.position-1,a=r.position+1;e&&(i=e.length,a=0);for(var o=a,s=a+i;o<s;o++){var l=e?e[o]:r.getMediaItemAt(o);l&&t.md(l)&&n.push(l)}n.length&&t.Od(n)},n.prototype.Od=function(e){var t=this,r=[];e.forEach(function(e){var n=t.zd(e),i=new s.cast.media.QueueItem(n);i.autoplay=!0,i.customData={media_uuid:n.customData.uuid,playlist_pos:"unknown"},i.preloadTime=10,i.startTime=0,r.push(i)});var n=new s.cast.media.QueueInsertItemsRequest(r),o=i("queue-items"),l=function(){a("queue-items successful"),t.Md()};t.Tc.queueInsertItems(n,l,o.onError)},n.prototype.zd=function(e){var t=this,r=s.cast.media.StreamType,n=Math.floor(e.streams.length/2),i=e.streams[n].url,a=e.images.large||e.images.thumbnail||e.images.medium||e.images.small||e.images.provider,o=new s.cast.media.MediaInfo(i),l=t.l,u="vod short",p=e?e.streams[0]:null,d=c.getHostUrl(),v=l.metrics&&l.metrics.rapidFields||{},m=l.baseConfig;if(d=d?d.replace(/(_ylt(.)+(\?)|_ylt(.)+)/,"?"):d,o.metadata=new s.cast.media.GenericMediaMetadata,o.metadata.metadataType=s.cast.media.MetadataType.GENERIC,o.metadata.title=e.title,o.metadata.images=[{url:a}],e.isLive())u="live";else{var y=e.duration;e.isCCM?"na"!==y&&y>600&&(u="vod long"):u="streamurl"}o.streamType=e.isLive()?r.LIVE:r.BUFFERED,o.duration=e.duration,o.customData={live:!!e.isLive(),"com.yahoo.castsdk.appId":"desktop",experience_name:l._b&&l._b.expName||"",pltype:t.playerType,"com.yahoo.castsdk.videoTitle":e.title,cast_start_pos:e.progress.position||0,uuid:e.id,cc_state:l.userPreferences.closedCaptions.show?1:0,pls:l.guid,watch_duration:e.progress.position||0,sdk_ver:l.version||"unknow","com.yahoo.castsdk.videoUrl":i,platform:"desktop",audio_name:e.getCurrentAudioLanguage()||"",video_type:u,site_id:m.site,account_id:"",vs:e.videoSession,mime_type:e.streams&&e.streams[0]&&e.streams[0].mime_type||"",lang:m.lang,region:m.region,pageSpaceId:m.pageSpaceId,isCCM:e.isCCM,playlist_pos:l.playlist.position>-1?l.playlist.position:"unknown",senderType:"desktop",ccode:l.metrics&&l.metrics.ccode,sec:v.sec||l.metrics&&l.metrics.sec,cpos:l.metrics&&l.metrics.cpos,sp:p?p.url.split(":")[0]:f.STRING_DEFAULT,synd:m.syndication&&m.syndication.split("-")[0],experience_mode:"fullscreen",expn:m.experienceName&&m.experienceName.toLowerCase(),expt:m.experienceType&&m.experienceType.toLowerCase(),expb:m.experienceBucket,pt:v.pt,pd:v.pd,pct:v.pct,pstcat:v.pstcat,ver:v.ver,pstaid_p:v.pstaid_p,pkgt:v.pkgt,subsec:v.subsec,_w:d,rcmode:p&&p.rcMode||f.STRING_DEFAULT};var E=e.getType();return o.contentType=h[E],o.textTrackStyle=new s.cast.media.TextTrackStyle,o.tracks=t.Pd(e,o),o},n.prototype.Pd=function(e){var t;if(e.closedCaptions.length){var r=1,n=[];e.closedCaptions.forEach(function(e){var t=new s.cast.media.Track(r,s.cast.media.TrackType.TEXT);t.trackContentId=e.url,t.trackContentType=e.content_type,t.language=e.lang,t.name=e.lang,t.customData=null,r++,n.push(t)}),t=n.sort(function(e,t){return e.language===t.language?-1*e.trackContentType.localeCompare(t.trackContentType):e.language.localeCompare(t.language)})}return t},n.prototype.md=function(e){return!e||!e.is360Video()},n.prototype.td=function(e,t){var r=this;r.k.publish(l.WARNING,c.createErr("P",r.l.playbackState,d.E_CAST,e,t))},n.prototype.Qd=function(e,t,r){var n=this,i=new s.cast.media.EditTracksInfoRequest(e);n.Tc.editTracksInfo(i,t,r)},n.prototype.kd=function(e){var t=this;if(t.Tc&&!u.isNullOrUndefined(t.Tc.currentItemId)){e=(e||t.l.userPreferences.closedCaptions.lang).toLocaleLowerCase();var r=t.l.castState,n=r.items[t.Tc.currentItemId].captions;if(0!==n.length){for(var i,s=function(){a("enable-captions successful"),r.captionsOn=!0},l=function(){o("enable-captions error")},c=0;c<n.length;c++){var p=(n[c].language||"").toLocaleLowerCase();if(p===e){i=n[c];break}}i||(i=n[0]),t.Qd([i.trackId],s,l)}}},n.prototype.ld=function(){var e=this;if(e.Tc&&!u.isNullOrUndefined(e.Tc.currentItemId)){var t=function(){a("disable-captions successful"),e.l.castState.captionsOn=!1},r=function(){o("disable-captions error")};e.Qd([],t,r)}},n.prototype.Rd=function(e,t){var r=this;if(!r.Tc)return void a("trying "+e+" without a casting media loaded");if(!r.Tc[e])return void a("Command "+e+" is not allowed to be executed");var n=null;if("seek"===e){if("number"!=typeof t||t<0)throw"numSeconds while requesting seek on cast device needs to be defined and positive";n=new s.cast.media.SeekRequest,n.currentTime=t||0,n.resumeState=s.cast.media.ResumeState.PLAYBACK_START}var o=i(e);r.Tc[e](n,o.onSuccess,o.onError)},n.prototype.isCastMediaLoaded=function(){var e=this;if(e.bd){var t=s.cast.media.PlayerState;return!(!e.Tc||e.Tc.playerState===t.IDLE)}return!1},n.prototype.isCastConnected=function(){var e=this;return!!e.bd&&!(!e.Rc||e.Rc.status!==s.cast.SessionStatus.CONNECTED)},n.prototype.play=function(){var e=this;e.isCastMediaLoaded()?e.Rd("play"):(a("no castingMediaLoaded. Requesting to load media and cancelling this play request"),e.jd())},n.prototype.pause=function(){var e=this;e.Rd("pause")},n.prototype.stop=function(){var e=this;e.Rd("stop")},n.prototype.seek=function(e){var t=this;t.Rd("seek",e)},n.prototype.setMute=function(e){var t=this;t.Rc&&t.Rc.setReceiverMuted(e)},n.prototype.setVolume=function(e){var t=this;t.Rc&&t.Rc.setReceiverVolumeLevel(e)}},{"../../lib":"/lib/index.js","../../lib/logger":"/lib/logger.js","./constants":7,"./error":12,"./event":"/nextgen/src/event.js","./util":"/nextgen/src/util.js"}],7:[function(e,t,r){"use strict";r.VIDEO_TAG_READY_STATES={HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4},r.CHROMECAST_RECEIVER_ID="84BB6CBA",r.PLAYLIST_THUMB_DIMENSION="260x144",r.PLAYLIST_SECTION_ICON_DIMENSION="14x14",r.PLAYLIST_LABEL_ICON_DIMENSION="70x70",r.PLAYLIST_POS_BOTTOM="bottom",r.PLAYLIST_POS_RIGHT="right",r.PLAYLIST_POS_HIDDEN="hidden",r.PLAYLIST_COUNT_PER_PAGE=12,r.PLAYLIST_HIDDEN_COUNT_PER_PAGE=6,r.PLAYLIST_ENDSCREEN_COUNT_PER_PAGE=12,r.DOCKED_PLAYER_FULL="full",r.LIVE_STATES_FOR_VOD={SCHEDULED:"scheduled",NO_ARCHIVE:"no-archive",POST:"post",REPLAY:"replay"},r.PERF={VP_SCRIPT_EXEC:"VP_SCRIPT_EXEC",VP_INIT:"VP_INIT",VP_CTRL_RENDER:"VP_CTRL_RENDER",VP_CTRL_FETCH_METADATA:"VP_CTRL_FETCH_METADATA",VP_CTRL_PREPARE_AUTOPLAY:"VP_CTRL_PREPARE_AUTOPLAY",VP_CTRL_LOAD_METADATA:"VP_CTRL_LOAD_METADATA",VP_CTRL_PREPARE_START:"VP_CTRL_PREPARE_START",VP_RC_SETUP:"VP_RC_SETUP_",VP_RC_PREPARE_NEXT:"VP_RC_PREPARE_NEXT_",VP_RC_PRELOAD_NEXT_AD:"VP_RC_PRELOAD_NEXT_AD_",VP_RC_PRELOAD_NEXT:"VP_RC_PRELOAD_NEXT_",VP_AD_FETCH:"VP_AD_FETCH",VP_AD_SETUP_TIMEOUT:"VP_AD_SETUP_TIMEOUT",VP_AD_WAIT_FOR_AD_READY:"VP_AD_WAIT_FOR_AD_READY",VP_AD_MAYBE_PLAY:"VP_AD_MAYBE_PLAY",VP_AD_VPAID_PREPARE_RENDERER:"VP_AD_VPAID_PREPARE_RENDERER",VP_AD_PREPARE_START:"VP_AD_PREPARE_START",VP_AD_NORMAL_PREPARE_RENDERER:"VP_AD_NORMAL_PREPARE_RENDERER"},r.PLAYLIST_RENDERING_TYPE={PLAYLIST_ID:"playlist_id",PLAYLIST_ID_AND_MEDIA_ITEMS:"playlist_id_and_mediaItems",ONLY_MEDIA_ITEMS:"mediaItems"},r.VIDEO_TYPE={THREE_SIXTY:"360"},r.HIGH_DEFINITION_HEIGHT_THRESHOLD=720,r.HIGH_DEFINITION_WIDTH_THRESHOLD=1080,r.Orientation={PORTRAIT:"portrait",LANDSCAPE:"landscape"},r.SUPPORTED_THEMES=["fuji","aol"],r.DDM_CSS_SETTINGS={wrapper:"yvp-ddm-wrapper",selectedWrapper:"yvp-ddm-selected-wrapper",selected:"yvp-ddm-selected",availability:"yvp-ddm-availability",notAvailable:"not-available",dropDownIcon:"yvp-ddm-chevron",list:"yvp-ddm-list",listItem:"yvp-ddm-item"},r.CUEOUT_COMMANDS={LOAD:"load",PLAY:"play"},r.ID3_MATCH_PATTERN={JSON:/\{([\S\s]*)\}/,NIELSEN:/\bwww.nielsen.com.*(\/\d+){3}/},r.DEFAULT_WIDTH=640,r.DEFAULT_HEIGHT=360,r.SAPI_MIME_TYPE="media/sapi",r.META_PLUGIN_TYPE="metadata-plugin",r.SOURCE_PLUGIN_TYPE="source-metadata-plugin"},{}],8:[function(e,t,r){"use strict";function n(e,t,r,n){var i=this;i.Ha=new m(e,r),i.Ha.add(c.Metrics.INIT_TO_STARTSCREEN),i.Ha.add(c.Metrics.INIT_TO_SAPI),i.Ha.add(c.Metrics.RENDER_TO_SWF),i.Ha.add(c.Metrics.VP_CONSTRUCTOR),i.k=n,i.l=new v.Model(e,t,r);var s=e.connectionType;if(s&&s.raw&&"boolean"==typeof s.mobile&&C.network.update(s.mobile,s.raw),i.ifPlaybackProgressCalled=!1,i.Sd=!1,i.Td=!1,i.Ud=null,window.performance&&window.performance.timing&&window.performance.timing.navigationStart&&(i.l.metrics.pageLatency=(new Date).getTime()-window.performance.timing.navigationStart),i.l.baseConfig.experienceNavStartTime&&(i.l.metrics.experienceLatency=(new Date).getTime()-i.l.baseConfig.experienceNavStartTime),i.l.playback.adPlaybackOnly&&(i.l.playback.autoplay=!0),!E.localStorage.get("yvp-dont-autoplay")&&i.l.isAutoplayAllowed()||(i.l.playback.autoplay=!1),i.l.playback.autoplay&&h.desktop){var l=C.needsGestureToPlayUnmuted&&(h.firefox>=66||h.chrome>=66||h.edge>=17);(h.safari>=11||l)&&i.l.setMute(!0)}C.canPlayInline&&C.autoplayByUIEvtOnly&&i.l.playback.autoplay&&(i.l.playbackState.waitingForUserTap=!0,i.k.once(c.TOUCH_TO_PLAY_RESTRICTION_REMOVED,function(){i.l.playbackState.waitingForUserTap=!1})),i.l.playback.autoplay&&!i.l.playbackState.waitingForUserTap||i.l.ui.chromeless||(i.l.ui.showStartScreen=!0),i.Vd=!0,i.l.playback.autoplay&&(i.Ha.add(c.Metrics.INIT_TO_START),i.Ha.add(c.Metrics.HLS_FIRST_TS_LOAD_START)),i.l.metrics.disableAllBeacons&&E.isOffNetwork()||(i.Wd=new f.Metrics(i.l,i.k,i.Ha)),i.l.failOver.fastInitRecoverer&&i.Xd(),i.k.subscribe(c.ERROR,i.tb,i),i.k.subscribe(c.INFO,i.tb,i),i.k.subscribe(c.WARNING,i.Yd,i),i.k.subscribe(c.START_SCREEN_CLICK,i.Zd,i),i.k.subscribe(c.RELATED_ITEM_CLICK,i.$d,i),i.k.subscribe(c.FETCH_MORE_RELATED_ITEMS,i._d,i),i.k.subscribe(c.MEDIA_ITEM_LOADED,i.D,i),i.k.subscribe(c.TOGGLE_PLAY_PAUSE,i.ed,i),i.k.subscribe(c.CONTROLS_SEEK_START,i.ae,i),i.k.subscribe(c.CONTROLS_SEEK_END,i.be,i),i.k.subscribe(c.CONTROLS_SEEKING,i.ce,i),i.k.subscribe(c.Video.CLICK,i.ee,i),i.k.subscribe(c.Video.PLAYING,i.fe,i),i.k.subscribe(c.Video.TIMEUPDATE,i.A,i),i.k.subscribe(c.Video.PAUSE,i.ge,i),i.k.subscribe(c.Video.SEEKING,i.je,i),i.k.subscribe(c.Video.SEEKED,i.ke,i),i.k.subscribe(c.Video.ENDED,i.le,i),i.k.subscribe(c.Video.ERROR,i.me,i),i.k.subscribe(c.Video.WAITING,i.ne,i),i.k.subscribe(c.PLAYBACK_REQUEST,i.oe,i),i.pe=i.k.subscribe(c.PLAYBACK_STARTED,function(){L&&L.endDebugMode(R.PERF.VP_CTRL_PREPARE_START),i.qe()}),i.re=i.k.subscribe(c.AD_PLAYBACK_STARTED,function(){i.qe()}),i.k.subscribe(c.SELECTED_STREAM_CHANGE,i.se,i),i.k.subscribe(c.SELECTED_STREAM_URL_CHANGE,i.se,i),i.k.subscribe(c.PLAYER_DIMENSION_CHANGE,i.ue,i),i.k.subscribe(c.MEDIA_RELOAD_BEGIN,i.ve,i),i.k.subscribe(c.MEDIA_RELOAD_END,i.we,i),i.k.subscribe(c.QUALITY_CHANGE,i.xe,i),i.k.subscribe(c.METADATA_AVAILABLE,i.ye,i),i.k.subscribe(c.USER_AUTHENTICATED,i.ze,i),i.k.subscribe(c.CONTROLS_SET_VOLUME,i.Ae,i),i.k.subscribe(c.CONTROLS_SET_MUTE,i.Be,i),i.k.subscribe(c.API.BITRATE_CHANGE,i.Ce,i),i.k.subscribe(c.KEYDOWN,i.De,i),i.k.subscribe(c.QUALITY_SELECTED,i.Ee,i),i.k.subscribe(c.BITRATE_LIST_CHANGED,i.Fe,i),i.k.subscribe(c.PTS_DISCONTINUITY,i.Ge,i),i.k.subscribe(c.RECOVERY_START,i.He,i),i.k.subscribe(c.RECOVERY_METADATA_READY,i.Ie,i),i.k.subscribe(c.ER_READY,i.Je,i),i.k.subscribe(c.API.CUEPOINT_STARTED,i.Ke,i),i.k.subscribe(c.API.CUEPOINT_STOPPED,i.Le,i),i.k.subscribe(c.TIMED_METADATA_RECEIVED,i.Me,i),i.k.subscribe(c.RENDERER_SWITCHED,i.Ne,i),i.k.subscribe(c.CONTENT_LOAD_FINISHED,i.Oe,i),i.k.subscribe(c.LIVE_RELOAD_MEDIA,i.Pe,i),i.k.subscribe(c.CONTROLS_AUDIO_CHANGE,i.Qe,i),i.k.subscribe(c.REQUEST_GEO_POSITION,i.Re,i),i.k.subscribe(c.BROWSER_BLOCKED_PLAYBACK_START,i.Se,this),i.uc=new u(i.l,i.k,i.Ha),i.Te=new O(i.l,i,i.k),i.Ue(i.l.playlist.getCurrentItem()),i.Ve={},i.Ha.setEndTime(c.Metrics.VP_CONSTRUCTOR),i.Ha.add(c.Metrics.INIT_RENDER_GAP),g.isFunction(o)&&(i.We=new o(i.k)),h.chrome>=32&&!i.l.disableCasting&&h.desktop&&(i.Xe=new a(i.l,i.k),i.k.subscribe(c.CAST.CONNECTION_STATUS_CHANGED,i.Ye,i),i.k.subscribe(c.CAST.PLAYLIST_ENDED,i.Ze,i),i.k.subscribe(c.CAST.TOGGLE_PLAYING,function(){i.m.syncViewState()},i),i.k.subscribe(c.CAST.VIDEO_ENDED,function(){i.m.syncViewState()},i))}t.exports=n;var i=e("./ads-controller"),a=e("./cast-controller"),o=e("./darla-controller"),s=e("./age-gate-controller"),l=e("./error"),c=e("./event"),u=e("./metadata-fetcher"),p=e("./network-restriction-verifier"),d=e("./media-store"),f=e("./metrics/metrics"),v=e("./model"),m=e("./profiler"),y=e("./states"),h=e("user-agent").userAgent,E=e("./util"),g=e("../../lib"),b=e("../../lib/logger"),_=e("./view"),A=e("./cc"),T=e("./metrics/metrics-constants"),S=e("./recoverer"),I=e("./renderers/type"),L=e("./perf"),R=e("./constants"),C=e("./navigator-info"),D=e("./gps-util"),O=e("./pause-handler"),N="yvpVolume",P=1e4,k=1e4;n.prototype.Ue=function(e){var t=this;e&&(e.mayUpdateVideoSession(),e.useVideoSession(),t.k.publish(c.VIDEO_REQUEST,e.isPrefetch))},n.prototype.ed=function(){var e=this;e.l.castState&&e.l.castState.connected||e.l.getState()===y.VIDEO&&(e.l.isPaused()?(e.play({type:T.CLICK,action:T.PLAY}),e.k.publish(c.CTRL_PLAYPAUSE,"play")):(e.pause({type:T.CLICK,action:T.PAUSE}),e.k.publish(c.CTRL_PLAYPAUSE,"pause")))},n.prototype.render=function(e){var t=this;t.Ha.setEndTime(c.Metrics.INIT_RENDER_GAP),t.Ha.add(c.Metrics.CREATE_RENDERER),L&&L.startDebugMode(R.PERF.VP_CTRL_RENDER);var r;r=g.isString(e)?document.querySelector(e):e._node||e,null===r&&t.k.publish(c.ERROR,E.createErr("C",t.l.playbackState,l.E_PLAYER,l.PLAYER_CODES.E_INVALID_CONFIG,"Invalid DOM node or CSS selector specified. Cannot render player.")),t.Wd&&t.Wd.setRootElem(r),t.m=new _(r,t.l,t.k,t.Ha),t.m.render(t.l),t.$e=t.m.getPlaylistController(),t.l.rendered=!0,g.isFunction(A)&&(t._e=new A(t.k,t.l,t.m));var n={play:function(){t.play()},pause:function(){t.pause()},setOverlayActive:function(e){t.m.setOverlayActive(e)}};if(t.af(),g.isFunction(i)&&(t.bf=new i(t.k,n,t.l,t.m)),t.cf=!1,t.df(),t.l.playback.autoplay)var a={type:T.AUTOPLAY,action:T.AUTOPLAY};var o=t.l.getPlaylistRenderingType(),s=R.PLAYLIST_RENDERING_TYPE;return o!==s.ONLY_MEDIA_ITEMS&&o!==s.PLAYLIST_ID_AND_MEDIA_ITEMS||(L&&L.startDebugMode(R.PERF.VP_CTRL_FETCH_METADATA),t.uc.updateMetadata()),o===s.PLAYLIST_ID&&(L&&L.startDebugMode(R.PERF.VP_CTRL_FETCH_METADATA),t.$e.fetchMore(R.PLAYLIST_COUNT_PER_PAGE,function(e){return e?void t.error({code:l.E_SAPI_RELATED,type:l.PLAYER_CODES.E_CMS_XHR_REQ_ERROR,message:""}):0===t.l.playlist.items.length?void t.error({code:l.SAPI_CODES.E_EMPTY_LIST,type:l.E_SAPI_PLAYLIST,message:""}):(t.l.playlist.setPosition(0),t.setPlaylistPosition(0,t.l.playback.autoplay,a),void t.setContinuousPlay(!0))})),t.l.playback.autoplay&&(L&&L.startDebugMode(R.PERF.VP_CTRL_PREPARE_AUTOPLAY),t.play(a)),t.ef&&(t.ff(t.l.playlist.getCurrentItem()),delete t.ef),t.k.publish(c.API.PLAYER_RENDERED),t.Ha.setEndTime(c.Metrics.CREATE_RENDERER),L&&L.endDebugMode("VP_CTRL_RENDER"),t},n.prototype.af=function(){var e=this;if(h.mobile&&C.autoplaySupported)return e.l.setVolume(1),void e.l.setMute(!0);var t=1,r=!1,n=E.localStorage.get(N);n&&(t=n.volume,r=n.mute),null===e.l.getVolume()&&e.l.setVolume(t),null===e.l.getMute()&&e.l.setMute(r)},n.prototype.Ae=function(e){var t=this,r=t.l.getVolume();t.l.setVolume(e),e>0&&!t.l.muteMode&&t.l.setMute(!1),t.l.rendered&&t.m.setVolume(e),E.localStorage.put(N,{volume:e,mute:t.l.getMute()}),t.k.publish(c.CTRL_VOLUME,r)},n.prototype.Be=function(e){var t=this;t.l.muteMode&&t.l.getMute()||(t.l.setMute(e),t.l.rendered&&t.m.setMute(e),E.localStorage.put(N,{volume:t.l.getVolume(),mute:e}))},n.prototype.Qe=function(e){var t=this,r=t.l.playlist.getCurrentItem();t.m.setAudioLanguage(e),r&&r.setCurrLanguage(e)},n.prototype.Re=function(){var e=this;e.uc.updateMetadata()},n.prototype.De=function(e){var t=this,r=e.keyCode,n="key-"+r;32!==r&&38!==r&&40!==r||(e.preventDefault(),t.k.publish(c.API.UI_INTERACT,{srcElement:n}))},n.prototype.getModel=function(){var e=this;return e.l},n.prototype.getRootElement=function(){var e=this;return e.l.rendered?e.m.getRootElement():null},n.prototype.getCustomControlsNode=function(){var e=this;return e.l.rendered?e.m.getCustomControlsNode():null},n.prototype.getVideoElement=function(){var e=this;return e.l.rendered?e.m.getVideoElement():null},n.prototype.supportSendBeacon=function(){return!(h.ie||h.safari||h.ios)},n.prototype.saveResumeTime=function(e){var t=this;t.l.watchHistory.saveProgress(e,t.l.isPlaylistStructured())},n.prototype.ye=function(e){var t=this,r=t.l.playlist.getCurrentItem();L&&L.endDebugMode(R.PERF.VP_CTRL_FETCH_METADATA),t.gf(e),r&&e.indexOf(r.id)!==-1&&r.recoveryStatus!==d.ItemRecoveryStatus.RECOVERING&&t.ff(r)},n.prototype.gf=function(e){var t=this,r=[];t.bf&&(e.forEach(function(e){var n=t.l.mediaStore.get(e),i=n.isLive();r.push({clipId:n.id,clipDuration:n.duration,licenseId:n.license.licenseId,spaceId:n.metrics.pageSpaceId,playlistId:t.l.playlist.id,yvap:n.yvap,vrm:n.vrm,isLive:i,hasLiveMidrolls:i&&!!n.liveMidrollsMaxDur,liveMidrollsMaxDur:n.liveMidrollsMaxDur,rendererType:n.rendererType,useFlash:t.l.useFlash})}),t.bf.updateYVAPData(r))},n.prototype.ff=function(e){var t=this;if(e){if(e.streamProfiles&&e.streamProfiles.length){var r=e.streamProfiles[0],n="uplynk"===r.cdn&&r.live,i=h.win8||h.win7||h.winXP||h.winVista||!1,a=n&&i&&h.ie;a&&t.k.publish(c.ERROR,E.createErr("S",t.l.playbackState,l.E_PLAYER,l.PLAYER_CODES.E_FLASH_LIVE_NOT_SUPPORTED),!0)}if(e.license&&e.license.isDrm&&!E.isDrmSupported()&&t.k.publish(c.ERROR,E.createErr("P",t.l.playbackState,l.E_PLAYER_DRM,l.PLAYER_DRM_CODES.E_CONFIG),!0),!t.l.rendered)return void(t.ef=!0);if(e.hasLiveStreams()&&e.hasLiveStateForVod())return void t.k.publish(c.WARNING,E.createErr("P",t.l.playbackState,l.E_WARNING,l.WARNING_CODES.E_LIVE_PLAYBACK_COMPLETE),!0);var o=e.status.code,s=e.progress&&e.progress.position||t.l.playback.startTime;if(L&&L.startDebugMode(R.PERF.VP_CTRL_LOAD_METADATA),t.Xd(),e.state===d.ItemState.HAS_DATA){t.l.playbackState.attemptingPlayback()||t.Td||t.hf()||t.df(),t.bf&&t.bf.prepare(e);var u=function(){t.m.prepareNextRenderer({rendererType:e.rendererType,mediaItem:e,isRecovering:e.recoveryStatus===d.ItemRecoveryStatus.RECOVERING},function(r){return r?(t.if(),void(e.rendererType||t.k.publish(c.INFO,E.createErr("R",t.l.playbackState,l.E_PLAYER,l.E_PLAYER.E_NO_RENDERER_FOUND)))):(t.jf=!1,t.m.preloadNextRenderer({mediaItem:e,startTime:s})||t.k.publish(c.ERROR,E.createErr("S",t.l.playbackState,l.E_SAPI_STREAM,l.SAPI_CODES.E_NO_PLAYABLE_STREAMS)),t.l.playbackState.loadedItem=e,L&&L.endDebugMode(R.PERF.VP_CTRL_LOAD_METADATA),t.k.publish(c.MEDIA_ITEM_LOADED,e),void(t.Td=!1))})};t.l.ui.allowGeoRequest&&h.mobile?t.kf(e,function(){u()}):u()}else{if(t.l.playbackState.loadedItem=e,o&&o.length>0||(o=l.SAPI_CODES.E_NOT_FOUND),!t.lf(o)){var p=l.isInfoCode(o);o===l.INFO_CODES.E_SAPI_GEO_POSITION_REQUIRED?(e.setGeoRequired(!0),t.k.publish(p?c.INFO:c.ERROR,E.createErr("S",t.l.playbackState,p?l.E_INFO:l.E_SAPI_STREAM,o))):o===l.INFO_CODES.E_SAPI_RESTRICTED_NETWORK_TYPE?t.k.publish(p?c.INFO:c.ERROR,E.createErr("R",t.l.playbackState,l.E_SAPI_STREAM,o)):o===l.INFO_CODES.E_FLASH_RENDERER_NOT_SUPPORTED?t.k.publish(p?c.INFO:c.ERROR,E.createErr("R",t.l.playbackState,l.E_INFO,o)):t.k.publish(p?c.INFO:c.ERROR,E.createErr("S",t.l.playbackState,p?l.E_INFO:l.E_SAPI_STREAM,o))}L&&L.endDebugMode(R.PERF.VP_CTRL_LOAD_METADATA);var f=t.l&&t.l.playlist&&t.l.playlist.getCurrentItem(),v=f&&f.id,m=e&&e.id;m===v&&(t.k.publish(c.MEDIA_ITEM_LOADED,e),t.Td=!1)}}},n.prototype.kf=function(e,t){var r=this,n=/\/hlsfilter\//,i=/&geo-position=/;r.mf(e.id).then(function(t){var r="&"+E.querystring(t);return e.streams.forEach(function(e){n.test(e.url)&&!i.test(e.url)&&(e.url+=r)}),e.streamProfiles.forEach(function(e){n.test(e.url)&&!i.test(e.url)&&(e.url+=r)}),t}).then(t).catch(t)},n.prototype.mf=function(e){var t=this,r=h.tv?"tv-widget":h.mobile?"smartphone":"desktop";return new Promise(function(n,i){D.getXAuthParams(e,r).then(function(e){var r={};t.l.getGeoData(!1).then(function(t){if(t.errorCode)n(e);else{var i=t.latitude+";"+t.longitude+" epu="+t.accuracy;r["geo-position"]=i,r=Object.assign({},e,r),n(r)}})}).catch(function(){i({})})})},n.prototype.lf=function(e){return e===l.E_CMS_JSONP_REQUEST_FAILURE||e===l.E_CMS_JSONP_REQUEST_SILENT_FAIL||e===l.E_CMS_RESPONSE||e===l.E_CMS_JSONP_REQ_TIMEOUT||e===l.E_CMS_JSONP_REQ_TIMEOUT_SILENT_FAIL||e===l.E_CMS_XHR_REQ_CONNECTION_FAILED||e===l.E_CMS_XHR_REQ_CONNECTION_FAILED_TIMEOUT||e===l.E_CMS_XHR_RESPONSE_ABSENT||e===l.E_CMS_XHR_RESPONSE_ABSENT_TIMEOUT||e===l.E_CMS_XHR_REQ_LOAD_FAILED||e===l.E_CMS_XHR_REQ_LOAD_TIMEOUT||e===l.E_CMS_XHR_REQ_LOAD_408||e===l.E_CMS_XHR_REQ_INCOMPLETE||e===l.E_CMS_XHR_REQ_INCOMPLETE_TIMEOUT||e===l.E_CMS_XHR_REQ_408||e===l.E_CMS_XHR_REQ_ERROR||e===l.E_CMS_XHR_REQ_TIMEOUT},n.prototype.D=function(e){var t=this;t.cf||(t.cf=!0,t.k.publish(c.API.PLAYER_READY))},n.prototype.Ye=function(e,t){var r=this;if(e)r.l.playbackState.isVideoPlaying()&&r.nf();else if(t.playlist_pos===r.l.playlist.position){var n=r.l.playlist.getCurrentItem();r.l.getState()!==y.VIDEO||n.isLive()||r.seek(n.progress.position),r.play()}else if(g.isNumber(t.playlist_pos)&&"unknown"!==t.playlist_pos)r.setPlaylistPosition(t.playlist_pos,!0);else if(t.media_uuid){var i=r.l.playlist.items.indexOf(t.media_uuid);r.setPlaylistPosition(i>-1?i:0,!0)}else r.play();r.m.syncViewState()},n.prototype.Ze=function(){var e=this;e.l.playlist.position=e.l.playlist.items.length-1,e.le()},n.prototype.play=function(e,t){var r=this;if(r.l.rendered){if(r.Te.resumeStreaming(),r.l.castState&&r.l.castState.connected)return void r.Xe.play();if(!r.pf(e))return r.l.playback.autoplay=!1,r.l.ui.showStartScreen=!0,void r.m.syncViewState();if(r.l.playbackState.waitingForUserTap)return void(r.qf||(r.qf=r.k.once(c.TOUCH_TO_PLAY_RESTRICTION_REMOVED,function(){delete r.qf,r.play(e,t)})));var n=!!g.isNullOrUndefined(t)||t;if(r.l.isPaused()&&r.l.playbackState.isVpaidAdPlaying())return r.k.publish(c.RESUME_VPAID),void r.rf();if(!r.l.playbackState.attemptingPlayback()){var i=r.l.playlist.getCurrentItem();if(i){if(r.sf=null,e&&(r.l.playback.requestType=e.type,e.action&&E.isValidRequestAction(e.action)&&(r.l.playback.requestAction=e.action)),r.l.isPaused())return r.l.setState(y.VIDEO),void r.m.play();if(i.ageGate&&r.l.ui.showAgeGate)return void r.tf();if(r.l.ui.showAgeGate&&r.m.destroyAgeGateScreen(),r.Ha.add(c.Metrics.PLAYBACK_START),r.uf(),i===r.l.playbackState.loadedItem)r.l.setLoading(!0),r.setSelectedStreams(),r.k.publish(c.PLAYBACK_REQUEST,i.id),r.vf(i,n);else if(h.mobile&&!C.autoplaySupported)r.k.publish(c.INFO,E.createErr("C",r.l.playbackState,l.E_WARNING,l.PLAYER_CODES.E_NATIVE_PREMATURE_PLAY,"Cannot play before metadata is available"));else{r.l.setState(y.WAITING),r.l.setLoading(!0);var a=r.k.subscribe(c.MEDIA_ITEM_LOADED,function(t){if(t===i){if(a(),!r.pf(e))return r.l.playback.autoplay=!1,r.l.ui.showStartScreen=!0,void r.df();if(r.setSelectedStreams(),i.ageGate&&r.l.ui.showAgeGate)return r.l.setState(y.INIT),void r.tf();r.k.publish(c.PLAYBACK_REQUEST,i.id),r.vf(i,n)}})}r.m.syncViewState()}}}},n.prototype.pf=function(e){var t=this;if(!t.Vd)return!0;e=e||{};var r=t.getCurrentMediaItem();return!(e.type===T.AUTOPLAY&&t.l.playback.autoplay&&r&&r.blockAutoplay)&&(!h.mobile||t.wf(e))},n.prototype.wf=function(e){var t=this,r=e.type===T.CLICK;return!(!r&&!t.l.isAutoplayAllowed())},n.prototype.setSelectedStreams=function(){var e=this,t=e.l.playlist.getCurrentItem();t&&t.selectedStreams&&0===t.selectedStreams.length&&t.streams.length&&e.m.setSelectedStreams(t.streams)},n.prototype.vf=function(e,t){var r=this,n="start";if(e===r.l.playlist.getCurrentItem()&&!r.hf()){e.restartIfNeeded(),r.l.playbackState.hasStartedPlayback=!0;var i=function(t){L&&L.startDebugMode(R.PERF.VP_CTRL_PREPARE_START),r.getAutoplay()||r.xf||(r.xf=!0,r.Ha.add(c.Metrics.CLICK_TO_START));var n=r.l.playback.startTime||0;e.isLongForm()&&isNaN(r.l.playback.startTime)&&e.progress.position>0&&(r.l.playback.isResume=!0,n=e.progress.position);var i=!1;t&&(i=r.yf(t)),r.m.switchAndPlayNextRenderer(n,i),r.l.playback.fullscreen&&r.m.setFullscreen(!0)},a=function(){r.l.setState(y.VIDEO),r.uf(),r.l.setLoading(!0),r.m.syncViewState()};r.Vd=!1,r.bf&&t?(L&&L.endDebugMode(R.PERF.VP_CTRL_PREPARE_AUTOPLAY),r.bf.maybePlay(n,function(t,n){a(),t||n?(r.Ha.add(c.Metrics.PLAYBACK_START),r.m.prepareNextRenderer({rendererType:e.rendererType,mediaItem:e},function(t){r.m.preloadNextRenderer({mediaItem:e}),i(n)})):i()})):(L&&L.endDebugMode(R.PERF.VP_CTRL_PREPARE_AUTOPLAY),a(),i())}},n.prototype.oe=function(){var e=this;e.zf(),e.Af()},n.prototype.zf=function(){var e=this,t=e.l.playlist.getCurrentItem();e.m.didRendererTimeOut()||e.Bf||"error"===t.state||(e.Bf=setTimeout(function(){e.k.publish(c.API.PLAYBACK_TIMEOUT,E.createErr("P",e.l.playbackState,l.E_WARNING,l.WARNING_CODES.E_PLAYBACK_TIMEOUT,"No playback after 10 seconds of requesting to play on player"))},P))},n.prototype.Pe=function(){var e=this;e.Cf.recover(e.Cf.RECOVERY_STATES.RESUME)},n.prototype.Af=function(){var e=this,t=e.l.playlist.getCurrentItem();t&&t.rendererType===I.HTML5_HLS&&e.k.publish(c.CONVIVA_READY_FOR_SESSION_CREATION,t)},n.prototype.if=function(){var e=this;e.Bf&&clearTimeout(e.Bf)},n.prototype.qe=function(){var e=this;e.jf||(e.k.publish(c.API.VIDEO_STARTED),e.jf=!0),e.if()},n.prototype.pause=function(e){var t=this;if(t.l.rendered){var r=t.l.castState;r&&r.connected?!r.paused&&t.Xe.pause():"function"==typeof t.qf?(t.qf(),delete t.qf):(e&&(t.l.playback.requestType=e.type,e.action&&E.isValidRequestAction(e.action)&&(t.l.playback.requestAction=e.action)),t.nf())}},n.prototype.nf=function(){var e=this;e.l.playbackState.isVpaidAdPlaying()?(e.k.publish(c.PAUSE_VPAID),e.ge()):e.l.playbackState.attemptingPlayback()&&(e.m.pause(),e.if(),!e.l.isLoading()&&e.Te.scheduleSuspend())},n.prototype.seek=function(e){var t=this;t.l.rendered&&(t.l.castState&&t.l.castState.connected?t.Xe.seek(e):t.l.getState()===y.VIDEO&&t.m.seek(e))},n.prototype.recover=function(){var e=this;e.Cf&&e.Cf.recover()},n.prototype.preload=function(e){var t=this;if(t.l.rendered){var r=t.l.playlist.getCurrentItem();g.isNumber(e)&&r&&e>0&&e<=r.duration&&t.m.preload(e)}},n.prototype.disableControls=function(){var e=this;e.l.rendered&&e.m.disableControls()},n.prototype.enableControls=function(){var e=this;e.l.rendered&&e.m.enableControls()},n.prototype.enableCC=function(e){var t=this;t._e&&t._e.enable(e)},n.prototype.disableCC=function(){var e=this;e._e&&e._e.disable()},n.prototype.isPlaying=function(){var e=this;return e.l.getState()===y.VIDEO&&!e.l.isPaused()},n.prototype.isLoading=function(){var e=this;return e.l.playbackState.videoLoading()},n.prototype.endVideo=function(){var e=this;if(e.l.rendered){var t=e.l.playlist.getCurrentItem();t&&(t.progress.position=0),e.l.endVideo(),e.m.endVideo()}},n.prototype.getOpenSimSim=function(){var e=this;return e.l.rendered?e.m.getOpenSimSim():null},n.prototype.setFullscreen=function(e){var t=this;t.l.rendered&&t.m.setFullscreen(e)},n.prototype.getFullscreen=function(){var e=this;return!!e.l.rendered&&e.m.getFullscreen()},n.prototype.setVolume=function(e){var t=this;t.k.publish(c.CONTROLS_SET_VOLUME,e)},n.prototype.getVolume=function(){var e=this;return e.l.getVolume()},n.prototype.getCurrentTime=function(){var e=this;return e.l.rendered?e.m.getCurrentTime():0},n.prototype.setMute=function(e){var t=this;t.k.publish(c.CONTROLS_SET_MUTE,e)},n.prototype.getMute=function(){var e=this;return e.l.getMute()},n.prototype.setLoop=function(e){var t=this;t.l.setLoop(e)},n.prototype.setContinuousPlay=function(e){var t=this;t.l.playback.continuousPlay=e},n.prototype.getContinuousPlay=function(){var e=this;return e.l.playback.continuousPlay},n.prototype.setSkipWatchedVideos=function(e){var t=this;t.l.playback.skipWatchedVideos=e},n.prototype.getSkipWatchedVideos=function(){var e=this;return e.l.playback.skipWatchedVideos},n.prototype.resumeContinuousPlay=function(e){var t=this;t.setContinuousPlay(!0);var r={skipWatchedVideos:t.l.playback.skipWatchedVideos};if(t.l.getState()===y.END){var n=t.l.playlist.getNextPosition(t.l.playback.continuousPlay,t.l.getLoop(),r);n!==-1&&t.setPlaylistPosition(n,!0,e)}},n.prototype.getAutoplay=function(){var e=this;return e.l.playback.autoplay},n.prototype.getMediaStore=function(){var e=this;return e.l.mediaStore},n.prototype.getPlaybackState=function(){var e=this;return e.l.getState()},n.prototype.getCurrentMediaItem=function(){var e=this;return e.l.playlist.getCurrentItem()},n.prototype.getPlaylistItems=function(){var e=this;return e.l.playlist.items},n.prototype.getPlaylist=function(){var e=this;return e.l.playlist},n.prototype.isRendered=function(){var e=this;return e.l.rendered},n.prototype.ue=function(e){var t=this;t.l.uiState.width=e.width,t.l.uiState.height=e.height;var r;t.m&&(r=t.m.getVideoDimension(),t.l.uiState.videoWidth=r.width,t.l.uiState.videoHeight=r.height)},n.prototype.Ne=function(e){var t=this,r=e.active;t.Wd&&t.Wd.setActiveRenderer(r)},n.prototype.se=function(e,t){var r,n=this,i=n.l.playlist.getCurrentItem();if(t){t.cdn=E.getMediaCDNName(i,e,t.selectedStreamUrl),t.url=t.selectedStreamUrl;var a=[t];r=a}else{for(var o=e.length,s=0;s<o;s++)e[s].cdn=E.getMediaCDNName(i,e,null);r=e}i.fillSelectedStreams(r,null)},n.prototype.hf=function(){for(var e,t,r=this,n=r.l.errors,i=n.length,a=0;a<i;a++)if(e=n[a].category,t=n[a].subcategory,
e||t)return i>1&&t===l.INFO_CODES.E_SAPI_GEO_POSITION_REQUIRED?n[a+1]:n[a];return null},n.prototype.Zd=function(){var e=this;h.mobile&&C.autoplaySupported&&e.l.playbackState.mute&&!e.l.muteMode&&e.k.publish(c.CONTROLS_SET_MUTE,!1),e.k.publish(c.CTRL_PLAYREQUEST,"ctp"),e.Ha.add(c.Metrics.HLS_FIRST_TS_LOAD_START);var t={type:T.CLICK,action:T.CLICK};e.play(t)},n.prototype.ee=function(){var e=this;if(h.mobile&&C.autoplaySupported&&e.l.isMobileStrmInlineExpr()&&(e.l.baseConfig.strmExprUnMuteOnClick?e.l.getMute()&&e.setMute(!1):e.m.pause()),e.k.publish(c.API.UI_INTERACT,{srcElement:"video-click"}),h.desktop&&e.m.controls)if(e.l.playbackState.rendererType===I.FLASH||e.l.playbackState.rendererType===I.FLASH_SIMPLE){var t=e.l.isPaused()?"play":"pause";e.k.publish(c.CTRL_PLAYPAUSE,t),e.m.setKeyboardFocus()}else e.ed()},n.prototype.$d=function(e,t,r){var n=this,i=n.l.playlist,a="next-vid-",o={srcElement:a+t},s=n.getCurrentMediaItem();s&&s.isWatched()&&(n.setSkipWatchedVideos(!1),n.setContinuousPlay(!0));var l,u=t===-1?c.CTRL_REPLAY:c.CTRL_ENDSCREEN_VID;t===-1&&(o.srcElement="es-rpl"),t>-2&&n.k.publish(c.API.UI_INTERACT,o),n.k.publish(u,{vid:e,vindex:t});var p={type:T.CONTINUOUS,action:r?T.AUTOPLAY:T.CLICK};l=i.getItemPosition(e),n.setPlaylistPosition(l,!0,p)},n.prototype._d=function(e,t,r){var n=this,i=function(e,t){var i=[];t||(t=[]),t&&t.length>0&&(i=t.map(function(e){return n.getPlaylistItems().indexOf(e)<0&&n.l.playlist.appendItem(e),n.l.mediaStore.get(e)})),r&&r(e,i)};n.uc.getRelatedVideosChannel(e,t,i)},n.prototype.setPlaylistPosition=function(e,t,r){var n=this;n.Df(),n.l.errors=[],n.l.playbackState.criticalError=null,n.l.playbackState.isAdPlaying()&&n.bf.cancelAd();var i=n.l.playlist,a=i.getCurrentItem();n.endVideo(),n.Cf&&n.Cf.stopTimers(),i.position=e;var o=i.getCurrentItem();n.l.playbackState.looped=!1,n.l.playback.startTime=NaN,n.l.rendered&&(o?(n.Ha.add(c.Metrics.INIT_CONT_PLAY_START),n.m.resetState(),n.k.publish(c.API.PLAYLIST_POSITION_CHANGE,i.position),n.df(),n.Ue(o),o.fetchFinished()&&n.ff(o)):t=!1,o&&"error"!==o.state?t&&n.play(r):(null!==a&&n.Ef(a),n.Ff()))},n.prototype.setContentHeightForNFL=function(){var e=this,t=e.l.playlist.getCurrentItem(),r=t?t.provider:null;r&&"video.nflhighlights.com"===r.providerId&&e.m.Gf()},n.prototype.sendPrefetchInfo=function(e){var t=this,r={url:e.url,source:e.source,latency:e.latency||"na",http_code:e.http_code||"na",resp_len:e.resp_len||"na",instrument:e.instrument||"na",perfInfo:e.perfInfo||"na",perfStack:e.perfStack||"na"};return!(!r.source||!r.url)&&(t.k.publish(c.API_CALLED,r),!0)},n.prototype.Ef=function(e){var t=this;t.m.setFullscreen(!1),t.l.playbackState.previousItem=e,t.l.setState(y.END),t.uf(),t.m.syncViewState()},n.prototype.df=function(){var e=this;e.l.setState(y.INIT),e.uf(),e.m.syncViewState()},n.prototype.uf=function(){var e=this;e.l.setPaused(!1),e.l.setSeeking(!1),e.l.setLoading(!1)},n.prototype.removePlaylistItems=function(e,t){var r=this,n=r.l.playlist;n.items.splice(e,t),n.position>=e+t?n.position-=t:e<=n.position&&n.position<e+t&&r.setPlaylistPosition(-1)},n.prototype.prefetch=function(e){var t=this,r=!(t.l.playlist.getCurrentItem().id in e);t.uc.prefetch(e,r)},n.prototype.me=function(e){var t=this;t.k.publish(c.PLAYBACK_ERROR,e)},n.prototype.tb=function(e){var t=this;if(!t.Cf||t.Cf.shouldRenderErrorScreen(e)){t.k.publish(c.ERR_NO_RECOVERY,e);try{throw new Error("Stack Trace")}catch(e){b.error(e.stack)}t.l.errors.push(e),t.Hf(function(){var e=t.hf();e&&(t.if(),t.If(e),t.l.playbackState.criticalError=e,t.l.setState(y.END),t.disableCC(),t.uf(),t.m.syncViewState(),t.Wd.reportCriticalError(e.errorInfo.msg))})}},n.prototype.Yd=function(e,t){var r=this;t&&r.tb(e)},n.prototype.Ge=function(e){var t=this;t.k.publish(c.WARNING,E.createErr("P",t.l.playbackState,l.E_WARNING,l.PLAYER_CODES.E_PLAYER_PTS_DISCONTINUITY,null,"consecutive frame time diference is "+e))},n.prototype.If=function(e){var t=this,r=function(){!E.isFlashInstalled()&&h.desktop&&(e.category=l.E_PLAYER,e.subcategory=l.PLAYER_CODES.E_PLAYER_NOT_ENABLED)};switch(e.category){case l.E_SAPI_ABSTRACT:case l.E_SAPI_STREAM:case l.E_SAPI_PLAYLIST:case l.E_SAPI_RELATED:case l.E_SAPI_POPULAR:var n=l.SAPI_CODES,i=l.INFO_CODES;switch(e.subcategory){case n.E_EXTERNAL_NO_STREAMS:var a=t.l.playlist.getCurrentItem();a&&a.shareUrl&&E.redirect(a.shareUrl,!0);break;case i.E_SAPI_UNSUPPORTED_LIVE_ON_HTML:h.android?(e.category=l.E_INFO,e.subcategory=i.E_PLAYER_ANDROID_CHROME_REQUIRED):r();break;case n.E_DRM_RESTRICTED:h.desktop&&r()}break;case l.E_PLAYER:switch(e.subcategory){case l.PLAYER_CODES.E_NATIVE_ENCRYPT_MEDIA:e.category=l.E_PLAYER_DRM,e.subcategory=l.PLAYER_DRM_CODES.E_EME_MISSING}}},n.prototype.tf=function(){var e=this;e.Jf||(e.Jf=new s(e.k,e.l,e.m,e,e.uc)),e.Jf.run()},n.prototype.ze=function(){var e=this;e.Jf&&e.Jf.isWaitingAuthentication()&&e.tf()},n.prototype.Kf=function(e){var t=this;t.ifPlaybackProgressCalled=!1,t.k.publish(c.PLAYBACK_STARTED,e.id,t.m.getCurrentTime()),t.Ve[e.id]=!0,t.l.playback.startTime=NaN,t.Lf&&(t.Lf.destroy(),t.Lf=null),e.allowedConnectionTypes&&(t.Lf=new p(t.uc,e),t.Mf())},n.prototype.fe=function(){var e=this,t=e.l.playlist.getCurrentItem();e.l.playbackState.videoLoading()&&(h.android||e.Nf(!1)),e.l.isPaused()&&(e.Ud&&(clearTimeout(e.Ud),e.Ud=null),e.k.publish(c.PLAYBACK_RESUMED,t.id),e.rf()),e.Ve[t.id]||e.Kf(t)},n.prototype.Df=function(){var e=this;e.Ve={}},n.prototype.A=function(e,t,r){var n=this;h.android&&!n.ifPlaybackProgressCalled&&(n.Nf(!1),n.ifPlaybackProgressCalled=!0);var i=n.l.playlist.getCurrentItem();if(i){i.progress.position=Math.floor(e);var a=1.5,o=n.m.getClientVideoDimension();n.l.playerDimension.width!==o.width&&n.l.playerDimension.height!==o.height&&(n.l.playerDimension.width=o.width,n.l.playerDimension.height=o.height,n.k.publish(c.PLAYER_DIMENSION_CHANGE,{width:n.l.playerDimension.width,height:n.l.playerDimension.height})),n.k.publish(c.PLAYBACK_PROGRESS,i.id,e,t,r),!g.isNumber(e)||!g.isNumber(t)||e>t+1||(i.isCCM||null!==i.duration||i.isLive()||(i.duration=t),n.l.isLoading()&&(!h.safari||h.safari<6)?n.sf?e-n.sf>=a&&(n.sf=null,n.Nf(!1)):n.sf=e:n.sf=null,i.isLive()||(n.l.castState&&n.l.castState.connected||n.Of(i),!(i.isLongForm()||n.l.isPlaylistStructured()&&!i.isBumper())||i.progress.position%10!==0||n.l.isSeeking()||n.l.playbackState.ad||n.saveResumeTime(i)))}},n.prototype.Me=function(e){var t=this;if(e)if(e.COMMAND){var r={command:e.COMMAND.toLowerCase(),duration:e.DURATION,adBreakNumber:e["BREAK-NO"],adId:e["AD-ID"],adLabel:e["AD-LABEL"]};switch(r.command){case R.CUEOUT_COMMANDS.LOAD:t.bf.cueLoadAds(r);break;case R.CUEOUT_COMMANDS.PLAY:r.duration=1e3*r.duration,t.Ke(r)}}else"cue_out"===e.type&&void 0!==e.duration&&t.Ke(1e3*e.duration)},n.prototype.Ke=function(e){var t=this,r="object"==typeof e?e:{duration:e};r.duration=parseInt(r.duration,10),r.duration=isNaN(r.duration)?null:r.duration/1e3,t.Of(t.l.playlist.getCurrentItem(),r)},n.prototype.Of=function(e,t){var r=this,n=e.progress.position,i={currentTime:n,isLive:e.isLive(),adDuration:t&&t.duration,adBreakMeta:t&&t.adLabel?t:null};r.bf&&r.bf.maybeAdBreak(i,function(t,i,a){if(t){r.l.setState(y.VIDEO),r.uf(),r.l.setLoading(!0);var o=!1;i&&(o=r.yf(i)),r.m.prepareNextRenderer({rendererType:e.rendererType,mediaItem:e},function(t){r.m.preloadNextRenderer({mediaItem:e}),r.m.switchAndPlayNextRenderer(n,o),e.progress.adbreaks[a]=(new Date).getTime()})}})},n.prototype.Mf=function(e){var t=this;t.Lf&&(e||(e=18e4),t.Lf.scheduleVerification(function(e){return e===!1?void t.k.publish(c.INFO,E.createErr("R",t.l.playbackState,l.E_SAPI_STREAM,l.INFO_CODES.E_SAPI_RESTRICTED_NETWORK_TYPE)):void t.Mf()},e))},n.prototype.yf=function(e){return!1},n.prototype.Le=function(e){var t=this;t.l.playbackState.isAdPlaying()&&t.bf&&t.bf.maybeEndAdBreak("cuein",e)},n.prototype.ae=function(){var e=this;e.l.castState&&e.l.castState.connected||e.l.isSeeking()||(e.l.setSeeking(!0),e.m.syncViewState())},n.prototype.be=function(){var e=this;e.l.castState&&e.l.castState.connected||e.l.isSeeking()&&(e.l.isPaused()||e.m.play(),e.l.setSeeking(!1),e.m.syncViewState())},n.prototype.ce=function(e){var t=this;t.l.castState&&t.l.castState.connected||t.m.seek(e)},n.prototype.ge=function(){var e=this;e.l.getState()!==y.INIT&&e.l.getState()!==y.END&&(e.l.setPaused(!0),e.m.syncViewState())},n.prototype.rf=function(){var e=this;e.l.setPaused(!1),e.m.syncViewState()},n.prototype.le=function(){var e=this;e.Df(),e.Lf&&(e.Lf.destroy(),e.Lf=null);var t=e.l.playlist,r=t.getCurrentItem();if(r){var n=e.l.playback.continuousPlay,i=e.l.getLoop(),a=e.l.playback.playlistLoop,o={playlistLoop:a,skipWatchedVideos:e.getSkipWatchedVideos()},s=t.getNextPosition(n,i,o);e.k.publish(c.PLAYBACK_ENDED,r.id,o.ended);var l=e.l.ui.stopAtLastFrame;if(l)return e.m.pause(),void e.ge();var u=function(){if(r.progress.position=0,!r.isLongForm()||e.l.isSeeking()||e.l.playbackState.ad||e.saveResumeTime(r),s!==-1){if(n||i)var t={type:T.CONTINUOUS,action:T.AUTOPLAY};e.setPlaylistPosition(s,n||i,t),e.l.playbackState.looped=o.looped}else e.getSkipWatchedVideos()&&e.setContinuousPlay(!1),e.Ef(r),e.k.publish(c.API.PLAYLIST_COMPLETE)};e.bf?e.bf.maybePlay("end",u):u()}},n.prototype.je=function(){var e=this;e.Nf(!0)},n.prototype.ke=function(){var e=this;e.Nf(!1),e.k.publish(c.API.PLAYBACK_SEEK_COMPLETE),e.sf=null},n.prototype.Ce=function(e){var t=this;t.l.playback.bitrate=e},n.prototype.error=function(e){var t=this;e&&t.k.publish(c.ERROR,E.createErr("C",t.l.playbackState,e.type,e.code,e.msg))},n.prototype.ve=function(){var e=this;e.Nf(!0)},n.prototype.we=function(){var e=this;e.Nf(!1)},n.prototype.xe=function(){return!1},n.prototype.Nf=function(e){var t=this;t.l.setLoading(e),t.m.syncViewState()},n.prototype.Ee=function(e){var t=this;t.m.setQuality(e)},n.prototype.Fe=function(e,t){var r=this;r.l.playback.bitrates=e,r.l.playback.heights=t},n.prototype.He=function(e){var t=this;t.l.isLoading()||(t.l.setLoading(!0),t.m.syncViewState()),t.uc.updateMetadata(e)},n.prototype.Ie=function(){var e=this,t=e.l.getState();e.m.getCurrentTime()>0&&(e.l.playback.startTime=e.m.getCurrentTime()),e.pause(),e.m.stopMedia(),e.ff(e.l.playlist.getCurrentItem()),e.l.setLoading(!1),e.m.syncViewState(),e.l.setState(y.INIT),e.l.playlist.getCurrentItem().recoveryStatus=d.ItemRecoveryStatus.RECOVERED,t===y.VIDEO&&e.play(null,!1)},n.prototype.Je=function(e){var t=this;t.uc.fillFromER(e),t.Ie()},n.prototype.ne=function(e){var t=this;if(!h.tv){var r=e&&e.value;if(t.Nf(r),r&&!e.ignoreBuffering)t.Ha.add(c.Metrics.PLAYBACK_STALLED);else if(!e.ignoreBuffering){t.Ha.setEndTime(c.Metrics.PLAYBACK_STALLED);var n=t.Ha.getItem(c.Metrics.PLAYBACK_STALLED);n&&t.k.publish(c.PLAYBACK_STALLED,n.timeDiff?n.timeDiff/1e3:"")}}var i=e&&e.value===!0?c.API.BUFFERING_START:c.API.BUFFERING_END;t.k.publish(i)},n.prototype.isDocked=function(){var e=this;return!!e.l.rendered&&e.m.isDocked()},n.prototype.updateDockingConfig=function(e,t,r,n,i,a){var o=this;o.l.rendered&&o.m.updateDockingConfig(e,t,r,n,i,a)},n.prototype.dockVideoPlayer=function(){var e=this;e.l.rendered&&e.m.dockVideoPlayer()},n.prototype.undockVideoPlayer=function(e){var t=this;t.l.rendered&&t.m.undockVideoPlayer(e)},n.prototype.updateRapidConfig=function(e){var t=this;t.l.updateRapidConfig(e),t.Wd&&t.Wd.loadRapidConfigFromModel()},n.prototype.updatePageSpaceId=function(e){var t=this;t.l.updatePageSpaceId(e)},n.prototype.destroy=function(){var e=this;e.m&&e.m.destroy(),e.Ff(),e.Te.destroy(),e.uc&&e.uc.destroy(),e.k&&e.k.destroy(),e._e&&e._e.destroy(),e.bf&&e.bf.destroy(),e.Wd&&e.Wd.destroy(),e.l&&e.l.destroy(),e.We&&e.We.destroy(),e.Lf&&(e.Lf.destroy(),e.Lf=null)},n.prototype.Ff=function(){var e=this;e.Cf&&(e.Cf.destroy(),e.Cf=null)},n.prototype.Xd=function(){var e=this;e.Cf||E.isInternalUser()&&!e.l.enableRecovery||(e.Cf=new S(e.k,e.l))},n.prototype.Hf=function(e){var t=this,r=t.l&&t.l.playlist&&t.l.playlist.getCurrentItem();r&&r.is360Video()&&(t.l.skipOnError="timebased");var n=t.l.skipOnError;switch(n){case"always":t.Pf(e);break;case"timebased":e(),setTimeout(function(){t.Pf()},k);break;case"never":e();break;default:e()}},n.prototype.Pf=function(e){var t=this,r=t.l.playlist.getNextPosition(!0,t.l.getLoop()),n=t.l.playlist.position,i=t.l.playback.autoplay||t.l.playback.continuousPlay&&t.l.playbackState.hasStartedPlayback;if(r===-1||r===n){var a=t.l.playlist.getCurrentItem();if(!a)return void(e&&e());t._d(a,{videoUuid:a.id,playlistId:t.l.ui.playlistUI.playlistId},function(a,o){r=t.l.playlist.getNextPosition(!0,t.l.getLoop()),a||r===-1||r===n?e&&e():(t.setPlaylistPosition(r,i),t.m.syncViewState())})}else t.setPlaylistPosition(r,i),t.m.syncViewState()},n.prototype.Oe=function(e){var t=this,r=!0;if(e){var n,i=t.l.playlist,a=i.getCurrentPosition(),o=i.getNextPosition(r,t.l.getLoop());o!==-1?o!==a&&(n=i.getMediaItemAt(o),n&&(n.mayUpdateVideoSession(),t.k.publish(c.RENDERER_PP_NEXT,n))):t.m.maybeFetchMoreVideos(function(){var e,n=t.l.playlist,i=n.getCurrentPosition(),a=n.getNextPosition(r,t.l.getLoop());a!==-1&&a!==i&&(e=n.getMediaItemAt(a),e&&(e.mayUpdateVideoSession(),t.k.publish(c.RENDERER_PP_NEXT,e)))})}},n.prototype.setStartTime=function(e){var t=this;t.l.playback.startTime=e},n.prototype.getCurrentDate=function(){var e=this;return e.m.getCurrentDate()},n.prototype.updateGeoConfig=function(e){var t=this;t.l.updateGeoConfig(e)},n.prototype.suspendStreaming=function(){var e=this;e.m.suspendStreaming()},n.prototype.resumeStreaming=function(){var e=this;e.m.resumeStreaming()},n.prototype.Se=function(){var e=this;e.l.setPaused(!0),e.l.setLoading(!1),e.m.syncViewState()}},{"../../lib":"/lib/index.js","../../lib/logger":"/lib/logger.js","./ads-controller":3,"./age-gate-controller":4,"./cast-controller":6,"./cc":"/nextgen/src/cc.js","./constants":7,"./darla-controller":9,"./error":12,"./event":"/nextgen/src/event.js","./gps-util":14,"./media-store":18,"./metadata-fetcher":"/nextgen/src/metadata-fetcher.js","./metrics/metrics":22,"./metrics/metrics-constants":21,"./model":25,"./navigator-info":26,"./network-restriction-verifier":27,"./pause-handler":28,"./perf":29,"./profiler":31,"./recoverer":32,"./renderers/type":44,"./states":46,"./util":"/nextgen/src/util.js","./view":48,"user-agent":233}],9:[function(e,t,r){"use strict";function n(e){var t=this;t.Qf={},t.k=e,t.Rf=!1,t.Xa=function(e){var t,r=!1;if(e=e||window,e.parent==window.top)try{t=e&&e.$sf&&e.$sf.ext,t&&("function"!=typeof t.register&&"function"!=typeof t.supports||(r=!0))}catch(e){r=!1}return r}(),t.Xa&&(t.Qf[i.AD_PLAYBACK_STARTED]=t.k.subscribe(i.AD_PLAYBACK_STARTED,t.Sf,t),t.Qf[i.PLAYBACK_ENDED]=t.k.subscribe(i.PLAYBACK_ENDED,t.Tf,t))}t.exports=n;var i=e("./event");e("../../lib/logger");n.prototype.destroy=function(){var e=this;for(var t in e.Qf)if(e.Qf.hasOwnProperty(t))try{e.Qf[t]()}catch(e){}},n.prototype.Sf=function(){var e=this;if(e.Xa&&!e.Rf){try{Y.SandBox.vendor.video(!0)}catch(e){}e.Rf=!0}},n.prototype.Tf=function(){var e=this;if(e.Xa){if(e.Rf)try{Y.SandBox.vendor.video(!1)}catch(e){}e.Rf=!1}}},{"../../lib/logger":"/lib/logger.js","./event":"/nextgen/src/event.js"}],10:[function(e,t,r){"use strict";function n(e,t){var r=this;r.Db=t,r.Uf=[],r.Vf=e,r.Wf(),r.Xf()}t.exports=n;var i=(e("../../lib/logger"),{UP:"up",DOWN:"down",LEFT:"left",RIGHT:"right",TAP:"tap"}),a={AD:[{combination:[38,38,40,40,191],alt:!0},{combination:[40,40,38,38,37,39,37,39]}],NORMAL:[{combination:[79,80,69,78,83,73,77,83,73,77]},{combination:[79,80,83,83]},{combination:[37,37,39,39,13],alt:!0},{combination:[38,38,40,40,37,39,37,39]}]},o={AD:[i.LEFT,i.RIGHT,i.UP,i.DOWN,i.TAP,i.TAP,i.TAP],NORMAL:[i.UP,i.DOWN,i.LEFT,i.RIGHT,i.TAP,i.TAP]};n.prototype.Xf=function(){var e=this,t=[],r=0,n=0,i=a[e.Vf];i.forEach(function(e){e.length=e.combination.length,e.value=e.length?e.combination.toString():null,e.length>r&&(r=e.length)}),e.De=function(a){n=a.altDown||a.altKey?n+1:0,t.push(a.keyCode),t.length>r&&t.shift();var o=i.some(function(e){var r=t.slice(Math.max(t.length-e.length,0)).toString(),i=r===e.value;return e.alt?i&&n>e.length:i});o&&e.Db(),"AD"===e.Vf},document.addEventListener("keydown",e.De,!1)},n.prototype.Wf=function(){var e=this,t=o[e.Vf];e.Yf=function(t){e.Zf=t.changedTouches[0].pageX,e.$f=t.changedTouches[0].pageY,e._f=0,e.ag=0},document.addEventListener("touchstart",e.Yf,!1),e.cg=function(t){if(1===t.touches.length){var r=t.touches[0];e._f=r.pageX,e.ag=r.pageY}},document.addEventListener("touchmove",e.cg,!1),e.dg=function(){var r;if(e._f||e.ag){var n=Math.abs(e.Zf-e._f),a=Math.abs(e.$f-e.ag);r=n>a?e.Zf-e._f<0?i.RIGHT:i.LEFT:e.$f-e.ag<0?i.DOWN:i.UP}else r=i.TAP;e.Uf.push(r),e.Uf.length>t.length&&e.Uf.shift(),e.Uf.length===t.length&&e.Uf.every(function(e,r){return e===t[r]})&&e.Db()},document.addEventListener("touchend",e.dg,!1)},n.prototype.destroy=function(){var e=this;document.removeEventListener("keydown",e.De,!1),document.removeEventListener("touchstart",e.Yf,!1),document.removeEventListener("touchmove",e.cg,!1),document.removeEventListener("touchend",e.dg,!1)}},{"../../lib/logger":"/lib/logger.js"}],11:[function(e,t,r){"use strict";function n(e,t){var r=this;r.k=e,r.l=t,r.init()}var i=e("./event"),a=e("./error"),o=e("./util"),s=(e("../../lib/logger"),e("./media-store")),l=2e4,c="https://nflstream.yahoo.com/streams/{uuid}",u="_",p=1,d=2;n.prototype.init=function(){var e=this;e.eg=null,e.fg=!1,e.gg=e.l.failOver&&e.l.failOver.sapiUrl;var t=e.l.playlist.getCurrentItem();e._=t&&t.isLive(),e.hg=e._||t&&t.state!==s.ItemState.HAS_DATA,e.ig=e.hg&&e.jg()||null,e.kg=e.mg(),e.kg},n.prototype.mg=function(){var e=this;if(e.gg)return e.l.failOver.sapiUrl.replace(new RegExp("{uuid}"),e.l.playlist.getCurrentItem().id);if(e.hg&&e.ig){var t=Math.floor(Math.random()*d)+1;return e.ig.replace(new RegExp("_1"),u+t)}},n.prototype.jg=function(){var e=this;if(e.gg)return null;var t=e.l.playlist.getCurrentItem();return t?c.replace(new RegExp("{uuid}"),t.id)+u+p:null},n.prototype.getRecord=function(){var e=this;if(e.eg)return void e.k.publish(i.ER_READY,e.eg);if(!e.fg){if(!e.kg)return void e.k.publish(i.ER_ERROR);e.ng(e.kg,!0),e.fg=!0}},n.prototype.og=function(e,t){var r=this;r.pg("success "+t),r.eg=e,r.k.publish(i.ER_READY,r.eg),r.fg=!1},n.prototype.qg=function(e,t,r){var n=this;return r=r===!0,r&&n.ig?void n.ng(n.ig,!1):(n.pg("failure "+t),n.k.publish(i.ER_ERROR),void(n.fg=!1))},n.prototype.ng=function(e,t){var r=this,n={context:r,timeout:l,responseTypeJson:!0,jsonpHandler:function(){},successHandler:function(t){r.og(t,e)},failureHandler:function(n){r.qg(n,e,t)}};o.ajax(e,n)},n.prototype.pg=function(e){var t=this;t.k.publish(i.WARNING,o.createErr("P",t.l.playbackState,a.E_WARNING,a.WARNING_CODES.E_ER_TRY,null,e))},n.prototype.isActive=function(){var e=this;return!!e.kg},n.prototype.destroy=function(){var e=this;e.eg=null,e.fg=!1,e.ig=null,e.kg=null},t.exports=n},{"../../lib/logger":"/lib/logger.js","./error":12,"./event":"/nextgen/src/event.js","./media-store":18,"./util":"/nextgen/src/util.js"}],12:[function(e,t,r){"use strict";function n(e){return e.group+e.phase+"-"+e.category+"-"+e.subcategory}function i(e,t,r,n,i){var a=this;if(!e||!t||!r)throw"Error must be created with a group, category, and subcategory!";a.errorInfo=n,a.userAgent=i,a.group=e,a.phase=a.rg(n),a.category=t,a.subcategory=r,a.sg=n?n.msg:null,a.debugMessage=n?n.debugMsg:null,a.prefetch=!(!n||void 0===n.prefetch)&&n.prefetch}var a=e("./strings"),o=e("./states"),s=e("videoplayer-common-lib").errorCodes,l=["305","306","307"];r.E_INFO=s.E_INFO,r.E_WARNING=s.E_WARNING,r.E_YVAP=s.E_YVAP;var c=r.E_PLAYER=s.E_PLAYER,u=r.E_PLAYER_FAILOVER=s.E_PLAYER_FAILOVER,p=r.E_PLAYER_DRM=s.E_PLAYER_DRM,d=r.E_PLAYER_JS_HLS=s.E_PLAYER_JS_HLS,f=r.E_SAPI_ABSTRACT=s.E_SAPI_ABSTRACT;r.E_SAPI_STREAM=s.E_SAPI_STREAM,r.E_SAPI_PLAYLIST=s.E_SAPI_PLAYLIST,r.E_SAPI_RELATED=s.E_SAPI_RELATED,r.E_SAPI_POPULAR=s.E_SAPI_POPULAR;var v=r.E_SAPI_CLOSEDCAPTION=s.E_SAPI_CLOSEDCAPTION;r.E_CAST=s.E_CAST;var m=r.INFO_CODES=s.INFO_CODES,y=r.WARNING_CODES=s.WARNING_CODES,h=r.PLAYER_CODES=s.PLAYER_CODES,E=r.PLAYER_DRM_CODES=s.PLAYER_DRM_CODES,g=r.PLAYER_JS_HLS_CODES=s.PLAYER_JS_HLS_CODES,b=r.SAPI_CODES=s.SAPI_CODES,_=(r.CAST_CODES=s.CAST_CODES,function(e,t,r){t.forEach(function(t){e[t]=r})}),A=function(e){var t=[];if(e)for(var r in e)e.hasOwnProperty(r)&&t.push(e[r]);return t},T={};T[m.E_PLAYER_360_IS_NOT_SUPPORTED]=a.i18n.ERR_TITLE_CANNOT_PLAY_360_VIDEO,T[m.E_SAPI_GEO_POSITION_REQUIRED]=a.i18n.ERR_TITLE_LOCATION_REQUIRED,T[m.E_FLASH_RENDERER_NOT_SUPPORTED]=a.i18n.ERR_TITLE_CANNOT_PLAY_VIDEO,_(T,[m.E_SAPI_LICENSE_ERROR,m.E_SAPI_UNAVAILABLE_TEMP,m.E_SAPI_GEO,m.E_SAPI_BLACKOUT],a.i18n.ERR_TITLE_VIDEO_NOT_AVAILABLE),A(m).forEach(function(e){T[e]||(T[e]=a.i18n.ERR_TITLE_CANNOT_PLAY_VIDEO)});var S={};S[m.E_SAPI_UNAVAILABLE_TEMP]=a.i18n.ERR_UNAVAILABLE,S[m.E_SAPI_LICENSE_ERROR]=a.i18n.ERR_UNAVAILABLE,S[m.E_SAPI_GEO]=a.i18n.ERR_GEO,S[m.E_SAPI_BLACKOUT]=a.i18n.ERR_BLACKOUT,S[m.E_SAPI_AUTH_FAILED]=a.i18n.ERR_GENERAL_ERROR,S[m.E_SAPI_INVALID_AUTH_KEY_VERSION]=a.i18n.ERR_GENERAL_ERROR,S[m.E_SAPI_GEO_POSITION_REQUIRED]=a.i18n.ERR_GEO_REQUIRED,S[m.E_SAPI_DEVICE]=a.i18n.ERR_DEVICE,S[m.E_SAPI_EMBED]=a.i18n.ERR_EMBED,S[m.E_PLAYER_ANDROID_CHROME_REQUIRED]=a.i18n.ERR_ANDROID_LIVE_CHROME_REQUIRED,S[m.E_PLAYER_NO_COMPATIBLE_FORMAT]=a.i18n.ERR_BROWSER_UNSUPPORTED,S[m.E_PLAYER_360_IS_NOT_SUPPORTED]=a.i18n.ERR_BROWSER_UNSUPPORTED_SKIP_IN_10,S[m.E_FLASH_RENDERER_NOT_SUPPORTED]=a.i18n.ERR_BROWSER_UNSUPPORTED,_(S,[m.E_SAPI_UNSUPPORTED_LIVE_ON_HTML],a.i18n.ERR_FLASH_IS_BLOCKED);var I={};I[h.E_NATIVE_SRC_NOT_SUPPORTED]=a.i18n.ERR_TITLE_VIDEO_NOT_AVAILABLE,_(I,[h.E_PLAYER_NOT_ENABLED,h.E_PLAYER_NOT_UPTO_DATE,h.E_NATIVE_ABORTED,h.E_FLASH_LIVE_NOT_SUPPORTED],a.i18n.ERR_TITLE_CANNOT_PLAY_VIDEO),A(h).forEach(function(e){I[e]||(I[e]=a.i18n.ERR_TITLE_SOMETHING_WENT_WRONG)});var L={};L[h.E_PLAYER_NOT_ENABLED]=a.i18n.ERR_FLASH_LATEST_DOWNLOAD,L[h.E_PLAYER_NOT_UPTO_DATE]=a.i18n.ERR_FLASH_LATEST_DOWNLOAD,L[h.E_NATIVE_NETWORK_FAILURE]=a.i18n.ERR_NETWORK_ISSUE,L[h.E_FLASH_LIVE_NOT_SUPPORTED]=a.i18n.ERR_IE_LIVE_NOT_AVAILABLE,A(h).forEach(function(e){L[e]||(L[e]=a.i18n.ERR_GENERAL_ERROR)});var R={};_(R,[E.E_INIT,E.E_LICENSE_REQUEST],a.i18n.ERR_TITLE_SOMETHING_WENT_WRONG),A(E).forEach(function(e){R[e]||(R[e]=a.i18n.ERR_TITLE_CANNOT_PLAY_VIDEO)});var C={};C[E.E_CONFIG]=a.i18n.E_CONFIG,C[E.E_EME_MISSING]=a.i18n.E_EME_MISSING,C[E.E_CERTPATH_MISSING]=a.i18n.E_EME_MISSING,_(C,[E.E_INIT,E.E_LICENSE_REQUEST],a.i18n.ERR_GENERAL_ERROR),A(E).forEach(function(e){C[e]||(C[e]=a.i18n.ERR_DRM_BAD_LICENSE_FILE)});var D={},O={};A(g).forEach(function(e){D[e]=a.i18n.ERR_TITLE_SOMETHING_WENT_WRONG,O[e]=a.i18n.ERR_GENERAL_ERROR});var N={};N[m.E_SAPI_RESTRICTED_NETWORK_TYPE]=a.i18n.ERR_TITLE_CANNOT_PLAY_VIDEO,_(N,[b.E_INCOMPATIBLE_FORMAT,b.E_NO_STREAMS],a.i18n.ERR_TITLE_SOMETHING_WENT_WRONG),_(N,[b.E_UNAUTHORIZED_USER,b.E_DRM_RESTRICTED],a.i18n.ERR_TITLE_CANNOT_PLAY_VIDEO),A(b).forEach(function(e){N[e]||(N[e]=a.i18n.ERR_TITLE_VIDEO_NOT_AVAILABLE)});var P={};P[b.E_UNAUTHORIZED_USER]=a.i18n.ERR_UNAUTHORIZED,P[b.E_RESTRICTED_TO_INTERNAL]=a.i18n.ERR_UNAVAILABLE,P[b.E_DRM_RESTRICTED]=a.i18n.ERR_DRM_RESTRICTED,P[m.E_SAPI_RESTRICTED_NETWORK_TYPE]=a.i18n.ERR_RESTRICTED_NETWORK_TYPE,_(P,[b.E_INCOMPATIBLE_FORMAT,b.E_NO_STREAMS],a.i18n.ERR_GENERAL_ERROR),A(b).forEach(function(e){P[e]||(P[e]=a.i18n.ERR_MISSING_OR_DAMAGED)});var k={};A(y).forEach(function(e){e!==y.E_LIVE_PLAYBACK_COMPLETE&&(k[e]=a.i18n.ERR_TITLE_SOMETHING_WENT_WRONG)}),k[y.E_LIVE_PLAYBACK_COMPLETE]=a.i18n.ERR_TITLE_VIDEO_NOT_AVAILABLE;var M={};M[y.E_LIVE_PLAYBACK_COMPLETE]=a.i18n.ERR_LIVE_PLAYBACK_COMPLETE,A(y).forEach(function(e){e!==y.E_LIVE_PLAYBACK_COMPLETE&&(M[e]=a.i18n.ERR_GENERAL_ERROR)}),r.Error=i,Object.defineProperty(i.prototype,"rep",{get:function(){return n(this)}}),i.prototype.rg=function(e){var t="S";return e&&e.playbackState&&(e.playbackState.state===o.VIDEO||e.playbackState.state===o.END)&&(t="P"),t},i.prototype.isSAPIError=function(){var e=this;return e.category>=f&&e.category<=v},Object.defineProperty(i.prototype,"title",{get:function(){var e=this,t=null,n=e.errorInfo.playbackState&&e.errorInfo.playbackState.loadedItem&&e.errorInfo.playbackState.loadedItem.isLive();if(e.isSAPIError())t=N;else{if(e.category===c&&l.indexOf(e.subcategory)!==-1&&n&&e.userAgent&&(e.userAgent.android||e.userAgent.ios))return a.i18n.ERR_TITLE_SOMETHING_WENT_WRONG;e.category===c||e.category===u?t=I:e.category===r.E_WARNING?t=k:e.category===r.E_INFO?t=T:e.category===p?t=R:e.category===d&&(t=D)}return t&&t[e.subcategory]||a.i18n.ERR_TITLE_SOMETHING_WENT_WRONG}}),Object.defineProperty(i.prototype,"message",{get:function(){var e=this,t=null,n=e.errorInfo.playbackState&&e.errorInfo.playbackState.loadedItem&&e.errorInfo.playbackState.loadedItem.isLive();if(e.isSAPIError())t=P;else{if(e.category===c&&l.indexOf(e.subcategory)!==-1&&n&&e.userAgent&&(e.userAgent.android||e.userAgent.ios))return a.i18n.ERR_LIVE_IOS_PLAYBACK;e.category===c||e.category===u?t=L:e.category===r.E_WARNING?t=M:e.category===r.E_INFO?t=S:e.category===p?t=C:e.category===d&&(t=O)}return this.sg||t&&t[e.subcategory]||a.i18n.ERR_TECH_DIFFICULTIES}}),r.isInfoCode=function(e){for(var t in m)if(m.hasOwnProperty(t)&&m[t]===e)return!0;return!1}},{"./states":46,"./strings":"/nextgen/src/strings.js","videoplayer-common-lib":237}],13:[function(e,t,r){"use strict";function n(e,t,r){var n=this;n.k=e,n.l=t,n.tg=r,n.ug=null,n.vg=null,n.tg.addEventListener("webkitneedkey",function(e){n.wg(e.target,e.initData)})}t.exports=n;var i=e("./util"),a=e("./error"),o=e("./event"),s="https://assets.video.yahoo.net/fairplay.cer";n.prototype.load=function(e){var t=this;return t.ug=e?e:s,null===t.ug||""===t.ug?void t.xg("C","No Fairplay certificate path given. Cannot play."):void 0===window.WebKitMediaKeys?void t.xg("C","No Fairplay browser support detected. Cannot play."):void i.ajax(t.ug,{method:"GET",context:t,headers:{Pragma:"Cache-Control: no-cache","Cache-Control":"max-age=0"},responseType:"arraybuffer",successHandler:function(e){t.yg(e)},failureHandler:function(e){t.xg("P","Failed to retrieve the server certificate for Fairplay DRM. "+e)}})},n.prototype.yg=function(e){var t=this;t.vg=new Uint8Array(e)},n.prototype.wg=function(e,t){var r=this;if(null===t)return void r.xg("P","Fairplay DRM is requesting a key, but no init data available.");if(null===r.vg)return void r.xg("P","Fairplay DRM is requesting a key, but no certificate data available.");var n=r.zg(t),i=r.Ag(n),a=r.Bg(t,i);if(!e.webkitKeys){var o=r.Cg();e.webkitSetMediaKeys(new window.WebKitMediaKeys(o))}e.webkitKeys||r.xg("P","Could not create EME MediaKeys for Fairplay DRM");var s=e.webkitKeys.createSession("video/mp4",a);s||r.xg("P","Could not create key session for Fairplay DRM"),s.contentId=i,s.destinationURL=n,s.addEventListener("webkitkeymessage",function(e){r.Dg(e.target,e.message)}),s.addEventListener("webkitkeyadded",function(e){r.Eg()}),s.addEventListener("webkitkeyerror",function(e){r.Fg()})},n.prototype.Ag=function(e){var t=document.createElement("a");t.href=e;var r=t.search.substr(1),n=r.split("&"),i=n[0].split("="),a=i[1];return a},n.prototype.zg=function(e){var t=i.array16ToString(e),r=t.replace("skd://","https://");return r=r.substring(1,r.length)},n.prototype.Bg=function(e,t){var r=this;"string"==typeof t&&(t=i.stringToArray16(t));var n=0,a=new ArrayBuffer(e.byteLength+4+t.byteLength+4+r.vg.byteLength),o=new DataView(a),s=new Uint8Array(a,n,e.byteLength);s.set(e),n+=e.byteLength,o.setUint32(n,t.byteLength,!0),n+=4;var l=new Uint8Array(a,n,t.byteLength);l.set(t),n+=l.byteLength,o.setUint32(n,r.vg.byteLength,!0),n+=4;var c=new Uint8Array(a,n,r.vg.byteLength);return c.set(r.vg),new Uint8Array(a,0,a.byteLength)},n.prototype.Cg=function(){var e=this;return window.WebKitMediaKeys.isTypeSupported("com.apple.fps.1_0","video/mp4")?"com.apple.fps.1_0":(e.xg("P","Fairplay DRM Key System not supported"),null)},n.prototype.Dg=function(e,t){var r=this,n={spc:i.base64EncodeUint8Array(t),assetId:e.contentId};i.ajax(e.destinationURL,{method:"POST",body:JSON.stringify(n),context:this,responseTypeJson:!0,beforeSend:function(t){t.session=e},successHandler:function(e,t,n,i){r.Gg(e,i.session)},failureHandler:function(e){r.xg("P","Fairplay DRM license request failed. "+e)}})},n.prototype.Gg=function(e,t){t.update(i.base64DecodeUint8Array(e.ckc))},n.prototype.Fg=function(){var e=this;e.xg("P","Fairplay DRM decryption key error was encountered")},n.prototype.Eg=function(){},n.prototype.xg=function(e,t){var r=this;r.k.publish(o.ERROR,i.createErr(e,r.l.playbackState,a.E_PLAYER,a.PLAYER_CODES.E_NATIVE_ABORTED,t))}},{"./error":12,"./event":"/nextgen/src/event.js","./util":"/nextgen/src/util.js"}],14:[function(e,t,r){"use strict";function n(e,t){return new Promise(function(r,n){o&&o.importKey||n(new Error("crypto is not supported by the current browser")),o.importKey("raw",l(t),s,!1,["sign","verify"]).then(function(t){return o.sign(t.algorithm,t,l(e))}).then(function(e){r(c(e))}).catch(function(e){n(e)})})}var i=e("./util"),a=t.exports={},o=null;o=window.crypto||window.msCrypto,o||("undefined"!=typeof crypto?o=crypto:"undefined"!=typeof msCrypto&&(o=msCrypto)),o=o&&(o.subtle||o.webkitSubtle)||null;var s={name:"HMAC",hash:{name:"SHA-1"}},l=function(e){var t,r=unescape(encodeURIComponent(e)),n=new ArrayBuffer(r.length),i=new Uint8Array(n);for(t=0;t<r.length;t++)i[t]=r.charCodeAt(t);return i},c=function(e){return String.fromCharCode.apply(null,new Uint8Array(e))};a.getXAuthParams=function(e,t){var r,a={},o=(new Date).getTime(),s=Math.random().toString(36).slice(2,12),l="",c=1,u=i.getSingleton("PlayerHosting");if(u&&(c=u.gv||1,r=u.g||[],Array.isArray(r))){for(var p=[],d=0;d<r.length;d++)p.push(String.fromCharCode(r[d]));l=p.join("")}var f="dev_id="+t+"&nonce="+s+"&ts="+o+"&uuid="+e+"&v="+c;return new Promise(function(e,r){n(f,l).then(function(r){var n=btoa(r);a.xauth_v=c,a.xauth_ts=o,a.xauth_nonce=s,a.xauth_dev_id=t,a.xauth_signature=n,e(a)}).catch(function(e){r({})})})}},{"./util":"/nextgen/src/util.js"}],15:[function(e,t,r){"use strict";function n(e,t){var r=this;r.l=t,r.k=e,r.Hg={},r.a=[],r.Ig={},r.Jg={},r.Kg=null,r.Lg="",r.Mg="",r.Ng=0,r.Og=null,r.Pg()}t.exports=n;var i=e("./util"),a=e("./event"),o=(e("../../lib/logger"),8e3),s=/^#(EXT-X-MEDIA-SEQUENCE|EXTINF|EXT-X-CUE-OUT(?:-CONT)?|EXT-X-CUE-IN|EXT-X-ENDLIST):?([0-9\.]+)?(?:\/([0-9\.]+)?)?,?$/;n.prototype.updatePlaylistURLs=function(e,t){var r=this;r.Lg=e,r.Mg=t},n.prototype.Qg=function(e,t){var r=this;r.Rg(e,t,function(e,t){e||r.Sg(t)}),r.Tg(),r.Og=setTimeout(function(){r.Qg(e,t)},o)},n.prototype.Tg=function(){var e=this;clearTimeout(e.Og),e.Og=null},n.prototype.Sg=function(e){for(var t=this,r=e.split("\n"),n=0;r.length;){var i=r.shift(),o=i.match(s);if(o)switch(o[1]){case"EXT-X-MEDIA-SEQUENCE":n=parseInt(o[2]);break;case"EXTINF":if(n++,t.Hg[n]){t.Ng=t.Hg[n].end;break}var l=parseFloat(o[2]);t.Ng+=l,t.Hg[n]={dur:l,end:t.Ng};break;case"EXT-X-CUE-OUT":t.Ng=0,t.Ig[n]||(t.Kg=n,t.Ig[n]=!0);break;case"EXT-X-CUE-IN":if(!t.Jg[n]){var c=Math.round(t.Ng);t.a.push({type:a.API.CUEPOINT_STOPPED,seqNum:n,cueOutSeqNum:t.Kg,time:c}),t.Jg[n]=!0,t.Ug(c,t.Kg)}break;case"EXT-X-ENDLIST":t.Tg()}}},n.prototype.Vg=function(e,t){var r=this,n=null,i=-1;if(r.a.forEach(function(r,a){e>=r.time&&t===r.cueOutSeqNum&&(n=r,i=a)}),n){r.a=r.a.slice(i+1);var o=[n.type];n.type===a.API.CUEPOINT_STOPPED&&o.push(n.time),r.k.publish.apply(r.k,o)}},n.prototype.Pg=function(){function e(){clearInterval(i.Wg),i.Wg=null}function t(e){if(!i.l)return null;var t=i.l.playlist.getCurrentItem().streamProfiles||[];return t=t.filter(function(e){return"stream"===e.type}),t[e]?t[e].url:null}function r(r,n,a){var s=1e3;o=a.cueoutStartSeqNum,i.Mg=t(a.cueoutStreamIndex)||i.Mg,i.Qg(i.Lg,i.Mg),e();var l=0;i.Wg=window.setInterval(function(){i.Vg(++l,o)},s)}function n(){e(),i.Tg(),i.a.length=0}var i=this,o=null;i.Ug=function(e,t){t===o&&i.k.publish(a.CUEIN_DETECTED,e)},i.k.subscribe(a.API.CUEPOINT_STARTED,r,i),i.k.subscribe(a.API.CUEPOINT_STOPPED,n,i),i.k.subscribe(a.AD_BREAK_ENDED,n,i)},n.prototype.Rg=function(e,t,r){var n=this;return n.Lg=e,t?(n.Mg=t,n.Xg(n.Mg,r)):void i.ajax(n.Lg,{
method:"GET",context:n,successHandler:function(e){return n.Mg=n.Yg(e),""!==n.Mg?n.Xg(n.Mg,r):r("bad mpl url")},failureHandler:function(e){return r(e)}})},n.prototype.Xg=function(e,t){var r=this;if(!e.match(/^https?:/)){var n=r.Lg.match(/^(https?:.*\/).*?\.m3u8?/)[1];n&&(e=n+e)}i.ajax(e,{method:"GET",context:r,successHandler:function(e){return t(null,e)},failureHandler:function(e){return t(e)}})},n.prototype.Yg=function(e){for(var t=e.split("\n");t.length;){var r=t.shift();if(r.match(/^[^#].*\.m3u8.*?$/))return r}return""},n.prototype.destroy=function(){var e=this;e.Tg()}},{"../../lib/logger":"/lib/logger.js","./event":"/nextgen/src/event.js","./util":"/nextgen/src/util.js"}],16:[function(e,t,r){"use strict";function n(e,t,r,n){var a=this,o=i.getWindow(),l=o.location.protocol;a.Zg={isPlaying:null,getPlaybackState:null,getDuration:null,getCurrentTime:null,getTimeRemaining:null,getFullscreen:null,getVolume:null,getMute:null},a.$g={getCurrentItemTitle:null,getCurrentItemDescription:null,getCurrentItemProviderName:null,getCurrentItemLiveStatus:null},a._g="VID-"+Math.floor(1e3*Math.random()),a.ah=JSON.parse(JSON.stringify(e)),a.bh=r,a.k=n,a.ch=null,a.eh=null,a.fh=Date.now(),a.gh=!1,a.hh=null,a.ih=null,a.ah.local?a.jh=o.location.protocol+"//"+o.location.host:a.jh="https:"===l?"https://s.yimg.com":"http://l.yimg.com",e.insideIframeConfig||(a.hh=a.kh.bind(a),window.addEventListener("message",a.hh,!1)),a.k.subscribe(s.PLAYER_DIMENSION_CHANGE,a.lh,a)}t.exports=n;var i=e("./util"),a=e("../../lib"),o=e("./error"),s=e("./event"),l=s.Iframe.MessageType;n.prototype.destroy=function(){var e=this;e.hh&&window.removeEventListener("message",e.hh,!1),e.ih&&window.removeEventListener("message",e.ih,!1)},n.prototype.constructIframe=function(e){var t,r=this,n=i.getWindow();if(t=a.isString(e)?document.querySelector(e):e._node||e,null===t)return void r.k.publish(s.ERROR,i.createErr("C",null,o.E_PLAYER,o.PLAYER_CODES.E_INVALID_CONFIG,"Invalid DOM node or CSS selector specified. Cannot render player."));r.eh=t,r.ah.insideIframeConfig={startTime:r.fh,iframeVID:r._g,parentURL:n.location.protocol+"//"+n.location.host},r.ah.playerJSPath=window.YAHOO&&window.YAHOO.VideoPlatform&&window.YAHOO.VideoPlatform.PlayerHosting&&window.YAHOO.VideoPlatform.PlayerHosting.req&&window.YAHOO.VideoPlatform.PlayerHosting.req.path||"",r.ah.scriptLanguage=r.bh.language;var l=document.createElement("iframe"),c=encodeURIComponent(JSON.stringify(r.ah)),u="";u=r.ah.local?r.ah.insideIframeConfig.parentURL+"/iframe-controller-page.html":r.jh+"/rx/builds/7.86.909.1590008200/iframe-controller-page.html",l.setAttribute("src",u),l.setAttribute("name",c),l.setAttribute("id",r._g),l.setAttribute("width","100%"),l.setAttribute("height","100%"),l.setAttribute("frameBorder","0"),l.setAttribute("allowFullScreen",""),l.setAttribute("allow","autoplay; fullscreen; encrypted-media"),t.appendChild(l),r.ch=l,r.ch.onload=function(){r.gh=!0}},n.prototype.mh=function(){var e=this;if(e.ch&&e.gh){var t=Array.prototype.slice.call(arguments),r=JSON.stringify(t);e.ch.contentWindow.postMessage(r,e.jh)}},n.prototype.kh=function(e){var t=this,r=null,n=null,i={},o=null,s=t.Zg,c=t.$g;if(e.origin===t.jh){try{r=JSON.parse(e.data)}catch(e){return}if(r&&a.isArray(r)&&r.length>=2){if(o=r.pop(),!a.isString(o)||0!==o.indexOf("VID-"))return;if(t._g!==o)return;if(n=r.pop(),!n||!l[n])return;switch(n){case l.EVENT:i=r.pop(),Object.keys(i).forEach(function(e){t.Zg.hasOwnProperty(e)?s[e]=i[e]:t.$g.hasOwnProperty(e)&&(c[e]=i[e])}),t.bh.nh.Zg=s,t.bh.nh.$g=c,t.bh.publish.apply(t.bh,r);break;case l.CLEAR_IFRAME_NAME:t.ch.setAttribute("name","");break;case l.IFRAME_WINDOW_EVENT:t.bh.oh.onReceiveFromIframe(r);break;case l.PLAYER_DIMENSION_CHANGE:var u=r.length?r.pop():null,p="object"==typeof u?u.height:null;p&&t.ph(p)}}}},n.prototype.routeControlsApiToIframe=function(){var e=this,t="controls",r="playlist",n=["addItems","addItem","setPositionById","setPosition","removeItem","removeItems","removeItemById","removeItemsById"],i=["getCurrentItemTitle","getCurrentItemDescription","getCurrentItemProviderName","getCurrentItemLiveStatus"],a=function(r){return function(){var n=Array.prototype.slice.call(arguments);e.mh(t,r,n)}},o=function(t){return function(){return e.Zg[t]}},s=function(t){return n.indexOf(t)!==-1?function(){var n=Array.prototype.slice.call(arguments);e.mh(r,t,n)}:i.indexOf(t)!==-1?function(){return e.$g[t]}:function(){throw new Error("playlist API "+t+" is not supported when safe frame is enabled")}},l=function(e){return function(){throw new Error("player API "+e+" is not supported when safe frame is enabled")}};for(var c in e.bh[t])if("function"==typeof e.bh[t][c]){if(void 0!==e.Zg[c]){e.bh[t][c]=o(c);continue}e.bh[t][c]=a(c)}for(var u in e.bh[r])"function"==typeof e.bh[r][u]&&(e.bh[r][u]=s(u));e.bh.getCustomControlsNode=l("getCustomControlsNode"),e.bh.fetchMetaData=l("fetchMetaData"),e.bh.getMediaStore=l("getMediaStore")},n.prototype.routeAPIeventToPage=function(e){var t=this,r=window.YAHOO.VideoPlatform.API_Events[e];t.bh.on(r,function(){var e=Array.prototype.slice.call(arguments);e.unshift(r),e.push(t.refreshControlsAPIData()),e.push(l.EVENT),e.push(t.ah.insideIframeConfig.iframeVID),t.qh(JSON.stringify(e))})},n.prototype.sendClearIframeNameToPage=function(){var e=this,t=[];t.push(l.CLEAR_IFRAME_NAME),t.push(e.ah.insideIframeConfig.iframeVID),e.qh(JSON.stringify(t))},n.prototype.qh=function(e){var t=this,r=null;t.ah.insideIframeConfig&&(r=t.ah.insideIframeConfig.parentURL),window.parent.postMessage(e,r)},n.prototype.rh=function(e){var t=this,r=null,n=null,i=null,a=null;if(e.data){try{a=JSON.parse(e.data)}catch(e){return}Array.isArray(a)&&(r=a.length>0?a[0]:null,n=a.length>1?a[1]:null,i=a.length>2?a[2]:null),r&&n&&t.bh&&t.bh[r]&&t.bh[r][n]&&t.bh[r][n].apply(t.bh[r],i)}},n.prototype.refreshControlsAPIData=function(){var e=this,t={isPlaying:e.bh.controls.isPlaying(),getPlaybackState:e.bh.controls.getPlaybackState(),getDuration:e.bh.controls.getDuration(),getCurrentTime:e.bh.controls.getCurrentTime(),getTimeRemaining:e.bh.controls.getTimeRemaining(),getFullscreen:e.bh.controls.getFullscreen(),getVolume:e.bh.controls.getVolume(),getMute:e.bh.controls.getMute(),getCurrentItemTitle:e.bh.playlist.getCurrentItemTitle(),getCurrentItemDescription:e.bh.playlist.getCurrentItemDescription(),getCurrentItemProviderName:e.bh.playlist.getCurrentItemProviderName(),getCurrentItemLiveStatus:e.bh.playlist.getCurrentItemLiveStatus()};return t},n.prototype.setupIframeToPageCommunication=function(){var e=this;e.ih=e.rh.bind(e),window.addEventListener("message",e.ih,!1),e.sh=e.sh.bind(e),window.addEventListener(s.WINDOW_ON_FOCUS,e.sh,!1),e.uh=e.uh.bind(e),window.addEventListener(s.WINDOW_ON_BLUR,e.uh,!1);for(var t in window.YAHOO.VideoPlatform.API_Events)window.YAHOO.VideoPlatform.API_Events.hasOwnProperty(t)&&e.routeAPIeventToPage(t)},n.prototype.lh=function(e){var t=this,r=[];"object"==typeof e&&"PlaylistController"===e.from&&(r.push(e),r.push(l.PLAYER_DIMENSION_CHANGE),r.push(t.ah.insideIframeConfig.iframeVID),t.qh(JSON.stringify(r)))},n.prototype.ph=function(e){var t=this;t.eh.style.height=e+"px"},n.prototype.sh=function(){var e=this,t=Array.prototype.slice.call(arguments);t.unshift(s.Iframe.ON_FOCUS),t.push(l.IFRAME_WINDOW_EVENT),t.push(e.ah.insideIframeConfig.iframeVID),e.qh(JSON.stringify(t))},n.prototype.uh=function(){var e=this,t=Array.prototype.slice.call(arguments);t.unshift(s.Iframe.ON_BLUR),t.push(l.IFRAME_WINDOW_EVENT),t.push(e.ah.insideIframeConfig.iframeVID),e.qh(JSON.stringify(t))}},{"../../lib":"/lib/index.js","./error":12,"./event":"/nextgen/src/event.js","./util":"/nextgen/src/util.js"}],17:[function(e,t,r){"undefined"!=typeof window&&(window.vh={"./three-facade":"/nextgen/build/videoplayer-three-facade-min.js","/nextgen/src/renderers/three-facade.js":"/nextgen/build/videoplayer-three-facade-min.js"});var n=e("./event"),i=e("./util"),a=e("./video-player");i.setSingleton("VideoPlayer",a),i.setSingleton("API_Events",n.API)},{"./event":"/nextgen/src/event.js","./util":"/nextgen/src/util.js","./video-player":47}],18:[function(e,t,r){"use strict";function n(e){return h.isString(e)&&""!==e}function i(e,t){var r=this;s(C,e,r,t),h.isString(r.url)&&0!==r.url.length||(r.url=r.host+r.path),r.format||(r.format=y.getFormat(r.url)),!r.host&&r.url.length>0&&(r.host=y.getHostname(r.url)),"subtitle"===r.type&&(r.type="SUBTITLES")}function a(){var e=this;e.streams=[],e.selectedStreams=[],e.relatedVideoIds=[],e.state=f.NO_DATA,e.recoveryStatus=v.NOT_RECOVERING,e.geoRequired=!1,e.isCCM=!0,e.tryCount=1,e.failoverCount=0,e.isCCAvailable=!1,e.languages=[],e.isDrmProtected=!1,e.drmSystem="none"}function o(){var e=this;e.Ah={},e.Bh=[]}function s(e,t,r,n){l(e,t,r,null,n),t.CMS&&Object.keys(t.CMS).forEach(function(e){r.CMS[e]=t.CMS[e]}),t.html5_hls&&Object.keys(t.html5_hls).forEach(function(e){r.html5_hls[e]=t.html5_hls[e]})}function l(e,t,r,n,i){var a=r,o=t,s=!0,u=!1;if("configName"in e&&(n=e.configName),n&&(h.isObject(t)&&n in t?(o=t[n],u=!0):s=!1),s&&"transform"in e&&(o=e.transform(o)),"defaultVal"in e){var p=e.defaultVal;if(void 0===r&&(a=h.isFunction(p)?p():p),u){var d=!0;if("overwrite"in e){var f=e.overwrite;h.isFunction(e.overwrite)?d=f(a,o):f||(d=a===p)}d&&("validator"in e?e.validator(o)?a=o:c("Bad configuration data for '"+n+"'",i):a=o)}else e.required&&c("Missing required configuration parameter '"+n+"'",i)}else{a=r||{},s&&!h.isObject(o)&&(n?c("Expecting object in configuration for '"+n+"'",i):c("Expecting object for configuration",i),s=!1),s||(o={});for(var v in e)if(e.hasOwnProperty(v)&&N.indexOf(v)===-1){var m=e[v];a[v]=l(m,o,a[v],v,i)}}return a}function c(e,t){var r=new Error(e);if(!t)throw r;t.push(r)}function u(e){if(!e)return"";for(var t=e.split("&"),r=0;r<t.length;r++)if(0===t[r].indexOf("ps=")&&t[r].length>3){var n=t[r].substring(3),i=n.split("_");return i[0]}return""}function p(e,t){for(var r=e.split("&"),n=0;n<r.length;n++)if(0===r[n].indexOf("ps=")&&r[n].length>3){r[n]=r[n].replace(r[n].substring(3),t);break}return r.join("&")}function d(e,t){e&&e.length>0&&e.forEach(function(e){e.path&&(e.path=p(e.path,t)),e.url&&(e.url=p(e.url,t)),e.hlsInfo&&e.hlsInfo.ts_url&&(e.hlsInfo.ts_url=p(e.hlsInfo.ts_url,t))})}var f={NO_DATA:"no-data",FETCHING:"fetching",HAS_DATA:"has-data",ERROR:"error"},v={NOT_RECOVERING:"not-recovering",RECOVERING:"recovering",RECOVERED:"recovered"};t.exports={MediaStore:o,Stream:i,MediaItem:a,ItemState:f,ItemRecoveryStatus:v,fillFromConfig:s,addError:c,getSapiVsId:u,updateVsInStreams:d};var m=e("./event"),y=e("./util"),h=e("../../lib"),E=e("../../lib/logger"),g=e("./stream"),b=e("./error"),_=e("./constants"),A=e("./renderers/type"),T="yvpResumeTimeItems",S=10,I=480,L={Community:{providerId:"video.community.sony.com"},"Sin City Saints":{providerId:""},"Other Space":{providerId:""}},R="application/vnd.apple.mpegurl",C={mimeType:{configName:"mime_type",defaultVal:"",validator:n},format:{defaultVal:"",transform:function(e){if(!h.isString(e))return null;var t=e.toLowerCase().split("/");return t[t.length-1]},validator:n},width:{defaultVal:0,validator:h.isNumber},height:{defaultVal:0,validator:h.isNumber},bitrate:{defaultVal:0,validator:h.isNumber},avgBitrate:{configName:"avgbitrate",defaultVal:0,validator:h.isNumber},duration:{defaultVal:0,validator:h.isNumber},host:{defaultVal:"",validator:h.isString},path:{defaultVal:"",validator:h.isString},url:{defaultVal:"",validator:n},live:{defaultVal:!1,validator:h.isBoolean},is360:{defaultVal:!1,validator:h.isBoolean},isPrimary:{configName:"is_primary",defaultVal:!1,validator:h.isBoolean},cdn:{configName:"cdn",defaultVal:"",validator:h.isString},hlsInfo:{configName:"hls_info",defaultVal:null},drmType:{configName:"drm_type",defaultVal:null},fairplayCertificatePath:{defaultVal:"",validator:h.isString},deliveryType:{defaultVal:""},manifestContent:{configName:"mediaPlaylist",defaultVal:null},type:{defaultVal:"",validator:h.isString},frameRate:{defaultVal:0,validator:h.isNumber,configName:"framerate"},channels:{configName:"channels",defaultVal:null},rcMode:{configName:"rc_mode",defaultVal:"cbr",validator:h.isString},alt_renditions:{configName:"alt_renditions",defaultVal:null}};i.prototype.isRTMP=function(){var e=this,t=/^rtmp(?:e|t|te|s)?:\/\//;return t.test(e.host)||t.test(e.url)},i.prototype.isRTX=function(){var e=this;return e.url.indexOf("/rtx/")>-1},i.prototype.isAtlas=function(){var e=this,t=e.host;return e.hlsInfo&&(t=e.hlsInfo.ts_url),/atlas\.cdn\.yimg\.com/.test(t)},i.prototype.isDrmProtected=function(){var e=this;return"adobe"===e.drmType||"apple"===e.drmType},i.prototype.isStreamCompatibleForDrm=function(e){var t=this;return t.isDrmProtected()?"flash"===e&&"f4m"===t.format?1:-1:0},i.prototype.Qa=function(){var e=this,t="http",r=e.url.split(":");return r.length>1&&(t=r[0]),t},i.prototype.getType=function(){var e=this,t="unknown",r=e.url,n=e.Qa();return"m3u8:fmp4"===e.format?t="hls-fmp4":r&&(n&&(n.indexOf("rtmp")>-1||n.indexOf("rtsp")>-1)?t=n:/\/*\.f4m/i.test(r)?t=e.isRTX()?"rtx-hds":"hds":/\/*\.m3u8/i.test(r)||r.length>0&&r.indexOf("content=hls")>-1?t=e.isRTX()?"rtx-hls":"hls":/\/*\.mp4/i.test(r)?t="mp4":/\/*\.webm/i.test(r)&&(t="webm")),t};var D={id:{configName:"id",defaultVal:null,validator:h.isString},license:{configName:"license",licensorName:{configName:"account_name",defaultVal:"",validator:h.isString},licensorId:{configName:"account_id",defaultVal:"",validator:h.isString},licenseName:{configName:"title",defaultVal:"",validator:h.isString},licenseId:{configName:"salesforce_id",defaultVal:"",validator:h.isString},originatingProperty:{configName:"originating_property",defaultVal:"",validator:h.isString},isDrm:{configName:"is_drm",defaultVal:!1,validator:h.isBoolean}},metrics:{ywa:{defaultVal:[],validator:function(e){return h.isArray(e)&&e.every(h.isString)}},comscoreC5:{configName:"comscore_cm5",defaultVal:"",validator:h.isString},comscoreC6:{configName:"comscore6",defaultVal:"",validator:h.isString},pageSpaceId:{configName:"pspid",defaultVal:"",validator:h.isString},beacons:{defaultVal:{},transform:function(e){if(!h.isArray(e))return null;for(var t={},r=0;r<e.length;r++){var n=e[r],i=n.events,a=n.target||"",o=n.data||"",s=n.urlTemplate;if(!h.isArray(i))return null;h.isString(s)||(s=null);for(var l=0;l<i.length;l++){var c=i[l],u=c.param||"";if(!h.isObject(c)||!h.isString(c.name))return null;c.name in t||(t[c.name]=[]);var p={url:s};o&&u&&(p.target=a,p.addParam="&"+o+u),t[c.name].push(p)}}return t},validator:h.isObject},mmActivityId:{configName:"mmActivityId",defaultVal:"",validator:h.isString},mediametrie:{configName:"mediametrie",defaultVal:null,validator:h.isString}},status:{code:{defaultVal:"",validator:h.isString},msg:{defaultVal:"",validator:h.isString}},vrm:{defaultVal:null},yvap:{defaultVal:{}},closedCaptions:{configName:"closedcaptions",defaultVal:[],url:{validator:h.isString},lang:{validator:h.isString}},visualSeek:{configName:"visualseek",defaultVal:{},frequency:{defaultVal:0,validator:h.isNumber},width:{defaultVal:0,validator:h.isNumber},height:{defaultVal:0,validator:h.isNumber},images:{defaultVal:[],validator:h.isArray}},vpaTraceDigest:{defaultVal:"",validator:h.isString},progress:{position:{defaultVal:null,validator:h.isNumber},adbreaks:{defaultVal:[],validator:h.isArray}},seriesInfo:{defaultVal:{},series_id:{configName:"series_id",defaultVal:null,validator:h.isNumber},videoType:{configName:"type",defaultVal:"",validator:h.isString},seasonNumber:{configName:"season_number",defaultVal:0,validator:h.isNumber},episodeNumber:{configName:"episode_number",defaultVal:0,validator:h.isNumber}},annotations:{configName:"annotations",defaultVal:{},content:{defaultVal:[],validator:h.isArray},theme:{defaultVal:"dark",validator:h.isString},transition:{defaultVal:{},class:{defaultVal:"dissolve",validator:h.isString}},version:{defaultVal:"1",validator:h.isString}},algo:{defaultVal:null,transform:function(e){return e.algo_name},validator:h.isString},instrument:{defaultVal:{},transform:function(e){return e?e:{}},validator:h.isObject}},O={description:{defaultVal:"",validator:h.isString,transform:function(e){return y.sanitizeAndUnescape(e)}},blockAutoplay:{configName:"block_autoplay",defaultVal:!1,validator:h.isBoolean},title:{defaultVal:"",validator:h.isString,transform:function(e){return y.sanitizeAndUnescape(e)}},snapshots:{count:{defaultVal:null,validator:h.isNumber},height:{defaultVal:null,validator:h.isNumber},width:{defaultVal:null,validator:h.isNumber},url:{defaultVal:null,validator:h.isString}},provider:{name:{defaultVal:"",validator:h.isString},providerId:{configName:"provider_id",defaultVal:null,validator:h.isString},providerVideoId:{configName:"provider_video_id",defaultVal:null,validator:h.isString},publisherId:{configName:"publisher_id",defaultVal:null,validator:h.isString},providerLogoUrl:{configName:"logourl",defaultVal:null,validator:h.isString},providerUrl:{configName:"url",defaultVal:null,validator:h.isString}},provisioningSource:{configName:"provisioning_source",defaultVal:"",validator:h.isString},playlistConfig:{defaultVal:{},configName:"playlist_config",validator:h.isObject},genres:{configName:"genre",defaultVal:[],transform:function(e){return h.isString(e)?e.split(","):null},validator:h.isArray},duration:{defaultVal:null,validator:h.isNumber},publishTime:{configName:"publish_time",defaultVal:null,validator:h.isString},credits:{mainArtists:{configName:"main_artists",defaultVal:[],transform:function(e){return h.isString(e)?e.split(/[,;]/):null},validator:h.isArray},label:{defaultVal:null,validator:h.isString}},images:{large:{defaultVal:null,validator:h.isString},medium:{defaultVal:null,validator:h.isString},small:{defaultVal:null,validator:h.isString},provider:{defaultVal:null,validator:h.isString},thumbnail:{defaultVal:null,validator:h.isString}},wh:{configName:"thumbnail",defaultVal:null,validator:h.isString},thumbnails:{configName:"thumbnails",defaultVal:[],validator:h.isArray},resized_thumbnails:{configName:"resized_thumbnails",defaultVal:[],validator:h.isArray},showName:{configName:"show_name",defaultVal:"",validator:h.isString},shareUrl:{configName:"url",defaultVal:"",overwrite:!1,validator:h.isString},embedCode:{configName:"embedCode",defaultVal:"",overwrite:!1,validator:h.isString},embedRights:{configName:"embed_rights",defaultVal:!1,validator:h.isBoolean},videoTypes:{configName:"video_types",defaultVal:[],validator:h.isArray},videoMarkers:{configName:"video_markers",defaultVal:null,validator:h.isObject},primaryVideoMarker:{configName:"primaryMarkerLabel",defaultVal:null,validator:h.isString},eventBeginTime:{configName:"event_start",defaultVal:null,validator:h.isNumber},eventEndTime:{configName:"event_stop",defaultVal:null,validator:h.isNumber},liveState:{configName:"live_state",defaultVal:null,validator:h.isString},ageGate:{configName:"age_gate",defaultVal:"",validator:h.isString},castable:{configName:"castable",defaultVal:!0,validator:h.isBoolean},liveMidrollsMaxDur:{configName:"midroll_adpod_dur",defaultVal:null,validator:h.isNumber},seriesInfo:{configName:"seriesInfo",defaultVal:{},type:{defaultVal:"",validator:h.isString}},header:{defaultVal:null,validator:h.isObject},itemConfig:{configName:"item_config",playbackStart:{configName:"pb_start",defaultVal:null,validator:h.isNumber},playbackEnd:{configName:"pb_end",defaultVal:null,validator:h.isNumber}},enableNielsen:{configName:"nielsen_beacons",defaultVal:!1,validator:h.isBoolean},gameOrigin:{configName:"game_origin",defaultVal:[],validator:h.isArray},allowedConnectionTypes:{configName:"allowed_connection_types",defaultVal:null,validator:function(e){return h.isArray(e)&&e.every(h.isString)}}};a.prototype.getRecoveryStatusForBeacon=function(){var e=this,t=e.recoveryStatus===v.RECOVERED;return t&&(e.recoveryStatus=v.NOT_RECOVERING),t},a.prototype.setGeoRequired=function(e){var t=this;t.geoRequired=e},a.prototype.fetchFinished=function(){var e=this;return e.state===f.HAS_DATA||e.state===f.ERROR},a.prototype.isLongForm=function(){var e=this;return e.duration>600},a.prototype.setDrmAvailability=function(e){var t=this;h.isBoolean(e)&&(t.isDrmProtected=e)},a.prototype.setDrmSystem=function(e){var t=this;h.isString(e)&&(t.drmSystem=e)},a.prototype.fillFromRaw=function(e,t,r,n){var a,o=this;e.shareUrl&&(e.url=e.shareUrl),s(D,e,o,n);var l=e.meta||e;if(s(O,l,o,n),null===o.id&&(o.isCCM=!1,o.id=y.generateGuid()),null!==o.duration&&o.isLongForm()){if(null===o.progress.position){var c=y.localStorage.get(T);c&&c[o.id]?o.progress=c[o.id]:o.progress.position=0}o.restartIfNeeded()}if(o.thumbnails.forEach(function(e){e.hasOwnProperty("tag")&&e.tag===_.PLAYLIST_THUMB_DIMENSION&&(o.images.small=e.url)}),o.resized_thumbnails.forEach(function(e){e.hasOwnProperty("tag")&&e.tag===_.PLAYLIST_THUMB_DIMENSION&&(o.images.small=e.url)}),o.videoMarkers&&(h.isArray(o.videoMarkers.markers)&&(o.videoMarkers=o.videoMarkers.markers,o.videoMarkers.forEach(function(e){e.start_time=parseInt(e.start_time)/1e3})),h.isArray(o.videoMarkers)||(o.videoMarkers=null)),o.images.thumbnail=o.images.thumbnail||o.wh,o.images.defaultThumbnail=o.images.large||o.images.thumbnail||o.images.medium||o.images.small||o.images.provider,o.fillStreamsFromRaw(e.streams,t,r,n),o.altStreams=e.alt_streams||o.altStreams||[],o.streamProfiles=o.streamProfiles||[],e.streamProfiles&&e.streamProfiles.length&&(o.streamProfiles=[],e.streamProfiles.forEach(function(e){"subtitle"===e.type?o.altStreams.push(new i(e,n)):o.streamProfiles.push(new i(e,n))}),o.is360Video()&&(a=g.filterStreamByResolution(o.streamProfiles,I),a.length>0&&(o.streamProfiles=a))),o.closedCaptions&&!o.altStreams.length){var u=o.closedCaptions.filter(function(e){return e.content_type===R});u.forEach(function(e){var t={host:e.url,format:"m3u8",mime_type:e.content_type,mediaPlaylist:'#EXT-X-MEDIA:TYPE=SUBTITLES,GROUP-ID="subs",NAME="English",DEFAULT=YES,AUTOSELECT=YES,FORCED=NO,LANGUAGE="eng",URI="'+e.url+'"',type:"SUBTITLES"};o.altStreams.push(new i(t,n))}),o.altStreams&&o.altStreams.length&&o.streamProfiles.forEach(function(e){e.manifestContent||(e.manifestContent='#EXT-X-STREAM-INF:SUBTITLES="subs"')})}o.isCCM?o.hasStreams()&&o.hasThumbnail()?o.state=f.HAS_DATA:o.hasStreams()&&o.state===f.FETCHING&&(o.state=f.HAS_DATA):o.hasStreams()?o.state=f.HAS_DATA:o.state=f.ERROR},a.prototype.hasPlaylistConfig=function(){var e=this;return Object.keys(e.playlistConfig).length>0},a.prototype.isBumper=function(){var e=this;return!(!e.playlistConfig||!e.playlistConfig.is_bumper)},a.prototype.getSectionType=function(){var e=this;return e.playlistConfig&&e.playlistConfig.section&&e.playlistConfig.section.type?e.playlistConfig.section.type:null},a.prototype.getSectionLabel=function(){var e=this;return e.playlistConfig&&e.playlistConfig.section&&e.playlistConfig.section.label?e.playlistConfig.section.label:null},a.prototype.getSectionIcon=function(e){var t=this;if(t.playlistConfig&&t.playlistConfig.section&&t.playlistConfig.section.icons)for(var r=0;r<t.playlistConfig.section.icons.length;r++)if(e&&t.playlistConfig.section.icons[r].tag===e)return t.playlistConfig.section.icons[r];return null},a.prototype.getHeaderIcon=function(e){var t=this;if(t.playlistConfig&&t.playlistConfig.header&&t.playlistConfig.header.icons){var r=0,n=t.playlistConfig.header.icons.length;for(r;r<n;r++)if(e&&t.playlistConfig.header.icons[r].tag===e)return t.playlistConfig.header.icons[r]}return null},a.prototype.getLabelIcon=function(e){var t=this;if(t.playlistConfig&&t.playlistConfig.label&&t.playlistConfig.label.icons)for(var r=0;r<t.playlistConfig.label.icons.length;r++)if(e&&t.playlistConfig.label.icons[r].tag===e)return t.playlistConfig.label.icons[r];return null},a.prototype.getPlaylistSource=function(){var e=this;return e.playlistConfig&&e.playlistConfig.source?e.playlistConfig.source:null},a.prototype.getLeadArticleUrl=function(){var e=this;return e.playlistConfig&&e.playlistConfig.slick_article_url?e.playlistConfig.slick_article_url:null},a.prototype.restartIfNeeded=function(){var e=this;e.progress.position+S>e.duration&&(e.progress.position=0)},a.prototype.hasStreams=function(){var e=this;return 0!==e.streams.length},a.prototype.hasHD=function(){var e=this,t=e.streams;if(!t)return!1;for(var r=0;r<t.length;r++)if(t[r].height>=_.HIGH_DEFINITION_HEIGHT_THRESHOLD&&t[r].width>=_.HIGH_DEFINITION_WIDTH_THRESHOLD)return!0;return!1},a.prototype.getCDN=function(){var e=this;return e.selectedStreams.length>0?e.selectedStreams[0].cdn:null},a.prototype.isLive=function(){var e=this;return!!e.hasLiveStreams()||!!e.liveState&&!e.hasLiveStateForVod()},a.prototype.hasLiveStreams=function(){for(var e=this,t=0;t<e.streams.length;t++)if(e.streams[t].live)return!0;return!1},a.prototype.hasLiveStateForVod=function(){var e=this;if(e.liveState){for(var t=_.LIVE_STATES_FOR_VOD,r=Object.keys(t),n=0;n<r.length;n++)if(t[r[n]]===e.liveState)return!0;return!1}return!1},a.prototype.is360Video=function(){var e=this,t=!1;return h.isArray(e.videoTypes)&&e.videoTypes.indexOf(_.VIDEO_TYPE.THREE_SIXTY)!==-1&&(t=!0),t},a.prototype.hasThumbnail=function(){var e=this;return!!e.images.defaultThumbnail},a.prototype.fillStreamsFromRaw=function(e,t,r,n){var a,o=this;if(e&&!(e.length<=0)){o.streams=[];var s=e.map(function(e){return new i(e,n)});if(s.length){o.is360Video()&&(a=g.filterStreamByResolution(s,I),a.length>0&&(s=a));for(var l=0;l<t.length;l++){var c=t[l],u=r[c];if((!o.is360Video()||u.is360Renderer)&&(o.is360Video()||!u.is360Renderer)){var p=g.findAcceptedStreams(s,u);if(0!==p.length){o.rendererType=c,o.streams=p;break}}}if(0===o.streams.length){var d;o.is360Video()?(d=new Error("Unable to play 360 video"),E.error(d.message),n.push(d),o.status.code=b.INFO_CODES.E_PLAYER_360_IS_NOT_SUPPORTED,o.status.msg=d.message):(d=new Error("None of the streams is accepted. Possiblemismatch in accepted format or/and protocol."),E.error(d.message),n.push(d),o.status.code=b.SAPI_CODES.E_INCOMPATIBLE_FORMAT,o.status.msg=d.message,"m3u8"===s[0].format&&s[0].live&&t.indexOf("flash")===-1&&(o.status.code=b.INFO_CODES.E_FLASH_RENDERER_NOT_SUPPORTED))}else o.streams.sort(function(e,t){return e.bitrate-t.bitrate})}else{var f=new Error("No streams returned");E.error(f.message),n.push(f),o.status.code=b.SAPI_CODES.E_NO_STREAMS,o.status.msg=f.message}}},a.prototype.generateVSid=function(){for(var e=[],t="abcdefghijklmnopqrstuvwxyz123456789",r=0;r<8;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));var n=e.join("");return n},a.prototype.generateSamplingId=function(){return Math.floor(10*Math.random())},a.prototype.fillSelectedStreams=function(e,t){var r=this,n=e.map(function(e){return new i(e,t)});n.length&&(r.selectedStreams=n),r.selectedStreams&&r.selectedStreams.length>1&&r.selectedStreams.sort(function(e,t){return e.bitrate-t.bitrate})},a.prototype.hasDrmStreams=function(){for(var e=this,t=0;t<e.streams.length;t++)if(e.streams[t].isDrmProtected())return!0;return!1},a.prototype.getType=function(){var e=this;return e.hasStreams()?e.selectedStreams.length>0?e.selectedStreams[0].getType():e.streams[0].getType():"none"},a.prototype.getShowName=function(){var e=this;return e.showName},a.prototype.getSubtitleStreams=function(){var e=this;return e.altStreams.filter(function(e){return"SUBTITLES"===e.type})},a.prototype.isCCInRawMediaItem=function(){var e=this;if(e.rendererType===A.HTML5_HLS){var t=e.getSubtitleStreams();if(t&&t.length>0)return!0}return!(!e.closedCaptions||!e.closedCaptions.length)},a.prototype.isOriginalShow=function(e){var t=this;return e||(e=t.getShowName()),!(!e||!L[e])},a.prototype.isSeriesEpisode=function(){var e=this;return!(!e.seriesInfo||"episode"!==e.seriesInfo.videoType)},a.prototype.mayUpdateVideoSession=function(){var e=this;e.xh||e.yh()},a.prototype.useVideoSession=function(){var e=this;e.xh=!1},a.prototype.zh=function(e){var t=this;t.isPrefetch=!1,e.streams&&e.streams.length>0&&(t.isPrefetch=!0)},a.prototype.yh=function(){var e=this;e.videoSession=e.generateVSid(),e.xh=!0,e.samplingId=e.generateSamplingId()},a.prototype.setCCAvailability=function(e){var t=this;h.isBoolean(e)&&(t.isCCAvailable=e)},a.prototype.setMultiLanguages=function(e){var t=this;t.languages=e},a.prototype.getMultiLanguages=function(){var e=this;return e.languages},a.prototype.setCurrLanguage=function(e){var t=this;if(t.languages&&t.languages.length)for(var r=0;r<t.languages.length;r++)t.languages[r].name===e?(t.currLang=e,t.languages[r].selected=!0):t.languages[r].selected=!1},a.prototype.getCurrLanguage=function(){var e=this;return e.currLang},a.prototype.getCurrentAudioLanguage=function(){var e=this;if(!e.isMultiAudioAvailable())return null;var t=e.languages||[];return t=t.filter(function(e){return!!e.selected}),t.length?t[0].name:null},a.prototype.isMultiAudioAvailable=function(){var e=this;return Array.isArray(e.languages)&&e.languages.length>=2},a.prototype.isWatched=function(){var e=this;return!!e.watched},a.prototype.setWatched=function(e){var t=this;t.watched=e},a.prototype.updatePageSpaceId=function(e){var t=this,r={metrics:{pspid:e}};t.state===f.HAS_DATA&&s(D,r,t)},o.prototype.get=function(e){var t=this;return e?t.Ah[e]||null:null},o.prototype.getBySessionId=function(e){var t=this;if(!e)return null;for(var r=Object.keys(t.Ah),n=0;n<r.length;n++){var i=r[n],a=t.Ah[i];if(a&&a.videoSession===e)return a}return null},o.prototype.getAll=function(){var e=this;return e.Ah},o.prototype.updateItemFromRaw=function(e,t,r,n){var i=this,o=i.get(e.id);return o||(o=new a,o.zh(e),o.yh()),o.fillFromRaw(e,t,r,n),i.Ah[o.id]=o,o},o.prototype.fillFromSapi=function(e,t,r,n){var i=this;if(h.isArray(e))return e.map(function(e){return i.updateItemFromRaw(e,t,r,n).id});var a=new Error("No SAPI data available");return n.push(a),[]},o.prototype.notifyFetchFinished=function(e,t){var r=this;e.forEach(function(e){var n=r.get(e);n.state!==f.HAS_DATA&&(n.state=f.ERROR,t&&(n.status.code=t))}),r.Bh.forEach(function(t){t(e)})},o.prototype.registerFinished=function(e){var t=this,r=function(t){e.publish(m.METADATA_AVAILABLE,t)};return t.Bh.push(r),function(){var e=t.Bh.indexOf(r);e!==-1&&t.Bh.splice(e,1)}};var N=["configName","defaultVal","validator","transform","overwrite"]},{"../../lib":"/lib/index.js","../../lib/logger":"/lib/logger.js","./constants":7,"./error":12,"./event":"/nextgen/src/event.js","./renderers/type":44,"./stream":"/nextgen/src/stream.js","./util":"/nextgen/src/util.js"}],19:[function(e,t,r){"use strict";function n(e,t,r){var n=this;n.l=e,n.k=t,n.Ch=r;var a=e.metrics.skipComscore;if(n.Dh=a?function(){}:null,n.Eh=[],n.Fh={},n.Gh="",n.gdpr=null,n.gdpr_consent=null,c.initIframeForGDPR(),n.Hh(),n.k.subscribe(o.MEDIA_ITEM_LOADED,n.Ih,n),n.k.subscribe(o.PLAYBACK_ENDED,n.Jh,n),n.k.subscribe(o.Video.SEEKING,n.Kh,n),n.k.subscribe(o.Video.SEEKED,n.Lh,n),n.k.subscribe(o.Video.PAUSE,n.ge,n),n.k.subscribe(o.PLAYBACK_RESUMED,n.rf,n),n.k.subscribe(o.Video.WAITING,n.ne,n),n.k.subscribe(o.PLAYBACK_STARTED,n.setVideoClipLabels,n),n.k.subscribe(o.Video.PLAYING,n.pb,n),n.k.subscribe(o.CONTROLS_SET_VOLUME,n.Mh,n),n.k.subscribe(o.AD_PLAYBACK_ENDED,n.Nh,n),n.k.subscribe(o.AD_PLAYBACK_STARTED,n.setAdClipLabels,n),n.k.subscribe(o.AD_PLAYBACK_PAUSED,n.Oh,n),n.k.subscribe(o.PAUSE_VPAID,n.Oh,n),n.k.subscribe(o.AD_PLAYBACK_RESUMED,n.Ph,n),n.k.subscribe(o.RESUME_VPAID,n.Oh,n),!a&&!l.tv){var s=i.getAssetUrl(e.isLocal(),e.version,u);window.ns_&&window.ns_.StreamSense?n.Qh():i.lazyLoad(s,f,function(e){e||n.Qh()},a)}}t.exports=n;var i=e("../util"),a=e("../../../lib"),o=(e("../../../lib/logger"),e("../event")),s=e("./metrics-constants"),l=e("user-agent").userAgent,c=e("videoplayer-common-lib").Privacy,u="streamsense.min.js",p="scorecardresearch.com/p?c1=2&c2=7241469",d=77,f=1e4;n.prototype.Qh=function(){var e=this,t=("https:"===document.location.protocol?"https://sb.":"http://b.")+p;e.Dh=new window.ns_.StreamSense({},t),e.Rh={play:window.ns_.StreamSense.PlayerEvents.PLAY,pause:window.ns_.StreamSense.PlayerEvents.PAUSE,buffer:window.ns_.StreamSense.PlayerEvents.BUFFER,end:window.ns_.StreamSense.PlayerEvents.END}},n.prototype.Ih=function(){var e=this,t=e.Ch;e.Sh=0,e.Th=null,e.Uh=0;var r;switch(t.location()){
case"3":r="Emb onNet";break;case"4":r="Emb offNet";break;default:r="onProp"}e.setComscorePersistentLabels(e.Ch),e.addToComscoreQueue(function(){e.setPlaylist({y_lms:t.licenseId(),c6:t.comscoreC6(),y_sp:t.streamProtocol(),y_stype:t.streamType(),ns_st_pl:t.videoTitle(),ns_st_cs:t.dimensions(),y_st:t.site(),y_rg:t.region(),y_lc:r,y_pb:s.STRING_DEFAULT})})},n.prototype.Kh=function(e){var t=this,r=e>0?e:t.Ch.playbackPosition();t.addToComscoreQueue(function(){var e=t.l.isPaused()?"pause":"play";t.notifyState(e,{ns_st_ui:"seeking"},(1e3*r).toString())})},n.prototype.Lh=function(e){var t=this;t.addToComscoreQueue(function(){var r=t.l.isPaused()?"pause":"play";t.notifyState(r,{ns_st_ui:"seeking"},(1e3*e).toString())})},n.prototype.ne=function(e){var t=this;if(!e||!e.ignoreBuffering&&e.value){var r=t.Ch.playbackPosition();t.addToComscoreQueue(function(){t.notifyState("buffer",{},(1e3*r).toString())}),t.Vh=!0}},n.prototype.pb=function(){var e=this,t=e.Ch.playbackPosition();e.Vh&&(e.addToComscoreQueue(function(){e.notifyState("play",{},(1e3*t).toString())}),e.Vh=!1)},n.prototype.Jh=function(e,t){var r=this,n=r.Ch.playbackPosition(),i=r.l.playback.bitrate,a={ns_st_br:i.toString()};t&&(a.ns_st_pe="1"),r.addToComscoreQueue(function(){r.notifyState("end",a,(1e3*n).toString())})},n.prototype.ge=function(){var e=this,t=e.Ch.playbackPosition();e.addToComscoreQueue(function(){e.notifyState("pause",{},(1e3*t).toString())})},n.prototype.rf=function(){var e=this,t=e.Ch.playbackPosition();e.addToComscoreQueue(function(){e.notifyState("play",{},(1e3*t).toString())})},n.prototype.Oh=function(){var e=this,t=e.Ch.playbackPosition();e.addToComscoreQueue(function(){e.notifyState("pause",{},(1e3*t).toString())})},n.prototype.Mh=function(e){var t=this;t.addToComscoreQueue(function(){t.updateClipAttrs({ns_st_vo:Math.round(100*e)})})},n.prototype.Ph=function(){var e=this,t=e.Ch.playbackPosition();e.addToComscoreQueue(function(){e.notifyState("play",{},(1e3*t).toString())})},n.prototype.Wh=function(){var e=this,t=e.Ch.playbackPosition();e.addToComscoreQueue(function(){var r=e.l.playback.bitrate,n={};0!==r&&(r=r.toString(),n.ns_st_br=r),e.notifyState("play",n,(1e3*t).toString())})},n.prototype.Nh=function(){var e=this,t=e.Ch.adPlaybackPosition();e.addToComscoreQueue(function(){e.notifyState("end",{},(1e3*t).toString())})},n.prototype.setComscorePersistentLabels=function(){var e=this,t=e.Ch,r=e.Fh,n=t.rendererType();r.ns_site="yahoo-video","html"===n?r.ns_st_mp="h":r.ns_st_mp="f",r.ns_st_mv=t.playerVersion(),r.ca2=t.comscoreCA2(),r.ca4=t.comscoreC4(),r.ca6=t.comscoreC6(),r.c3=s.NULL_DEFAULT,r.ca3=s.NULL_DEFAULT,r.c4=t.comscoreC4(),r.c7=t.pageUrl(),r.c9=t.pageReferrer(),""!==e.Gh&&(r.cs_ucfr=e.Gh),null!==e.gdpr&&(r.gdpr=e.gdpr),null!==e.gdpr_consent&&(r.gdpr_consent=e.gdpr_consent),e.addToComscoreQueue(function(){e.setPersistentLabels(r)})},n.prototype.setVideoClipLabels=function(){var e=this,t=e.Ch,r="true"===t.autoplay()?"1":"0";a.isNullOrUndefined(e.Th)&&(e.Sh++,e.Th=e.Sh);var n={c5:t.comscoreC5(),ca5:t.comscoreC5(),ns_st_pr:t.videoTitle(),ns_st_ep:t.videoShowName(),ns_st_ge:t.genre(),ns_st_cu:t.pageUrl(),ns_st_vo:Math.round(t.volumeLevel()),ns_st_ty:t.contentType(),ns_st_cn:e.Th,ns_st_st:s.NULL_DEFAULT,ns_st_pu:s.NULL_DEFAULT,ns_st_sn:s.NULL_DEFAULT,ns_st_en:s.NULL_DEFAULT,ns_st_ce:0,ns_st_ddt:s.NULL_DEFAULT,ns_st_tdt:s.NULL_DEFAULT,ns_st_ia:0,ns_st_ci:t.videoId(),y_pid:t.providerId(),y_lbl:t.label(),ns_st_pn:++e.Uh,y_art:t.mainArtist(),y_pvid:t.providerVideoId(),y_s:t.pageSpaceId(),y_c:t.cdn(),y_ap:r},i=t.videoLength(),o="vc11";if("na"!==i&&i>600&&(o="vc12"),t.isLive()){var l=t.eventBegin(),c=t.eventEnd();i=""!==l&&""!==c?c-l:null,n.ns_st_li="1",o="vc23"}n.ns_st_ct=o,n.ns_st_cl=i&&"na"!==i?(1e3*i).toString():s.INT_DEFAULT;var u=e.l.playbackState.looped;e.addToComscoreQueue(function(){u?e.setClip(n,!0):e.setClip(n)}),e.Wh()},n.prototype.setAdClipLabels=function(){var e=this,t=e.Ch,r="true"===t.autoplay()?"1":"0",n="va11",i=t.adId()||s.INT_DEFAULT,a=t.adPosition(),o=t.adDuration();t.isLive()?n="va21":"postroll"===a?n="va13":"midroll"===a&&(n="va12");var l={c5:t.comscoreC5ForAd(),ca5:t.comscoreCA5ForAd(),ns_st_ty:t.contentType(),ns_st_ct:n,ns_st_ad:"1",ns_st_pr:"ad",ns_st_ep:"ad",ns_st_cu:s.STRING_DEFAULT,ns_st_vo:Math.round(t.volumeLevel()),ns_st_cn:++e.Sh,ns_st_ci:i,ns_st_cl:o?(1e3*o).toString():s.STRING_DEFAULT,ns_st_pn:"1",y_pid:t.providerId(),y_lbl:t.label(),y_art:t.mainArtist(),y_pvid:t.providerVideoId(),y_s:t.pageSpaceId(),y_ap:r};e.addToComscoreQueue(function(){e.setClip(l)}),e.Wh()},n.prototype.setPersistentLabels=function(e){var t=this;t.Dh.setLabels(e)},n.prototype.setPlaylist=function(e){var t=this;t.Dh.setPlaylist(e)},n.prototype.setClip=function(e){var t=this;t.Dh.setClip(e)},n.prototype.notifyState=function(e,t,r){var n=this;n.Dh.notify(n.Rh[e],t,r)},n.prototype.updateClipAttrs=function(e){var t=this,r=t.Dh.getClip();r&&r.setLabels(e)},n.prototype.Xh=function(){var e=this,t=e.Eh;t.forEach(function(e){e()}),e.Eh=[]},n.prototype.addToComscoreQueue=function(e){var t=this,r=t.Eh;r.push(e),t.Dh&&t.Xh()},n.prototype.Hh=function(){var e=this;c.getUSPDoNotSell(function(t,r){r&&(e.Gh=t.doNotSell?"0":"1")}),"undefined"!=typeof window.__tcfapi?window.__tcfapi("getTCData",2,function(t,r){r?t&&t.gdprApplies&&t.tcString&&(e.gdpr=1,e.gdpr_consent=t.tcString):e.Yh()}):this.Yh()},n.prototype.Yh=function(){var e=this;c.getVendorConsent(d,function(t,r){if(r){var n=t&&t.gdprApplies;"0"!==e.Gh&&n&&(e.Gh=t.hasConsent===!0?"1":"0")}})}},{"../../../lib":"/lib/index.js","../../../lib/logger":"/lib/logger.js","../event":"/nextgen/src/event.js","../util":"/nextgen/src/util.js","./metrics-constants":21,"user-agent":233,"videoplayer-common-lib":237}],20:[function(e,t,r){"use strict";function n(e){var t=this,r=e.mmActivityId(),n=["rnd"],i={rnd:e.randomVal},a={baseUrl:r,keys:[],data:{}};t.sendOpts={baseUrl:r,target:"marketingpixel",paramGetters:i,beginningKeys:n,iFrameBeacon:!0},t.beaconMappings={PLAYBACK_START:a}}var i=e("../../../lib");t.exports=n,n.prototype.shouldFire=function(e){var t=this,r=i.isNullOrUndefined(e.metrics.mmActivityId)?"":e.metrics.mmActivityId.toString();return!(""===r||!t.isValidUrl(r))&&(t.sendOpts.baseUrl=r,!0)},n.prototype.isValidUrl=function(e){return e.match(/^https:\/\/[a-z0-9-\.]+\.[a-z]{2,4}\/?([^\s<>\#%"\,\{\}\\|\\\^\[\]`]+)?$/)}},{"../../../lib":"/lib/index.js"}],21:[function(e,t,r){"use strict";t.exports={PROGRESS_INTERVAL:10,TRUE_STREAMS_INTERVAL:3,QUARTILE_PROGRESS_INTERVAL:25,BEACON_HIDE_VALUE:{},BEACON_HIDE_KEY_VALUE:{},STRING_DEFAULT:"none",INT_DEFAULT:"",NULL_DEFAULT:"*null",CLICK:"click",AUTOPLAY:"autoplay",API:"api",CONTINUOUS:"continuous",HOVER:"hover",PLAY:"play",PAUSE:"pause",SCROLL:"scroll",SWIPE:"swipe",BACKGROUND:"background",DEFAULT_PAGE_SPACE_ID:"1111",PLAYBACK_PROGRESS_MODE_CLASSIC:{fixed:[3],recurring:10,playerUnload:!1,playPause:!1,firingCriteria:"FREQ_MODE_CLASSIC"},PLAYBACK_PROGRESS_MODE_STANDARD:{fixed:[3,10],recurring:30,playerUnload:!0,playPause:!0,firingCriteria:"FREQ_MODE_STANDARD"},BEACON_DISASTER_MODE:{global:0,PLAYBACK_START:1,PLAYER_ERROR:.05},SEG_INFO_LENGTH:6}},{}],22:[function(e,t,r){"use strict";function n(e,t,r){r=g.extend(r||{},{baseUrl:"https://bats.video.yahoo.com/p"}),s(e,t,r)}function i(e,t,r){var n=this;n.l=e,n.k=t,n.Ha=r,n.loadRapidConfigFromModel(),n.Zh={},n.$h=!1,n.k.subscribe(m.VIDEO_REQUEST,n._h,n),n.k.once(m.START_SCREEN_RENDERED,n.ai,n),n.k.subscribe(m.HLS_FIRST_TS_LOAD_START,n.bi,n),n.k.subscribe(m.HLS_FIRST_TS_FIRST_BYTE_ARRIVE,n.di,n),n.k.subscribe(m.PLAYBACK_STARTED,n.ei,n),n.k.subscribe(m.PLAYBACK_REQUEST,n.gi,n),n.k.subscribe(m.PLAYBACK_RESUMED,n.rf,n),n.k.subscribe(m.PLAYBACK_STALLED,n.ii,n),n.k.subscribe(m.API.UI_INTERACT,n.ji,n),n.k.subscribe(m.API.BITRATE_CHANGE,n.Ce,n),n.k.subscribe(m.API_CALLED,n.ki,n),n.k.subscribe(m.RECOVERY_METADATA_READY,n.Ie,n),n.k.subscribe(m.ABR_DATA_UPDATE,n.li,n),n.k.subscribe(m.SEG_INFO_AVAILABLE,n.mi,n),n.k.subscribe(m.SEGMENT_FIRST_BYTE_LOADED,n.oi,n),n.k.subscribe(m.MEDIA_ITEM_LOADED,n.D,n),n.k.subscribe(m.PRELOAD_START,n.pi,n),n.k.subscribe(m.PRELOAD_PROGRESS,n.qi,n),n.k.subscribe(m.PRELOAD_COMPLETE,n.si,n),n.k.subscribe(m.PLAY_CALLED_ON_RENDERER,n.ti,n),n.k.subscribe(m.CTRL_PLAYPAUSE,n.wi,n),n.k.subscribe(m.CTRL_SEEK,n.xi,n),n.k.subscribe(m.CTRL_VOLUME,n.yi,n),n.k.subscribe(m.FULLSCREEN_CHANGE,n.zi,n),n.k.subscribe(m.CTRL_SETTINGS,n.Ai,n),n.k.subscribe(m.CTRL_PLAYREQUEST,n.Bi,n),n.k.subscribe(m.CC.UI_TOGGLE,n.Ci,n),n.k.subscribe(m.CC.LANGUAGE_CHANGE,n.Di,n),n.k.subscribe(m.CC.UPDATE_STYLE,n.Ei,n),n.k.subscribe(m.CC.SETTINGS,n.Fi,n),n.k.subscribe(m.CC.SHOW_CONTROLS,n.Gi,n),n.k.subscribe(m.CTRL_AGEGATE_BDAY,n.Hi,n),n.k.subscribe(m.CTRL_REPLAY,n.Ii,n),n.k.subscribe(m.QUALITY_SELECTED,n.Ee,n),n.k.subscribe(m.CTRL_TIMER,n.Ji,n),n.k.subscribe(m.UI_LOGIN,n.Ki,n),n.k.subscribe(m.CTRL_ENDSCREEN_VID,n.Li,n),n.k.subscribe(m.CONTROLS_AUDIO_CHANGE,n.Mi,n),n.k.subscribe(m.API.PLAYER_MUTE_CHANGE,n.Be,n),n.k.subscribe(m.THREE_SIXTY_INTERACT,n.Ni,n),n.k.subscribe(m.THREE_SIXTY_PIE_INTERACT,n.Oi,n),n.k.subscribe(m.Video.TIMEUPDATE,n.A,n),n.k.subscribe(m.PLAYBACK_ENDED,n.Jh,n),n.k.subscribe(m.Video.PAUSE,n.ge,n),n.k.subscribe(m.Video.SEEKING,n.Kh,n),n.k.subscribe(m.Video.SEEKED,n.Lh,n),n.k.subscribe(m.Video.WAITING,n.ne,n),n.k.subscribe(m.AD_METRICS,n.Pi,n),n.k.subscribe(m.AD_PLAYBACK_STARTED,n.u,n),n.k.subscribe(m.AD_PLAYBACK_PROGRESS,n.B,n),n.k.subscribe(m.AD_PLAYBACK_ENDED,n.Nh,n),n.k.subscribe(m.AD_PLAYBACK_ERROR,n.Qi,n),n.k.subscribe(m.AD_BREAK_INFO,n.Ri,n),n.k.subscribe(m.AD_BREAK_ENDED,n.Si,n),n.k.subscribe(m.Ad.BREAK_CANCELLED,n.Ti,n),n.k.subscribe(m.Ad.IFRAME_LOAD,n.Ui,n),n.k.subscribe(m.Ad.IFRAME_LOADED,n.Vi,n),n.k.subscribe(m.YVAP_MIDROLL_CACHE_UPDATE,n.Wi,n),n.k.subscribe(m.RENDERER_PLUGIN_LOADED,n.Xi,n),n.k.subscribe(m.RENDERER_PLUGIN_LOAD_FAILED,n.Yi,n),n.k.subscribe(m.RENDERER_PLUGIN_LOAD_TIMED_OUT,n.Zi,n),n.k.subscribe(m.API.AIRPLAY_CONNECTION_STATE_CHANGE,n.$i,n),g.getWindow().addEventListener("unload",n._i.bind(n)),n.aj=0,n.bj=null,n.cj=null,n.k.subscribe(m.ERROR,n.tb,n),n.k.subscribe(m.WARNING,n.Yd,n),n.k.subscribe(m.INFO,n.dj,n),n.k.subscribe(m.API.PLAYBACK_TIMEOUT,n.Yd,n),n.debugSt="",n.ej=!1,n.Ch=n.fj(),n.gj=0,n.hj=0,n.ij=0,n.jj=n.l.guid,n.kj=!1,n.lj=!1,n.mj=0,n.nj=0,n.oj=[],n.pj=null,n.qj=null,n.rj=0,n.sj=0,n.tj=0,n.uj=0,n.vj=!1,n.wj,n.xj=null,n.yj=!1,n.zj=[],n.Aj=n.l.failOver&&n.l.failOver.beaconDisasterMode||!1,n.Bj=L.PLAYBACK_PROGRESS_MODE_STANDARD,n.l.metrics.progressBeaconStrategy&&(n.Bj=n.l.metrics.progressBeaconStrategy,n.Bj.firingCriteria="FREQ_MODE_CONFIG"),n.Cj=0,n.Dj={},n.Ej={},n.Fj={},n.Gj=0,n.Hj=0,Math.random()<=n.l.metrics.ultSamplingRate&&n.zj.push(new A(e,n.Ch)),g.shouldDisable3PMetricSystem()||(n.zj.push(new T(n.Ch)),this.l.metrics.disableBeacons!==!0&&(n.Ij=new S(e,n.k,n.Ch))),n.Jj(),n.Kj(),n.Lj={},n.Mj=null,n.viewability={value:0,timestamp:0},n.Nj=!1,n.Oj=!1,n._sqno=0}function a(e,t){var r=this;r.l=e,r.Fk={RANDOM_VALUE:t.randomVal,PLAYLIST_INDEX:t.playlistPosition,VOLUME_LEVEL:t.volumeLevel,DEVICE_NAME:t.deviceName,MAKE:t.deviceMake,MODEL:t.deviceModel,OS:t.deviceOS,AD_ID:t.adId,AD_LOADED:function(){return t.adLoaded()?"yes":"no"},AD_TYPE:t.adType,EVT_NAME:function(e){switch(e){case"PLAYBACK_START":return"play";case"PLAYBACK_PAUSE":return"pause";case"PLAYBACK_COMPLETE":return"end";default:return"unknown"}}}}function o(e,t){return g.strSubstitute(e,function(e){var r=t(e);return null!==r?r:(_.error("Metrics: unknown substitution key: "+e),"")})}function s(e,t,r,n,i){var a=r.beginningKeys||[],o=r.endKeys||[],s=r.paramGetters,c=r.mediaItem,u=[].concat(a,e,o),p=u.filter(function(e,t){return u.indexOf(e)===t}),d=[];p.forEach(function(e){var r;if(r=e in t?t[e]:e in s?s[e](c):null,b.isNullOrUndefined(r)&&(r=L.BEACON_HIDE_KEY_VALUE),r===L.BEACON_HIDE_VALUE&&(r=null),r!==L.BEACON_HIDE_KEY_VALUE){var n={};n[e]=r,d.push(n)}});var f=r.baseUrl+"?"+g.querystring(d,"&","=",l);return n&&(f+=n),r.iFrameBeacon?g.sendIframeBeacon(f):r.unloadBeacon?g.sendUnloadBeacon(f):(g.sendImageBeacon(f),void(i&&i.publish(m.API.BEACON_SEND,{url:f,date:new Date})))}function l(e){return encodeURIComponent(e).replace(/[!'()]/g,escape).replace(/\*/g,"%2A")}function c(e){return b.isBoolean(e)&&(e=e?"1":"0"),b.isArray(e)&&(e=e.toString()),e&&""!==e?e:L.STRING_DEFAULT}function u(){try{return window.top.document}catch(e){return null}}function p(e){if(window.performance&&window.performance.getEntriesByType){var t,r=window.performance.getEntriesByType("resource");for(t in r)if(r[t].name.match(e))return r[t].duration}return null}function d(e){return e=f(e),e?e.split("?")[0]:""}function f(e){return e?e.replace(/(_ylt(.)+(\?)|_ylt(.)+)/,"?"):e}function v(){var e=this;e.val=[],e.mode="sync",e.useDefaultBufferDuration=!1}t.exports={Metrics:i,sendPlayerInitBeacon:n};var m=e("../event"),y=e("user-agent"),h=y.userAgent,E=y.capabilities,g=e("../util"),b=e("../../../lib"),_=e("../../../lib/logger"),A=e("./ult-metrics"),T=e("./marketingpx-metrics"),S=e("./comscore"),I=e("./nielsen-analytics"),L=e("./metrics-constants"),R=e("../constants"),C=e("../error"),D=e("../media-store"),O=e("../renderers/type"),N=e("../perf"),P=e("../navigator-info"),k=P.network,M=e("../states"),w=4,x=1e3,F=20,U={801:1},B={ERROR:"error",DESTROY:"destroy",UNLOAD:"unload"};i.prototype.Pj=function(e){var t=this,r=Math.floor(4294967295*Math.random());return e&&!t.Fj[e.id]&&(t.Fj[e.id]=r),r},i.prototype.fj=function(){var e=this,t=e.l,r=function(){return t.playlist.getCurrentItem()},n=function(t){var r=e.Ha.getItem(t);return r&&!b.isNullOrUndefined(r.timeDiff)?r.timeDiff:L.INT_DEFAULT},i=function(t){var r=e.Ha.getItem(t);return r&&!b.isNullOrUndefined(r.startTime)?r.startTime+e.Ha.startTime:L.INT_DEFAULT},a=function(e,t){var n,i=r(),a=i?i.metrics.beacons:null;if(a){var o=a[e]&&a[e][0]||{};if("cs"===o.target&&o.addParam){var s=o.addParam.split("&");s.forEach(function(e){e.indexOf(t)!==-1&&(n=e.split("=")[1])})}}return n||L.INT_DEFAULT},o=function(){var t=e.Ha.getItem(m.Metrics.PLAYBACK_START);return t&&null===t.endTime&&e.Ha.setEndTime(m.Metrics.PLAYBACK_START),t},s={configDockingEnableOnScroll:function(){var t=e.l.ui&&e.l.ui.docking||{};return t.enableOnScrollDown||t.enableOnScrollUp?1:0},configDockingEnableOnMuted:function(){var t=e.l.ui&&e.l.ui.docking||{};return t.enableOnMuted?1:0},currVolume:function(){return e.l.getVolume()},tsapic:function(){var t=e.Ha.getItem(m.Metrics.SAPI_REQUEST);return t&&t.timeDiff&&0!==t.timeDiff?t.timeDiff:""},sapiColo:function(){return e.l.CMS.colo||""},cachedVs:function(){return e.l.CMS.cachedVs||""},flashVersion:function(){var t="na";return e.cj&&e.l.playbackState.rendererType===O.FLASH&&(t=e.cj.getFlashVersion(),t&&t.join(".")),t},site:function(){var e=t.baseConfig.siteAnalytics.toLowerCase();return c(e?e.toLowerCase():t.baseConfig.site.toLowerCase())},region:function(){return c(t.baseConfig.region.toLowerCase())},autoplay:function(){return t.playback.autoplay?"true":"false"},dimensions:function(){return t.uiState.width+"x"+t.uiState.height},videoSeqNum:function(){return e.Qj},isLive:function(e){var t=e||r();return t&&t.isLive()?1:0},isResume:function(){return t.playback.isResume?1:0},liveState:function(e){var t=e||r();return t&&t.liveState?t.liveState:""},bitrate:function(){return t.playback.bitrate},quality:function(){return t.playback.quality},continuousPlay:function(){return t.playback.continuousPlay?1:0},continuousPlayCount:function(){return e.gj},replayCount:function(){return e.hj},location:function(){return t.offNetwork?4:g.isIFrame()?3:1},offNetwork:function(){return t.offNetwork?1:L.BEACON_HIDE_KEY_VALUE},lang:function(){return t.baseConfig.lang.toLowerCase()},licensorName:function(e){var t=e||r();return c(t?t.license.licensorName:null)},licenseId:function(e){var t=e||r();return t?t.license.licenseId:L.INT_DEFAULT},videoId:function(e){var t=e||r();return t?t.id:L.INT_DEFAULT},videoTitle:function(e){var t=e||r();return c(t?t.title:null)},videoShowName:function(e){var t=e||r();return c(t?t.showName||t.license.licenseName:null)},videoQuartile:function(t){return t===!0?e.Hj:e.Gj},playbackPosition:function(){return Math.round(e.Rj)},adPlaybackPosition:function(){return Math.round(e.Sj)},seqStart:function(){return Math.round(e.Tj)},playerInt32Guid:function(){return e.jj},clipGuid:function(){return e.Uj||""},masterPlayerInt32Guid:function(){return e.Vj},videoLength:function(e){var t=e||r();return c(t?t.duration:null)},pageTitle:function(){var e=u();return e?e.title:L.STRING_DEFAULT},pageUrl:function(){return f(g.getHostUrl())},eventBegin:function(e){var t=e||r();return t&&t.eventBeginTime?t.eventBeginTime:""},eventEnd:function(e){var t=e||r();return t&&t.eventEndTime?t.eventEndTime:""},pageReferrer:function(){if(t.baseConfig.referrer)return t.baseConfig.referrer;var e=u();return e&&""===e.referrer&&window.history&&window.history.state&&window.history.state.referer?d(window.history.state.referer):e?d(e.referrer):L.STRING_DEFAULT},streamProtocol:function(e){var t=e||r(),n=t?t.streams[0]:null;return c(n?n.url.split(":")[0]:null)},streamType:function(n){var i=n||r();if(!i){var a=e.l.playlist.items.length,o=t.playlist.position;e.debugSt+="il:"+a,e.debugSt+=",p:"+o}return i?i.getType():"none"},audioLanguage:function(e){var t=e||r();return t&&t.getCurrentAudioLanguage()||"na"},errorCode:function(){for(var e=t.errors,r=0;r<e.length;r++)if(e[r].code)return e[r].code;return 100},syndication:function(){return t.baseConfig.syndication},playerVersion:function(){return t.version},experienceName:function(){return t.baseConfig.experienceName.toLowerCase()},experienceType:function(){return t.baseConfig.experienceType.toLowerCase()},experienceBucket:function(){return t.baseConfig.experienceBucket},testBucket:function(){var e=t.baseConfig.experienceBucket,r=t.playerHostingConfig.log;return e?e+=r?","+r:"":e=r,e},experienceLatency:function(){return t.metrics.experienceLatency?t.metrics.experienceLatency:"na"},playListId:function(){return c(t.playlist.id)},jurisdiction:function(){return t.baseConfig.jurisdiction},randomVal:function(){return Math.random()},pageSpaceId:function(){return t.baseConfig.pageSpaceId||e.Wj&&e.Wj.Spaceid||L.DEFAULT_PAGE_SPACE_ID},videoSpaceId:function(e){var t=e||r();return t?t.metrics.pageSpaceId:L.INT_DEFAULT},percentWatched:function(e,t){return t>0?Math.floor(100*e/t):0},ccode:function(){return t.metrics.ccode},sec:function(){return t.metrics.rapidFields.sec||t.metrics.sec},cpos:function(){return t.metrics.cpos},comscoreCA1:function(){return a("PLAYBACK_START","CA1")},comscoreCA2:function(){return a("PLAYBACK_START","CA2")},comscoreCA5ForAd:function(){return a("AD_START","CA5")},comscoreC4:function(){var e=t.metrics.comscoreC4;return e&&e.length?e:L.NULL_DEFAULT},comscoreC5:function(e){var t=e||r();return t?t.metrics.comscoreC5:L.INT_DEFAULT},comscoreC5ForAd:function(){return"09"},comscoreC6:function(e){var t=e||r();return t?t.metrics.comscoreC6:L.INT_DEFAULT},rendererType:function(){return e.getMetricRendererType(t.playbackState.rendererType)},contentRendererType:function(t){var n=t||r();return n?e.getMetricRendererType(n.rendererType):L.STRING_DEFAULT},playerType:function(){return"nextgen-desktop"},jsDownloadTime:function(){return c(t.pageLatency.pagePlayerJsDownloadTime)},providerId:function(e){var t=e||r();return t&&t.provider.providerId?t.provider.providerId:L.INT_DEFAULT},providerVideoId:function(e){var t=e||r();return t&&t.provider.providerVideoId?t.provider.providerVideoId:L.INT_DEFAULT},publisherId:function(e){var t=e||r();return c(t?t.provider.publisherId:null)},genre:function(e){var t=e||r();return c(t&&t.genres.length?t.genres[0]:L.NULL_DEFAULT)},syndicationId:function(){return t.baseConfig.syndication.split("-")[0]},mainArtist:function(e){var t=e||r();return c(t&&t.credits.mainArtists.length?t.credits.mainArtists[0]:null)},label:function(e){var t=e||r();return c(t&&t.credits?t.credits.label:null)},tripleplay:function(e){var t=e||r();return t&&"tripleplay"===t.provisioningSource?1:L.INT_DEFAULT},playlistPosition:function(){return t.playlist.position},volumeLevel:function(){return t.getMute()?0:100*t.getVolume()},deviceName:function(){return H.name},deviceMake:function(){return H.make},deviceModel:function(){return H.model},deviceOS:function(){return H.os},networkConnectionType:function(){return k.available?k.connectionType:"na"},networkConnectionTypeUa:function(){return E.getConnectionType()||"na"},isMobileNetworkConnection:function(){return k.available?k.mobile?"1":"0":"na"},autoplayAllowed:function(){return t.isAutoplayAllowed()},autoplaySupported:function(){return P.autoplaySupported||"na"},inlinePlaybackSupported:function(){return P.canPlayInline||"na"},adId:function(){var e=t.playbackState.ad;return c(e?e.adId:null)},adDuration:function(){var e=t.playbackState.ad;return c(e?e.duration:null)},adPosition:function(){var e=t.playbackState.ad;return c(e?e.position:null)},adLoaded:function(){return!!t.playbackState.ad},adType:function(){var e=t.playbackState.ad;return c(e?e.position:null)},typeOfContent:function(){return t.playbackState.videoSet()?t.playbackState.ad?"ad":"vid":"na"},playbackState:function(){return t.getState()},mediaMetaTags:function(e){var t=e||r();return c(t?t.metrics.ywa:null)},isDrm:function(e){var t=e||r();return c(t?t.hasDrmStreams():null)},videoSession:function(e){var t=e||r();return t&&t.videoSession?t.videoSession:L.STRING_DEFAULT},samplingId:function(e){var t=e||r();return t&&!isNaN(t.samplingId)?t.samplingId:L.STRING_DEFAULT},isMature:function(e){var t=e||r();return t&&"none"!==t.ageGate?1:0},isMute:function(){return t.getMute()?"m":"um"},cdn:function(e){var t=e||r(),n=t?t.getCDN():null;return n?n:"uncalculated"},contentType:function(){return e.Xj()},streamStatus:function(e){var t=e||r(),n=t&&t.liveState?t.liveState:"";return"pre"===n||"live"===n?"live":"vod"},rateControlMode:function(e){var t=e||r(),n=t&&t.streams&&t.streams.length?t.streams[0].rcMode:L.STRING_DEFAULT;return n},playerLocation:function(){var e=t.offNetwork?4:g.isIFrame()?3:1;switch(e){case 3:return"Emb onNet";case 4:return"Emb offNet";default:return"onProp"}},ucLatency:function(){var t=e.Ha.getItem(m.Metrics.CLICK_TO_START),r=1===e.gj&&t?t.timeDiff:"";return r},apLatency:function(){var t;t=e.gj>1?e.Ha.getItem(m.Metrics.INIT_CONT_PLAY_START):e.Ha.getItem(m.Metrics.INIT_TO_START);var r=t?t.timeDiff:null;return r?r:""},apLatencyStartTime:function(){return i(m.Metrics.INIT_TO_START)},viewability:function(){return e.Yj()+"%"},playbackWatchedTime:function(){return Math.round(e.mj)},bufferingTime:function(){return Math.round(e.nj)},rendererPluginLoadStatus:function(){return e.aj},loadFirstFragmentTime:function(){var t=e.Ha.getItem(m.Metrics.HLS_FIRST_TS_LOAD_START),r=t?t.timeDiff:null;return r?r:L.INT_DEFAULT},firstByteFirstFragmentTime:function(){var t=e.Ha.getItem(m.Metrics.HLS_FIRST_TS_FIRST_BYTE_ARRIVE),r=t?t.timeDiff:null;return r?r:L.INT_DEFAULT},mmActivityId:function(e){var t=e||r();return t&&t.metrics&&t.metrics.mmActivityId||null},wrapInFn:function(e){return function(){return e}},hostingEnv:function(){return t.playerHostingConfig.env?t.playerHostingConfig.env:t.isLocal()?"l":"p"},hostingBucket:function(){var e=t.playerHostingConfig.bucket,r=t.playerHostingConfig.env;return!e&&r&&(e=r),e||L.STRING_DEFAULT},hostingColo:function(){return t.playerHostingConfig.colo||L.STRING_DEFAULT},algo:function(e){var n=e||r();if(n){if(n.relatedVideoIds.length){var i=t.mediaStore.get(n.relatedVideoIds[0]);return i.instrument&&i.instrument.algo?i.instrument.algo:""}return n.instrument&&n.instrument.algo?n.instrument.algo:""}return null},instrument:function(e){var t=e||r(),n="";return t&&t.instrument&&Object.keys(t.instrument).length>0&&(n=JSON.stringify(t.instrument)),n},displayMode:function(){return e.fullScreenMode?"full":"window"},constructLatency:function(){return n(m.Metrics.VP_CONSTRUCTOR)},renderCreateLatency:function(){return n(m.Metrics.CREATE_RENDERER)},sapiLatency:function(){return n(m.Metrics.SAPI_REQUEST)},sapiLatencyStartTime:function(){return i(m.Metrics.SAPI_REQUEST)},swfLatency:function(){return n(m.Metrics.SWF_READY)},swfLatencyStartTime:function(){return i(m.Metrics.SWF_READY)},initToSapiLatency:function(){return n(m.Metrics.INIT_TO_SAPI)},renderToSwfLatency:function(){return n(m.Metrics.RENDER_TO_SWF)},initRenderGapLatency:function(){return n(m.Metrics.INIT_RENDER_GAP)},ccPrefLatency:function(){return n(m.Metrics.GET_USER_PREFS)},hlsPlaylistLatency:function(){return n(m.Metrics.LOAD_TO_LOADED_DATA)},streamLatency:function(){return n(m.Metrics.STREAM_REQUEST_TO_RENDER)},streamLatencyStartTime:function(){return i(m.Metrics.STREAM_REQUEST_TO_RENDER)},playToRenderLatency:function(){return n(m.Metrics.STREAM_PLAY_TO_RENDER)},segInfo:function(){return JSON.stringify({seg:e.oj.slice(0,Math.min(L.SEG_INFO_LENGTH,e.oj.length))})},bufferLength:function(){return e.pj},buffTimeDiff:function(){return e.sj},segmentBuffTime:function(){return Math.round(e.tj)},progressBeaconDistance:function(){var t=Math.round(e.mj)-Math.round(e.uj);return t>=0?t:0},getRecoveryStatus:function(e){var t=e||r();return t.getRecoveryStatusForBeacon()},recoveryStatus:function(t){var n=t||r();return e.vj?D.ItemRecoveryStatus.RECOVERED:n&&n.recoveryStatus===D.ItemRecoveryStatus.RECOVERING?D.ItemRecoveryStatus.RECOVERING:L.BEACON_HIDE_KEY_VALUE},pageLatency:function(){return t.metrics.pageLatency?t.metrics.pageLatency:"na"},playerJsDownloadTime:function(){return e.wj||(e.wj=p(/videoplayer(-nextgen-\w+)?-(min|debug).js/)),"number"==typeof e.wj?Math.round(e.wj):"na"},playerSwfDownloadTime:function(){return e.Zj||(e.Zj=p(/player\.swf$/)),"number"==typeof e.Zj?Math.round(e.Zj):"na"},playerCSSDownloadTime:function(){return e.$j||(e.$j=p(/yvp-video-player\.css$/)),"number"==typeof e.$j?Math.round(e.$j):"na"},requestType:function(){return e.l.playback.requestType||L.STRING_DEFAULT},requestAction:function(){return e.l.playback.requestAction||L.STRING_DEFAULT},playlistUI:function(){return e.l.ui.playlistUI&&e.l.ui.playlistUI.show===!0?"true":"false"},clientWidth:function(){return e.l.playerDimension.width},clientHeight:function(){return e.l.playerDimension.height},retinaDisplayDetected:function(){return window.devicePixelRatio>1},getVPATraceDigest:function(e){var t=e||r();return t&&t.vpaTraceDigest?t.vpaTraceDigest:"na"},getProgressBeaconMode:function(){return e.Bj},manufacturer:function(){return t.CTV.man},deviceClass:function(){return t.CTV.class},closedCaptionsUserPreference:function(){var t=e.l.userPreferences&&e.l.userPreferences.closedCaptions&&e.l.userPreferences.closedCaptions.show;return t?"1":"0"},ccAvailabilty:function(e){var t=e||r(),n=t&&t.isCCAvailable||!1;return n?"1":"0"},isPlayerDocked:function(){return e.l.uiState.isDocked},expMode:function(){return t.uiState.isFullscreen?"fullscreen":"lightbox"===t.baseConfig.experienceName.toLowerCase()?"lightbox":t.uiState.isDocked?"docked":"na"},playlistUIType:function(){var t=e.l.ui&&e.l.ui.playlistUI&&e.l.ui.playlistUI.show===!0&&e.l.ui.playlistUI.position,r="";return r="right"!==t||e.l.ui.playlistUI.inStream?t?t:"none":"hero"},playlistUIUuid:function(t){var n="",i=t||r();if(i){var a=i.getPlaylistSource();n=a?a:""}return""===n&&e.l.ui&&e.l.ui.playlistUI&&e.l.ui.playlistUI.show===!0&&(n=e.l.ui.playlistUI.playlistId||e.l.ui.playlistUI.playlistAlias||""),n},playlistSection:function(e){var t=e||r();return t?t.getSectionType():""},sizmekIfrmValue:function(){return 1},atlasMarker:function(){return e._j||""},isBumper:function(e){var t=e||r();return t&&t.isBumper()},pt:function(){return t.metrics.rapidFields.pt},pd:function(){return t.metrics.rapidFields.pd},pct:function(){return t.metrics.rapidFields.pct},pstcat:function(){return t.metrics.rapidFields.pstcat},ver:function(){return t.metrics.rapidFields.ver},rid:function(){return t.metrics.rapidFields.rid},rlvtscr:function(){return t.metrics.rapidFields.rlvtscr},vidPos:function(){return t.metrics.rapidFields.vidPos},pstaid_p:function(){return t.metrics.rapidFields.pstaid_p},pkgt:function(){return t.metrics.rapidFields.pkgt},subsec:function(){return t.metrics.rapidFields.subsec},flashAvailable:function(){return t.flashAvailable},focus:function(){return g.isPlayerInBackground()?"0":"1"},bcktConfig:function(){return t.playerHostingConfig.config?1:0},ccOk:function(t){var n=t||r();if(!n)return"na";var i=n.isCCInRawMediaItem()||n.isCCAvailable;return i===e.Oj},timeDiff:function(){var e=o(),t=e&&e.timeDiff?e.timeDiff:"";return t},startTime:function(){var t=o(),r=t.startTime+e.Ha.startTime;return t&&r?r:""},adInfo:function(){return e.Mj},titssc:function(){return e.ij},debugSt:function(){return e.debugSt},programDateTimeLatency:function(){if(e.cj){var t=e.cj.getCurrentDate(),r=(new Date).getTime();return t>0?r-t:L.INT_DEFAULT}return L.INT_DEFAULT},drmSystem:function(e){var t=e||r(),n=t?t.drmSystem:"none";return n},drmProtected:function(e){var t=e||r(),n=!!t&&t.isDrmProtected;return n},bx:function(){return g.getCookie("BX",{raw:!0})||""},sqno:function(){return e._sqno},timestamp:function(){return Date.now()-e.Ha.startTime}};return s},i.prototype.setRootElem=function(e){var t=this;t.bj=e},i.prototype.setActiveRenderer=function(e){var t=this;t.cj=e},i.prototype.loadRapidConfigFromModel=function(){var e=this;e.Wj=e.l.rapidConfig,e.ak=e.Wj&&e.Wj.rapid?e.Wj.rapid:null,e.bk=e.Wj?e.Wj.clickParams||{}:{}},i.prototype.ck=function(e){var t=this,r=Array.prototype.slice.call(arguments,1),n=[],i=null,a=null,o={INCOMPLETE_EXIT:!0};t.Aj&&t.dk(e)||(r.length>0&&(n=[r[0].data],i=r[0].fireCriteria,a=r[0].mediaItem),t.zj.forEach(function(r){var l=r.beaconMappings[e];if(l){var c=t.l.playlist,u=c?c.getCurrentItem():null;if(!r.shouldFire||r.shouldFire(u)!==!1){var p=l.keys;b.isFunction(p)&&(p=p.apply(r,n));var d=l.data;b.isFunction(d)&&(d=d.apply(r,n));var f=g.extend({},r.sendOpts);if(l.overrideBaseKeys&&(f.beginningKeys=f.endKeys=[]),l.baseUrl&&(f.baseUrl=l.baseUrl),o[e]&&(f.unloadBeacon=!0),a&&(f.mediaItem=a),u){var v,m=u.metrics.beacons;if(e in m)for(var y=u.metrics.beacons[e]||[],h=0;h<y.length;h++){var E=y[h];if(E.target===f.target&&E.addParam){v=t.ek(E.addParam);break}}}if((!i||l.firingCriteria.indexOf(i)>=0)&&s(p,d,f,v,t.k),"ult"===r.sendOpts.target&&t._sqno++,l.extras)for(var _=0;_<l.extras.length;_++){f.baseUrl=l.extras[_].baseUrl;var A=l.extras[_].data;b.isFunction(A)&&(A=A.apply(r,n)),s(l.extras[_].keys,A,f,null,t.k)}}}}),t.fk&&t.fk.sendBeacon(e,n))},i.prototype.dk=function(e){var t=L.BEACON_DISASTER_MODE,r=!1;return t.global<1&&(r=Math.random()>t.global),t[e]&&(r=1!==t[e]&&Math.random()>t[e]),r},i.prototype.ek=function(e){var t=this,r=t.Ch;return b.isString(e)?e.replace("{COMSCORE_C4}",r.comscoreC4()).replace("{COMSCORE_C5}",r.comscoreC5()).replace("{COMSCORE_C6}",r.comscoreC6()):null},i.prototype.Jj=function(){var e=this,t=g.getSingleton("Metrics");t||(t={},g.setSingleton("Metrics",t)),t.PageView?e.Vj=t.MasterPlayer:(e.Vj=e.jj,t.MasterPlayer=e.Vj,t.PageView=!0,e.ck("PAGE_VIEW"))},i.prototype._h=function(e){var t=this,r=t.Ch;t.Nj=!0,t.qj=Date.now(),r.isBumper()||(t.l.ui.showReplayOnlyEndScreen||t.l.getLoop()?(t.hj++,t.gj=1):t.gj++),t.ck("VIDEO_REQUEST",{data:e})},i.prototype.Bi=function(e){var t=this;t.ck("CTRL_PLAYREQUEST",{data:e?e:""})},i.prototype.Kj=function(){var e=this;e.ck("PLAYER_LOADED")},i.prototype.ai=function(){var e=this;e.Ha.setEndTime(m.Metrics.INIT_TO_STARTSCREEN);var t=e.Ha.getItem(m.Metrics.INIT_TO_STARTSCREEN);t&&(e.ij=t.timeDiff)},i.prototype.gi=function(){var e=this;e.gk=!1,e.Rj=0,e.hk(),e.ik=e.Rj,e.mj=0,e.rj=0,e.uj=0,e.Qj=1,e.Tj=e.Rj,e.nj=0,e.vj=e.Ch.getRecoveryStatus(),!e.vj||e.Nj||e.Vh?(e.oj=[],e.tj=0,e.kj=!1):(e.Vh=!0,e.jk=Date.now())},i.prototype.ji=function(e){var t=this,r=["ui_pl_nxt_clk","ui_pl_nxt_hvr","ui_pl_scrl","ui_pl_thmb_clk"],n={srcElement:e.srcElement,evt:r.indexOf(e.srcElement)>-1?"ui_pl":"none"};t.ck("UI_INTERACT",{data:n})},i.prototype.xi=function(e){var t=this;t.ck("CTRL_SEEK",{data:e?e:""})},i.prototype.yi=function(e){var t=this,r=t.l.getVolume();r!==e&&t.ck("CTRL_VOLUME",{data:e})},i.prototype.Ci=function(e){var t=this;t.ck("CC_TOGGLE",{data:e?"1":"0"
})},i.prototype.Di=function(e){var t=this;t.ck("CC_LANG",{data:e?e:"na"})},i.prototype.Ei=function(e){var t=this;t.ck("CC_STYLE",{data:e?e:"na"})},i.prototype.Fi=function(){var e=this;e.ck("CC_SETTINGS")},i.prototype.Gi=function(e){var t=this;t.Oj=e},i.prototype.Hi=function(){var e=this;e.ck("CTRL_AGEGATE_BDAY")},i.prototype.zi=function(e){var t=this;t.fullScreenMode=e,t.ck("FULLSCREEN",{data:e?"ON":"OFF"});var r=t.Ch.videoId();t.ak&&Object.keys(t.ak).length&&!t.Zh[r]&&t.fullScreenMode&&(t.kk("fullscreen"),t.Zh[r]=1)},i.prototype.Ai=function(){var e=this;e.ck("CTRL_SETTINGS")},i.prototype.Ee=function(e){var t=this;t.ck("QUALITY_SELECTED",{data:e.preference})},i.prototype.Ii=function(){var e=this;e.ck("CTRL_REPLAY");var t=e.Ch.videoId();e.ak&&Object.keys(e.ak).length&&!e.Zh[t]&&(e.kk("replay"),e.Zh[t]=1)},i.prototype.Ji=function(e){var t=this;t.ck("CTRL_TIMER",{data:e})},i.prototype.Ki=function(e){var t=this;t.ck("UI_LOGIN",{data:e})},i.prototype.Li=function(e){var t=this;t.ck("CTRL_ENDSCREEN_VID",{data:e})},i.prototype.Be=function(e){var t=this,r=t.Ch.videoId();t.ak&&Object.keys(t.ak).length&&!t.Zh[r]&&!e&&(t.kk("unmute"),t.Zh[r]=1)},i.prototype.Ni=function(){var e=this;e.lk||(e.lk=!0,e.ck("INTERACT_360"))},i.prototype.Oi=function(){var e=this;e.ck("INTERACT_PIE_360")},i.prototype.pi=function(){var e=this;e.ck("PRELOAD_START")},i.prototype.qi=function(){var e=this;e.ck("PRELOAD_PROGRESS")},i.prototype.si=function(){var e=this;e.ck("PRELOAD_COMPLETE")},i.prototype.ti=function(e){var t=this;t.ck("PLAY_CALLED_ON_RENDERER",{data:e.rtype})},i.prototype.$i=function(e){var t=this;e.isInitialEvt||t.ck("AIRPLAY_CONNECTION_STATE_CHANGE",{data:e.connected})},i.prototype.Yj=function(){var e=this,t=(new Date).getTime(),r=e.bj;if(r&&t-e.viewability.timestamp>1e3){var n=r.getElementsByClassName("yvp-main");n.length&&(e.viewability.value=g.getElementViewability(n[0]),e.viewability.timestamp=t)}return e.viewability.value},i.prototype.bi=function(){var e=this,t=e.Ha.getItem(m.Metrics.HLS_FIRST_TS_LOAD_START);t&&null===t.endTime&&(e.Ha.setEndTime(m.Metrics.HLS_FIRST_TS_LOAD_START),e.Ha.add(m.Metrics.HLS_FIRST_TS_FIRST_BYTE_ARRIVE))},i.prototype.di=function(){var e=this,t=e.Ha.getItem(m.Metrics.HLS_FIRST_TS_FIRST_BYTE_ARRIVE);t&&null===t.endTime&&e.Ha.setEndTime(m.Metrics.HLS_FIRST_TS_FIRST_BYTE_ARRIVE)},i.prototype.ei=function(e,t){var r=this;t&&(r.Rj=t);var n=r.Ha.getItem(m.Metrics.PLAYBACK_START);n&&null===n.endTime&&(r.Ha.setEndTime(m.Metrics.PLAYBACK_START),r.Wh(),r.Uj=r.Pj(r.l.playlist.getCurrentItem()),r.ck("PLAYBACK_START",{data:{convivaState:r.xj?r.xj.getState():-1,convivaId:"["+r.Ch.videoSession()+"]["+r.Ch.videoId()+"]"+r.Ch.videoTitle()}}),r.ij="",r.l.playback.requestType=null,r.l.playback.requestAction=null),r.$h||r.mk(),r.Mj=null,r.lk=!1},i.prototype.Xj=function(){var e,t=this,r=t.Ch,n=r.isLive()?"live":r.adLoaded()?"ad":"",i=r.adPosition();switch(n){case"ad":e="ad pre-roll","postroll"===i?e="ad post-roll":"midroll"===i&&(e="ad mid-roll");break;case"live":e=r.liveState()||"live";break;default:e=r.isBumper()?"slate":"vod short";var a=t.l.playlist.getCurrentItem();if(!a)break;var o=r.videoLength();a.isCCM?"na"!==o&&o>600&&(e="vod long"):e="streamurl"}return e},i.prototype.Wh=function(){var e=this,t={},r=e.Ha.getItem(m.Metrics.LOAD_TO_LOADED_DATA);r&&(t[m.Metrics.LOAD_TO_LOADED_DATA.type]=r.timeDiff);var n=e.Ha.getItem(m.Metrics.DRM_METADATA_IS_SET);n&&(t[m.Metrics.DRM_METADATA_IS_SET.type]=n.timeDiff);var i=e.Ha.getItem(m.Metrics.DRM_AUTH_COMPLETE);i&&(t[m.Metrics.DRM_AUTH_COMPLETE.type]=i.timeDiff);var a=e.Ha.getItem(m.Metrics.STREAM_REQUEST_TO_RENDER);a&&(t[m.Metrics.STREAM_REQUEST_TO_RENDER.type]=a.timeDiff),e.kj=!1,e.lj=!1;var o=e.Ha.getItem(m.Metrics.CLICK_TO_START);if(o&&null===o.endTime){e.Ha.setEndTime(m.Metrics.CLICK_TO_START),t[m.Metrics.CLICK_TO_START.type]=o.timeDiff;var s=o.timeDiff;e.ck("CLICK_TO_START",{data:t}),e.Ij.addToComscoreQueue(function(){e.Ij.updateClipAttrs({y_ucl:s?s.toString():L.INT_DEFAULT})})}var l=e.Ha.getItem(m.Metrics.INIT_TO_START);if(e.gj>1){var c=e.Ha.getItem(m.Metrics.INIT_CONT_PLAY_START);c&&null===c.endTime&&e.Ha.setEndTime(m.Metrics.INIT_CONT_PLAY_START)}if(l&&null===l.endTime){e.Ha.setEndTime(m.Metrics.INIT_TO_START),t[m.Metrics.INIT_TO_START.type]=l.timeDiff,e.ck("INIT_TO_START",{data:t});var u=l.timeDiff;e.Ij.addToComscoreQueue(function(){e.Ij.updateClipAttrs({y_apl:u?u.toString():L.INT_DEFAULT})})}},i.prototype.nk=function(e,t){var r=this,n=r.Ch,i=n.percentWatched(e,t);return Math.floor(i/L.QUARTILE_PROGRESS_INTERVAL)},i.prototype.A=function(e){var t=this;if(t.Nj=!1,!t.gk&&0!==e){var r=e-t.Rj;r&&(t.mj+=r),t.Rj=e,t.ok(),t.vj&&(t.pk(null,null,!0),t.vj=t.Ch.getRecoveryStatus());var n=t.l.playlist.getCurrentItem(),i=n?n.duration:0,a=t.qk(e,i);a.quartileBeacon&&t.pk(a.quartileBeacon,!1),a.progressBeacon&&t.pk(a.progressBeacon)}},i.prototype.rk=function(e,t,r){var n=this;e=e||!1;var i=new v;if(n.pj=null,n.ok(),n.k.publish(m.BEFORE_PROGRESS_BEACON,i),e=i.useDefaultBufferDuration||e,"sync"===i.mode)return n.oj=n.oj.concat(i.val),n.pj=i.bufferLen||null,n.tk(e),void(t&&t());var a=r?r.videoSession:null;a&&(n.Lj[a]||(n.Lj[a]=[]),n.Lj[a].push(function(){n.tk(e),t&&t()}))},i.prototype.tk=function(e){var t=this;t.vk(),e&&(t.oj=[{buf_dur:t.nj>F?t.nj:0}],t.tj=t.nj,t.sj=0)},i.prototype.mi=function(e){var t=this;if(e&&e.session){t.oj=t.oj.concat(e.val),t.pj=e.bufferLen||null;var r=t.Lj[e.session];r&&r.length>0&&r.shift()()}},i.prototype.oi=function(e){var t=this;t._j=e.atlasMarker},i.prototype.D=function(e){var t=this,r=t.l.metrics&&t.l.metrics.nielsenConfig?t.l.metrics.nielsenConfig:{},n=r.enableNielsen||e.enableNielsen||!1,i=r.nielsenAppId||null;n&&(t.wk||(t.wk=new I(t.k,t.Ch,i,n)),t.wk.activateBeaconing())},i.prototype.ok=function(){var e=this;if(e.Vh&&!e.Nj){if(e.Vh=!1,e.l.isPaused()||e.l.getState()===M.END)return;e.nj+=Date.now()-e.jk}},i.prototype.qk=function(e,t){var r=this,n={},i=r.Bj.firingCriteria;r.xk&&r.mj>=r.xk[0]?(r.xk[0]!==L.TRUE_STREAMS_INTERVAL||r.kj||(i=L.TRUE_STREAMS_INTERVAL,r.kj=!0),n.progressBeacon=i,r.xk.shift()):r.mj>=r.ik+r.Bj.recurring&&(n.progressBeacon=r.Bj.firingCriteria,r.ik+=r.Bj.recurring);var a=r.nk(e,t);return a&&a!==r.Gj&&(r.Gj=a,n.quartileBeacon=L.QUARTILE_PROGRESS_INTERVAL),n},i.prototype.hk=function(){var e=this,t=e.l.playlist.getCurrentItem();t?t.duration:0;e.xk=[],e.yk=[],e.xk=e.Bj.fixed.slice()},i.prototype.pk=function(e,t,r){var n=this,i=n.l.playlist.getCurrentItem();if(e=e||n.Bj.firingCriteria,t=!!b.isNullOrUndefined(t)||t,r=r||!1,n.ok(),t){var a=n.zk.bind(n,e,t,r,i);n.rk(r,a,i)}else n.zk(e,t,r)},i.prototype.zk=function(e,t,r,n){var i=this;n&&n.videoSession?n.videoSession:L.STRING_DEFAULT;e===L.TRUE_STREAMS_INTERVAL?(i.ck("PLAYBACK_STREAM_START",{fireCriteria:L.TRUE_STREAMS_INTERVAL,data:{convivaState:i.xj?i.xj.getState():-1,convivaId:"["+i.Ch.videoSession()+"]["+i.Ch.videoId()+"]"+i.Ch.videoTitle()},mediaItem:n}),i.rj=i.nj):i.ck("PLAYBACK_PROGRESS",{fireCriteria:e,data:{playEventFired:i.ej,convivaState:i.xj?i.xj.getState():-1,convivaId:"["+i.Ch.videoSession()+"]["+i.Ch.videoId()+"]"+i.Ch.videoTitle()},mediaItem:n}),e!==L.QUARTILE_PROGRESS_INTERVAL&&(i.uj=i.mj),t&&(i.nj=0,i.oj.splice(0,Math.min(L.SEG_INFO_LENGTH,i.oj.length)),i.oj.length&&(i.tk(!1),i.zk(e,t,r,n)))},i.prototype.Ak=function(e){var t,r=this;r.Bj.playerUnload&&!r.yj&&(r.l.incompleteExitData={reason:e?e:null},t=e===B.ERROR||null,r.rk(t),r.k.publish(m.BEFORE_INCOMPLETE_EXIT),r.ck("INCOMPLETE_EXIT",{data:r.l.incompleteExitData}),r.yj=!0),r.xj&&r.xj.destroy()},i.prototype._i=function(){var e=this;e.Ak(B.UNLOAD)},i.prototype.B=function(e,t){var r=this;r.Sj=t,!r.lj&&t>=L.TRUE_STREAMS_INTERVAL?(r.lj=!0,r.ck("AD_STREAMS")):t>=r.Bk+L.PROGRESS_INTERVAL&&(r.Bk+=L.PROGRESS_INTERVAL)},i.prototype.Jh=function(){var e=this;e.rk(),e.ck("PLAYBACK_COMPLETE"),e.nj=0,e.rj=0},i.prototype.ge=function(){var e=this;e.ck("PLAYBACK_PAUSE"),e.Bj.playPause!==!0||e.l.playbackState.ad||e.pk()},i.prototype.ii=function(e){var t=this;t.ck("PLAYBACK_STALLED",{data:e?e:""})},i.prototype.rf=function(){var e=this;e.ck("PLAYBACK_RESUMED")},i.prototype.wi=function(e){var t=this;t.ck("CTRL_PLAYPAUSE",{data:e?e:""}),t.l.playback.requestType=null,t.l.playback.requestAction=null},i.prototype.Mi=function(e,t){var r=this,n={value:e||"",value_e:t||""};r.ck("CONTROLS_AUDIO_CHANGE",{data:n})},i.prototype.Ie=function(){var e=this;(e.Ch.progressBeaconDistance()>0||e.nj>0)&&e.pk(null,null,!0)},i.prototype.li=function(e){var t=this;t.ck("ABR_DATA_UPDATE",{data:e})},i.prototype.ki=function(e){var t=this;t.ck("API_CALLED",{data:e})},i.prototype.Ce=function(e,t){var r=this;r.ck("BITRATE_CHANGE",{data:{bitrate:e,reason:t.reason,newFrameRate:t.newFrameRate,oldFrameRate:t.oldFrameRate}})},i.prototype.Kh=function(e){var t=this;t.gk||(t.Tj=e,t.gk=!0)},i.prototype.Lh=function(e){var t=this;t.gk=!1,t.Qj++,t.Rj=e,t.ck("PLAYBACK_SEEK"),t.Tj=e},i.prototype.ne=function(e){var t=this;if(!t.l.playbackState.ad){if(e){if(e.ignoreBuffering===!0)return;if(e.value===!1)return t.Vh=!1,void(t.nj+=Date.now()-t.jk)}t.Vh=!0,t.jk=Date.now()}},i.prototype.Ck=function(e){return e.category!==C.E_INFO&&e.category!==C.E_WARNING&&e.category!==C.E_YVAP},i.prototype.tb=function(e){var t=this,r=t.Ch.videoId(),n=t.Ck(e),i=t.Ej[r];e.group=i?"E":e.group,n&&(i?t.Ej[r]++:(t.Ak(B.ERROR),t.Ej[r]=1)),(!t.Ej[r]||t.Ej[r]<w)&&(e.category===C.E_PLAYER&&e.subcategory===C.PLAYER_CODES.E_NATIVE_ABORTED?setTimeout(function(){t.ck("PLAYER_ERROR",{data:e})},1e3):t.ck("PLAYER_ERROR",{data:e}))},i.prototype.Yd=function(e){var t=this,r=t.Ch.videoId();t.Dj[r]||(t.Dj[r]={});var n,i=U[e.subcategory]?U[e.subcategory]:x;t.Dj[r][e.subcategory]?n=t.Dj[r][e.subcategory]:(t.Dj[r][e.subcategory]=0,n=0),t.Cj<x&&n<i&&(t.ck("PLAYER_WARNING",{data:e}),t.Cj++,t.Dj[r][e.subcategory]++)},i.prototype.dj=function(e){var t=this;t.ck("PLAYER_INFO",{data:e})},i.prototype.Pi=function(e){var t=this;t.ck("AD_METRICS",{data:e})},i.prototype.u=function(e,t,r,n,i,a){var o=this,s=o.l,l=s.playbackState;o.Sj=0,o.Bk=o.Sj;var c=void 0!==a;o.Mj={type:l.ad.type,rendererType:l.rendererType,vpaidSwfLoadLatency:n,vpaidInitLatency:i,vpaidStartLatency:a,totalLatency:c?n+i+a:r},o.Wh(),o.Uj=o.Pj(),o.$h||o.mk(),o.xj&&o.xj.adStart()},i.prototype.Nh=function(){var e=this,t=e.Fj[e.l.playlist.getCurrentItem().id];t&&(e.Uj=t)},i.prototype.Qi=function(){var e=this;e.ck("AD_ERROR")},i.prototype.Ri=function(e){var t=this;t.ck("AD_BREAK_INFO",{data:e})},i.prototype.Si=function(e){var t=this;t.ck("AD_BREAK_ENDED",{data:e})},i.prototype.Ti=function(e){var t=this;t.ck("AD_BREAK_CANCELLED",{data:e})},i.prototype.Ui=function(){var e=this;e.ck("IFRAME_LOAD")},i.prototype.Vi=function(){var e=this;e.ck("IFRAME_LOADED")},i.prototype.Wi=function(e){var t=this;t.ck("MIDROLL_CACHE_UPDATE",{data:e})},i.prototype.Xi=function(){var e=this;e.aj=1},i.prototype.Yi=function(){var e=this;e.aj=2},i.prototype.Zi=function(){var e=this;e.aj=3},i.prototype.vk=function(){var e=this,t=e.nj;e.rj&&(t+=e.rj,e.rj=0);var r=e.oj.slice(0,Math.min(L.SEG_INFO_LENGTH,e.oj.length));e.tj=0;for(var n=0;n<r.length;n++)e.tj+=r[n].buf_dur;e.sj=e.tj-t},i.prototype.kk=function(e){var t=this,r=t.Ch.videoId(),n=t.Ch.videoTitle();if(0!==Object.keys(t.bk).length){var i=t.bk.sec?t.bk.sec:"yvp",a=t.bk.slk?t.bk.slk:n,o=t.bk.Dk?t.bk.Dk:1,s={itc:1,g:t.bk.g?t.bk.g:r,vid:r},l=g.extend(t.bk,s);t.ak.beaconClick(i,a,o,l,e)}},i.prototype.mk=function(){var e=this,t=e.Ch,r=t.apLatency(),n={perf_usertime:{utm:{APL:r}}},i=N&&N.getLocalMeasurements(e.jj),a=N&&N.getGlobalMeasurements(),o=R.PERF.VP_SCRIPT_EXEC,s=R.PERF.VP_INIT;n.perf_usertime.utm[o]=a&&a[o]?a[o].startTime.toFixed(2):"",n.perf_usertime.utm[s]=i&&i[s]?i[s].startTime.toFixed(2):"",e.ak&&"function"==typeof e.ak.beaconPerformanceData&&e.ak.beaconPerformanceData(n),e.$h=!0},i.prototype.Ek=function(){var e=this,t=e.l.playlist.getCurrentItem(),r=e.l.failOver.convivaSamplingRate;if(t&&!t.isCCM)return!1;var n=t&&t.isLive()?r.live:r.vod,i=g.bucketize();return i<100*n&&(e.Ch.bucketizeNum=i,!0)},i.prototype.getMetricRendererType=function(e){var t=L.STRING_DEFAULT;if(!e)return t;switch(e){case O.FLASH:t="flash";break;case O.FLASH_SIMPLE:t="flash-simple";break;case O.HTML5_HLS:t="html5-hls";break;case O.EXTERNAL:case O.HTML5_RAW:case O.HTML5_TV:case O.HTML5_TV_TIZEN:case O.HTML5_TV_ORSAY:t="html";break;case O.HTML5_HLS_360:t="html5-hls-360";break;case O.HTML5_RAW_360:t="html-360";break;default:t="html"}return t},i.prototype.reportCriticalError=function(e){var t=this;t.xj&&t.xj.reportError(e)},i.prototype.destroy=function(){var e=this;e.Ak(B.DESTROY),e._sqno=0},a.prototype.sendBeacon=function(e,t){var r=this,n=r.l.playlist.getCurrentItem();if(n){var i=function(n){var i=r.Fk[n];return i?i.apply(null,[e].concat(t)):null},a=n.metrics.beacons[e]||[];a.forEach(function(e){var t=e.url;t&&(t=o(t,i),g.sendImageBeacon(t))})}};var H=function(){return h.android?{name:"android",make:"unknown",model:"android",os:"android"}:h.ipad?{name:"iPad",make:"apple",model:"ipad",os:"ios"}:h.iphone?{name:"iPhone",make:"apple",model:"iphone",os:"ios"}:h.chrome?{name:"web",make:"chrome",model:h.chrome,os:h.os}:h.firefox?{name:"web",make:"firefox",model:h.firefox,os:h.os}:h.ie?{name:"web",make:"ie",model:h.ie,os:h.os}:h.safari?{name:"web",make:"safari",model:h.safari,os:h.os}:{name:"web",make:"na",model:"na",os:h.os}}()},{"../../../lib":"/lib/index.js","../../../lib/logger":"/lib/logger.js","../constants":7,"../error":12,"../event":"/nextgen/src/event.js","../media-store":18,"../navigator-info":26,"../perf":29,"../renderers/type":44,"../states":46,"../util":"/nextgen/src/util.js","./comscore":19,"./marketingpx-metrics":20,"./metrics-constants":21,"./nielsen-analytics":23,"./ult-metrics":24,"user-agent":233}],23:[function(e,t,r){"use strict";function n(e,t,r,n){var i=this;return e?(i.Gk=!1,s.initIframeForGDPR(),i.Hh(),i.k=e,i.Ch=t,i.Hk=null,i.Ik=!1,i.Jk=!1,i.Kk=!1,i.Lk=[],i.Mk={},i.gh=!1,i.Nk=[{evt:a.PLAYBACK_STARTED,cb:i.Ok.bind(i)},{evt:a.TIMED_METADATA_RECEIVED,cb:i.Me.bind(i)},{evt:a.PLAYBACK_ENDED,cb:i.Pk.bind(i)},{evt:a.MEDIA_ITEM_ERROR,cb:i.Pk.bind(i)}],i.Qk="P77FED7E1-92A2-4B10-A9AA-16756377EB20",i.Rk="vp-player-"+Math.floor(1e4*Math.random()),r&&r.length&&(i.Qk=r),i.Sk(),void i.Tk()):void console.error("[Nielsen] Cannot initialize Nielsen. Bad eventBus instance!")}t.exports=n;var i=e("../../src/constants"),a=e("../../src/event"),o=e("../../src/util"),s=e("videoplayer-common-lib").Privacy,l="7.86.909.1590008200",c="vp-nielsen-iframe",u=373,p="",d="";if(l.indexOf("local")>-1)p=location.protocol+"//"+location.host,d="/assets/nielsen-iframe.html";else{p="https://assets.video.yahoo.net";var f="/playerassets/builds/0.1.190/nielsen-iframe.html";d=p+f}var v={Linear:"1",Dynamic:"2"},m={LOAD_METADATA:"loadMetadata",SEND_ID3:"sendID3",END:"end"},y={INITIALIZE:"initialize",SEND_BEACON:"sendBeacon"};n.prototype.destroy=function(){var e=this;e.Hk&&(e.Nk.forEach(function(t){e.Mk[t.evt]&&e.Mk[t.evt]()}),window.removeEventListener("message",e.Uk),e.Hk=null,e.Lk=null,e.Mk={})},n.prototype.activateBeaconing=function(){var e=this;e.Kk||(e.Pg(),e.Jk=!1,e.Ik=!1,e.Kk=!0)},n.prototype.Vk=function(){var e=this;e.Kk&&(e.Nk.forEach(function(t){e.Mk[t.evt]&&e.Mk[t.evt]()}),window.removeEventListener("beforeunload",e.Pk.bind(e)),e.Jk=!0,e.Kk=!1)},n.prototype.Sk=function(){var e=this;e.Hk=document.getElementById(c),e.Hk?(e.Wk(),e.gh=!0):(e.Hk=document.createElement("iframe"),e.Hk.id=c,e.Hk.style.display="none",e.Hk.onload=function(){e.Wk(),e.gh=!0,e.Gk&&e.Xk()},e.Hk.src=d,document.body.appendChild(e.Hk))},n.prototype.Wk=function(){var e=this;e.Yk(y.INITIALIZE,null,{appid:e.Qk})},n.prototype.Yk=function(e,t,r){var n=this;if(n.Hk&&n.Hk.contentWindow){var i={messageType:e,nielsenEvent:t,payload:r,playerid:n.Rk};n.Hk.contentWindow.postMessage(i,p)}},n.prototype.Pg=function(){var e=this;return window.addEventListener?(window.addEventListener("beforeunload",e.Pk.bind(e)),void e.Nk.forEach(function(t){e.Mk[t.evt]=e.k.subscribe(t.evt,t.cb,e)})):void console.error("[Nielsen] addEventListener not supported")},n.prototype.Tk=function(){var e=this;return window.addEventListener?void window.addEventListener("message",e.Uk.bind(e)):void console.error("[Nielsen] addEventListener not supported")},n.prototype.Uk=function(e){var t=this;if(e.origin===p){var r=e.data&&e.data.messageType,n=e.data&&e.data.success||!1;if(r&&!n)return void console.error("[Nielsen] "+r+" error.");r===y.SEND_BEACON&&n&&(t.Ik=!0)}},n.prototype.Zk=function(e,t){var r=this;r.Lk.push(function(){r.Yk(y.SEND_BEACON,e,t)}),r.Hk&&r.gh&&r.Gk&&r.Xk()},n.prototype.Xk=function(){var e=this;e.Lk.forEach(function(e){e()}),e.Lk=[]},n.prototype.Ok=function(e,t){var r=this,n=r.Ch&&r.Ch.providerId()?e+";"+r.Ch.providerId():e,i={type:"content",channelName:n,adModel:v.Linear};r.Zk(m.LOAD_METADATA,i)},n.prototype.Pk=function(){var e=this;if(e.Ik&&!e.Jk){var t=Date.now()/1e3;e.Zk(m.END,t),e.Ik=!1,e.Vk()}},n.prototype.Me=function(e){var t=this,r=o.detectRegexPattern(i.ID3_MATCH_PATTERN.NIELSEN,e);r&&t.Ik&&t.Zk(m.SEND_ID3,r)},n.prototype.Hh=function(){var e=this;s.getVendorConsent(u,function(t,r){if(r){var n=t&&t.gdprApplies;n?e.Gk=!!t.hasConsent:e.Gk=!0,e.Gk||e.Vk()}else e.Vk()})},t.exports=n},{"../../src/constants":7,"../../src/event":"/nextgen/src/event.js","../../src/util":"/nextgen/src/util.js","videoplayer-common-lib":237}],24:[function(e,t,r){"use strict";function n(e,t){var r=this,n=["t","_V","s","V_sec","evt","ccode","sec","cpos","type","ss","_ex","_NOL"],s=["vid","pstaid","prt","cprt","lms_id","vs","psz","ccap","ccav","cdn","st","sp","bit","pls","vlng","site","lang","intl","lbl","synd","pver","pl_type","pl_uuid","pl_intr","pl_sec","expn","expt","expb","loc","auto","cont","replay","bckt","snd","test","pt","pd","pct","pstcat","ver","rlvtscr","vidPos","pstaid_p","pkgt","subsec","_w","vsid","_R","pltype","cached_vs","man","class","smpl","env","am","rcmode","fav","focus","view","expm","deos","deom","drmsys","drm","_rid","bx","_sqno","ts"],l=["ctv_db","ctv_dc","_di","ctv_di","ctv_ddv","ctv_dfv","_dv","_lo","_dm","_dl","_dc","_osv","ctv_yb","_sr","ctv_yr","ctv_ybv","ctv_yv","_an","_av","_at"],c=function(t){return function(){return e.CTV.ctvMetricsParams[t]}},u={ctv_db:c("ctv_db"),ctv_dc:c("ctv_dc"),$k:c("_di"),ctv_di:c("ctv_di"),ctv_ddv:c("ctv_ddv"),ctv_dfv:c("ctv_dfv"),_k:c("_dv"),cl:c("_lo"),dl:c("_dm"),gl:c("_dl"),hl:c("_dc"),il:c("_osv"),ctv_yb:c("ctv_yb"),jl:c("_sr"),ctv_yr:c("ctv_yr"),ctv_ybv:c("ctv_ybv"),ctv_yv:c("ctv_yv"),kl:c("_an"),ll:c("_av"),ol:c("_at")},p={t:t.randomVal,s:t.pageSpaceId,vsid:t.videoSpaceId,vid:t.videoId,adid:t.adId,pstaid:t.videoId,lms_id:t.licenseId,pls:t.playerInt32Guid,psz:t.dimensions,site:t.site,lang:t.lang,intl:t.region,prt:t.rendererType,cprt:t.contentRendererType,pltype:t.playerType,lbl:t.label,synd:t.syndicationId,_w:t.pageUrl,ccode:t.ccode,sec:t.sec,cpos:t.cpos,pver:t.playerVersion,pt:t.pt,pd:t.pd,pct:t.pct,pstcat:t.pstcat,ver:t.ver,rlvtscr:t.rlvtscr,vidPos:t.vidPos,pstaid_p:t.pstaid_p,pkgt:t.pkgt,subsec:t.subsec,expn:t.experienceName,expt:t.experienceType,expb:t.experienceBucket,loc:t.playerLocation,_R:t.pageReferrer,deos:t.configDockingEnableOnScroll,deom:t.configDockingEnableOnMuted,drmsys:t.drmSystem,drm:t.drmProtected,dur:t.playbackWatchedTime,dur_d:t.progressBeaconDistance,vlng:t.videoLength,adlng:t.adDuration,toc:t.typeOfContent,pbst:t.playbackState,_ex:t.offNetwork,_NOL:t.offNetwork,auto:t.autoplay,cont:t.continuousPlayCount,replay:t.replayCount,cdn:t.cdn,ucl:t.ucLatency,apl:t.apLatency,s_apl:t.apLatencyStartTime,bit:t.bitrate,view:t.viewability,sp:t.streamProtocol,st:t.streamType,bckt:t.hostingBucket,snd:t.isMute,type:t.contentType,ss:t.streamStatus,rsm:t.isResume,test:t.testBucket,algo:t.algo,disp:t.displayMode,consl:t.constructLatency,trcreate:t.renderCreateLatency,tsltps:t.playToRenderLatency,tmeta_call:t.sapiLatency,s_tsapic:t.sapiLatencyStartTime,trtswf:t.renderToSwfLatency,tswf_ready:t.swfLatency,s_tswfr:t.swfLatencyStartTime,tcc_pref:t.ccPrefLatency,tltld:t.hlsPlaylistLatency,strml:t.streamLatency,s_strml:t.streamLatencyStartTime,buff_info:t.segInfo,client_width:t.clientWidth,client_height:t.clientHeight,retina:t.retinaDisplayDetected,vpa_td:t.getVPATraceDigest,vs:t.videoSession,cached_vs:t.cachedVs,jsdt:t.jsDownloadTime,pgltcy:t.pageLatency,buf_dur:t.segmentBuffTime,man:t.manufacturer,smpl:t.samplingId,ccap:t.closedCaptionsUserPreference,ccav:t.ccAvailabilty,env:t.hostingEnv,class:t.deviceClass,rcmode:t.rateControlMode,expm:t.expMode,pl_type:t.playlistUIType,pl_uuid:t.playlistUIUuid,pl_intr:t.instrument,pl_sec:t.playlistSection,am:t.atlasMarker,fav:t.flashAvailable,focus:t.focus,cc_ok:t.ccOk,bl:t.bufferLength,pdtl:t.programDateTimeLatency,_rid:t.rid,bx:t.bx,_sqno:t.sqno,ts:t.timestamp,_V:function(){return"V"}};s=a.tv?s.concat(l):s,p=a.tv?o.extend(p,u):p,r.sendOpts={baseUrl:"//bats.video.yahoo.com/p",target:"ult",paramGetters:p,beginningKeys:n,endKeys:s},r.beaconMappings={AD_BREAK_INFO:{keys:["poddur","mttl","mvalid","mdur_ready","latency","cids","adblk","brknum","brklabel","brkid"],data:function(e){return{V_sec:"pb",evt:"pod-start-inf",poddur:e.adBreakDuration,mttl:e.numMidrollsTotal,mvalid:e.numMidrollsValid,mdur_ready:e.readyAdsDuration,latency:e.adStartLatency,cids:e.creativeIds.join(",")||"none",adblk:e.adBlockerDetected,brknum:e.adBreakNum||"na",brklabel:e.adBreakLabel||"na",brkid:e.adBreakId||"na"}}},AD_BREAK_ENDED:{keys:["poddur","mnum","merr","merr_dur","mdur_ready","mdur_true","mdur_rndr","unpld_dur","ads_latency","latency","cids","adblk","cuein_time","brknum","brklabel","brkid"],data:function(e){return{V_sec:"pb",evt:"pod-end-inf",poddur:e.adBreakDuration,merr:e.adsErrorCount,merr_dur:e.erroredAdsDuration,mnum:e.adsStartedCount,mdur_ready:e.readyAdsDuration,mdur_true:e.adsPlayDurationExpected,mdur_rndr:e.adsPlayDurationActual,latency:e.videoStartLatency,ads_latency:e.adsStartLatency,cids:e.creativeIds.join(",")||"none",adblk:e.adBlockerDetected,unpld_dur:e.unplayedDuration,cuein_time:e.adBreakCueInTime,brknum:e.adBreakNum||"na",brklabel:e.adBreakLabel||"na",brkid:e.adBreakId||"na"}}},MIDROLL_CACHE_UPDATE:{keys:["retry_cnt","target_ads_dur","uniq_ads_num","no_ads_num","dup_ads_num","uniq_ads_dur"],data:function(e){return{V_sec:"pb",evt:"pod-cache-updt",retry_cnt:e.retryCount,target_ads_dur:e.targetAdsDuration,no_ads_num:e.totalNoAds,dup_ads_num:e.totalDuplicatedAds,uniq_ads_num:e.totalUniqueAds,uniq_ads_dur:e.uniqueAdsDuration}}},AD_BREAK_CANCELLED:{keys:["unpld_cids","unpld_dur","reason"],data:function(e){return{V_sec:"pb",evt:"pod-cancelled",unpld_cids:e.unplayedCreativeIds.join(",")||"none",unpld_dur:e.unplayedDuration,reason:e.reason}}},IFRAME_LOAD:{keys:[],data:function(e){return{V_sec:"pb",evt:"ad_iframe_load"}}},IFRAME_LOADED:{keys:[],data:function(e){return{V_sec:"pb",evt:"ad_iframe_loaded"}}},AD_METRICS:{keys:function(e){var t=Object.keys(e.ult);return t.push("V_sec"),"ad_dlv"===e.ult.evt&&t.push("ucl","apl","s_apl","consl","trcreate","tmeta_call","s_tsapic","trtswf","tswf_ready","s_tswfr","tcc_pref","tltld","strml","s_strml","tsltps","tpb","s_tpb","pgltcy","expltcy","jsdt","swfdt","req_type","req_action","apallwd","apsupp","ipsupp","adl","tvpaid_swf","tvpaid_init","tvpaid_start"),t},data:function(e){var r=e.ult;if(r.V_sec="pb","ad_dlv"===e.ult.evt){var n=t.adInfo(),i=n&&"vpaid"===n.type;r.ucl=t.ucLatency(),r.apl=t.apLatency(),r.s_apl=t.apLatencyStartTime(),r.consl=t.constructLatency(),r.trcreate=t.renderCreateLatency(),r.tmeta_call=t.tsapic(),r.s_tsapic=t.sapiLatencyStartTime(),r.trtswf=t.renderToSwfLatency(),r.tswf_ready=t.swfLatency(),r.s_tswfr=t.swfLatencyStartTime(),r.tcc_pref=t.ccPrefLatency(),r.tltld=t.hlsPlaylistLatency(),r.strml=t.streamLatency(),r.s_strml=t.streamLatencyStartTime(),r.tsltps=t.playToRenderLatency(),r.tpb=t.timeDiff(),r.s_tpb=t.startTime(),r.pgltcy=t.pageLatency(),r.expltcy=t.experienceLatency(),r.jsdt=t.playerJsDownloadTime(),r.swfdt=t.playerSwfDownloadTime(),r.req_type=t.requestType(),r.req_action=t.requestAction(),r.apallwd=t.autoplayAllowed(),r.apsupp=t.autoplaySupported(),r.ipsupp=t.inlinePlaybackSupported(),r.adl=n?n.totalLatency:0,r.tvpaid_swf=i?n.vpaidSwfLoadLatency:0,r.tvpaid_init=i?n.vpaidInitLatency:0,r.tvpaid_start=i?n.vpaidStartLatency:0}return r}},ABR_DATA_UPDATE:{keys:["sc","ib","bft","ci","dw","dh","pr","eb","bl","swc","dfr","fbl","ted","ni","rs"],data:function(e){return{V_sec:"pb",evt:"v_abr",sc:e.sc,ib:e.ib,bft:e.bft,ci:e.ci,dw:e.dw,dh:e.dh,pr:e.pr,eb:e.eb,bl:e.bl,swc:e.swc,dfr:e.dfr,fbl:e.fbl?e.fbl.toString():"",ted:e.ted.map(function(e){return JSON.stringify(e)}).toString(),ni:e.ni,rs:e.rs}}},VIDEO_REQUEST:{keys:["prefetch","host"],data:function(e){return{V_sec:"pb",evt:"v_request",prefetch:e,host:document.location.hostname}}},PLAYBACK_START:{keys:["ucl","apl","s_apl","dur","rsm","disp","consl","trcreate","tmeta_call","titssc","s_tsapic","trtswf","tswf_ready","s_tswfr","tcc_pref","tltld","strml","s_strml","tsltps","tpb","s_tpb","pgltcy","expltcy","jsdt","swfdt","cssdt","req_type","req_action","d_st","_ct","_ctm","_ctua","apallwd","apsupp","ipsupp","ad","vpaid","adrt","adl","tvpaid_swf","tvpaid_init","tvpaid_start","c4","bckt_config","conviva_state","conviva_id","pdtl","mm_activity_id"],data:function(e){var r=t.adInfo(),n=r&&"vpaid"===r.type;return{V_sec:"pb",evt:"v_start",rsm:t.isResume(),tmeta_call:t.tsapic(),tpb:t.timeDiff(),s_tpb:t.startTime(),titssc:t.titssc(),pgltcy:t.pageLatency(),expltcy:t.experienceLatency(),jsdt:t.playerJsDownloadTime(),swfdt:t.playerSwfDownloadTime(),cssdt:t.playerCSSDownloadTime(),req_type:t.requestType(),req_action:t.requestAction(),d_st:t.debugSt(),_ct:t.networkConnectionType(),_ctm:t.isMobileNetworkConnection(),_ctua:t.networkConnectionTypeUa(),apallwd:t.autoplayAllowed(),apsupp:t.autoplaySupported(),ipsupp:t.inlinePlaybackSupported(),ad:r?1:0,vpaid:n?1:0,adrt:r?r.rendererType:"",adl:r?r.totalLatency:0,tvpaid_swf:n?r.vpaidSwfLoadLatency:0,tvpaid_init:n?r.vpaidInitLatency:0,tvpaid_start:n?r.vpaidStartLatency:0,c4:t.comscoreC4(),bckt_config:t.bcktConfig(),conviva_state:e.convivaState,conviva_id:e.convivaId,mm_activity_id:t.mmActivityId()}}},PLAYBACK_PROGRESS:{keys:["dur","dur_d","buff_info","buf_dur","p_width","p_height","retina","rcvr_status","vpa_td","conviva_state","conviva_id","bl","pdtl","alang"],firingCriteria:[t.getProgressBeaconMode().firingCriteria],data:function(e){return{V_sec:"pb",evt:"v_prog",rcvr_status:t.recoveryStatus(),p_width:t.clientWidth(),p_height:t.clientHeight(),retina:t.retinaDisplayDetected(),conviva_state:e.convivaState,conviva_id:e.convivaId,alang:t.audioLanguage()}}},PLAYBACK_STREAM_START:{keys:["buff_info","buf_dur","dur","dur_d","vpa_td","cc_ok","conviva_state","conviva_id","bl","pdtl","alang"],firingCriteria:[i.TRUE_STREAMS_INTERVAL],data:function(e){return{V_sec:"pb",evt:"v_strm_view",conviva_state:e.convivaState,conviva_id:e.convivaId,alang:t.audioLanguage()}}},PLAYBACK_COMPLETE:{keys:["dur","dur_d","stall_t","buff_info","buf_dur","vpa_td","bl","pdtl","alang"],data:function(){return{V_sec:"pb",evt:"v_comp",dur:t.playbackPosition(),stall_t:t.bufferingTime(),alang:t.audioLanguage()}}},INCOMPLETE_EXIT:{keys:["dur","dur_d","stall_t","buff_info","buf_dur","rcvr_status","vpa_td","toc","pbst","tswf_ready","tmeta_call","strml","ext_resn","vsl","vil","vst","s_vsl","s_vil","s_vst","bl","pdtl","alang","poddur","mdur_ready","unpld_dur","brknum","brklabel","brkid"],data:function(e){return{V_sec:"pb",evt:"v_ncomp",rcvr_status:t.recoveryStatus(),stall_t:t.bufferingTime(),ext_resn:e.reason||"na",vsl:e.vpaidLatencies&&e.vpaidLatencies.vsl||"na",vil:e.vpaidLatencies&&e.vpaidLatencies.vil||"na",vst:e.vpaidLatencies&&e.vpaidLatencies.vst||"na",s_vsl:e.vpaidLatencies&&e.vpaidLatencies.sVsl||"na",s_vil:e.vpaidLatencies&&e.vpaidLatencies.sVil||"na",s_vst:e.vpaidLatencies&&e.vpaidLatencies.sVst||"na",alang:t.audioLanguage(),poddur:e.adBreakStats&&e.adBreakStats.adBreakDuration||"na",mdur_ready:e.adBreakStats&&e.adBreakStats.readyAdsDuration||"na",unpld_dur:e.adBreakStats&&e.adBreakStats.unplayedDuration||"na",brknum:e.adBreakStats&&e.adBreakStats.adBreakNum||"na",brklabel:e.adBreakStats&&e.adBreakStats.adBreakLabel||"na",brkid:e.adBreakStats&&e.adBreakStats.adBreakId||"na"}}},PLAYBACK_RESUMED:{keys:[],data:function(){return{V_sec:"pb",evt:"p_resm"}}},PLAYBACK_STALLED:{keys:["value","play_pos","dur"],data:function(e){return{V_sec:"pb",evt:"v_stall",value:e,play_pos:t.playbackPosition()}}},BITRATE_CHANGE:{keys:["play_pos","value","value_e","dur","reason","fr","fr_old"],data:function(e){return{V_sec:"pb",evt:"v_btrt",play_pos:t.playbackPosition(),value:e.bitrate,value_e:t.bitrate(),reason:e.reason,fr:e.newFrameRate,fr_old:e.oldFrameRate}}},UI_INTERACT:{keys:["V_slk","dur","algo","pl_intr"],data:function(e){return{V_sec:"ctrl",evt:e.evt,V_slk:e.srcElement}}},CTRL_PLAYPAUSE:{keys:["value","dur","play_pos","req_type","req_action"],data:function(e){return{V_sec:"ctrl",evt:"ui_pp",value:e,play_pos:t.playbackPosition(),req_type:t.requestType(),req_action:t.requestAction()}}},CTRL_SEEK:{keys:["value","value_e","dur"],data:function(e){return{V_sec:"ctrl",evt:"ui_seek",value:t.playbackPosition(),value_e:e}}},CTRL_VOLUME:{keys:["value","value_e","play_pos"],data:function(e){return{V_sec:"ctrl",evt:"ui_cv",value:e,value_e:t.currVolume(),play_pos:t.playbackPosition()}}},CTRL_REPLAY:{keys:[],data:function(){return{evt:"ui_esrpl",V_sec:"ctrl"}}},CTRL_PLAYREQUEST:{keys:["req_type"],data:function(e){return{V_sec:"ctrl",evt:"ui_pb_req",req_type:e}}},CONTROLS_AUDIO_CHANGE:{keys:["value","value_e","play_pos"],data:function(e){return{V_sec:"ctrl",evt:"ui_aslng",value:e.value,value_e:e.value_e,play_pos:t.playbackPosition()}}},INTERACT_360:{keys:[],data:function(){return{evt:"ui_360_interact",V_sec:"ctrl"}}},INTERACT_PIE_360:{keys:[],data:function(){return{evt:"ui_360_pie_interact",V_sec:"ctrl"}}},AIRPLAY_CONNECTION_STATE_CHANGE:{keys:["value","play_pos"],data:function(e){return{V_sec:"ctrl",evt:"ui_airp",value:e?1:0,play_pos:t.playbackPosition()}}},QUALITY_SELECTED:{keys:["play_pos","value","dur"],data:function(e){return{evt:"ui_qual",V_sec:"ctrl",value:e,play_pos:t.playbackPosition()}}},CC_TOGGLE:{keys:["value","play_pos"],data:function(e){return{V_sec:"ctrl",evt:"ui_cctog",value:e,play_pos:t.playbackPosition()}}},CC_LANG:{keys:["play_pos","value"],data:function(e){return{V_sec:"ctrl",evt:"ui_cclng",play_pos:t.playbackPosition(),value:e}}},CC_STYLE:{keys:["play_pos","value"],data:function(e){return{V_sec:"ctrl",evt:"ui_ccstl",play_pos:t.playbackPosition(),value:e}}},CC_SETTINGS:{keys:["play_pos"],data:function(){return{V_sec:"ctrl",evt:"ui_ccstg",play_pos:t.playbackPosition()}}},CTRL_AGEGATE_BDAY:{keys:[],data:function(){return{V_sec:"ctrl",evt:"ui_agesm"}}},FULLSCREEN:{keys:["value","play_pos"],data:function(e){return{V_sec:"ctrl",evt:"ui_fs",value:e,play_pos:t.playbackPosition()}}},CTRL_SETTINGS:{keys:["play_pos"],data:function(){return{V_sec:"ctrl",evt:"ui_stgs",play_pos:t.playbackPosition()}}},CTRL_TIMER:{keys:["value","play_pos"],data:function(e){return{V_sec:"ctrl",evt:"ui_timer",play_pos:t.playbackPosition(),value:e}}},UI_LOGIN:{keys:["value"],data:function(e){return{V_sec:"ctrl",evt:"ui_login",value:e}}},CTRL_ENDSCREEN_VID:{keys:["value","value_e"],data:function(e){return{V_sec:"ctrl",evt:"ui_esvid",value:e.vindex,value_e:e.vid}}},PLAYER_ERROR:{keys:["ecode","estring","dur","play_pos"],data:function(e){return{V_sec:"pb",evt:"error",ecode:e.rep,estring:e.debugMessage||e.message,play_pos:t.playbackPosition()}}},PLAYER_WARNING:{keys:["ecode","estring"],data:function(e){return{V_sec:"pb",evt:"warn",ecode:e.rep,estring:e.debugMessage||e.message}}},PLAYER_INFO:{keys:["ecode","estring"],data:function(e){return{V_sec:"pb",evt:"info",ecode:e.rep,estring:e.debugMessage||e.message}}},PRELOAD_START:{keys:[],data:function(){return{evt:"v_plstart",V_sec:"pb"}}},PRELOAD_PROGRESS:{keys:[],data:function(){return{evt:"v_plprog",V_sec:"pb"}}},PRELOAD_COMPLETE:{keys:[],data:function(){return{evt:"v_plcomp",V_sec:"pb"}}},PLAY_CALLED_ON_RENDERER:{keys:["rtype"],data:function(e){return{evt:"v_play_rdr",V_sec:"pb",rtype:e}}},API_CALLED:{
keys:["source","url","latency","http_code","resp_len","instrument","perf_info","perf_stack"],data:function(e){return{V_sec:"pb",evt:"v_api",source:e.source||"na",url:e.url,latency:e.latency||t.tsapic(),http_code:e.http_code||"na",resp_len:e.resp_len||"na",instrument:e.instrument,perf_info:e.perfInfo,perf_stack:e.perfStack}}},STREAMING_SESSION_BEGIN:{keys:[],data:function(){return{V_sec:"streaming",evt:"st_session_begin"}}},STREAMING_SESSION_END:{keys:[],data:function(){return{V_sec:"streaming",evt:"st_session_end"}}},STREAMING_ERROR:{keys:["code","status","details"],data:function(e){return{V_sec:"streaming",evt:"st_error",code:e.code,status:e.status,details:encodeURIComponent(e.details)}}},STREAMING_ISSUE:{keys:["code","playbackTime","desc","details"],data:function(e){return{V_sec:"streaming",evt:"st_issue",code:e.code,playbackTime:e.playbackTime,desc:encodeURIComponent(e.desc),details:encodeURIComponent(e.details)}}},STREAMING_PHASE:{keys:["playbackRequest","playbackStarted","playbackCompleted"],data:function(e){return{V_sec:"streaming",evt:"st_phase",playbackRequest:e.playbackRequest,playbackStarted:e.playbackStarted,playbackCompleted:e.playbackCompleted}}},STREAMING_DATA:{keys:["startupBitrate","bitrateSwitches","bufferEventCount","playTime","totalBufferingTime","totalRebufferingRatio","sampledRebufferingRatio","sampledBufferingTime","sampledBufferingCount","mediaPlaylistLoadCount","minPlaylistUpdateInterval","maxPlaylistUpdateInterval","avgPlaylistUpdateInterval","rebufferingTimeoutCount","playbackFrozenCount","loadingLateCount","recoveryCount"],data:function(e){return{V_sec:"streaming",evt:"st_data",startupBitrate:e.startupBitrate,bitrateSwitches:e.bitrateSwitches,bufferEventCount:e.bufferEventCount,playTime:e.playTime,totalBufferingTime:e.totalBufferingTime,totalRebufferingRatio:e.totalRebufferingRatio,sampledRebufferingRatio:e.sampledRebufferingRatio,sampledBufferingTime:e.sampledBufferingTime,sampledBufferingCount:e.sampledBufferingCount,mediaPlaylistLoadCount:e.mediaPlaylistLoadCount,minPlaylistUpdateInterval:e.minPlaylistUpdateInterval,maxPlaylistUpdateInterval:e.maxPlaylistUpdateInterval,avgPlaylistUpdateInterval:e.avgPlaylistUpdateInterval,rebufferingTimeoutCount:e.rebufferingTimeoutCount,playbackFrozenCount:e.playbackFrozenCount,bufferFrozenCount:e.bufferFrozenCount,loadingLateCount:e.loadingLateCount,recoveryCount:e.recoveryCount}}},STREAMING_WARNING:{keys:["code","playbackTime","desc","details"],data:function(e){return{V_sec:"streaming",evt:"st_warning",code:e.code,playbackTime:e.playbackTime,desc:encodeURIComponent(e.desc),details:encodeURIComponent(e.details)}}},STREAMING_PLAYER_WARNING:{keys:["code","status","details"],data:function(e){return{V_sec:"streaming",evt:"st_player_warning",code:e.code,status:e.status,details:encodeURIComponent(e.details)}}}}}t.exports=n;var i=e("./metrics-constants"),a=e("user-agent").userAgent,o=e("../util");e("../event")},{"../event":"/nextgen/src/event.js","../util":"/nextgen/src/util.js","./metrics-constants":21,"user-agent":233}],25:[function(e,t,r){"use strict";function n(e){return!!e}function i(e,t){var r={defaultVal:e||!1,transform:n};return t&&(r.configName=t),r}function a(e,t){var r={defaultVal:e||"",validator:L.isString};return t&&(r.configName=t),r}function o(){return L.isFunction(b)}function s(){return L.isFunction(_)}function l(){return!!S.desktop&&!!(S.chrome||S.firefox||S.opera)}function c(){return!!L.isFunction(g)&&(!!u()&&(p('video/mp4; codecs="avc1.640010"')&&p('audio/mp4; codecs="mp4a.40.2"')))}function u(){return!!window.MediaSource}function p(e){var t=window.MediaSource;if(t&&!t.isTypeSupported){var r=document.createElement("video");return!(!r||!r.canPlayType(e))}return!(!t||!t.isTypeSupported(e))}function d(e){return S.mobile?!!(S.android&&S.chrome&&D.hasNativeAutoplaySupport):!(S.chrome<47&&S.firefox<44&&S.ie<11&&S.edge<12||window.location.href.indexOf("forceFlash=true")>-1)&&(!S.winXP&&!S.winVista&&("cavideo"!==e&&!!(S.chrome>=47||S.firefox>=44||S.ie||S.edge)))}function f(){return!S.mobile&&(!(!S.safari||S.safari<8||window.location.href.indexOf("forceFlash=true")>-1)&&window.location.href.indexOf("enableHTML5=true")>-1)}function v(e){var t=this;t.items=[],t.position=-1,t.tl=e,t.videoRecommendations=!0,t.endOfPlaylist=!1}function m(){var e=this;e.ad=null,e.state=T.INIT,e.paused=!1,e.seeking=!1,e.loading=!0,e.criticalError=null,e.previousItem=null,e.looped=!1,e.loadedItem=null,e.rendererType=null,e.hasStartedPlayback=!1}function y(e,t,r){var n,i,a,u=this;if(u.guid=r,u.mediaStore=t||new A.MediaStore,u.errors=[],e){u._b=e,u.playbackState=new m,A.fillFromConfig(w,e,u,u.errors),(e.userprefs||{}).closedcaptionprefs?u.userPreferences.closedCaptions.isAvailable=!0:u.userPreferences.closedCaptions.isAvailable=!1,u.disableCasting="boolean"==typeof e.disableCasting&&e.disableCasting,u.ui.chromeless&&(u.ui.showStartScreen=!1,u.ui.showControls=!1,u.ui.showEndScreen=!1,u.ui.showAgeGate=!1),u.isMobileStrmInlineExpr()&&(u.baseConfig.strmExprUnMuteOnClick||(u.muteMode=!0),u.ui.showControls=!1),u.muteMode&&u.setMute(!0),u.rendererTypes=[],u.flashAvailable=0;var p=!1;u.adsRendererTypes=[],n=("hls"===u.baseConfig.rl||d(u._b.expName))&&c()&&"raw"!==u.baseConfig.rl,a=!n&&f(),p=u.baseConfig.rl!==!0&&"raw"!==u.baseConfig.rl,i=!1,u.useFlash=i,n&&u.rendererTypes.push(C.HTML5_HLS),a&&u.rendererTypes.push(C.HTML5_RAW),u.rendererTypes.push(C.HTML5_RAW);var y=C.FLASH;i&&(n&&u.useSimpleFlash&&(y=C.FLASH_SIMPLE),u.rendererTypes.push(y),u.flashAvailable=1),l()&&(n&&s()&&u.rendererTypes.push(C.HTML5_HLS_360),o()&&u.rendererTypes.push(C.HTML5_RAW_360)),n&&u.adsRendererTypes.push(C.HTML5_HLS),u.adsRendererTypes.push(C.HTML5_RAW),i&&u.adsRendererTypes.push(y),S.tv&&(u.rendererTypes=[],u.adsRendererTypes=[],S.tizen?(u.rendererTypes.push(C.HTML5_TV_TIZEN),u.adsRendererTypes.push(C.HTML5_TV_TIZEN)):S.orsay?(u.rendererTypes.push(C.HTML5_TV_ORSAY),u.adsRendererTypes.push(C.HTML5_TV_ORSAY)):(u.rendererTypes.push(C.HTML5_TV),u.adsRendererTypes.push(C.HTML5_TV))),u.capabilities={},u.adsCapabilities={},u.rendererTypes.forEach(function(e){u.capabilities[e]=E(e),u.playback.skipFormats.length>0&&(u.capabilities[e].preferredFormats=u.capabilities[e].preferredFormats.filter(function(e){return u.playback.skipFormats.indexOf(e)===-1}))}),u.adsRendererTypes.forEach(function(e){u.adsCapabilities[e]=E(e),u.playback.skipFormats.length>0&&(u.adsCapabilities[e].preferredFormats=u.adsCapabilities[e].preferredFormats.filter(function(e){return u.playback.skipFormats.indexOf(e)===-1}))}),u.errors.length;var h=(((e.prefetch||{}).query||{}).results||{}).mediaObj;h&&u.mediaStore.fillFromSapi(h,u.rendererTypes,u.capabilities,u.errors);var g=e.prefetchIds;if(g&&L.isArray(g)){var b=g.map(function(e){return{id:e}});u.mediaStore.fillFromSapi(b,u.rendererTypes,u.capabilities,u.errors)}u.watchHistory=new N({watchHistoryEnabled:u.ui.watchHistoryEnabled,watchedPeriod:u.ui.watchedPeriod,watchHistoryExpiry:u.ui.watchHistoryExpiry}),u.watchHistory.clearExpired(),u.playlist=new v(u.mediaStore),e.playlist&&(u.playlist.initializeFromRaw(e.playlist,u.rendererTypes,u.capabilities,u.errors),u.errors.length),e.ignoreEndlist&&(u.playback.ignoreEndlist=!0),u.ul(),u.offNetwork=I.isOffNetwork()}u.playerHostingConfig=I.getPlayerHostingConfig(u.version),u.rendered=!1}t.exports={Model:y,Playlist:v,ql:m};var h=e("./yvap/ads-json"),E=e("../../lib/capability"),g=e("./renderers/html5-hls"),b=(e("./renderers/flash"),e("./renderers/html5-raw-360")),_=e("./renderers/html5-hls-360"),A=e("./media-store"),T=e("./states"),S=e("user-agent").userAgent,I=e("./util"),L=e("../../lib"),R=(e("../../lib/logger"),e("./constants")),C=e("./renderers/type"),D=e("./navigator-info"),O=D.network,N=e("./watch-history"),P=Object.keys(T).map(function(e){return T[e]}),k="nextgen-desktop",M=k.indexOf("nextgen-core")!==-1,w={version:{defaultVal:"7.86.909.1590008200",validator:L.isString},jshlsVersion:{defaultVal:"1.1.241",validator:L.isString},playlist:{id:{defaultVal:null,validator:L.isString}},CMS:{colo:{defaultVal:null,validator:L.isString},suppressAdContext:i(),enableCache:i(S.tv?!1:!0),cachedVs:{defaultVal:null,validator:L.isString}},pageLatency:{pagePlayerJsDownloadTime:{defaultVal:null,validator:L.isNumber}},forcePreloadBufferLimit:{defaultVal:32,validator:L.isNumber},html5_hls:{useWorker:i(!0),preloadBufferLimit:{defaultVal:8,validator:L.isNumber}},geoData:{latitude:{defaultVal:null,validator:L.isString},longitude:{defaultVal:null,validator:L.isString},accuracy:{defaultVal:null,validator:L.isString}},ui:{configName:null,contentTypeLabel:{defaultVal:null,validator:L.isString},watchHistoryEnabled:i(!1),watchedPeriod:{defaultVal:.5,validator:L.isNumber},watchHistoryExpiry:{defaultVal:129600,validator:L.isNumber},ccOnMute:i(!1),displayMarkers:{type:{configName:"type",defaultVal:null,validator:L.isString},group:i(!1)},chromeless:i(M,"chromeless"),startScreenConfig:{configName:"startscreen",transform:function(e){return L.isObject(e)?e:{}},showProvider:i(!0),showDescription:i(!0,"showDesc"),showButton:i(!0),showTitle:i(!0)},showStartScreen:{configName:"startscreen",defaultVal:!0,transform:function(e){return!!L.isObject(e)||n(e)}},showControls:i(!0),showTitleOnStart:{defaultVal:"",validator:L.isString},showTitleOnHover:i(!0),showEndScreen:i(!0,"endscreen"),showFullscreen:i(!0,"fullscreenBtn"),showReplayOnlyEndScreen:i(!1,"replayonlyendscreen"),stopAtLastFrame:i(!1,"stopAtLastFrame"),showAgeGate:{defaultVal:i(!0),validator:L.isBoolean},logoOverlay:{defaultVal:"bottomRight",validator:function(e){var t=["bottomRight","bottomLeft","off"];return L.isString(e)&&t.indexOf(e)>-1}},allowGeoRequest:{defaultVal:!1,validator:L.isBoolean},thumbnailDimensions:{height:{defaultVal:null,validator:L.isNumber},width:{defaultVal:null,validator:L.isNumber}},vttIndex:{defaultVal:null,validator:L.isNumber},playlistUI:{show:i(!1),playlistId:{defaultVal:null,validator:L.isString},playlistAlias:{defaultVal:null,validator:L.isString},position:{defaultVal:null,validator:L.isString},theme:{defaultVal:"light",validator:L.isString},inStream:i(!1)},docking:{enableOnScrollDown:i(!1),enableOnScrollUp:i(!1),fadeInAnimation:i(!0),closeButtonFadeIn:i(!1),positionTop:{defaultVal:-1,validator:L.isNumber},positionRight:{defaultVal:20,validator:L.isNumber},positionLeft:{defaultVal:-1,validator:L.isNumber},positionBottom:{defaultVal:20,validator:L.isNumber},width:{defaultVal:320,validator:function(e){return L.isNumber(e)||e===R.DOCKED_PLAYER_FULL}},height:{defaultVal:180,validator:L.isNumber},threshold:{defaultVal:50,validator:L.isNumber},enableOnMuted:i(!0),showInfoCard:i(!0)}},YVAP:{accountId:{defaultVal:null,validator:L.isString},timeout:{defaultVal:3,transform:function(e){return parseInt(e)}},cTopic:{defaultVal:null,validator:L.isString},standaloneAd:{xml:{defaultVal:null,validator:L.isString},gemini:{defaultVal:null},brxd:{defaultVal:null},rules:{defaultVal:null},beacons:{defaultVal:null},showAdSlug:i(!1)},vpaidTimeout:{defaultVal:null,validator:L.isNumber},adsReady:i(),preInitVpaid:i(!1)},metrics:{configName:null,disableAllBeacons:{defaultVal:!1,validator:L.isBoolean},disableBeacons:{defaultVal:!1,validator:L.isBoolean},comscoreC4:{defaultVal:"",validator:function(e){return L.isString(e)&&""!==e}},ccode:{defaultVal:"",validator:L.isString},sec:{defaultVal:"",validator:L.isString},skipComscore:{defaultVal:!1,validator:L.isBoolean},skipABRBeacon:i(!0),ywaSamplingRate:{defaultVal:1,validator:L.isNumber},ultSamplingRate:{defaultVal:1,validator:L.isNumber},qosSamplingRate:{defaultVal:1,validator:L.isNumber},cpos:{defaultVal:"",validator:L.isString},nielsenConfig:{defaultVal:null,enableNielsen:{defaultVal:!1,validator:L.isBoolean},nielsenAppId:{defaultVal:null,validator:L.isString}},progressBeaconStrategy:{configName:"progressBeaconStrategy",defaultVal:null,fixed:{configName:"fixed",defaultVal:[],validator:function(e){return L.isArray(e)&&e.every(function(e){return L.isNumber(e)})}},recurring:{configName:"recurring",defaultVal:null,validator:L.isNumber},playerUnload:i(!1),playPause:i(!1)}},playback:{configName:null,continuousPlay:i(),autoplay:i(),skipWatchedVideos:i(!0),bitrate:{configName:null,defaultVal:0,validator:L.isNumber},targetBitrate:{defaultVal:NaN,validator:L.isNumber},disableGPU:i(!1),quality:{defaultVal:"auto",validator:L.isString},bitrates:{defaultVal:[],validator:function(e){return L.isArray(e)&&e.every(function(e){return L.isNumber(e)})}},heights:{defaultVal:[],validator:function(e){return L.isArray(e)&&e.every(function(e){return L.isNumber(e)})}},desiredBitrate:{defaultVal:900,validator:L.isNumber},loop:i(),startTime:{defaultVal:NaN,validator:L.isNumber},stopBufferingOnPause:i(!1),conviva:i(!0),preload:i(!1,"preload"),preconnect:i(!0),fullscreen:i(),abr:i(),adPlaybackOnly:i(),protocol:{configName:null,defaultVal:"",validator:L.isString},skipFormats:{defaultVal:[],validator:function(e){return L.isArray(e)&&e.every(function(e){return L.isString(e)})}},playInlineVideo:i(!0,"playinlinevideos"),isResume:i(!1),ignoreEndlist:i(!1),requestType:{configName:null,defaultVal:null,validator:I.isValidRequestType},requestAction:{defaultVal:null,validator:I.isValidRequestAction},backgroundPause:{configName:"backgroundPause",onMute:i(!0,"onMute"),onUnmute:i(!1,"onUnmute"),timeToPause:{defaultVal:5,validator:L.isNumber}}},playbackState:{configName:null,mute:{defaultVal:null,transform:n},volume:{defaultVal:null,validator:function(e){return L.isNumber(e)&&e>=0&&e<=1}}},uiState:{configName:null,width:{configName:null,defaultVal:null},height:{configName:null,defaultVal:null},startScreenRendered:{configName:null,defaultVal:!1},isDocked:{configName:null,defaultVal:!1},isCSSLoaded:{configName:null,defaultVal:!1},deviceOrientation:{configName:null,defaultVal:null}},userPreferences:{configName:"userprefs",validator:L.isObject,closedCaptions:{configName:"closedcaptionprefs",show:i(!1),lang:{defaultVal:"en-US",validator:L.isString},fontSize:{defaultVal:24,validator:L.isNumber},fontName:{defaultVal:"Arial, Helvetica, sans-serif",validator:L.isString},fontColor:{defaultVal:"#ffffff",validator:L.isString},fontOpacity:{defaultVal:1,validator:L.isNumber},fontEffect:{defaultVal:"none",validator:L.isString},bgColor:{defaultVal:"#000000",validator:L.isString},bgOpacity:{defaultVal:.75,validator:L.isNumber},ccPos:{defaultVal:"bottom",validator:L.isString},isAvailable:i(!1)},isAdult:{defaultVal:null,validator:L.isBoolean},isAuthenticated:{defaultVal:i(!0),validator:L.isBoolean}},baseConfig:{configName:null,site:{defaultVal:"",validator:L.isString},siteAnalytics:{configName:"site_analytics",defaultVal:"",validator:L.isString},region:{defaultVal:"",transform:function(e){if(L.isString(e))return e.toUpperCase()},validator:L.isString},lang:{defaultVal:"",validator:L.isString},referrer:{defaultVal:"",validator:L.isString},jurisdiction:{defaultVal:"",validator:L.isString},rl:{configName:"html5",defaultVal:!1,validator:function(e){return"hls"===e||"raw"===e||L.isBoolean(e)}},experienceType:{configName:"expType",defaultVal:"",validator:L.isString},strmExprUnMuteOnClick:{configName:"unMuteOnClick",defaultVal:!1,validator:L.isBoolean},experienceName:{configName:"expName",defaultVal:"",validator:L.isString},experienceBucket:{configName:"expBucket",defaultVal:"",validator:L.isString},experienceNavStartTime:{configName:"expNavStartTime",defaultVal:"",validator:L.isNumber},pageSpaceId:{defaultVal:"",validator:function(e){return L.isString(e)||L.isNumber(e)}},syndication:{configName:"synd",defaultVal:"",validator:L.isString}},rapidConfig:{configName:"rapidConfig",defaultVal:{},validator:function(e){return L.isObject(e)?e:{rapid:{},clickParams:{},pageParams:{}}}},playerDimension:{configName:null,width:{configName:null,defaultVal:0},height:{configName:null,defaultVal:0}},CTV:{man:{defaultVal:"",validator:L.isString},class:{defaultVal:"",validator:L.isString},ctvMetricsParams:{ctv_db:a(),ctv_dc:a(),$k:a(),ctv_di:a(),ctv_ddv:a(),ctv_dfv:a(),_k:a(),cl:a(),dl:a(),gl:a(),hl:a(),il:a(),ctv_yb:a(),jl:a(),ctv_yr:a(),ctv_ybv:a(),ctv_yv:a(),kl:a(),ll:a(),ol:a()},forceHttp:{defaultVal:!1,validator:L.isBoolean}},skipOnError:{defaultVal:"never",validator:L.isString},liveUnloadOnPause:{defaultVal:!0,validator:L.isBoolean},enableRecovery:{defaultVal:!0,validator:L.isBoolean},autoplayIgnoreConnType:{defaultVal:!1,validator:L.isBoolean},useSimpleFlash:{defaultVal:!0,validator:L.isBoolean},muteMode:{defaultVal:!1,transform:n},failOver:{configName:"failover",fastInitRecoverer:{defaultVal:!1,validator:L.isBoolean},beaconDisasterMode:{defaultVal:!1,configName:"beaconDisasterMode",validator:L.isBoolean},sapiUrl:{defaultVal:null,validator:L.isString},convivaSamplingRate:{configName:"convivaSamplingRate",vod:{defaultVal:0,validator:function(e){return L.isNumber(e)&&e>=0&&e<=1}},live:{defaultVal:0,validator:function(e){return L.isNumber(e)&&e>=0&&e<=1}}},recoveryFailureTimeout:{defaultVal:120,validator:function(e){return L.isNumber(e)&&e>=0}}}};v.prototype.initializeFromRaw=function(e,t,r,n){var i=this;e&&(L.isObject(e)?(i.id=e.id||null,i.appendFromRaw(e.mediaItems,t,r,n),void 0!==e.videoRecommendations&&(i.videoRecommendations=e.videoRecommendations)):A.addError("Playlist must be an object",n))},v.prototype.appendFromRaw=function(e,t,r,n){var i=this;if(e){if(!L.isArray(e))return void A.addError("mediaItems must be an array",n);for(var a=e.length,o=0;o<a;o++){var s=e[o],l=i.tl.updateItemFromRaw(s,t,r,n);i.items.push(l.id)}a&&i.position===-1&&(i.position=0)}},v.prototype.getMediaItemAt=function(e){var t=this;return e<0||e>=t.items.length?null:t.tl.get(t.items[e])},v.prototype.getMediaItemById=function(e){var t=this;return e?t.tl.get(e):null},v.prototype.getMediaItemBySessionId=function(e){var t=this;return e?t.tl.getBySessionId(e):null},v.prototype.getCurrentItem=function(){var e=this;return e.getMediaItemAt(e.position)},v.prototype.appendItem=function(e){var t=this,r=t.items.length;return t.items.push(e),r},v.prototype.getItems=function(){for(var e=this,t=[],r=0;r<e.items.length;r++)t.push(e.getMediaItemAt(r));return t},v.prototype.getItemPosition=function(e){var t=this,r=t.items.indexOf(e);return r},v.prototype.setPosition=function(e){var t=this;L.isNumber(e)&&(t.position=e)},v.prototype.getNextPosition=function(e,t,r){var n=this;if(r=r||{},r.looped=!1,r.ended=!1,n.position===-1)return-1;if(!n.items.length)return-1;var i=n.position+1,a=n.getMediaItemAt(i);if(r&&r.skipWatchedVideos){for(;i<n.items.length&&a.isWatched();)i++,a=n.getMediaItemAt(i),a&&a.isBumper()&&i<n.items.length-1&&!I.hasUnwatchedClips(n.getItemsBeforeNextBumper(i+1))&&(i++,a=n.getMediaItemAt(i));if(n.position===n.items.length-1&&i===n.items.length&&!t)return r.ended=!0,n.playbackStopped=!0,-1}if(r.playlistLoop&&i===n.items.length)return r.looped=!0,0;if(e){if(i<n.items.length)return i;if(t&&i===n.items.length)return r.looped=!0,0;n.playbackStopped=!0}return!e&&t?(r.looped=!0,n.position):(r.ended=!0,-1)},v.prototype.getCurrentPosition=function(){var e=this;return e.position},v.prototype.getCurrentVideoShowName=function(){var e=this,t=e.getCurrentItem();return t&&t.getShowName()},v.prototype.isCurrentVideoOriginalShow=function(){var e=this,t=e.getCurrentItem();return!(!t||t.isOriginalShow()!==!0)},v.prototype.isCurrentVideoSeriesEpisode=function(){var e=this,t=e.getCurrentItem();return!(!t||t.isSeriesEpisode()!==!0)},v.prototype.getItemsBeforeNextBumper=function(e){for(var t,r=this,n=[];e<r.items.length&&(t=r.getMediaItemAt(e),t&&!t.isBumper());)n.push(t),e++;return n},m.prototype.attemptingPlayback=function(){var e=this;return e.videoSet()&&!e.paused||e.state===T.WAITING},m.prototype.isVideoPlaying=function(){var e=this;return e.videoSet()&&!e.paused},m.prototype.videoSet=function(){var e=this;return e.state===T.VIDEO},m.prototype.isOnCriticalError=function(){var e=this;return e.state===T.END&&e.criticalError},m.prototype.videoLoading=function(){var e=this;return e.videoSet()&&e.loading},m.prototype.isAdPlaying=function(){var e=this;return e.videoSet()&&e.ad},m.prototype.isVpaidAdPlaying=function(){var e=this;return e.isAdPlaying()&&e.ad.type===h.ADTYPES.VPAID},y.prototype.getConfig=function(){var e=this;return e._b},y.prototype.isPlaylistStructured=function(){var e=this,t=e.playlist.getMediaItemAt(0);return!(!t||!t.hasPlaylistConfig())},y.prototype.isLocal=function(){var e=this;return e.version.indexOf("local")>-1},y.prototype.isFlashRendererEnabled=function(){return!1},y.prototype.isHtmlEnforced=function(){var e=this;return e.baseConfig.rl===!0||"hls"===e.baseConfig.rl},y.prototype.isMobileStrmInlineExpr=function(){var e=this;return(S.ios||S.android)&&"strm-inline"===e.baseConfig.experienceType&&D.canPlayInline},y.prototype.isAutoplayAllowed=function(){var e=this,t=e.autoplayIgnoreConnType||O.mobile!==!0;return!S.mobile||D.autoplaySupported&&t},y.prototype.getGeoData=function(e){var t=this,r=t.geoData;return e?D.requestGeoData():new Promise(function(e,t){r.latitude&&r.longitude&&r.accuracy?(r.requestGeoNextCall=!1,e(r)):(r.errorCode=!0,r.requestGeoNextCall=!0,e(r))})},y.prototype.ul=function(){var e=this,t={},r=e.rapidConfig||{},n=r.pageParams||{},i=r.clickParams||{},a="";a="strm"===n.sec?i.pstaid||"":n.pstaid||"",t={pt:n.pt||"",pd:n.pd||"",pct:n.pct||"",pstcat:n.pstcat||"",ver:n.ver||"",sport:n.sport||"",ticker:n.ticker||"",rid:n._rid||"",rlvtscr:n.rlvtscr||"",vidPos:n.vidPos||"",pstaid_p:a,pkgt:i.pkgt||"",sec:i.sec||"",subsec:i.subsec||""},e.metrics.rapidFields=t},y.prototype.isMobileWebAutoplayCase=function(){var e=this;return S.mobile&&(e.playback.autoplay||e.isMobileStrmInlineExpr())},y.prototype.endVideo=function(){var e=this;e.playback.bitrate=0},y.prototype.getLoop=function(){var e=this,t=e.playback.loop;return e.getPlaylistRenderingType()===R.PLAYLIST_RENDERING_TYPE.ONLY_MEDIA_ITEMS?t:!(!e.playlist.endOfPlaylist&&t)&&t},y.prototype.setLoop=function(e){var t=this;L.isBoolean(e)&&(t.playback.loop=e)},y.prototype.getMute=function(){var e=this;return e.playbackState.mute},y.prototype.setMute=function(e){var t=this;L.isBoolean(e)&&(t.playbackState.mute=e)},y.prototype.getState=function(){var e=this;return e.playbackState.state},y.prototype.setState=function(e){var t=this;P.indexOf(e)>-1&&(t.playbackState.state=e)},y.prototype.getVolume=function(){var e=this;return e.playbackState.volume},y.prototype.setVolume=function(e){var t=this;L.isNumber(e)&&e>=0&&e<=1&&(t.playbackState.volume=e)},y.prototype.isPaused=function(){var e=this;return e.playbackState.paused},y.prototype.setPaused=function(e){var t=this;L.isBoolean(e)&&(t.playbackState.paused=e)},y.prototype.isSeeking=function(){var e=this;return e.playbackState.seeking},y.prototype.setSeeking=function(e){var t=this;L.isBoolean(e)&&(t.playbackState.seeking=e)},y.prototype.isLoading=function(){var e=this;return e.playbackState.loading},y.prototype.setLoading=function(e){var t=this;L.isBoolean(e)&&(t.playbackState.loading=e)},y.prototype.destroy=function(){var e=this;e.playlist.position=-1},y.prototype.getModelSchema=function(){return w},y.prototype.isDockable=function(){var e=this,t=e.ui&&e.ui.docking||{};return t.enableOnScrollDown||t.enableOnScrollUp},y.prototype.getPlaylistRenderingType=function(){var e,t=this,r=t.playlist&&t.playlist.id,n=t._b&&t._b.playlist,i=n&&n.mediaItems||[];return e=r?0===i.length?R.PLAYLIST_RENDERING_TYPE.PLAYLIST_ID:R.PLAYLIST_RENDERING_TYPE.PLAYLIST_ID_AND_MEDIA_ITEMS:R.PLAYLIST_RENDERING_TYPE.ONLY_MEDIA_ITEMS},y.prototype.getSapiQSConfig=function(e){var t=this,r=t._b&&t._b.pluginConfigs,n=r&&r[e],i=n&&n[R.SAPI_MIME_TYPE];return i&&i.qs||{}},y.prototype.updateRapidConfig=function(e){var t,r=this;e&&(t={rapidConfig:e},A.fillFromConfig(w,t,r),r.ul())},y.prototype.updatePageSpaceId=function(e){var t,r=this,n={pageSpaceId:e};A.fillFromConfig(w,n,r),r.CMS.suppressAdContext||(t=r.playlist.getItems(),t.forEach(function(t){t.updatePageSpaceId(e)}))},y.prototype.updateGeoConfig=function(e){var t=this;L.isBoolean(e.allowGeoRequest)&&(t.ui.allowGeoRequest=e.allowGeoRequest);var r=e.geoData;r&&L.isString(r.latitude)&&L.isString(r.longitude)&&L.isString(r.accuracy)?t.geoData=r:null===r&&(t.geoData={latitude:null,longitude:null,accuracy:null})},y.prototype.getUspString=function(){var e=this;return window.__uspapi&&window.__uspapi("getUSPData",1,function(t,r){r&&(e.uspString=t.uspString)}),e.uspString||""}},{"../../lib":"/lib/index.js","../../lib/capability":"/lib/capability.js","../../lib/logger":"/lib/logger.js","./constants":7,"./media-store":18,"./navigator-info":26,"./renderers/flash":36,"./renderers/html5-hls":39,"./renderers/html5-hls-360":38,"./renderers/html5-raw-360":40,"./renderers/type":44,"./states":46,"./util":"/nextgen/src/util.js","./watch-history":94,"./yvap/ads-json":95,"user-agent":233}],26:[function(e,t,r){"use strict";function n(){return!u.mobile||(u.android&&u.chrome>=50||u.ios&&u.iosVersion>=10)}function i(){return u.android&&u.chrome>=56}function a(e){var t=window.document.createElement("video");t.muted=e,t.setAttribute("playsinline",!0);var r=t.play&&t.play();r&&r instanceof window.Promise&&r.catch(function(e){});var n=t.paused;return t=null,n}function o(){return!!(u.android&&u.chrome>=50&&u.chrome<53||u.iosVersion>=10&&p.needsGestureToPlay)}function s(){return!u.mobile||(u.android&&u.chrome>=50||u.ios&&u.iosVersion>=10||!1)}function l(){return u.mobile?u.ipad||u.androidTablet?"tablet":"phone":u.tv?"tv":u.desktop?"desktop":void 0}var c=e("./util"),u=e("user-agent").userAgent,p=t.exports={};p.deviceType=l(),p.canPlayInline=n(),p.hasMuteAtFirstPlayRestriction=i(),p.needsGestureToPlay=a(!0),p.needsGestureToPlayUnmuted=a(!1),p.autoplaySupported=p.canPlayInline&&s(),p.autoplayByUIEvtOnly=p.autoplaySupported&&o(),p.hasNativeAutoplaySupport=p.autoplaySupported&&!p.autoplayByUIEvtOnly,p.airplaySupported=(u.safari>=9||u.iosVersion>=9)&&!!window.WebKitPlaybackTargetAvailabilityEvent;var d=function(e,t){return{value:e,enumerable:!0,configurable:!t}};Object.defineProperties(p,{network:d({},!0)}),Object.defineProperties(p.network,{available:d(!1,!1),connectionType:d("unknown",!1),update:{value:function(e,t){"boolean"==typeof e&&t&&!p.network.available&&Object.defineProperties(p.network,{mobile:d(e,!0),connectionType:d(t,!0),available:d(!0,!0)})}}}),c.setSingleton("navigatorInfo",p),p.requestGeoData=function(){var e={};e.requested=!1;var t=new Promise(function(t,r){var n={enableHighAccuracy:!0,timeout:5e3,maximumAge:0},i=function(r){var n=r.coords;e.latitude=n.latitude,e.longitude=n.longitude,e.accuracy=n.accuracy,t(e)},a=function(t){e.errorCode=t.code,e.errorMessage=t.message,r(e)};navigator.geolocation&&navigator.geolocation.getCurrentPosition(i,a,n),e.requested=!0});return t},u.phantomJS&&(p.wl=s,p.xl=a,p.yl=n,p.zl=o)},{"./util":"/nextgen/src/util.js","user-agent":233}],27:[function(e,t,r){"use strict";function n(e,t){var r=this;r.yb=t,r.uc=e}t.exports=n,n.prototype.verify=function(e){var t=this;t.uc&&t.uc.getRawMediaObjResponse(t.yb.id,function(t,r){if(t||!r)return e(!0);var n=r.status||{};e("214"!==n.code)})},n.prototype.scheduleVerification=function(e,t){var r=this;r.Al(),r.Bl=window.setTimeout(function(){r.verify(e)},t)},n.prototype.destroy=function(){var e=this;e.Al(),e.uc=null,e.yb=null},n.prototype.Al=function(){var e=this;e.Bl&&(clearTimeout(e.Bl),e.Bl=null)}},{}],28:[function(e,t,r){"use strict";function n(e,t,r){var n=this;if(!r||!t||!e)throw new Error("[PauseHandler] Invalid arguments");n.l=e,n.tc=t,n.k=r,n.k.subscribe(i.PAGE_VISIBILITY_CHANGED,n.Cl,n),n.k.subscribe(i.Video.PLAYING,n.fe,n),n.k.subscribe(i.Iframe.ON_FOCUS,n.Dl,n),n.k.subscribe(i.Iframe.ON_BLUR,n.El,n),n.k.subscribe(i.Iframe.WINDOW_ON_BLUR,n.Fl,n),n.k.subscribe(i.Iframe.WINDOW_ON_FOCUS,n.Gl,n),n.BACKGROUND_PAUSE_TIME=5e3,n.SUSPEND_STREAM_TIME=2e4;var a=n.l.playback.backgroundPause,o=a.timeToPause>0?1e3*a.timeToPause:0;n.Hl=a.onMute,n.Il=a.onUnmute,n.Jl=n.Hl||n.Il,n.Kl=o||n.BACKGROUND_PAUSE_TIME,n.Ll=a.suspendStreamingTime||n.SUSPEND_STREAM_TIME,n.Ml=!0,n.Nl=null,n.Ol=null,n.Pl=!1,n.Ql=!1,n.Rl=!0}var i=e("./event"),a=(e("./model"),e("./states")),o=e("./metrics/metrics-constants"),s=e("user-agent").userAgent;t.exports=n,n.prototype.destroy=function(){var e=this;e.Sl(e.Nl),e.Sl(e.Ol)},n.prototype.Cl=function(e){var t=this;return e?(t.Sl(t.Nl),t.Sl(t.Ol),void t.Lb()):void(t.Tl()&&t.Ul())},n.prototype.Dl=function(){var e=this;e.Sl(e.Nl),e.Sl(e.Ol),e.Lb()},n.prototype.El=function(){var e=this;!e.Rl&&e.Tl()&&e.Ul()},n.prototype.Fl=function(){var e=this;e.Tl()&&(e.Rl=!1,e.Ul())},n.prototype.Gl=function(){var e=this;e.Rl=!0,e.Lb()},n.prototype.Tl=function(){var e=this;if(!e.Jl||!e.Vl())return!1;var t=e.l.getMute();return!(t&&!e.Hl||!t&&!e.Il)},n.prototype.Ul=function(){var e=this;e.Nl||(e.Nl=setTimeout(function(){e.Sl(e.Nl),e.Wl()}.bind(e),e.Kl))},n.prototype.Wl=function(){var e=this;e.Pl=!0,e.tc.pause({type:o.API,action:o.BACKGROUND}),e.k.publish(i.CTRL_PLAYPAUSE,"pause")},n.prototype.scheduleSuspend=function(){var e=this;e.Ol||e.Ml&&(e.Ol=setTimeout(function(){e.Sl(e.Ol),e.suspendStreaming()}.bind(e),e.Ll))},n.prototype.Lb=function(){var e=this;e.Jl&&!e.Vl()&&e.Pl&&(e.resumeStreaming(),e.tc.play({type:o.API,action:o.BACKGROUND}),e.k.publish(i.CTRL_PLAYPAUSE,"play"))},n.prototype.fe=function(){var e=this;e.Pl&&s.chrome&&e.tc.seek(e.tc.getCurrentTime()),e.Pl=!1},n.prototype.suspendStreaming=function(){var e=this;e._()&&(e.Ql=!0,e.tc.suspendStreaming())},n.prototype.resumeStreaming=function(){var e=this;e.Sl(e.Ol),e._()&&e.Ql&&(e.tc.resumeStreaming(),e.Ql=!1)},n.prototype.Vl=function(){var e=this;return!e.l.isLoading()&&e.l.getState()===a.VIDEO&&!e.l.isPaused()},n.prototype.Sl=function(e){e&&(clearTimeout(e),e=null)},n.prototype._=function(){var e=this,t=e.l.playlist.getCurrentItem();return!!t&&t.isLive()}},{"./event":"/nextgen/src/event.js","./metrics/metrics-constants":21,"./model":25,"./states":46,"user-agent":233}],29:[function(e,t,r){"use strict";function n(){var e=i.getWindow(),t=e&&e.location&&e.location.search&&e.location.search.indexOf("vperf=1")!==-1,r=!0,n=e.performance;n&&n.now&&n.mark&&n.measure&&n.getEntriesByType||(r=!1),r||(n={originTime:Date.now(),now:function(){return Date.now()-this.originTime}});var s={},l={},c={},u={start:function(e,t){if(t){if(c[t]&&c[t][e]&&c[t][e].startTime)return!1;c[t]||(c[t]={}),c[t][e]={startTime:n.now()}}else{if(l[e]&&l[e].startTime)return!1;l[e]={startTime:n.now()}}return!0},end:function(e,t){if(t){if(!c[t]||!c[t][e]||!c[t][e].startTime)return!1;if(c[t]&&c[t][e]&&c[t][e].endTime)return!1;c[t][e].endTime=n.now()}else{if(!l[e]||!l[e].startTime)return!1;if(l[e]&&l[e].endTime)return!1;l[e].endTime=n.now()}return!0},getLocalMeasurements:function(e){if(c&&c[e])return c[e]},getGlobalMeasurements:function(){return l},removeLocalMeasurements:function(e){c&&c[e]&&delete c[e]},startDebugMode:function(e){return!(!t||!r)&&(!s[e]&&(s[e]=a,n.mark("mark_"+e+"_start"),!0))},endDebugMode:function(e,i){return!(!t||!r)&&(!!s[e]&&(s[e]!==o&&(s[e]=o,n.mark("mark_"+e+"_end"),i||this.measure(e),!0)))},measure:function(e){return!!r&&(!(!s[e]||s[e]!==o)&&(n.measure(e,"mark_"+e+"_start","mark_"+e+"_end"),!0))},listMarks:function(){if(r){var e=n.getEntriesByType("mark").map(function(e){return{name:e.name,startTime:e.startTime}});return e}},listMeasures:function(){if(r){var e=n.getEntriesByType("measure").map(function(e){return{name:e.name,startTime:e.startTime,endTime:e.startTime+e.duration,duration:e.duration}});return e}},clearMarks:function(){r&&n.clearMarks()},clearMeasures:function(){r&&n.clearMeasures()},destroy:function(e){c&&c[e]&&delete c[e]}};return e.Xl=e.Xl||{},e.Xl.perf=u,u}var i=(e("../../lib/logger"),e("./util")),a="started",o="ended";t.exports=n()},{"../../lib/logger":"/lib/logger.js","./util":"/nextgen/src/util.js"}],30:[function(e,t,r){"use strict";function n(e){var t=this;t.m=e,t.bj=e.getRootElement(),t.Yl=e.getMainElement(),t.Zl=e.getContentNode(),t.l=e.getModel(),t.k=e.getEventBus(),t.$l=t.l.playlist.getMediaItemAt(0),t._l=[],t.bm=0,t.cm(),t.dm&&(t.l.playback.continuousPlay=!0,t.em(),t._l.push(t.k.subscribe(s.MEDIA_ITEM_LOADED,t.D,t)),t._l.push(t.k.subscribe(s.FULLSCREEN_CHANGE,t.fm,t)),
t._l.push(t.k.subscribe(s.AD_PLAYBACK_STARTED,t.u,t)),t._l.push(t.k.subscribe(s.PLAYBACK_STARTED,t.Kf,t)),t._l.push(t.k.subscribe(s.Video.ENDED,t.Tf,t)),t._l.push(t.k.subscribe(s.Ad.PLAYING,t.gm,t)))}t.exports=n;var i=e("user-agent").userAgent,a=e("./util"),o=e("./tap"),s=e("./event"),l=e("./constants"),c=e("./views/playlist"),u=e("./views/structured-playlist"),p=l.PLAYLIST_POS_BOTTOM,d=l.PLAYLIST_POS_RIGHT,f=l.PLAYLIST_POS_HIDDEN,v=83,m=318,y=276;n.prototype.fetchMore=function(e,t){var r=this;if(r.l.playlist.endOfPlaylist!==!0){var n={start:r.bm,count:e,videoUuid:r.$l&&r.$l.id||"",playlistId:r.hm,playlistAlias:r.im},i=function(n,i){n||(r.bm+=e),i&&0===i.length&&(r.l.playlist.endOfPlaylist=!0),t&&t(n,i)};r.k.publish(s.FETCH_MORE_RELATED_ITEMS,r.$l,n,i)}},n.prototype.gm=function(){var e=this;e.jm(!1)},n.prototype.Tf=function(){var e=this;e.jm(!1)},n.prototype.jm=function(e){var t=this;t.dm&&t.km&&(e&&!t.l.playlist.getCurrentItem().isLive()?a.classList(t.km).remove("disabled"):a.classList(t.km).add("disabled"),t.lm=e)},n.prototype.initDrawPlaylist=function(e,t,r){var n=this;n.dm&&(n.mm||(n.mm=function(){return i.mobile?(n.nm.style.display="block",void(a.classList(n.nm).contains("open")?(a.classList(n.qm).remove("yvp-bottom-upnext"),a.classList(n.nm).remove("open"),n.om.removeAttribute("style")):(a.classList(n.nm).add("open"),n.nm.style.display="block",n.om.style.top=n.pm()+"px",a.classList(n.qm).add("yvp-bottom-upnext")))):void n.rm.upNextBtnTapHandler()},n.sm=new o(n.tm),n.tm.addEventListener("tap",n.mm)),r===!0&&t.length<=0&&n.jm(!0),t&&t.length>2?n.rm.renderPlaylist(t):e&&n.jm(!1))},n.prototype.um=function(){var e=this,t=e.m.getControls();return!!t&&(e.qm=t&&t.getBottomBar(),e.om=e.qm.querySelector(".yvp-bottom-container"),e.tm=e.qm.querySelector(".yvp-upnext-btn"),e.nm=e.qm.querySelector(".yvp-upnext-playlist"),e.km=e.qm.querySelector(".yvp-upnext-container"),!0)},n.prototype.cm=function(){var e,t,r=this,n=r.l.ui&&r.l.ui.playlistUI,a=r.l.playlist.id;if(r.vm=!1,r.wm=null,r.xm=!1,r.dm=!1,r.hm=n&&n.playlistId||a||"",r.im=n&&n.playlistAlias||"",n&&n.show===!0&&(r.wm=n.position,n.inStream===!0&&r.wm===d&&(r.xm=!0),i.mobile||(t=r.bj.clientWidth,e=r.l.uiState&&r.l.uiState.width||t,(r.wm===f&&e>200||r.wm===p&&e>=560||r.wm===d&&(e>=627||t>=627))&&(r.dm=!0))),r.dm){var o=r.um();o||(r.dm=!1)}},n.prototype.em=function(){var e,t,r,n,i,a,o,c=this;if(c.dm&&c.wm!==f)switch(c.ym={rootElem:{height:null,width:null},contentElem:{height:null,width:null},mainElem:{height:null,width:null}},c.wm){case p:e=c.bj.clientHeight||l.DEFAULT_HEIGHT,t=e+v,c.bj.style.height=t+"px",c.Zl.style.height=e+"px",c.zm=e+"px",c.ym.rootElem.height=t,c.ym.rootElem.width=c.bj.clientWidth,c.ym.contentElem.height=c.Zl.clientHeight,c.k.publish(s.PLAYER_DIMENSION_CHANGE,{width:c.ym.rootElem.width||l.DEFAULT_WIDTH,height:t,from:"PlaylistController"});break;case d:r=c.Yl.clientWidth||l.DEFAULT_WIDTH,n=c.Zl.clientWidth||l.DEFAULT_WIDTH,a=0,c.xm?(i=y,o=r-i,c.Yl.style.width=o+"px",c.Am=o+"px"):(i=m,o=n-i,a=100*o/n,c.Yl.style.width=a+"%",c.Am=a+"%"),c.Bm(),c.ym.rootElem.width=c.bj.clientWidth,c.ym.mainElem.width=o,c.k.publish(s.PLAYER_DIMENSION_CHANGE,{width:o,height:c.bj.clientHeight||l.DEFAULT_HEIGHT})}},n.prototype.Cm=function(){var e,t,r=this;switch(r.wm){case p:e=r.bj.clientHeight,t=e-v,r.bj.style.height=t+"px",r.ym.rootElem.height=t}},n.prototype.D=function(){var e=this;e.dm&&(e.vm||e.Dm())},n.prototype.u=function(){var e=this;e.dm&&e.jm(!1)},n.prototype.Kf=function(){var e=this;e.dm&&(e.lm||e.jm(!0))},n.prototype.pm=function(){var e=this,t=e.Zl.clientHeight,r=e.om.clientHeight,n=e.m.getNFLBrandingNode(),i=0;return null!==n&&(i=n.clientHeight),t-r-i},n.prototype.attachUpNextMouseEvents=function(){var e=this;e.km&&e.km.addEventListener("mouseover",function(){a.classList(e.qm).contains("yvp-bottom-upnext")||(a.classList(e.qm).add("yvp-bottom-upnext"),e.om.style.top=e.pm()+"px",e.k.publish(s.API.UI_INTERACT,{srcElement:"ctrl-next-hover"}),e.k.publish(s.API.UI_INTERACT,{srcElement:"ui_pl_nxt_hvr"}))}),e.km&&e.km.addEventListener("mouseout",function(){setTimeout(function(){window.getComputedStyle(e.Em).zIndex<0&&(a.classList(e.qm).remove("yvp-bottom-upnext"),e.om.removeAttribute("style"))},100)})},n.prototype.detachUpNextMouseEvents=function(){var e=this;e.km&&e.km.addEventListener("mouseover",function(){a.classList(e.qm).remove("yvp-bottom-upnext"),e.om.removeAttribute("style")})},n.prototype.Dm=function(){var e=this;if(!i.mobile||e.wm===f){switch(e.l.isPlaylistStructured()?(e.rm=new u(e.k,e.m,e.l),e.l.playback.playlistLoop=!0,e.initDrawPlaylist(null,[],!0)):e.rm=new c(e.k,e.m,e.l),e.wm){case f:e.Fm=e.rm.create(f),e.Em=e.Fm,e.nm.appendChild(e.Em),a.classList(e.km).remove("hide"),i.mobile||e.attachUpNextMouseEvents();break;case p:e.Em=e.rm.create(f),e.Fm=e.rm.create(p),e.nm.appendChild(e.Em),e.Zl.appendChild(e.Fm),a.classList(e.km).remove("hide"),a.classList(e.nm).add("hide");break;case d:e.Em=e.rm.create(f),e.Fm=e.rm.create(d),e.nm.appendChild(e.Em),e.Zl.appendChild(e.Fm),a.classList(e.km).remove("hide"),a.classList(e.nm).add("hide")}e.l.playback.autoplay!==!0&&e.rm.renderFirstBatch(),e.vm=!0}},n.prototype.fm=function(){var e,t=this,r=t.m.isDocked();r||t.wm!==f&&(e=t.m.getFullscreen(),e===!0?t.wm===p?t.Zl.style.height="100%":t.wm===d&&t.Yl.style&&(t.Yl.style.width="100%",t.Yl.style["z-index"]=1):t.wm===p?t.Zl.style.height=t.zm:t.wm===d&&(t.Yl.style.width=t.Am,t.Yl.style["z-index"]="auto"))},n.prototype.Gm=function(){var e=this,t=e.Zl.clientWidth,r=t-m,n=100*r/t,i=".yvp-playlist-mode-"+e.wm,o=e.Zl.querySelector(i);t>=627&&e.m.getFullscreen()===!1?(e.Yl.style.width=n+"%",e.Am=n+"%",a.classList(o).remove("yvp-hide-playlist")):t<627&&e.m.getFullscreen()===!1&&(e.Yl.style.width=e.Am="100%",a.classList(o).add("yvp-hide-playlist"))},n.prototype.Bm=function(){var e=this;e.wm!==d||e.xm||(e.Hm=e.Gm.bind(e),window.addEventListener("resize",e.Hm))},n.prototype.togglePlaylistUI=function(e){var t=this;if(!t.m.getFullscreen()&&t.dm&&t.wm!==f){var r=".yvp-playlist-mode-"+t.wm,n=t.Zl.querySelector(r);switch(e?a.classList(n).add("yvp-hide-playlist"):a.classList(n).remove("yvp-hide-playlist"),t.wm){case d:e===!0?(t.Yl.removeAttribute("style"),t.bj.style.width=t.ym.mainElem.width+"px"):(t.Yl.style.width=t.ym.mainElem.width+"px",t.bj.style.width=t.ym.rootElem.width+"px");break;case p:e===!0?t.Zl.style.height=t.ym.rootElem.height+"px":(t.Zl.style.height=t.ym.contentElem.height+"px",t.bj.style.height=t.ym.rootElem.height+"px")}}},n.prototype.getPlaylistRootElement=function(){var e=this;return e.Fm},n.prototype.getPlaylistUIPosition=function(){var e=this;return e.wm},n.prototype.isPlaylistInStream=function(){var e=this;return e.xm},n.prototype.isPlaylistShown=function(){var e=this;return e.dm},n.prototype.destroy=function(){var e=this;e.Hm&&(window.removeEventListener("resize",e.Hm),e.Hm=null),e.Cm(),e._l.forEach(function(e){e()}),e._l=[]}},{"./constants":7,"./event":"/nextgen/src/event.js","./tap":"/nextgen/src/tap.js","./util":"/nextgen/src/util.js","./views/playlist":79,"./views/structured-playlist":85,"user-agent":233}],31:[function(e,t,r){"use strict";function n(e){var t=this;t._b=e,t.startTime=e&&e.insideIframeConfig&&e.insideIframeConfig.startTime?e.insideIframeConfig.startTime:Date.now(),t.startTime=Date.now(),t.Im=[]}t.exports=n;var i=e("user-agent").userAgent,a=e("./util"),o=(e("../../lib/logger"),e("./views/profiler.html"));n.prototype.add=function(e){var t=this,r=t.Jm(e);r>-1&&t.Im.splice(r,1),t.Im.push({type:e.type,desc:e.desc,startTime:Date.now()-t.startTime,endTime:null})},n.prototype.Jm=function(e){for(var t=this,r=0;r<t.Im.length;r++){var n=t.Im[r];if(e.type===n.type)return r}return-1},n.prototype.getItem=function(e){var t=this,r=t.Jm(e);return r>-1?t.Im[r]:null},n.prototype.setEndTime=function(e,t,r){var n=this,i=n.getItem(e);t||(t=Date.now(),r=!0),i&&(i.endTime=r?t-n.startTime:t,i.timeDiff=i.endTime-i.startTime)},n.prototype.render=function(e){var t=this,r=t.Im.slice(0);r.forEach(function(e){e.startWidth=e.startTime/4,e.barWidth=e.timeDiff/4});var n;try{n=JSON.parse(JSON.stringify(t._b))}catch(e){n={}}var s=!!n.rapidConfig,l=!(!s||!n.rapidConfig.rapid)&&Object.keys(n.rapidConfig.rapid).length>0;s&&(delete n.rapidConfig.rapid,n.rapidConfig.hasValidRapid=l);var c=a.render(o,{config:JSON.stringify(n,null,2),profileItems:r});if(e){var u=document.createElement("div");u.appendChild(c),u.appendChild(e),c=u}if(i.mobile)document.write(c.innerHTML);else{var p=window.open();p&&p.document.write(c.innerHTML)}}},{"../../lib/logger":"/lib/logger.js","./util":"/nextgen/src/util.js","./views/profiler.html":80,"user-agent":233}],32:[function(e,t,r){"use strict";function n(e,t){var r=this;r.k=e,r.l=t,r.Km=new c(e,t),r.Lm(),r.Mm=!1,r.RECOVERY_STATES=m,r.Nm=[],r.Nm.push(r.k.subscribe(a.Video.WAITING,r.ne,r)),r.Nm.push(r.k.subscribe(a.ERROR,r.tb,r)),r.Nm.push(r.k.subscribe(a.ER_READY,r.Om,r)),r.Nm.push(r.k.subscribe(a.ER_ERROR,r.Pm,r))}t.exports=n;var i=e("./error"),a=e("./event"),o=e("./media-store"),s=e("./util"),l=(e("../../lib/logger"),e("../../lib")),c=e("./emergency-record-manager"),u=["200","400","501","430"],p=["7","57","304","307"],d=["700","701","710","711","720","721","722","730","731","732","740","750","760"],f=["103","500","502","503","550","403","404","504"],v=["11","12","13","14"],m={INIT_OR_PLAYING:0,BUFFERING:1,ERROR:2,API:3,RESUME:4},y=1e4,h=1e4,E=2e3,g=1e4,b=1e4;n.prototype.Lm=function(){var e=this;e.Qm=Math.random()*h+y,e.Rm=E,e.Sm(),e.Tm(),e.Um=m.INIT_OR_PLAYING,e.Vm=!1},n.prototype.ne=function(e){var t=this,r=e&&e.value;r?t.Wm(m.BUFFERING):(t.Mm&&t.k.publish(a.WARNING,s.createErr("P",t.l.playbackState,i.E_WARNING,i.WARNING_CODES.E_RECOVERY_STATUS,null,"recovered")),t.Xm())},n.prototype.Wm=function(e){var t=this;return t.Ym(),t.Km.init(),e===m.BUFFERING?void t.Zm(t.Qm):void t.recover(e)},n.prototype.Xm=function(){var e=this;e.Lm(),e.stopTimers(),e.Mm=!1},n.prototype.tb=function(e){var t=this;if(e&&t.$m(e)){if("400"===e.category.toString()&&"7"===e.subcategory.toString())return t._m(),void(t.an=setTimeout(function(){t.Wm(m.ERROR)},Math.random()*g));t.Wm(m.ERROR)}},n.prototype.recover=function(e){var t=this;t.l.playbackState.ad||t.Um===m.INIT_OR_PLAYING&&(t.Sm(),t.Tm(),t.Mm||(t.Mm=!0,t.k.publish(a.WARNING,s.createErr("P",t.l.playbackState,i.E_WARNING,i.WARNING_CODES.E_RECOVERY_STATUS,null,"recovering"))),e===m.RESUME&&t.k.publish(a.WARNING,s.createErr("P",t.l.playbackState,i.E_WARNING,i.WARNING_CODES.E_RECOVER_LONG_PAUSE,null,"Recovering from long pause on live")),t.Km.isActive()&&(t.cn=setTimeout(function(){t.dn()},b)),t.Um=e?e:m.API,t.l.playlist.getCurrentItem().failoverCount++,t.l.playlist.getCurrentItem().recoveryStatus=o.ItemRecoveryStatus.RECOVERING,t.k.publish(a.RECOVERY_START,t.fn.bind(t)))},n.prototype.shouldRenderErrorScreen=function(e){return!!e&&(u.indexOf(e.category.toString())<0||p.indexOf(e.subcategory.toString())<0&&d.indexOf(e.subcategory.toString())<0&&f.indexOf(e.subcategory.toString())<0&&v.indexOf(e.subcategory.toString())<0)},n.prototype.$m=function(e){var t=this;return!!e&&(!((d.indexOf(e.subcategory.toString())>=0||e.category===i.E_SAPI_STREAM)&&t.l.playlist.getCurrentItem().failoverCount>0)&&!t.shouldRenderErrorScreen(e))},n.prototype.fn=function(e){var t=this;return t.Um?(t.k.publish(a.WARNING,s.createErr("P",t.l.playbackState,i.E_WARNING,i.WARNING_CODES.E_PLAYBACK_FROZEN_DETECTED,null,t.Um)),void(e?t.Km.isActive()?t.dn():t.gn():(t.k.publish(a.RECOVERY_METADATA_READY),t.Lm()))):void t.l.playlist.getCurrentItem().failoverCount--},n.prototype.dn=function(){var e=this;return e.Vm?void e.gn():(e.Km.getRecord(),void(e.Vm=!0))},n.prototype.Zm=function(e){var t=this;t.Sm(),t.hn=setTimeout(function(){t.recover(t.Um?t.Um:m.BUFFERING)},e)},n.prototype.gn=function(e){var t=this;e=!!l.isNullOrUndefined(e)||e,e&&(t.Qm+=t.Rm,t.Rm*=2),t.Zm(t.Qm),t.Vm=!1},n.prototype.Ym=function(){var e=this;e.in||(e.in=setTimeout(function(){var t=s.createErr("P",e.l.playbackState,i.E_PLAYER,i.PLAYER_CODES.E_RECOVERY_FAILURE);e.k.publish(a.ERROR,t),e.Xm()},1e3*e.l.failOver.recoveryFailureTimeout))},n.prototype.Sm=function(){var e=this;e.hn&&(clearTimeout(e.hn),e.hn=null)},n.prototype.Tm=function(){var e=this;e.cn&&(clearTimeout(e.cn),e.cn=null)},n.prototype._m=function(){var e=this;e.an&&(clearTimeout(e.an),e.an=null)},n.prototype.jn=function(){var e=this;e.in&&(clearTimeout(e.in),e.in=null)},n.prototype.stopTimers=function(){var e=this;e.Sm(),e.Tm(),e._m(),e.jn()},n.prototype.ln=function(){var e=this,t=e.l.playlist.getCurrentItem();t&&!t.isLive()&&e.gn(!1)},n.prototype.Om=function(){var e=this;e.Lm()},n.prototype.Pm=function(){var e=this;e.gn()},n.prototype.destroy=function(){var e=this;e.Xm(),e.Km.destroy(),e.Nm.forEach(function(e){e()}),e.Nm=[]}},{"../../lib":"/lib/index.js","../../lib/logger":"/lib/logger.js","./emergency-record-manager":11,"./error":12,"./event":"/nextgen/src/event.js","./media-store":18,"./util":"/nextgen/src/util.js"}],33:[function(e,t,r){"use strict";var n=e("./navigator-info"),i=e("user-agent").userAgent,n=e("./navigator-info"),a=e("../../lib/logger"),o=e("./util"),s=e("./event"),l=e("./renderers/type"),c=e("./renderers/modes"),u=e("./constants"),p=e("./perf"),d="yvp-mode-",f={};f[l.EXTERNAL]=e("./renderers/external"),f[l.FLASH]=e("./renderers/flash"),f[l.FLASH_SIMPLE]=e("./renderers/flash-simple"),f[l.HTML5_TV]=e("./renderers/html5-tv"),f[l.HTML5_HLS]=e("./renderers/html5-hls"),f[l.HTML5_RAW]=e("./renderers/html5-raw"),f[l.HTML5_RAW_360]=e("./renderers/html5-raw-360"),f[l.HTML5_HLS_360]=e("./renderers/html5-hls-360"),f[l.HTML5_TV_TIZEN]=e("./renderers/tizen"),f[l.HTML5_TV_ORSAY]=e("./renderers/orsay");var v=function(e){var t=this;t.m=e,t.k=e.getEventBus(),t.l=e.getModel(),t.Ha=e.getProfiler(),t.mn=e.getContentNode(),t.nn=e.getMainElement(),t.pn=null,t.qn=null,t.rn=null,t.sn=null,t.tn=null,t.un=null,t.vn={},t.wn=t.xn(),t.yn=!1,t.Pg()};v.prototype.Pg=function(){var e=this;e.k.subscribe(s.RENDERER_PP_NEXT,e.zn,e)},v.prototype.An=function(e){var t=this,r=t.l,i=t.k,a=t.Ha,o=t.l.capabilities[e],s=t.vn[e];if(s)return s.bindCustomEvents(),s;switch(e){case l.FLASH:if(t.pn)return t.pn;s=new f[l.FLASH](i,r,a),s.detectFlashBlockers(t.nn),t.pn=s;break;case l.FLASH_SIMPLE:if(t.qn)return t.qn;s=new f[l.FLASH_SIMPLE](i,r,a),s.detectFlashBlockers(t.nn),t.qn=s;break;case l.HTML5_HLS:s=new f[l.HTML5_HLS](i,r,a);break;case l.HTML5_TV:s=new f[l.HTML5_TV](i,o,a,r);break;case l.HTML5_TV_TIZEN:s=new f[l.HTML5_TV_TIZEN](i,o,a,r);break;case l.HTML5_TV_ORSAY:s=new f[l.HTML5_TV_ORSAY](i,o,a,r);break;case l.HTML5_RAW_360:s=new f[l.HTML5_RAW_360](i,o,a,r);break;case l.HTML5_HLS_360:s=new f[l.HTML5_HLS_360](i,o,a,r);break;case l.EXTERNAL:s=new f[l.EXTERNAL](i,r,a);break;default:s=new f[l.HTML5_RAW](i,o,a,r)}return t.nn.appendChild(s.create()),e!==l.FLASH&&e!==l.FLASH_SIMPLE&&t.l.ui&&t.l.ui.showControls&&!n.canPlayInline&&s.node&&(s.node.controls=!0),s.mode=c.VIDEO,t.Bn(s,e),s},v.prototype.Cn=function(e){var t,r=this;return p&&p.startDebugMode(u.PERF.VP_RC_SETUP+e),t=i.tv?i.tizen?r.An(l.HTML5_TV_TIZEN):i.orsay?r.An(l.HTML5_TV_ORSAY):i.fios?r.An(l.HTML5_HLS):r.An(l.HTML5_TV):r.An(e),p&&p.endDebugMode(u.PERF.VP_RC_SETUP+e),t},v.prototype.Dn=function(e,t){if(e&&t){for(var r=0;r<t.length;r++)t[r].cdn=o.getMediaCDNName(e,t,null);e.fillSelectedStreams(t,null)}},v.prototype.En=function(e){var t,r=this,n=[l.EXTERNAL,l.HTML5_RAW_360,l.HTML5_HLS_360];if(e)return t=e.type,r.Fn(e,!1),r.vn[t]||n.indexOf(t)!==-1?void(t!==l.FLASH&&t!==l.FLASH_SIMPLE&&e.destroy()):void r.Bn(e,t)},v.prototype.Fn=function(e,t){var r;if(e)switch(r=e.type){case l.FLASH:case l.FLASH_SIMPLE:t?e.bindPlaybackEvents():(e.stopMedia(),e.unbindPlaybackEvents());break;case l.EXTERNAL:t?e.attach():e.detach();break;default:t?(e.detachNode&&e.detachNode(),e.reattachNode&&e.reattachNode()):(e.detachNode&&e.detachNode(),e.stopMedia&&e.stopMedia())}},v.prototype.Gn=function(){var e=this;e.m.syncViewState(),(i.safari||i.firefox)&&e.m.setBlockedFlashState()},v.prototype.Hn=function(e,t){var r,n,i=[],a=e.ad,o=e.mediaItem;return t||(t=0),i.push(e.rendererType),i.push(t),a?(i.push("ad"),i.push(a.playbackId),i.push(a.adId),i.push(a.position),r=a.streams,r&&r.length>0&&i.push(r[0].url),n=a.adObj,n&&(i.push(n.adFormat),i.push(n.creativeId),i.push(n.bookingId),i.push(n.serveId))):o&&(i.push("mediaItem"),i.push(o.id),r=o.streams,r&&r.length>0&&i.push(r[0].url)),i.join("|")},v.prototype.zn=function(e){var t=this;e&&e.rendererType===l.HTML5_HLS&&t.prepareNextRenderer({rendererType:e.rendererType,mediaItem:e},function(r){r||t.sn===t.rn||e.isLive()||t.preloadNextRenderer({mediaItem:e,isAdvancePreload:!0,forcePreloadStream:!0})})},v.prototype.xn=function(){var e=i.mobile&&!n.hasNativeAutoplaySupport;return!(i.tv||i.ios||e)},v.prototype.setupDefault=function(){var e=this;return!e.l.isFlashRendererEnabled()||void e.Cn(l.FLASH)},v.prototype.prepareNextRenderer=function(e,t){var r,n,i,o=this;if(t||(t=function(){}),!e)return void t(new Error("no data is given"));if(r=e.rendererType,!o.mn)return a.log("RendererController.prepareNextRenderer: no container node is set"),void t(new Error("no container node is set"));if(!r)return a.log("RendererController.prepareNextRenderer: no renderer type is given"),void t(new Error("no renderer type is given"));if(p&&p.startDebugMode(u.PERF.VP_RC_PREPARE_NEXT+r),n=o.Hn(e),o.tn===n){if(o.yn)return;return p&&p.endDebugMode(u.PERF.VP_RC_PREPARE_NEXT+r),void t()}i=!o.wn&&o.rn&&o.rn.type===r&&o.rn.type!==l.EXTERNAL||e.isRecovering&&o.rn?o.rn:o.Cn(r),o.sn&&o.sn!==o.rn&&o.Fn(o.sn,!1),o.sn=i,o.tn=n,o.yn=!0,o.sn.waitForReady(function(e){o.yn=!1,p&&p.endDebugMode(u.PERF.VP_RC_PREPARE_NEXT+r),e&&(o.Gn(),o.In(o.sn)),t(e)})},v.prototype.In=function(e){var t=this;return e.type===l.FLASH_SIMPLE?t.qn=null:e.type===l.FLASH&&(t.pn=null),delete t.vn[e.type],e.destroy()},v.prototype.preloadNextAdRenderer=function(e){var t=this,r=e.bestStream,n=e.mediaItem,i=e.ad||{},a={rendererType:e.rendererType,ad:i};p&&p.startDebugMode(u.PERF.VP_RC_PRELOAD_NEXT_AD+e.rendererType);var o=function(){t.preloadNextAdRenderer(e)},s=function(){var o=t.Hn(a),s={streams:[r],adId:i.adId,sessionId:n?n.videoSession:null},l=!0;return!(!n||!r)&&(t.Dn(n,s.streams),t.un===o?(p&&p.endDebugMode(u.PERF.VP_RC_PRELOAD_NEXT_AD+e.rendererType),!0):t.sn?(t.un=o,l=t.sn.setStreams(s),p&&p.endDebugMode(u.PERF.VP_RC_PRELOAD_NEXT_AD+e.rendererType),l):void 0)},l=t.Hn(a);return t.tn===l?s():void t.prepareNextRenderer(a,o)},v.prototype.preloadNextRenderer=function(e){var t,r,n,i,a=!1;if(!e)return!1;if(t=e.mediaItem,r=e.startTime,n=e.forcePreloadStream,i=e.isAdvancePreload,!t)return!1;var o=this,s={rendererType:t.rendererType,mediaItem:t};p&&p.startDebugMode(u.PERF.VP_RC_PRELOAD_NEXT+s.rendererType);var c=function(){o.preloadNextRenderer(e)},d=function(){var e=o.Hn(s,r),c={streams:t.streams,streamProfiles:t.streamProfiles,altStreams:t.altStreams,abr:o.l.playback.abr,uuid:t.id,isCCM:t.isCCM,is360:t.is360Video(),startTime:r,ignoreEndlist:t.isLive()&&o.l.playback.ignoreEndlist,sessionId:t?t.videoSession:null};if(i||o.Dn(t,c.streams),o.un===e)return p&&p.endDebugMode(u.PERF.VP_RC_PRELOAD_NEXT+s.rendererType),!0;if(o.sn){if(o.un=e,a=o.sn.setStreams(c),a&&n&&o.sn.type===l.HTML5_HLS){var d=t&&t.itemConfig,f={startOffset:d?d.playbackStart:NaN,bufferLimit:o.l.forcePreloadBufferLimit||30};o.sn.preload(f)}return p&&p.endDebugMode(u.PERF.VP_RC_PRELOAD_NEXT+s.rendererType),a}},f=o.Hn(s);return o.tn===f?d():void o.prepareNextRenderer(s,c)},v.prototype.switchToRenderer=function(e,t){var r=this,n=r.rn;r.Jn(e),r.l.playbackState.rendererType=e.type,r.setVolume(r.l.getVolume()),r.setMute(r.l.getMute()),n&&n!==e&&(n.type===l.HTML5_HLS_360||n.type===l.HTML5_RAW_360||n.type===l.EXTERNAL?o.classList(n.Kn).remove("yvp-renderer-active"):o.classList(n.node).remove("yvp-renderer-active"),i.mobile&&r.m.getFullscreen()&&r.exitFS(),t?r.In(n):r.En(n)),r.Fn(e,!0),e.type===l.HTML5_HLS_360||e.type===l.HTML5_RAW_360||e.type===l.EXTERNAL?o.classList(e.Kn).add("yvp-renderer-active"):o.classList(e.node).add("yvp-renderer-active"),r.m.syncViewState(),r.k.publish(s.RENDERER_SWITCHED,{active:e})},v.prototype.switchAndPlayNextRenderer=function(e,t){var r=this;r.switchToNextRenderer(t),r.play(e)},v.prototype.switchToNextRendererAndStartExternal=function(e){var t=this;if(!t.sn||t.sn.type!==l.EXTERNAL)throw new Error("Next renderer is not external");if(t.switchToNextRenderer(),t.rn.type!==l.EXTERNAL)throw new Error("Active renderer is not external");t.rn.startExternal(e)},v.prototype.switchToNextRenderer=function(e){var t=this;t.sn&&(delete t.vn[t.sn.type],t.switchToRenderer(t.sn,e),t.tn=null,t.un=null)},v.prototype.endVideo=function(){var e=this;e.rn&&(e.rn.ended||(e.rn.ended=!0,e.rn.type===l.HTML5_TV_TIZEN||e.rn.type===l.HTML5_TV_ORSAY?e.rn.stop():e.rn.node&&e.rn.node.pause()))},v.prototype.setSelectedStreams=function(e){var t=this;t.rn&&t.rn.setSelectedStreams(e)},v.prototype.didRendererTimeOut=function(){var e=this;return e.rn&&!!e.rn.timedOut},v.prototype.getActiveRenderer=function(){var e=this;return e.rn},v.prototype.setRendererMode=function(e){var t=this,r=d+e,n=o.classList(t.mn);t.rn&&(t.rn.mode=e),Object.keys(c).forEach(function(e){var t=d+c[e];n.contains(t)&&t!==r&&n.remove(t)}),n.contains(r)||n.add(r)},v.prototype.syncPlaybackState=function(){var e=this;e.rn&&(e.rn.paused=e.l.isPaused(),e.rn.seeking=e.l.isSeeking())},v.prototype.rewindAfterEnd=function(e){var t=this;if(t.rn&&e)switch(t.rn.type){case l.HTML5_RAW:case l.HTML5_HLS:t.rn.node&&(t.rn.node.src="")}},v.prototype.play=function(e){var t=this;t.k.publish(s.PLAY_CALLED_ON_RENDERER,{rtype:t.getActiveRendererType()}),t.rn&&t.rn.play(e)},v.prototype.getActiveRendererType=function(){var e=this;return e.rn&&e.rn.type?e.rn.type.toLowerCase():""},v.prototype.pause=function(){var e=this;e.rn&&(e.rn.type===l.HTML5_TV_TIZEN||e.rn.type===l.HTML5_TV_ORSAY?e.rn.pause():e.rn.node&&e.rn.node.pause())},v.prototype.preload=function(e){var t=this;t.sn&&t.sn.type===l.HTML5_HLS&&t.sn.preload(e)},v.prototype.setQuality=function(e){var t=this;t.rn&&t.rn.setQuality(e)},v.prototype.seek=function(e){var t=this;t.rn&&t.rn.seek(e)},v.prototype.setVolume=function(e){var t=this;t.rn&&t.rn.setVolume(e)},v.prototype.setMute=function(e){var t=this;t.rn&&t.rn.setMute(!!e)},v.prototype.enterFS=function(){var e=this;e.rn&&e.rn.enterFullScreen&&e.rn.enterFullScreen()},v.prototype.exitFS=function(){var e=this;e.rn&&e.rn.exitFullScreen&&e.rn.exitFullScreen()},v.prototype.setAudioLanguage=function(e){var t=this;t.rn&&t.rn.setAudioLanguage&&t.rn.setAudioLanguage(e)},v.prototype.getCurrentTime=function(){var e=this;return e.rn&&e.rn.getCurrentTime()||0},v.prototype.getDuration=function(){var e=this;return e.rn&&e.rn.getDuration()||0},v.prototype.getNextRendererNode=function(){var e=this;return e.sn&&e.sn.node||null},v.prototype.stopMedia=function(){var e=this;return e.rn&&e.rn.stopMedia()},v.prototype.Jn=function(e){var t=this;e&&(t.rn=e,e.setActive(!0))},v.prototype.Bn=function(e,t){var r=this;e&&(r.vn[t]=e,e.setActive(!1))},v.prototype.getCurrentDate=function(){var e=this;return e.rn&&e.rn.getCurrentDate()},v.prototype.suspendStreaming=function(){var e=this;e.rn&&e.rn.suspendStreaming()},v.prototype.resumeStreaming=function(){var e=this;e.rn&&e.rn.resumeStreaming()},v.prototype.destroy=function(){var e=this;e.rn&&e.rn.destroy()},t.exports=v},{"../../lib/logger":"/lib/logger.js","./constants":7,"./event":"/nextgen/src/event.js","./navigator-info":26,"./perf":29,"./renderers/external":34,"./renderers/flash":36,"./renderers/flash-simple":35,"./renderers/html5-hls":39,"./renderers/html5-hls-360":38,"./renderers/html5-raw":41,"./renderers/html5-raw-360":40,"./renderers/html5-tv":139,"./renderers/modes":43,"./renderers/orsay":139,"./renderers/tizen":139,"./renderers/type":44,"./util":"/nextgen/src/util.js","user-agent":233}],34:[function(e,t,r){"use strict";function n(e,t,r){var n=this;n.type=a.EXTERNAL,n.k=e,n.l=t,n.Ha=r,n.mode=o.VIDEO}t.exports=n;var i=e("../util"),a=e("./type"),o=e("./modes"),s=e("../event");n.prototype.create=function(){var e=this,t=document.createElement("div");return t.setAttribute("id",i.generateGuid()),i.classList(t).add("yvp-external-video"),e.Kn=t,t},n.prototype.destroy=function(){var e=this;this.Ln(),e.Kn&&(e.Kn.parentNode&&e.Kn.parentNode.removeChild(e.Kn),e.Kn=null)},n.prototype.waitForReady=function(e){e&&e(null)},n.prototype.startExternal=function(e){var t=this,r={container:t.Kn,eventBus:t.k,model:t.l,profiler:t.Ha};e&&e(r)},n.prototype.attach=function(){var e=this;e.Pg()},n.prototype.detach=function(){var e=this;e.Ln()},n.prototype.Pg=function(){var e=this;e.Mn=e.k.subscribe(s.FULLSCREEN_CHANGE,function(){e.Kn&&e.k.publish(s.PLAYER_RESIZE,e.Kn.clientWidth,e.Kn.clientHeight)},e)},n.prototype.Ln=function(){var e=this;e.Mn&&(e.Mn(),e.Mn=null)},n.prototype.setStreams=i.noop,n.prototype.setSelectedStreams=i.noop,n.prototype.play=i.noop,n.prototype.pause=i.noop,n.prototype.preload=i.noop,n.prototype.getCurrentTime=i.noop,n.prototype.getDuration=i.noop,n.prototype.setQuality=i.noop,n.prototype.seek=i.noop,n.prototype.setMute=i.noop,n.prototype.setVolume=i.noop,n.prototype.stopMedia=i.noop,n.prototype.stop=i.noop,n.prototype.setActive=i.noop,n.prototype.bindCustomEvents=i.noop,n.prototype.getCurrentDate=i.noop},{"../event":"/nextgen/src/event.js","../util":"/nextgen/src/util.js","./modes":43,"./type":44}],35:[function(e,t,r){"use strict";function n(e,t,r){var n=this;n.type=d.FLASH_SIMPLE,n.Nn=i,n.k=e,n.l=t,n.Ha=r,n.seeking=!1,n.ended=!1,n.On=!1;var a;Object.defineProperty(n,"mode",{get:function(){return a},set:function(e){a!==e&&(a=e,n.setPlayMode(e))}}),n.Pn=new u(n),n.Qn=!1,n.timedOut=!1,n.Rn=!1,n.Sn=!1}t.exports=n;var i=e("../error.js"),a=e("../event"),o=e("./modes"),s=e("user-agent").userAgent,l=e("../util"),c=e("../../../lib/logger"),u=e("../../../lib/command-queue"),p=e("../states"),d=e("./type"),f=e("../stream"),v="simpleplayer.swf";n.prototype.create=function(){var e=this,t=l.generateGuid(),r=l.getAssetUrl(e.l.isLocal(),e.l.version,v);return e.Tn="__YVPFlashAdHandler_"+e.l.guid,e.Pg(),e.Ha&&e.Ha.add(a.Metrics.SWF_OBJECT_TO_INIT_START),e.node=e.Un({id:t,swfUrl:r,params:[{name:"allowscriptaccess",value:"always"},{name:"allowFullScreen",value:"true"},{name:"wmode",value:e.Vn()},{name:"flashVars",value:"jsCallback="+e.Tn+"&allowedDomain="+document.location.hostname}]}),e.node.pause=function(){e.Wn(e.Wl)},e.Xn=setTimeout(function(){l.classList(e.node).remove("yvp-swf-not-ready")},1e3),e.Yn=setTimeout(function(){e.timedOut=!0,e.k.publish(a.SWF_READY_TIMEOUT,e.node)},7e3),e.Ha&&(e.Ha.setEndTime(a.Metrics.RENDER_TO_SWF),e.Ha.add(a.Metrics.SWF_READY)),e.Zn=[],e.node},n.prototype.Un=function(e){var t='<object id="'+e.id+'" class="yvp-flash-video yvp-swf-not-ready" type="application/x-shockwave-flash" data="'+e.swfUrl+'" width="100%" height="100%">';e.params.forEach(function(e){t+='<param name="'+e.name+'" value="'+e.value+'">'}),t+="</object>";var r=document.createElement("div");return r.innerHTML=t,r.children[0]},n.prototype.setActive=function(e){var t=this;t.Sn=e},n.prototype.waitForReady=function(e){var t=this;if(t.Qn)return void e()},n.prototype.bindCustomEvents=function(){},n.prototype.unbindCustomEvents=function(){},n.prototype.Pg=function(){var e=this;window[e.Tn]=function(t){try{a.Video[t.type.toUpperCase()]?e.$n(t):e._n(t)}catch(e){c.error("Error in flash event handler:",e.message||e,e.stack)}}},n.prototype.$n=function(e){var t,r=this,n=e.type;if(r.mode===o.VIDEO)t=a.Video[n.toUpperCase()];else{if(r.mode!==o.AD)return;t=a.Ad[n.toUpperCase()]}switch("playing"===n&&r.Ha&&(r.Ha.setEndTime(a.Metrics.STREAM_PLAY_TO_RENDER),r.Ha.setEndTime(a.Metrics.STREAM_REQUEST_TO_RENDER)),n){case"timeupdate":case"seeking":case"seeked":if("timeupdate"===n&&r.On)break;if("seeked"===n&&(r.On=!1),r.l.playbackState.isOnCriticalError()||r.l.getState()===p.END)break;var i=e.buffered,s={length:1,start:function(){return i?i.start:0},end:function(){return i?i.end:0}};r.k.publish(t,e.currentTime,e.duration,s);break;case"error":if(r.mode===o.VIDEO){var l=null;e.critical&&r.ao("stopMedia"),r.k.publish(a.ERROR,l)}else r.k.publish(a.Ad.ERROR,e.error);break;case"ended":r.ended=!0,r.k.publish(t);break;case"pause":if(r.ended)break;if(r.seeking)break;r.k.publish(t);break;default:r.k.publish(t,e)}},n.prototype._n=function(e){var t=this;if(!t.Rn){var r=e.type;switch(r){case"swfReady":t.Qn=!0,t.Ha.setEndTime(a.Metrics.SWF_READY),clearTimeout(t.Yn),l.classList(t.node).remove("yvp-swf-not-ready"),t.Pn.flush(!0),t.k.publish(a.SWF_READY,t.node);break;case"jsLog":break;case"noAccessAllowed":t.k.publish(a.SWF_READY,t.node);break;case"uiInteract":t.mode===o.VIDEO?t.k.publish(a.Video.CLICK):t.mode===o.AD&&t.k.publish(a.Ad.CLICK,t.ao("get","currentTime"));break;case"playerPluginResize":t.k.publish(a.PLAYER_RESIZE,e.width,e.height)}}},n.prototype.setStreams=function(e){var t=this;return e.mode=t.mode,t.Wn(t.bo,[e]),!0},n.prototype.bo=function(e){var t=this,r=e.streams;t.ended=!1,t.On=!1,!r||r.length<=0||t.co(e)},n.prototype.co=function(e){var t=this,r=e.streams,n=f.findStreamByProperty(r,"bitrate",t.l.playback.desiredBitrate,t.l.capabilities[d.FLASH_SIMPLE]);t.ao("set","src",{bitrate:n.bitrate,format:n.format,url:n.url})},n.prototype.play=function(e){var t=this;t.Wn(t.Lb,[e])},n.prototype.Lb=function(e){var t=this,r=t.Nn;if(!t.seeking||t.l.isPaused()){t.seeking=!1,t.ended=!1,t.On=!1;var n=0;t.l.playback.preconnect||(t.mode===o.VIDEO?t.Pn.flush(!0):t.mode===o.AD&&(n=1)),t.Pn.getLength()>n&&t.k.publish(a.ERROR,l.createErr("P",t.l.playbackState,r.E_PLAYER,r.PLAYER_CODES.E_INTERNAL_VIOLATION)),t.Ha&&(t.Ha.add(a.Metrics.STREAM_REQUEST_TO_RENDER),t.Ha.add(a.Metrics.STREAM_PLAY_TO_RENDER)),t.ao("playMedia",e)}},n.prototype.getCurrentTime=function(){var e=this;return e.Wn(e.do)},n.prototype.do=function(){var e=this;return e.ao("get","currentTime")},n.prototype.getDuration=function(){var e=this;return e.Wn(e.eo)},n.prototype.eo=function(){var e=this;return e.ao("get","duration")},n.prototype.setQuality=function(e){},n.prototype.Wl=function(){var e=this;e.ao("pauseMedia")},n.prototype.seek=function(e){var t=this;t.Wn(t.fo,[e])},n.prototype.fo=function(e){var t=this;t.On=!0,t.ao("set","currentTime",e)},n.prototype.setVolume=function(e){var t=this;t.Wn(t.go,[e])},n.prototype.setMute=function(e){var t=this;t.setVolume(e?0:t.l.getVolume())},n.prototype.go=function(e){var t=this;t.ao("set","volume",e)},n.prototype.stopMedia=function(){var e=this;e.Wn(e.io)},n.prototype.io=function(){var e=this;e.ao("stopMedia")},n.prototype.setPlayMode=function(e){var t=this;t.Wn(t.jo,[e])},n.prototype.jo=function(e){var t=this;t.ao("set","playMode",[e])},n.prototype.Wn=function(e,t){var r=this;return r.Qn?e.apply(r,t):(r.Pn.enQueue(e,t),null)},n.prototype.ao=function(e){var t=this;if(!t.Rn){var r=Array.prototype.slice.call(arguments,1);try{if(t.Qn&&t.node[e])return t.node[e].apply(t.node,r)}catch(e){t.Rn=!0}}},n.prototype.Vn=function(){return"macintosh"===s.os&&(s.chrome||s.safari||s.firefox)?"direct":"opaque"},n.prototype.bindPlaybackEvents=function(){},n.prototype.unbindPlaybackEvents=function(){var e=this;e.Zn&&(e.Zn.forEach(function(e){e()}),e.Zn=[])},n.prototype.Ln=function(){},n.prototype.detectFlashBlockers=function(e){},n.prototype.getCurrentDate=function(){return null},n.prototype.suspendStreaming=n.prototype.resumeStreaming=function(){},n.prototype.destroy=function(){var e=this;e.stopMedia(),delete window[e.Tn],e.Ln(),e.unbindPlaybackEvents(),clearTimeout(e.Xn),clearTimeout(e.Yn),e.Pn.destroy(),e.node&&e.node.parentNode&&e.node.parentNode.removeChild(e.node),e.node=null}},{"../../../lib/command-queue":1,"../../../lib/logger":"/lib/logger.js","../error.js":12,"../event":"/nextgen/src/event.js","../states":46,"../stream":"/nextgen/src/stream.js","../util":"/nextgen/src/util.js","./modes":43,"./type":44,"user-agent":233}],36:[function(e,t,r){"use strict";function n(e){var t='<object id="'+e.id+'" class="yvp-flash-video yvp-swf-not-ready" type="application/x-shockwave-flash" data="'+e.swfUrl+'" width="100%" height="100%">';
e.params.forEach(function(e){t+='<param name="'+e.name+'" value="'+e.value+'">'}),t+="</object>";var r=document.createElement("div");return r.innerHTML=t,r.children[0]}function i(e,t,r){var n=this;n.type=f.FLASH,n.Nn=a,n.k=e,n.l=t,n.Ha=r,n.seeking=!1,n.ended=!1,n.On=!1,n.lo=null;var i=s.VIDEO;Object.defineProperty(n,"mode",{get:function(){return i},set:function(e){i!==e&&(i=e,n.ao("set","playMode",e))}}),n.Pn=new p(n),n.Qn=!1,n.timedOut=!1,n.Rn=!1,n.Sn=!1,n.mo=y.NO_DRM}t.exports=i;var a=e("../error.js"),o=e("../event"),s=e("./modes"),l=e("user-agent").userAgent,c=e("../util"),u=e("../../../lib/logger"),p=e("../../../lib/command-queue"),d=e("../states"),f=e("./type"),v=e("../hls-cue-tracker"),m="player.swf",y={NO_DRM:"no-drm",DRM_INITIAL:"drm-initial",DRM_METADATA_IS_SET:"drm-metadata-set",DRM_AUTH_COMPLETE:"drm-auth-complete"};i.prototype.create=function(){var e=this,t=c.generateGuid(),r=c.getAssetUrl(e.l.isLocal(),e.l.version,m);return e.Tn="__YVPFlashHandler_"+e.l.guid,e.Pg(),e.Ha&&e.Ha.add(o.Metrics.SWF_OBJECT_TO_INIT_START),e.node=n({id:t,swfUrl:r,params:[{name:"allowscriptaccess",value:"always"},{name:"allowFullScreen",value:"true"},{name:"wmode",value:e.Vn()},{name:"flashVars",value:"YUIBridgeCallback="+e.Tn+"&allowedDomain="+document.location.hostname}]}),e.node.pause=function(){e.Qn?e.Wl():e.Pn.enQueue(e.Wl)},e.Xn=setTimeout(function(){c.classList(e.node).remove("yvp-swf-not-ready")},1e3),e.Yn=setTimeout(function(){e.timedOut=!0,e.k.publish(o.SWF_READY_TIMEOUT,e.node)},7e3),e.Ha&&(e.Ha.setEndTime(o.Metrics.RENDER_TO_SWF),e.Ha.add(o.Metrics.SWF_READY)),e.node},i.prototype.waitForReady=function(e){var t=this;if(t.Qn)return void e();var r=!1;t.k.subscribe(o.SWF_READY,function(){r||(r=!0,e())})},i.prototype.isReady=function(){var e=this;return e.Qn},i.prototype.setActive=function(e){var t=this;t.Sn=e},i.prototype.Vn=function(){return"macintosh"===l.os&&(l.chrome||l.safari||l.firefox)?"direct":"opaque"},i.prototype.setSelectedStreams=function(e){var t=this;t.k.publish(o.SELECTED_STREAM_CHANGE,e)},i.prototype.bindPlaybackEvents=function(){var e=this;e.no=[],e.no.push(e.k.subscribe(o.BEFORE_PROGRESS_BEACON,e.oo,e))},i.prototype.bindCustomEvents=function(){},i.prototype.unbindCustomEvents=function(){},i.prototype.Pg=function(){var e=this;window[e.Tn]=function(t){try{o.Video[t.type.toUpperCase()]?e.$n(t):e._n(t)}catch(e){u.error("Error in flash event handler:",e.message||e,e.stack)}},e.$n=function(t){var r,n=t.type;if(e.mode===s.VIDEO)r=o.Video[n.toUpperCase()];else{if(e.mode!==s.AD)return;r=o.Ad[n.toUpperCase()]}switch("playing"===n&&e.Ha&&(e.Ha.setEndTime(o.Metrics.STREAM_PLAY_TO_RENDER),e.Ha.setEndTime(o.Metrics.STREAM_REQUEST_TO_RENDER)),n){case"timeupdate":case"seeking":case"seeked":if("timeupdate"===n&&e.On)break;if("seeked"===n&&(e.On=!1),e.l.playbackState.isOnCriticalError()||e.l.getState()===d.END)break;var i=t.buffered,a={length:1,start:function(){return i?i.start:0},end:function(){return i?i.end:0}};e.k.publish(r,t.currentTime,t.duration,a);break;case"error":if(e.mode===s.VIDEO){var l,u=e.Nn;t.code===u.PLAYER_DRM_CODES.E_FLASH_DRM_CONTENT_DATA_NOT_SET_ERROR?l=c.createErr("C",e.l.playbackState,u.E_PLAYER_DRM,u.PLAYER_DRM_CODES.E_FLASH_DRM_CONTENT_DATA_NOT_SET_ERROR):t.code===u.PLAYER_DRM_CODES.E_FLASH_DRM_TIMEOUT_LOAD_VOUCHER_ERROR?l=c.createErr("S",e.l.playbackState,u.E_PLAYER_DRM,u.PLAYER_DRM_CODES.E_FLASH_DRM_TIMEOUT_LOAD_VOUCHER_ERROR):t.code===u.FLASH_CODES.E_FLASH_DRM_SYSTEM_UPDATE_ERROR?l=c.createErr("R",e.l.playbackState,u.E_PLAYER,u.FLASH_CODES.E_FLASH_DRM_SYSTEM_UPDATE_ERROR,null,t.msg+"; "+t.detail):t.code===u.FLASH_CODES.E_FLASH_DRM_CHROME_SETTING_ERROR?l=c.createErr("R",e.l.playbackState,u.E_PLAYER_DRM,u.FLASH_CODES.E_FLASH_DRM_CHROME_SETTING_ERROR):t.code>=u.FLASH_CODES.E_FLASH_DRM_LOWER_BOUND_ERROR&&t.code<=u.FLASH_CODES.E_FLASH_DRM_UPPER_BOUND_ERROR?l=c.createErr("C",e.l.playbackState,u.E_PLAYER_DRM,t.code,null,t.msg+t.detail):t.code===u.FLASH_CODES.E_HLS_CLIENT_DISABLE_COOKIES&&(l=c.createErr("R",e.l.playbackState,u.E_PLAYER,t.code,null,t.msg+"; "+t.detail)),t.critical&&e.ao("stopMedia"),e.k.publish(o.ERROR,l)}else e.k.publish(o.Ad.ERROR,e.ao("get","error"));break;case"ended":e.ended=!0,e.k.publish(r);break;case"pause":if(e.ended)break;if(e.seeking)break;e.k.publish(r);break;case"loadeddata":e.Ha&&e.Ha.setEndTime(o.Metrics.LOAD_TO_LOADED_DATA),e.k.publish(r);break;case"warning":/Remove Last Fragment Buffer/.test(t.msg)&&e.k.publish(o.RELOAD_FRAGMENT,t.msg);break;default:e.k.publish(r,t)}}},i.prototype._n=function(e){var t=this,r=e.type;switch(r){case"infoupdate":var n=e.mediaInfo;t.l.playback.bitrate=n.currentStreamBitrate,t.l.playback.protocol=n.deliveryProtocol,t.k.publish(o.PLAYBACK_INFO,n);break;case"swfReady":t.Qn=!0,t.Ha.setEndTime(o.Metrics.SWF_READY),t.Ha.setEndTime(o.Metrics.SWF_OBJECT_TO_INIT_START,t.ao("get","swfInitTimestamp"),!0),clearTimeout(t.Yn),c.classList(t.node).remove("yvp-swf-not-ready"),t.po(),t.Pn.flush(!0),t.k.publish(o.SWF_READY,t.node);break;case"noAccessAllowed":t.k.publish(o.SWF_READY,t.node),t.qo();break;case"playerPluginResize":t.k.publish(o.PLAYER_RESIZE,e.width,e.height);break;case"selectedStreamChange":t.k.publish(o.SELECTED_STREAM_CHANGE,e.selectedStreams);break;case"selectedStreamUrlChange":t.k.publish(o.SELECTED_STREAM_URL_CHANGE,null,e);break;case"jsLog":break;case"drmMetadataSet":t.Ha&&(t.Ha.setEndTime(o.Metrics.DRM_METADATA_IS_SET),t.Ha.add(o.Metrics.DRM_AUTH_COMPLETE),t.mo=y.DRM_METADATA_IS_SET);break;case"drmAuthComplete":t.Ha&&(t.Ha.setEndTime(o.Metrics.DRM_AUTH_COMPLETE),t.mo=y.DRM_AUTH_COMPLETE);break;case"uiInteract":t.mode===s.VIDEO?t.k.publish(o.Video.CLICK):t.mode===s.AD&&t.k.publish(o.Ad.CLICK,t.ao("get","currentTime"));break;case"bitratechange":var i=e.bitrate,l=e.info;t.k.publish(o.API.BITRATE_CHANGE,i,l);break;case"durationchange":break;case"pluginLoadComplete":t.k.publish(o.RENDERER_PLUGIN_LOADED);break;case"pluginLoadError":t.k.publish(o.RENDERER_PLUGIN_LOAD_FAILED);break;case"pluginLoadTimedOut":t.k.publish(o.RENDERER_PLUGIN_LOAD_TIMED_OUT);break;case"loadFirstFragment":t.k.publish(o.HLS_FIRST_TS_LOAD_START);break;case"firstFragmentFirstByteFReceived":t.k.publish(o.HLS_FIRST_TS_FIRST_BYTE_ARRIVE);break;case"reloadBegin":t.k.publish(o.MEDIA_RELOAD_BEGIN);break;case"reloadEnd":t.k.publish(o.MEDIA_RELOAD_END);break;case"mediaPlaylistLoaded":t.k.publish(o.MEDIA_PLAYLIST_LOADED);break;case"mediaPlaylistUpdated":t.k.publish(o.MEDIA_PLAYLIST_UPDATED,e.interval);break;case"qualityChanged":t.k.publish(o.QUALITY_CHANGE);break;case"streamLoadBegin":t.Ha&&t.Ha.add(o.Metrics.STREAM_REQUEST_TO_RENDER);break;case"vttSegmentLoaded":e.vttSegmentInfo&&(e.vttSegmentInfo.itemId=t.lo),t.k.publish(o.VTT_SEGMENT_LOADED,e.vttSegmentInfo);break;case"bitrateListChanged":t.k.publish(o.BITRATE_LIST_CHANGED,e.bitrates,e.heights);break;case"playbackComplete":t.l.playlist.getCurrentItem().isLive()&&t.k.publish(o.WARNING,c.createErr("P",t.l.playbackState,a.E_WARNING,a.WARNING_CODES.E_LIVE_PLAYBACK_COMPLETE),!0);break;case"fragLoadRetryFailure":t.k.publish(o.FRAG_LOAD_RETRY_FAILURE);break;case"liveMediaPlaylistLoadRetryFailure":t.k.publish(o.LIVE_MEDIA_PLAYLIST_LOAD_RETRY_FAILURE);break;case"liveLoadingLate":t.k.publish(o.LIVE_LOADING_LATE);break;case"PTSDiscontinuity":t.k.publish(o.PTS_DISCONTINUITY,e.timedifference);break;case"cuepointStarted":var u={cueoutStartSeqNum:e.startSeqNum,cueoutStreamIndex:e.cueoutStreamIndex};t.k.publish(o.API.CUEPOINT_STARTED,e.cuepointDuration,e.cuepointPlayedTime,u);break;case"cuepointStopped":t.k.publish(o.API.CUEPOINT_STOPPED);break;case"cuepointDetected":t.k.publish(o.API.CUEPOINT_DETECTED,e.cuepointDuration,e.timeGapBeforeCUEOUT);break;case"abrDataUpdated":t.l.metrics.skipABRBeacon||t.k.publish(o.ABR_DATA_UPDATE,e)}},i.prototype.po=function(){var e=this,t=e.l,r={name:"Fireball",site:t.baseConfig.site,version:t.version,region:t.baseConfig.region,autoplay:t.playback.autoplay,spaceid:t.baseConfig.pageSpaceId,hostEnv:t.isLocal()?"l":"p",lang:t.baseConfig.lang,conviva:t.playback.conviva,bucket:c.bucketize(),browserName:e.so(),os:l.os,expType:t.baseConfig.experienceType,expName:t.baseConfig.experienceName,convivaSamplingRate:t.failOver?t.failOver.convivaSamplingRate:null,disableGPU:t.playback.disableGPU};e.ao("set","playerInfo",r)},i.prototype.so=function(){var e="";return l.chrome?e="chrome":l.firefox?e="firefox":l.safari?e="safari":l.ie?e="ie":l.opera&&(e="opera"),e},i.prototype.setStreams=function(e){var t=this;return t.lo=e.uuid||e.adId,e.mode=t.mode,t.Qn?t.bo(e):t.Pn.enQueue(t.bo,[e]),!0},i.prototype.bo=function(e){var t=this,r=e.streams,n=e.mode;t.ended=!1,t.On=!1,!r||r.length<=0||(n===s.AD?t.to(e):e.isCCM?t.vo(e):t.uo(e))},i.prototype.co=function(e){var t=this;t.l.playback.preconnect?t.wo(e):(t.Pn.deQueue(t.wo),t.Pn.enQueue(t.wo,[e]))},i.prototype.wo=function(e){var t=this;e.live&&"hls"===e.streamType&&(t.xo||(t.xo=new v(t.k,t.l)),t.xo.updatePlaylistURLs(null,e.streams[0].url)),t.ao("set","src",e)},i.prototype.to=function(e){var t=this,r=e.streams;try{t.ao("set","src",{live:!1,rtx:!1,url:r[0].url})}catch(e){t.k.publish(o.Ad.ERROR)}},i.prototype.uo=function(e){var t=this,r={live:!1,rtx:!1};if(e.streams&&e.streams.length){var n=e.streams[0];"m3u8"===n.format?(e.streams.forEach(function(e){e.url&&""!==e.url&&(e.host=e.url)}),r.streams=e.streams):r.url=n.url,r.live=n.live,n.isDrmProtected()&&(t.mo=y.DRM_INITIAL)}t.Ha.add(o.Metrics.LOAD_TO_LOADED_DATA),t.ao("set","src",r)},i.prototype.vo=function(e){var t=this,r=t.Nn,n=e.streamProfiles&&e.streamProfiles.length>0?e.streamProfiles:e.streams;t.Ha.add(o.Metrics.LOAD_TO_LOADED_DATA);var i=[],a=[],s=!1;if(e.altStreams&&e.altStreams.forEach(function(e){"SUBTITLES"===e.type&&i.push(e)}),n.forEach(function(e){e=c.extend({},e),e.format.indexOf("m3u8")>-1&&(e.format="m3u8"),e.path&&e.path.indexOf("content=hls")>-1&&(e.format="m3u8"),e.isAtlas()&&t.yo(e);var r=e.isStreamCompatibleForDrm("flash");return r===-1?void(s=!0):(1===r&&(t.mo=y.DRM_INITIAL),void a.push(e))}),a.length<=0){if(s){var l=c.createErr("C",t.l.playbackState,r.E_PLAYER_DRM,r.PLAYER_DRM_CODES.E_PLAYER_DRM_UNSUPPORTED_STREAM_ERROR);t.k.publish(o.ERROR,l)}}else{var u=a.filter(function(e){return!t.zo(e)}),p=t.l.playlist.getCurrentItem(),d={uuid:e.uuid,showName:p?p.showName:"",title:p?p.title:"",duration:p?p.duration:0};e.startTime&&(d.startTime=e.startTime),i.length>0&&(d.subtitles=i),u.length>0?(d.streamType=u[0].getType(),d.streams=u,d.live=u[0].live,d.rtx=u[0].isRTX()):(a=a.sort(function(e,t){return t.bitrate-e.bitrate}),d.streamType=a[0].getType(),d.url=a[0].url,d.rtx=a[0].isRTX(),d.bitrate=a[0].bitrate),t.ao("set","stopBufferingOnPause",t.l.playback.stopBufferingOnPause),t.ao("set","preload",t.l.playback.preload),t.ao("set","ignoreEndlist",e.ignoreEndlist),t.co(d),t.l.playback.targetBitrate&&t.Ao({preference:"config",bitrate:t.l.playback.targetBitrate})}},i.prototype.yo=function(e){if(e.format){var t="mp4"===e.format.toLowerCase(),r=e.path.replace(/^\/?mp4:/,"");(t||"flv"===e.format.toLowerCase())&&(r=r.replace(/^\//,"")),t&&e.isRTMP()&&(r="mp4:"+r),e.path=r}},i.prototype.zo=function(e){return!e.host||/^http[s]?:\/\//.test(e.host)&&"m3u8"!==e.format&&"f4m"!==e.format},i.prototype.play=function(e){var t=this,r=t.Nn;if(!t.seeking||t.l.isPaused())if(t.Ha&&t.Ha.add(o.Metrics.STREAM_PLAY_TO_RENDER),t.Qn){t.seeking=!1,t.ended=!1,t.On=!1;var n=0;if(t.l.playback.preconnect||(t.mode===s.VIDEO?t.Pn.flush(!0):t.mode===s.AD&&(n=1)),t.Pn.getLength()>n&&t.k.publish(o.ERROR,c.createErr("P",t.l.playbackState,r.E_PLAYER,r.PLAYER_CODES.E_INTERNAL_VIOLATION)),t.ao("playMedia",e),t.Ha&&t.mo===y.DRM_INITIAL){var i=t.Ha.getItem(o.Metrics.DRM_METADATA_IS_SET);i||t.Ha.add(o.Metrics.DRM_METADATA_IS_SET)}}else t.Pn.enQueue(t.play,[e])},i.prototype.Wl=function(){var e=this;e.ao("pauseMedia")},i.prototype.seek=function(e){var t=this;if(t.Qn)if(t.On=!0,t.ao("get","seekable"))t.ao("set","currentTime",e);else var r=t.k.subscribe(o.Video.PLAYING,function(){t.ao("set","currentTime",e),r.detach()});else t.Pn.enQueue(t.seek,[e])},i.prototype.getCurrentTime=function(){var e=this;return e.ao("get","currentTime")},i.prototype.getDuration=function(){var e=this;return e.ao("get","duration")},i.prototype.getFlashVersion=function(){var e=this;return e.Qn?e.ao("get","flashVersion"):null},i.prototype.setVolume=function(e){var t=this;t.Qn?t.ao("set","volume",e):t.Pn.enQueue(t.setVolume,[e])},i.prototype.setMute=function(e){var t=this;t.setVolume(e?0:t.l.getVolume())},i.prototype.setQuality=function(e){var t=this;t.Ao({preference:e.preference,bitrate:e.stream.bitrate})},i.prototype.Ao=function(e){var t=this;t.Qn?t.ao("set","quality",e):t.Pn.enQueue(t.Ao,[e])},i.prototype.oo=function(e){var t,r=this;if(e&&r.Sn&&r.Qn){var n=document.getElementsByClassName("yvp-main"),i=!c.isPlayerInBackground()&&n&&n.length>0&&0!==c.getElementViewability(n[0]);for(t=r.ao("get","segmentMetrics");t&&t.length;){var a=t.shift();a.vis||(a.vis=i),e.val&&e.val.push(a)}}},i.prototype.detectFlashBlockers=function(e){},i.prototype.Ln=function(){},i.prototype.unbindPlaybackEvents=function(){var e=this;e.no&&(e.no.forEach(function(e){e()}),e.no=[])},i.prototype.ao=function(e){var t=this;if(!t.Rn){var r=Array.prototype.slice.call(arguments,1);try{if(t.Qn&&t.node)return t.node[e].apply(t.node,r)}catch(e){t.qo(e)}}},i.prototype.qo=function(e,t,r){var n=this;u.error("Flash crashed:",e),n.Rn=!0;var i,a=!0;"get"===t&&"segmentMetrics"===r[0]&&(a=!1,i="segInfo-flash-error",n.Rn=!1)},i.prototype.stopMedia=function(){var e=this;e.ao("stopMedia")},i.prototype.getCurrentDate=function(){return null},i.prototype.suspendStreaming=i.prototype.resumeStreaming=function(){},i.prototype.destroy=function(){var e=this;e.ao("stopMedia"),delete window[e.Tn],e.Ln(),e.unbindPlaybackEvents(),clearTimeout(e.Xn),clearTimeout(e.Yn),e.Pn.destroy(),e.node&&e.node.parentNode&&e.node.parentNode.removeChild(e.node),e.node=null}},{"../../../lib/command-queue":1,"../../../lib/logger":"/lib/logger.js","../error.js":12,"../event":"/nextgen/src/event.js","../hls-cue-tracker":15,"../states":46,"../util":"/nextgen/src/util.js","./modes":43,"./type":44,"user-agent":233}],37:[function(e,t,r){"use strict";function n(){}t.exports=n;var i=e("../cc"),a=e("../error"),o=e("../event"),s=e("./modes"),l=e("../tap"),c=(e("../../../lib/logger"),e("../util")),u=e("user-agent").userAgent,p=e("../navigator-info"),d=e("../video-elements-pool").getPool,f=e("../mobile-web-utils"),v=function(){var e=c.createVideoNode(),t="function"==typeof e.play&&e.play();return e=null,!(!window.Promise||!t)}();f=f.available?f:null;var m;u.mobile&&p.hasNativeAutoplaySupport&&"function"==typeof d&&(m=d()),n.prototype.create=function(e){var t=this;return t.node=e||(m?m.get():c.createVideoNode()),t.node.setAttribute("id",c.generateGuid()),c.classList(t.node).add("yvp-html5-video"),t.Pg(),u.mobile&&p.autoplayByUIEvtOnly&&t.l.playback.autoplay&&f&&(t.Bo=f.setupTouchToPlayRestrictionRemoval(t.node,function(){t.Bo=null,t.k.publish(o.TOUCH_TO_PLAY_RESTRICTION_REMOVED)})),t.Sn=!1,t.Co(t.node),t.node},n.prototype.Co=function(e){var t=this;v&&(e.__play=e.play.bind(e),e.play=function(){var r=e.__play();return r&&r.catch(function(r){e.paused&&t.k.publish(o.BROWSER_BLOCKED_PLAYBACK_START)}),r})},n.prototype.detachNode=function(){var e=this;e.Ln(),e.node&&e.node.pause&&e.node.pause()},n.prototype.reattachNode=function(){var e=this;e.Pg()},n.prototype.Pg=function(){var e=this;if(e.$n=function(t){if(!e.ended){var r,n=t.type;if(e.mode===s.VIDEO)r=o.Video[n.toUpperCase()];else{if(e.mode!==s.AD)return;r=o.Ad[n.toUpperCase()]}e.Do(n,r)}},o.nativeVideoEvents.forEach(function(t){e.node.addEventListener(t,e.$n)}),u.iphone&&!p.canPlayInline||(e.Eo=new l(e.node),e.Fo=function(){e.mode===s.VIDEO?e.k.publish(o.Video.CLICK):e.mode===s.AD&&e.k.publish(o.Ad.CLICK,e.node.currentTime)},e.node.addEventListener("tap",e.Fo)),(u.safari>=8||u.ios&&u.iosVersion>=10)&&e.Go(),p.airplaySupported&&!e.l.disableCasting){e.node.removeAttribute("x-webkit-airplay");var t=e.l.playlist.getCurrentItem();t&&t.castable?e.Ho():(e.node.setAttribute("x-webkit-airplay","deny"),e.k.publish(o.API.AIRPLAY_AVAILABILITY_CHANGE,!1))}e.no=[],e.no.push(e.k.subscribe(o.CC.FETCH_MOBILE,e.Io,e)),e.no.push(e.k.subscribe(o.FULLSCREEN_CHANGE,function(){e.k.publish(o.PLAYER_RESIZE,e.node.clientWidth,e.node.clientHeight)},e)),e.no.push(e.k.subscribe(o.BEFORE_PROGRESS_BEACON,e.oo,e))},n.prototype.bindCustomEvents=function(){},n.prototype.setActive=function(e){var t=this;t.Sn=e},n.prototype.Jo=function(e,t){var r=this;e&&(r.mode===s.VIDEO?e=o.Video[e.toUpperCase()]:r.mode===s.AD&&(e=o.Ad[e.toUpperCase()]),t?t.unshift(e):t=new Array(e),r.k.publish.apply(r.k,t))},n.prototype.oo=function(e){e.useDefaultBufferDuration=!0},n.prototype.setSelectedStreams=function(e){var t=this;t.k.publish(o.SELECTED_STREAM_CHANGE,e)},n.prototype.seek=function(e){var t=this;try{t.node.currentTime=e}catch(n){if("InvalidStateError"===n.name)var r=t.k.subscribe(o.Video.LOADEDMETADATA,function(){t.node.currentTime=e,r.detach()})}},n.prototype.getCurrentTime=function(){var e=this;return e.node.currentTime},n.prototype.getDuration=function(){var e=this;return e.node.duration},n.prototype.setVolume=function(e){var t=this;t.node&&(t.node.volume=e)},n.prototype.setMute=function(e){var t=this;t.node&&"boolean"==typeof e&&(u.mobile&&p.autoplaySupported&&f?f.setMuteSafe(t.node,e):t.node.muted=e)},n.prototype.enterFullScreen=function(){var e=this;if(e.node){var t=e.node.requestFullscreen||e.node.webkitRequestFullscreen||e.node.webkitEnterFullscreen;t&&t.call(e.node)}},n.prototype.exitFullScreen=function(){var e=this;if(e.node){var t=document.exitFullscreen||document.webkitExitFullscreen;t?t.call(document):e.node.webkitExitFullscreen&&e.node.webkitExitFullscreen()}},n.prototype.setAudioLanguage=function(e){},n.prototype.Io=function(e){var t=this,r=document.createDocumentFragment();t.Ko(),e.langList.forEach(function(t){var n=document.createElement("track");n.setAttribute("label",i.prototype.getLanguageForCode.call(null,t.lang)),n.setAttribute("srclang",t.lang),n.setAttribute("kind","subtitles"),n.setAttribute("type","text/vtt"),t.lang===e.selectedLang&&n.setAttribute("default",!0),n.src=t.url,n.mode="hidden",r.appendChild(n)}),t.node.appendChild(r)},n.prototype.Ko=function(){for(var e=this,t=e.node.querySelectorAll("track"),r=0;r<t.length;r++)e.node.removeChild(t[r])},n.prototype.Go=function(){var e=this;if(e.node.textTracks){var t=function(t){var r=t.track;"metadata"===r.kind?(r.mode="hidden",r.addEventListener("cuechange",function(t){var r=t.target,n=r.activeCues[0],i=n.value&&n.value.data,a=n&&n.value&&n.value.info;try{i instanceof ArrayBuffer&&i.byteLength&&(i=String.fromCharCode.apply(null,new Uint8Array(i))),"string"==typeof i&&(i=JSON.parse(i))}catch(e){i=null}i?e.k.publish(o.TIMED_METADATA_RECEIVED,i):a&&e.k.publish(o.TIMED_METADATA_RECEIVED,a)})):"subtitles"!==r.kind&&"captions"!==r.kind||e.Lo&&e.k.publish(o.SUBTITLE_TRACK_RECEIVED,{itemId:e.lo,track:r})},r=function(e){for(var t=e&&e.srcElement,r=0;r<t.length;r++)"metadata"===t[r].kind&&"disabled"===t[r].mode&&(t[r].mode="hidden")};e.node.textTracks.addEventListener("addtrack",t),e.node.textTracks.addEventListener("change",r),e.Mo=function(){e.node.textTracks.removeEventListener("addtrack",t),e.node.textTracks.removeEventListener("change",r)}}},n.prototype.Ln=function(){var e=this;e.Mo&&e.Mo(),e.No&&e.No(),o.nativeVideoEvents.forEach(function(t){e.node.removeEventListener(t,e.$n)}),e.Eo&&(e.Eo.destroy(),e.node.removeEventListener("tap",e.Fo)),e.no&&(e.no.forEach(function(e){e()}),e.no=[])},n.prototype.Oo=function(e){if(!(e&&e instanceof window.MediaError))return a.PLAYER_CODES.E_NATIVE_ERROR;switch(e.code){case window.MediaError.MEDIA_ERR_ABORTED:return a.PLAYER_CODES.E_NATIVE_ABORTED;case window.MediaError.MEDIA_ERR_NETWORK:return a.PLAYER_CODES.E_NATIVE_NETWORK_FAILURE;case window.MediaError.MEDIA_ERR_DECODE:return a.PLAYER_CODES.E_NATIVE_DECODE_ERROR;case window.MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:return a.PLAYER_CODES.E_NATIVE_SRC_NOT_SUPPORTED;case window.MediaError.MEDIA_ERR_ENCRYPTED:return a.PLAYER_CODES.E_NATIVE_ENCRYPT_MEDIA;default:return a.PLAYER_CODES.E_NATIVE_ERROR}},n.prototype.Ho=function(){function e(e){r.k.publish(o.API.AIRPLAY_AVAILABILITY_CHANGE,"available"===e.availability)}function t(){r.k.publish(o.API.AIRPLAY_CONNECTION_STATE_CHANGE,{connected:r.isAirplaying(),isInitialEvt:!r.Po}),r.Po||(r.Po=!0)}var r=this;p.airplaySupported&&(r.node.addEventListener("webkitplaybacktargetavailabilitychanged",e),r.node.addEventListener("webkitcurrentplaybacktargetiswirelesschanged",t),r.No=function(){r.node.removeEventListener("webkitplaybacktargetavailabilitychanged",e),r.node.removeEventListener("webkitcurrentplaybacktargetiswirelesschanged",t)})},n.prototype.showAirplayTargetMenu=function(){var e=this;e.node&&"function"==typeof e.node.webkitShowPlaybackTargetPicker&&e.node.webkitShowPlaybackTargetPicker()},n.prototype.isAirplaying=function(){var e=this;return!(!e.node||!e.node.webkitCurrentPlaybackTargetIsWireless)},n.prototype.getCurrentDate=function(){return null},n.prototype.suspendStreaming=function(){},n.prototype.resumeStreaming=function(){},n.prototype.destroy=function(){var e=this;e.Ln(),e.node.pause(),e.node.src="",e.node.load(),e.Qo&&(e.Qo.parentNode.removeChild(e.Qo),e.Qo=null),e.hlsCues&&e.hlsCues.destroy(),e.Bo&&(e.Bo(),e.Bo=null),m&&m.discard(e.node),e.node.parentNode.removeChild(e.node),e.node=null}},{"../../../lib/logger":"/lib/logger.js","../cc":"/nextgen/src/cc.js","../error":12,"../event":"/nextgen/src/event.js","../mobile-web-utils":139,"../navigator-info":26,"../tap":"/nextgen/src/tap.js","../util":"/nextgen/src/util.js","../video-elements-pool":139,"./modes":43,"user-agent":233}],38:[function(e,t,r){"use strict";function n(e,t,r,n){var i=this;i.type=s.HTML5_HLS_360,i.k=e,i.Ro=t,i.Ha=r,i.l=n,i.mode=l.VIDEO}t.exports=n;var i=e("../util"),a=e("./html5-hls"),o=e("./mixins-360"),s=e("./type"),l=e("./modes");i.inherits(n,a),o.call(n.prototype),n.prototype.create=function(){var e=this;return a.prototype.create.apply(e,arguments),e.So(),e.Kn},n.prototype.destroy=function(){var e=this;e.To(),a.prototype.destroy.apply(e)}},{"../util":"/nextgen/src/util.js","./html5-hls":39,"./mixins-360":42,"./modes":43,"./type":44}],39:[function(e,t,r){"use strict";function n(e,t,r){var n=this;n.type=l.HTML5_HLS,n.k=e,n.l=t,n.Ha=r,n.mode=c.VIDEO,n.seeking=!1,n.ended=!1,n.Uo=0,n.Vo=!0,n.lo=null}t.exports=n;var i=e("../error"),a=e("../event"),o=e("./html5-base.js"),s=e("js-hls"),l=e("./type"),c=e("./modes"),u=e("../util"),p=e("../../../lib"),d=(e("../../../lib/logger"),e("user-agent").userAgent),f=e("../constants");u.inherits(n,o),n.prototype.create=function(){var e=this;o.prototype.create.apply(e,arguments);var t=e.Wo();return e.Xo=new s(e.node,t),e.node},n.prototype.Pg=function(){var e=this;o.prototype.Pg.apply(e,arguments),e.bindCustomEvents()},n.prototype.bindCustomEvents=function(){var e=this;e.node&&(e.Yo=function(t){e.Do(t.type,t)},a.html5HlsEvents.forEach(function(t){e.node.addEventListener(t,e.Yo)}))},n.prototype.Ln=function(){var e=this;o.prototype.Ln.apply(e,arguments),e.unbindCustomEvents()},n.prototype.unbindCustomEvents=function(){var e=this;e.node&&a.html5HlsEvents.forEach(function(t){e.node.removeEventListener(t,e.Yo)})},n.prototype.Wo=function(){var e=this;e.Zo=!1;var t={debug:u.keepConsoleLogs,sendAbrAnalytics:e.Zo,stopBufferingOnPause:e.l.playback.stopBufferingOnPause,dimensions:{width:e.l.uiState.width,height:e.l.uiState.height}},r=e.l.html5_hls;for(var n in r)if(r.hasOwnProperty(n)){if("preloadBufferLimit"===n&&e.l.playback.preload!==!0)continue;t[n]=r[n]}return t},n.prototype.waitForReady=function(e){e(null)},n.prototype.Do=function(e,t){var r,n=this;if("playing"===e&&n.Ha){n.Ha.setEndTime(a.Metrics.STREAM_PLAY_TO_RENDER);var o=n.Ha.getItem(a.Metrics.STREAM_REQUEST_TO_RENDER);o&&null===o.endTime&&n.Ha.setEndTime(a.Metrics.STREAM_REQUEST_TO_RENDER)}switch(e){case"seeking":case"seeked":"seeked"===e&&(n._a=!0),n.k.publish(t,n.node.currentTime,n.node.duration,n.node.buffered);break;case"error":var s=n.node.error;if(n.mode===c.VIDEO){var l,d,v=n.Xo.error||{};p.isNumber(v.code)?(l=v.code.toString(),d=v.message):(l=s.code.toString(),d=s.message);var m=u.createErr("P",n.l.playbackState,v.isDrm?i.E_PLAYER_DRM:i.E_PLAYER_JS_HLS,l,null,d);n.k.publish(a.Video.ERROR,s),n.k.publish(a.ERROR,m)}else n.k.publish(a.Ad.ERROR,s);break;case"ended":n.ended=!0,n.$o=!1,n.l.playlist.getCurrentItem().isLive()&&n.k.publish(a.WARNING,u.createErr("P",n.l.playbackState,i.E_WARNING,i.WARNING_CODES.E_LIVE_PLAYBACK_COMPLETE),!0),n.k.publish(t);break;case"pause":if(n.ended)break;if(n.seeking)break;n.k.publish(t);break;case"play":n.Vo=!1,n.k.publish(t);break;case"playing":n.Vo=!0,n.k.publish(t);break;case"timeupdate":n.k.publish(t,n.node.currentTime,n.node.duration,n.node.buffered),n.Vo||(n.Vo=!0,n.k.publish(a.Video.PLAYING));break;case"loadeddata":n.Ha&&n.Ha.setEndTime(a.Metrics.LOAD_TO_LOADED_DATA),n.k.publish(t);break;case"infoUpdate":if(n.Sn){var y=t.detail.mediaInfo,h=y.currentStreamBitrate;0===n.l.playback.bitrate&&h>0&&n.k.publish(a.API.BITRATE_CHANGE,h,{}),y.drm&&y.drmsys&&(r=n.l.playlist.getCurrentItem(),r&&r.setDrmAvailability(y.drm),r&&r.setDrmSystem(y.drmsys)),n.l.playback.protocol=y.deliveryProtocol,n.k.publish(a.PLAYBACK_INFO,y)}break;case"streamSwitched":var E=t.detail.bitrate,g={reason:t.detail.reason,oldFrameRate:t.detail.oldFrameRate,newFrameRate:t.detail.newFrameRate};n.k.publish(a.API.BITRATE_CHANGE,E,g);break;case"hlsWaiting":t&&t.detail&&!p.isNullOrUndefined(t.detail.bufferInit)&&n.k.publish(a.Video.WAITING,{value:t.detail.value,ignoreBuffering:t.detail.bufferInit});break;case"segmentFirstByteLoaded":n.k.publish(a.SEGMENT_FIRST_BYTE_LOADED,t.detail);break;case"vttSegmentLoaded":var b=n.l?n.l.playlist:null;if(t.detail&&b){var _;if(n.l.playbackState.ad)_=n.lo;else{var A=b.getMediaItemBySessionId(t.detail.sessionId);_=A?A.id:null}t.detail.itemId=_}n.k.publish(a.VTT_SEGMENT_LOADED,t.detail);break;case"liveLoadingLate":n.k.publish(a.LIVE_LOADING_LATE);break;case"streamUpdated":n.k.publish(a.MEDIA_PLAYLIST_UPDATED);break;case"cuepointDetected":n.k.publish(a.API.CUEPOINT_DETECTED,t.detail.cuepointDuration,t.detail.timeGapBeforeCUEOUT);break;case"cuepointStarted":n.k.publish(a.API.CUEPOINT_STARTED,t.detail.cuepointDuration,t.detail.cuepointPlayedTime);break;case"subtitleStreamUpdated":n.k.publish(a.SUBTITLE_PLAYLIST_UPDATED);break;case"abrDataUpdated":n.Zo&&n.k.publish(a.ABR_DATA_UPDATE,t.detail);break;case"preloadStart":n.k.publish(a.PRELOAD_START);break;case"preloadProgress":n.Ha.setEndTime(a.Metrics.STREAM_REQUEST_TO_RENDER),n.k.publish(a.PRELOAD_PROGRESS);break;case"preloadComplete":n.k.publish(a.PRELOAD_COMPLETE);break;case"waiting":break;case"segInfoMetricsAvailable":var T=t.detail.segInfo,S=t.detail.sessionId,I=n._o();T.forEach(function(e){e.vis=I}),n.k.publish(a.SEG_INFO_AVAILABLE,{val:T,session:S,bufferLen:t.detail.bufferLen});break;case"contentLoadFinished":n.k.publish(a.CONTENT_LOAD_FINISHED,t.detail);break;case"bufferGrowthDetected":n.k.publish(a.BUFFER_GROWTH_DETECTED,t.detail);break;case"ccVttAvailable":r=n.l.playlist.getMediaItemBySessionId(t.detail.sessionId),r&&r.setCCAvailability(!0);break;case"multiLanguagesAvailable":r=n.l.playlist.getMediaItemBySessionId(t.detail.sessionId),r&&r.setMultiLanguages(t.detail.languages),n.k.publish(a.MULTI_LANGUAGES_AVAILABLE);break;case"timedMetadataReady":var L=u.extractID3Data(t.detail.data);if(L){var R=u.detectRegexPattern(f.ID3_MATCH_PATTERN.JSON,L);if(R)try{L=JSON.parse(R)}catch(e){}n.k.publish(a.TIMED_METADATA_RECEIVED,L)}break;case"bufferGapDetected":var C=u.createErr("P",n.ap,i.E_WARNING,i.WARNING_CODES.E_BUFFER_GAP);n.k.publish(a.WARNING,C);break;default:n.k.publish(t)}},n.prototype.setStreams=function(e){var t=this;t.ended=!1,t.Uo=0,t.$o=!1,t.lo=e.uuid||e.adId;var r=t.l.playlist.getMediaItemById(t.lo),n=p.isNullOrUndefined(r)?null:r.isLive(),o=e.streamProfiles;if(o&&o.length||(o=e.streams),!o)return!1;var s,l=[];if(o.forEach(function(e){e&&e.format&&e.format.indexOf("m3u8")>=0?(e.hls_info=e.hlsInfo,l.push(e),t.bp="hls"):e&&e.format&&e.format.indexOf("mpd")>=0&&(s=e.url,t.bp="dash")}),"hls"===t.bp){var f=[];if(e.altStreams&&(e.altStreams=t.cp(e.altStreams),e.altStreams.forEach(function(e){f.push(e)})),t.Ha&&(t.Ha.add(a.Metrics.STREAM_REQUEST_TO_RENDER),t.mode===c.VIDEO&&t.Ha.add(a.Metrics.LOAD_TO_LOADED_DATA)),l.length>0)return t.Xo.setSrc({streams:l,altStreams:f,sessionId:e.sessionId,currLang:r&&r.getCurrLanguage(),is360:!!e.is360,live:n}),!0}else if("dash"===this.bp){var v;if(59===d.firefox)return v=u.createErr("P",t.l.playbackState,i.E_PLAYER_JS_HLS,i.PLAYER_JS_HLS_CODES.MEDIA_ERR_DECODE),t.k.publish(a.ERROR,v),!1;if(d.safari&&r.license&&r.license.isDrm)return v=u.createErr("P",t.l.playbackState,i.E_PLAYER_DRM,i.PLAYER_DRM_CODES.E_CONFIG),t.k.publish(a.ERROR,v),!1;if(null!==s)return this.Xo.setSrc({url:s,sessionId:e.sessionId,currLang:r&&r.getCurrLanguage(),is360:!!e.is360,live:n}),!0}return!1},n.prototype.setQuality=function(e){var t=this;return t.Xo.setQuality(e),!1},n.prototype.setAudioLanguage=function(e){var t=this;t.Xo.setAudioLanguage(e)},n.prototype.stopMedia=function(){var e=this;e.Xo.unload()},n.prototype.play=function(e){var t=this;t.ended=!1,t.seeking=!1,t.Ha&&t.Ha.add(a.Metrics.STREAM_PLAY_TO_RENDER),t.Xo.play(e)},n.prototype.preload=function(e){var t=this;!e||p.isNumber(e.startOffset)&&e.startOffset>0||t.Xo.preload(e.bufferLimit)},n.prototype.oo=function(e){var t,r=this;if(e&&r.Sn&&(t=r.Xo.getSegInfo())){if(e.bufferLen=t.bufferLen,"sync"!==t.mode)return void(e.mode="async");for(e.mode="sync",t=t.segInfo;t&&t.length;){var n=t.shift();n.vis||(n.vis=r._o()),e.val&&e.val.push(n)}}},n.prototype._o=function(){var e=document.getElementsByClassName("yvp-main");return!u.isPlayerInBackground()&&e&&e.length>0&&0!==u.getElementViewability(e[0])},n.prototype.cp=function(e){if(!e)return e;var t={};return e.filter(function(e){var r=e.type+"_"+e.host+e.path;return!t[r]&&(t[r]=1,!0)})},n.prototype.getCurrentDate=function(){var e=this;return e.Xo.getCurrentDate()},n.prototype.suspendStreaming=function(){var e=this;e.Xo.suspendStreaming()},n.prototype.resumeStreaming=function(){var e=this;e.Xo.resumeStreaming()}},{"../../../lib":"/lib/index.js","../../../lib/logger":"/lib/logger.js","../constants":7,"../error":12,"../event":"/nextgen/src/event.js","../util":"/nextgen/src/util.js","./html5-base.js":37,"./modes":43,"./type":44,"js-hls":194,"user-agent":233}],40:[function(e,t,r){"use strict";function n(e,t,r,n){var i=this;i.type=s.HTML5_RAW_360,i.k=e,i.Ro=t,i.Ha=r,i.l=n,i.mode=l.VIDEO}t.exports=n;var i=e("../util"),a=e("./html5-raw"),o=e("./mixins-360"),s=e("./type"),l=e("./modes");i.inherits(n,a),o.call(n.prototype),n.prototype.create=function(){var e=this;return a.prototype.create.apply(e,arguments),e.So(),e.Kn},n.prototype.destroy=function(){var e=this;e.To(),a.prototype.destroy.apply(e)}},{"../util":"/nextgen/src/util.js","./html5-raw":41,"./mixins-360":42,"./modes":43,"./type":44}],41:[function(e,t,r){"use strict";function n(e,t,r,n){var i=this;i.type=l.HTML5_RAW,i.k=e,i.l=n,i.Ro=t,i.Ha=r,i.mode=c.VIDEO,i.dp=!1,i.ep="",i.fp=null,i.gp=0,i.hp=[],i.ip=null,i.MIN_TIME_TO_BUFFER_CHECK=150,i.jp=null,i.$o=!1,i.kp=!1,i.lp(),i.lo=null,(p.desktop||p.mobile&&d.hasNativeAutoplaySupport)&&(i.Lo=!0)}t.exports=n;var i=e("../bitrate-selector"),a=e("../error"),o=e("../event"),s=e("./html5-base.js"),l=e("./type"),c=e("./modes"),u=e("../stream"),p=e("user-agent").userAgent,d=e("../navigator-info"),f=e("../util"),v=e("../../../lib"),m=(e("../../../lib/logger"),e("../states")),y=e("../constants"),h=e("../fairplay-license-manager"),E=10,g=2,b=[1,5],_=250,A=.15;f.inherits(n,s),n.prototype.waitForReady=function(e){e(null)},n.prototype.lp=function(){var e=this;e.Nj=!0,e.mp=NaN,e.np=!1,e.op=!1,e.pp=0,e.seeking=!1,e.ended=!1,e.qp=0,e.tp=!1,e.up=null},n.prototype.Do=function(e,t){var r=this;switch("playing"===e&&r.Ha&&(r.Ha.setEndTime(o.Metrics.STREAM_PLAY_TO_RENDER),
r.Ha.setEndTime(o.Metrics.STREAM_REQUEST_TO_RENDER)),e){case"timeupdate":if(!r.op&&(r.tp||(r.tp=!0,r.Jo("playing")),r.seeking)){var n=[r.node.currentTime,r.node.duration,r.node.buffered];r.Jo("seeked",n),r.seeking=!1}var i=r.node.currentTime;p.android&&(!r.$o&&p.chrome<33&&i>1&&i<2&&(r.l.playlist.getCurrentItem().isLive()?(r.node.pause(),r.node.play()):r.seek(0),r.$o=!0),!r.kp&&p.androidVersion<=4.4&&r.node.addEventListener("webkitfullscreenchange",function(){var e=r.node.currentTime;r.kp=!0,r.node.load();var t=r.k.subscribe(o.Video.LOADEDMETADATA,function(){r.node.play(),r.l.playlist.getCurrentItem().isLive()||(r.node.currentTime=parseInt(e,10)),t.detach()})},!1)),r.dp||r.op||r.k.publish(t,r.node.currentTime,r.node.duration,r.node.buffered),r.pp=r.node.currentTime;break;case"seeking":r.seeking=!0,r.wp(),r.dp||r.op||r.k.publish(t,r.node.currentTime,r.node.duration,r.node.buffered),r.pp=r.node.currentTime;break;case"seeked":r.dp?r.xp():r.op||(r.gk=!1,r.k.publish(t,r.node.currentTime,r.node.duration,r.node.buffered)),r.pp=r.node.currentTime;break;case"error":var s=r.node.error;if(r.mode===c.VIDEO){var l=r.Oo(s),u=a.E_WARNING,d=o.WARNING,v=r.hp.length<=1&&r.gp>=g;v&&(u=a.E_PLAYER,d=o.ERROR);var m=f.createErr("P",r.l.playbackState,u,l,null,r.node.src);if(parseInt(m.subcategory)>=303&&parseInt(m.subcategory)<=308){r.gp++,v||r.k.publish(d,m);var y=null;return y=r.l.playlist.getCurrentItem().isLive()?r.retryStreams(0):r.retryStreams(r.pp),y?void f.getUrlStatus(y.url,function(e){401===e?m.subcategory=a.PLAYER_CODES.E_NATIVE_UNAUTHORIZED_URL:404===e&&(m.subcategory=a.PLAYER_CODES.E_NATIVE_URL_NOT_FOUND),m.errorType=a.E_PLAYER,r.k.publish(o.ERROR,m)}):void 0}r.k.publish(o.Video.ERROR,s),m.errorType=a.E_PLAYER,r.k.publish(d,m)}else r.k.publish(o.Ad.ERROR,s);break;case"ended":r.ended=!0,r.$o=!1,r.jp&&clearInterval(r.jp),r.op&&r.yp(!1),r.k.publish(t);break;case"loadeddata":if(r.dp){r.zp();break}r.Ha&&r.Ha.setEndTime(o.Metrics.LOAD_TO_LOADED_DATA),r.k.publish(t),r.node.audioTracks&&r.node.audioTracks.length>1&&r.Ap();break;case"pause":if(r.ended||r.node.ended)break;if(r.seeking)break;if(!r.node.paused)break;r.op&&r.yp(!1),r.k.publish(t);break;case"play":case"playing":if(r.dp){"playing"===e&&r.Bp();break}r.op||(r.tp="playing"===e,r.k.publish(t));break;case"waiting":break;default:r.k.publish(t)}},n.prototype.Cp=function(e,t){return e.indexOf(t)>-1},n.prototype.Dp=function(e,t){var r=this;return r.Cp(e,"mp4")&&r.Cp(t,"m3u8")||r.Cp(e,"m3u8")&&r.Cp(t,"mp4")},n.prototype.setStreams=function(e){var t=this;t.lp();var r=e.streams,n=!1,a=null;if(t.lo=e.uuid||e.adId,t.Ep=r,t.hp=r.slice(0),t.Fp(),p.safari>=6&&r.forEach(function(e){e.format.indexOf("m3u8")>-1&&(e.isPrimary||e.is_primary||!a)&&(a=e,n=!0)}),!n){var s=[];r.forEach(function(e){s.push(parseInt(e.bitrate))}),s=s.sort(),t.Gp=new i(t.node,s);var l=t.l.playback.targetBitrate?t.l.playback.targetBitrate:t.Gp.getTargetBitrate();a=t.Hp(l)}return!!a&&(t.co(a,e.startTime),n||(t.Ip(a),e.abr&&s.length>1&&(t.k.subscribe(o.Video.TIMEUPDATE,t.A,t),t.Jp=0)),!0)},n.prototype.setQuality=function(e){var t=this;t.Kp(e.stream.url),t.Ip(e.stream)},n.prototype.retryStreams=function(e){var t=this,r=t.fp;if(t.gp<=g)setTimeout(function(){t.Lp(r,e)},1e3*b[t.gp-1]);else{t.gp=0;var n=t.hp.indexOf(r);if(t.hp.splice(n,1),0===t.hp.length)return r;var i=u.findStreamByProperty(t.hp,u.BITRATE,t.Gp.getTargetBitrate(),t.Ro);t.Lp(i,e)}return null},n.prototype.Mp=function(){var e=this,t=null;if(e.Ep)for(var r=0;r<e.Ep.length;r++)if(e.Ep[r].isPrimary){t=e.Ep[r];break}return t},n.prototype.Hp=function(e){var t=this,r=t.Mp();return r||(r=u.findStreamByProperty(t.Ep,"bitrate",e,t.Ro)),!r&&t.Ep&&t.Ep.length>0&&(r=t.Ep[0]),r},n.prototype.A=function(e){var t=this;if(e-t.Jp>E){t.Jp=e;var r=t.Hp(t.Gp.getRecommendedBitrate());r&&(t.Kp(r.url),t.Ip(r))}},n.prototype.Ip=function(e){var t=this;t.Gp&&(t.Gp.currentBitrate=e.bitrate),t.k.publish(o.PLAYBACK_INFO,{currentStreamBitrate:e.bitrate,qualityLevels:t.Ep.length})},n.prototype.co=function(e,t,r){var n=this;if(n.node){if(p.safari){var i=n.l.playlist.getCurrentItem();(e.fairplayCertificatePath||i.license&&i.license.isDrm)&&(n.Np||(n.Np=new h(n.k,n.l,n.node)),n.Np.load(e.fairplayCertificatePath))}if(n.ended=!1,n.$o=!1,n.node.src!==e.url||r){if(p.iphone&&n.node.hasOwnProperty("webkitDisplayingFullscreen")&&!n.node.webkitDisplayingFullscreen&&n.Dp(e.format,n.ep)){var s=n.node.parentNode;n.destroy(),s.appendChild(n.create())}if(p.android&&e.live&&(p.chrome&&p.chrome<30||!f.isAndroidVersionAbove4())){var l=f.createErr("R",n.l.playbackState,a.E_INFO,a.INFO_CODES.E_PLAYER_ANDROID_CHROME_REQUIRED);return void n.k.publish(o.INFO,l)}if(n.Ko(),p.mobile&&e.drmType&&("adobe"===e.drmType||"apple"===e.drmType)&&(e.url=e.url+"&dv=0"),n.Ha&&n.Ha.add(o.Metrics.STREAM_REQUEST_TO_RENDER),n.node.src=e.url,t)var u=n.k.subscribe(o.Video.LOADEDMETADATA,function(){n.node.currentTime=t,u.detach()});n.Vd=!0,n.ep=e.format,n.fp=e,n.Ha&&n.mode===c.VIDEO&&n.Ha.add(o.Metrics.LOAD_TO_LOADED_DATA),p.mobile?d.hasNativeAutoplaySupport&&n.node.load():(n.node.load(),n.l.getState()===m.VIDEO&&n.play())}}},n.prototype.Op=function(){var e=this,t=e.node.videoWidth,r=e.node.videoHeight,n=t/r,i=e.node.clientWidth,a=e.node.clientHeight,o=i/a,s=0,l=0;o>n?(l=a.toFixed(2),s=(n*a).toFixed(2)):(s=i.toFixed(2),l=(i/n).toFixed(2));var c=Math.max((i-s)/2,0),u=Math.max((a-l)/2,0);return{width:s,height:l,left:c,top:u}},n.prototype.zp=function(){var e=this;e.seek(e.Pp)},n.prototype.xp=function(){var e=this;e.node.play(),e.Qp.parentNode.removeChild(e.Qp)},n.prototype.Bp=function(){var e=this;e.k.publish(o.Video.SWITCHED),e.dp=!1},n.prototype.Kp=function(e){var t=this,r=t.node.clientWidth,n=t.node.clientHeight;if(t.node.src===e)return t.k.publish(o.Video.SWITCHING),void t.k.publish(o.Video.SWITCHED);t.dp=!0,t.node.pause(),t.Pp=t.node.currentTime;var i=document.createElement("canvas");t.Qp=i,i.className="yvp-switching-canvas",i.width=r,i.height=n;var a=t.Op();i.style.cssText="width:"+a.width+"px;height:"+a.height+"px;left:"+a.left+"px;top:"+a.top+"px",t.node.parentNode.appendChild(i),i.getContext("2d").drawImage(t.node,0,0,r,n),t.k.publish(o.Video.SWITCHING),t.node.src=e},n.prototype.Lp=function(e,t){var r=this;r.co(e,t,!0),r.Ip(e)},n.prototype.Ap=function(){var e=this;if(e.node&&e.node.audioTracks&&!(e.node.audioTracks.length<2)){var t=Array.prototype.slice.call(e.node.audioTracks).map(function(e){return{name:e.label,language:e.language,selected:e.enabled}}),r=e.l.playlist.getCurrentItem();r&&(r.setMultiLanguages(t),e.k.publish(o.MULTI_LANGUAGES_AVAILABLE))}},n.prototype.play=function(e){var t=this;if(t.ended=!1,t.Vd&&!d.autoplaySupported){if(p.ios){var r=t.node.src;t.node.src="",t.node.load(),t.node.src=r}p.mobile&&t.node.load()}var n=t.lo&&t.l.playlist.getMediaItemById(t.lo),i=n&&n.duration||0,a=isNaN(t.node.duration)?i:t.node.duration;if(v.isNumber(e)&&e>0&&e<a&&(t.node.currentTime=e,0===t.node.currentTime)){var s=function(){t.node.currentTime=e,t.node.removeEventListener("canplay",s)};t.node.addEventListener("canplay",s)}t.Vd=!1,t.Ha&&t.Ha.add(o.Metrics.STREAM_PLAY_TO_RENDER),t.node.play(),t.np||(t.yp(!0),t.np=!0)},n.prototype.Fp=function(){var e=this;e.jp&&(clearInterval(e.jp),e.jp=null),e.jp=setInterval(e.wp.bind(e),_)},n.prototype.wp=function(e){var t=this;if(!t||!t.node)return void clearInterval(t.jp);var r=t.Rp();if(e||!(r<t.MIN_TIME_TO_BUFFER_CHECK)){var n=t.node.currentTime,i=t.node.duration,a=!1;if(p.safari>=6){var s=0;t.node.buffered&&t.node.buffered.length>0&&(s=t.node.buffered.end(t.node.buffered.length-1)),a=t.node.readyState!==y.VIDEO_TAG_READY_STATES.HAVE_ENOUGH_DATA||s>0&&s+1<t.node.duration&&s<n}if(n!==t.qp&&!a||t.node.paused)!isNaN(t.mp)&&n>t.mp&&t.yp(!1);else if(!t.op){var l=t.lo&&t.l.playlist.getMediaItemById(t.lo),u=l&&l.isLive();if(!u&&i>0&&n+A>=i)return void t.Do("ended",t.mode===c.VIDEO?o.Video.ENDED:o.Ad.ENDED);t.Nj=n<=.02||t.seeking,t.yp(!0)}t.qp=n,t.up=Date.now()}},n.prototype.Rp=function(){var e=this,t=Date.now();return e.up=e.up||t,t-e.up},n.prototype.getCurrentTime=function(){var e=this;return e.node.currentTime},n.prototype.stopMedia=function(){var e=this;e.node.removeAttribute("src"),e.node.load()},n.prototype.yp=function(e){var t=this;t.op&&e||(t.op||e)&&(t.k.publish(o.Video.WAITING,{type:"waiting",value:e,ignoreBuffering:t.Nj}),t.op=e,e?t.mp=t.node.currentTime:(t.Nj=!1,t.mp=NaN),e&&(t.tp=!1))},n.prototype.setAudioLanguage=function(e){var t=this;if(t.node&&t.node.audioTracks&&t.node.audioTracks.length){for(var r,n=-1,i=0;i<t.node.audioTracks.length;i++)r=t.node.audioTracks[i],r.enabled=!1,r.label===e&&n===-1&&(n=i);n>-1&&(t.node.audioTracks[n].enabled=!0)}},n.prototype.suspendStreaming=function(){var e=this;e.stopMedia()},n.prototype.resumeStreaming=function(){var e=this;e.k.publish(o.LIVE_RELOAD_MEDIA)}},{"../../../lib":"/lib/index.js","../../../lib/logger":"/lib/logger.js","../bitrate-selector":5,"../constants":7,"../error":12,"../event":"/nextgen/src/event.js","../fairplay-license-manager":13,"../navigator-info":26,"../states":46,"../stream":"/nextgen/src/stream.js","../util":"/nextgen/src/util.js","./html5-base.js":37,"./modes":43,"./type":44,"user-agent":233}],42:[function(e,t,r){"use strict";var n,i=e("../event"),a=e("../util"),o=e("../views/pie-360.js"),s=500,l=16/9,c=function(){var t=this;return t.So=function(){var t=this;t.Sp=!1,t.node.setAttribute("crossorigin","anonymous"),t.node.style.visibility="hidden";var r=document.createElement("div");r.classList.add("yvp-360-node"),r.style.position="absolute";var i=document.createElement("div");i.setAttribute("id",a.generateGuid()),i.classList.add("yvp-360-video"),i.appendChild(t.node),i.appendChild(r),t.Tp=r,t.Kn=i;var o=a.getScriptUrl(t.l.isLocal(),t.l.version,"videoplayer-three-facade");a.lazyLoad(o,3e3,function(){n=e("./three-facade"),t.Up(n)})},t.Up=function(e){var t=this,r=new e.PerspectiveCamera(70,l,.01,1e3);r.target=new e.Vector3(0,0,0);var n=new e.SphereBufferGeometry(500,64,32);n.scale(-1,1,1);var a=new e.VideoTexture(t.node);a.minFilter=e.NearestFilter;var s=new e.MeshBasicMaterial({map:a}),c=new e.Mesh(n,s),u=new e.Scene;u.add(c);var p=new e.WebGLRenderer;p.setPixelRatio(window.devicePixelRatio),t.Tp.appendChild(p.domElement),t.Vp=new o(t.Kn),t.Vp.render(),t.Wp=r,t.Xp=u,t.Yp=p,t.Zp=0,t.$p=0,t._p=!0,t.aq(),t.Sp=!0,t.k.publish(i.THREE_SIXTY_READY)},t.aq=function(){var e=this;e.mouseDownHandler=e.onMouseDown.bind(e),e.mouseMoveHandler=e.onMouseMove.bind(e),e.mouseUpHandler=e.onMouseUp.bind(e),e.mouseOverHandler=e.onMouseOver.bind(e),e.mouseOutHandler=e.onMouseOut.bind(e),e.resizeHandler=e.onResize.bind(e),e.Kn.addEventListener("mousedown",e.mouseDownHandler,!1),e.Kn.addEventListener("mousemove",e.mouseMoveHandler,!1),e.Kn.addEventListener("mouseup",e.mouseUpHandler,!1),e.Kn.addEventListener("mouseover",e.mouseOverHandler,!1),e.Kn.addEventListener("mouseout",e.mouseOutHandler,!1),e.Kn.addEventListener("resize",e.resizeHandler,!1),e.onPauseHandler=e.onPause.bind(e),e.onPlayingHandler=e.onPlaying.bind(e),e.onSeekedHandler=e.onSeeked.bind(e),e.node.addEventListener("pause",e.onPauseHandler),e.node.addEventListener("playing",e.onPlayingHandler),e.node.addEventListener("seeked",e.onSeekedHandler),e.Vp.addClickListener(e.bq.bind(e)),e.cq=[],e.cq.push(e.k.subscribe(i.PLAYER_RESIZE,function(t,r){window.setTimeout(function(){e.dq&&(t=window.screen.width,r=window.screen.height),e.eq(t,r)},1)})),e.cq.push(e.k.subscribe(i.FULLSCREEN_CHANGE,function(t){t?e.dq=!0:e.dq=!1})),e.cq.push(e.k.subscribe(i.PLAYER_DIMENSION_CHANGE,function(){var t,r,n;e.node&&e.node.parentNode&&(t=window.getComputedStyle(e.node.parentNode),t&&(r=parseInt(t.getPropertyValue("width"),10),n=parseInt(t.getPropertyValue("height"),10)),r&&!isNaN(r)&&n&&!isNaN(n)&&e.eq(r,n))}))},t.bq=function(){var e=this;e.Zp=0,e.$p=0,e.fq(),e.Vp.update(e.Zp),e.k.publish(i.THREE_SIXTY_PIE_INTERACT)},t.gq=function(){var e=this;e.cq&&(e.cq.forEach(function(e){e()}),e.cq=[]),e.mouseDownHandler&&(e.Kn.removeEventListener("mousedown",e.mouseDownHandler,!1),e.mouseDownHandler=null),e.mouseMoveHandler&&(e.Kn.removeEventListener("mousemove",e.mouseMoveHandler,!1),e.mouseMoveHandler=null),e.mouseUpHandler&&(e.Kn.removeEventListener("mouseup",e.mouseUpHandler,!1),e.mouseUpHandler=null),e.mouseOverHandler&&(e.Kn.removeEventListener("mouseover",e.mouseOverHandler,!1),e.mouseOverHandler=null),e.resizeHandler&&(e.Kn.removeEventListener("resize",e.resizeHandler,!1),e.resizeHandler=null),e.mouseOverHandler&&(e.Kn.removeEventListener("mouseover",e.mouseOverHandler,!1),e.mouseOverHandler=null),e.onPauseHandler&&(e.node.removeEventListener("pause",e.onPauseHandler),e.onPauseHandler=null),e.onPlayingHandler&&(e.node.removeEventListener("playing",e.onPlayingHandler),e.onPlayingHandler=null),e.onSeekedHandler&&(e.node.removeEventListener("seeked",e.onSeekedHandler),e.onSeekedHandler=null),e.hq&&(e.hq(),e.hq=null)},t.iq=function(){var e=this;e.jq=!1,e.Kn.classList.remove("grabbing-360"),e.Kn.classList.add("over-360"),e.kq&&(e.kq=!1,e._p=!0)},t.eq=function(e,t){var r=this,n=e,i=t;t*l>e&&(i=e/l),r.Wp&&(r.Wp.setViewOffset(e,t,e-n,t-i,n,i),r.Wp.updateProjectionMatrix()),r.Yp&&r.Yp.setSize(e,t)},t.lq=function(){var e=this,t=e.lq.bind(e);return e._p?(window.cancelAnimationFrame(e.requestAnimationId),void(e.requestAnimationId=null)):(e.requestAnimationId=window.requestAnimationFrame(t),void e.fq())},t.fq=function(){var e,t,r=this;r.$p=Math.max(-85,Math.min(85,r.$p)),e=n.Math.degToRad(90+r.$p),t=n.Math.degToRad(r.Zp),r.Wp.position.x=s*Math.sin(e)*Math.cos(t),r.Wp.position.y=s*Math.cos(e),r.Wp.position.z=s*Math.sin(e)*Math.sin(t),r.Wp.lookAt(r.Wp.target),r.Wp.position.copy(r.Wp.target).negate(),r.Yp.render(r.Xp,r.Wp)},t.To=function(){var e=this;window.cancelAnimationFrame(e.requestAnimationId),e._p=!0,e.gq(),e.Vp&&(e.Vp.destroy(),e.Vp=null),e.Tp&&(e.Tp.parentNode&&e.Tp.parentNode.removeChild(e.Tp),e.Tp=null),e.Kn&&(e.Kn.parentNode&&e.Kn.parentNode.removeChild(e.Kn),e.Kn=null),e.Wp=null,e.Xp=null,e.Yp=null},t.onPause=function(){var e=this;e.mq=!0,e._p=!0},t.onPlaying=function(){var e=this;e.mq=!1,e._p=!1,e.lq()},t.onSeeked=function(){var e=this;e.fq()},t.onMouseOver=function(){var e=this;e.Kn.classList.add("over-360")},t.onMouseDown=function(e){var t=this;t.nq=!1,t.Kn.classList.remove("over-360"),t.Kn.classList.add("grabbing-360"),t.jq=!0,t.onPointerDownPointX=e.clientX,t.onPointerDownPointY=e.clientY,t.onPointerDownLon=t.Zp,t.onPointerDownLat=t.$p},t.onMouseMove=function(e){var t=this;t.jq&&(t.mq&&!t.kq&&(t.kq=!0,t._p=!1,t.lq()),t.nq=!0,t.Zp=.1*(t.onPointerDownPointX-e.clientX)+t.onPointerDownLon,t.$p=.1*(e.clientY-t.onPointerDownPointY)+t.onPointerDownLat,t.Vp.update(t.Zp))},t.onMouseUp=function(){var e=this;e.jq&&(e.iq(),e.nq?e.k.publish(i.THREE_SIXTY_INTERACT):e.k.publish(i.TOGGLE_PLAY_PAUSE)),e.nq=!1},t.onMouseOut=function(){var e=this;e.iq()},t.onResize=function(){var e=this;e.eq(e.Kn.offsetWidth,e.Kn.offsetHeight)},t.oq=function(){var e=this;e.hq&&(e.hq(),e.hq=null),e.pq||(e.Yp.setSize(e.Kn.offsetWidth,e.Kn.offsetHeight),e.pq=!0)},t.waitForReady=function(e){var t=this;t.Sp?(t.oq(),e()):t.hq=t.k.subscribe(i.THREE_SIXTY_READY,function(){t.oq(),e()})},t};t.exports=c},{"../event":"/nextgen/src/event.js","../util":"/nextgen/src/util.js","../views/pie-360.js":76,"./three-facade":"/nextgen/src/renderers/three-facade.js"}],43:[function(e,t,r){t.exports={VIDEO:"video",AD:"ad",VPAID:"vpaid"}},{}],44:[function(e,t,r){t.exports={EXTERNAL:"external",FLASH:"flash",FLASH_SIMPLE:"flash-simple",HTML5_HLS:"html5-hls",HTML5_RAW:"html5-raw",HTML5_RAW_360:"html5-raw-360",HTML5_HLS_360:"html5-hls-360",HTML5_TV:"html5-tv",HTML5_TV_TIZEN:"html5tv-tizen",HTML5_TV_ORSAY:"html5tv-orsay"}},{}],45:[function(e,t,r){"use strict";function n(e,t,r){var n=this;n.l=e,n.guid=e?e.guid:"",n.qq=[],n.k=t,n.Ha=r,n.rq=!1,n.sq={0:{timeout:o.PLAYER_CODES.E_CMS_XHR_REQ_CONNECTION_FAILED_TIMEOUT,default:o.PLAYER_CODES.E_CMS_XHR_REQ_CONNECTION_FAILED},1:{timeout:o.PLAYER_CODES.E_CMS_XHR_RESPONSE_ABSENT_TIMEOUT,default:o.PLAYER_CODES.E_CMS_XHR_RESPONSE_ABSENT},2:{408:o.PLAYER_CODES.E_CMS_XHR_REQ_LOAD_408,timeout:o.PLAYER_CODES.E_CMS_XHR_REQ_LOAD_TIMEOUT,default:o.PLAYER_CODES.E_CMS_XHR_REQ_LOAD_FAILED},3:{408:o.PLAYER_CODES.E_CMS_XHR_REQ_408,timeout:o.PLAYER_CODES.E_CMS_XHR_REQ_INCOMPLETE_TIMEOUT,default:o.PLAYER_CODES.E_CMS_XHR_REQ_INCOMPLETE},default:{timeout:o.PLAYER_CODES.E_CMS_XHR_REQ_TIMEOUT,cors:o.PLAYER_CODES.E_CMS_XHR_REQ_CORS_ERROR,default:o.PLAYER_CODES.E_CMS_XHR_REQ_ERROR}},a.preconnect("preConnector","//"+a.getHostname(v))}t.exports=n;var i=e("user-agent").userAgent,a=e("./util"),o=e("./error"),s=e("./event"),l=e("../../lib"),c=e("./navigator-info").network,u=e("./media-store"),p=e("./renderers/type"),d=e("./constants"),f=e("./gps-util"),v="//video-api.yql.yahoo.com/v1/video/sapi",m="//video-api.yql.yahoo.com/v1/video/user/prefs/get",y="//video-api.yql.yahoo.com/v1/video/user/ccprefs/set",h="//video-api.yql.yahoo.com/v1/video/alias/channels",E=2,g=6e4;n.prototype.tq=function(e,t){var r=this,n=[],o=[],s=r.l.playlist.getCurrentItem(),l=r.l.getUspString();e.rt.forEach(function(e){var r=t[e];n=n.concat(r.acceptedProtocols),o=o.concat(r.preferredFormats)}),n=a.uniquifyArray(n),o=a.uniquifyArray(o);var c=e.rt.indexOf(p.FLASH)>=0||e.rt.indexOf(p.FLASH_SIMPLE)>=0?"flash":"html",u=navigator&&navigator.platform.toLowerCase()||"",f=["mac","win"].some(function(e){return u.indexOf(e)>-1}),v={protocol:n.join(","),format:o.join(","),srid:Math.floor(4294967295*Math.random()),rt:c,devtype:i.tv?"tv-widget":i.mobile&&!f?"smartphone":"desktop",offnetwork:r.l.offNetwork,region:e.region,site:e.site,expb:e.expb,expn:e.expn,bckt:r.uq(),lang:e.lang,width:e.width,height:e.height,resize:!0,ps:e.ps,autoplay:e.autoplay,image_sizes:e.showPlaylist?d.PLAYLIST_THUMB_DIMENSION:"",excludePS:!0,isDockable:r.l.isDockable()?"1":"0",acctid:e.acctid,synd:e.synd,pspid:e.pspid,plidl:e.plidl,topic:e.topic,pver:r.l.version,try:s&&s.tryCount||1,failover_count:s&&s.failoverCount||0,plid:e.plid,ads:"vrm2",nad:e.standaloneAdMode?1:0,usprv:l},m=a.getPageParameterByName("ad_debug");if(m&&(v.ad_debug=m),e.uuids){var y=r.l.playlist.getMediaItemAt(0)||{};0===e.uuids.indexOf(y.id)&&(v.firstVideo=y.id)}i.tv&&(v.dv=0,v.devtype="tv-widget",v.man=r.l.CTV.man,v.class=r.l.CTV.class),r.vq(e.rt)&&(v.hlspre="true");var h=r.l.getSapiQSConfig(d.SOURCE_PLUGIN_TYPE);v=a.extend({},h,v);var E=r.l.getModelSchema();for(var g in r.l.CMS)g in E.CMS||(v[g]=r.l.CMS[g]);return v},n.prototype.wq=function(e){var t=this,r=e.toString(),n=i.tv?"tv-widget":i.mobile?"smartphone":"desktop";return new Promise(function(e,i){f.getXAuthParams(r,n).then(function(e){return e}).then(function(r){var n={};t.l.getGeoData(t.rq).then(function(i){if(t.rq=i.requestGeoNextCall||!1,i.errorCode)e(r);else{var a=i.latitude+";"+i.longitude+" epu="+i.accuracy;n["geo-position"]=a,n=Object.assign({},r,n),e(n)}})}).catch(function(){i({})})})},n.prototype.vq=function(e){if(!e||!l.isArray(e))return!1;var t=e.indexOf(p.HTML5_HLS);if(t!==-1)return!0;var r=e.indexOf(p.HTML5_RAW),n=e.indexOf(p.FLASH);return!(r!==-1&&n!==-1&&r<n)&&n!==-1},n.prototype.loadClips=function(e,t,r,n){var l=this,p=l.tq(e,t);if(i.mobile&&!c.available&&(p.conntype=!0),""===p.format)l.k.publish(s.INFO,a.createErr("R",l.l.playbackState,o.E_INFO,o.INFO_CODES.E_FLASH_RENDERER_NOT_SUPPORTED));else{var d=l.l.playlist.getCurrentItem(),f=d&&d.recoveryStatus,v=f===u.ItemRecoveryStatus.RECOVERING||l.l.failOver&&l.l.failOver.sapiUrl?0:null;l.l.ui.allowGeoRequest&&i.mobile?l.wq(e.uuids).then(function(t){var i=Object.assign({},p,t);l.xq(e.uuids,"/streams",i,r,v,n)}).catch(function(t){l.xq(e.uuids,"/streams",p,r,v,n)}):l.xq(e.uuids,"/streams",p,r,v,n)}},n.prototype.loadRelatedVideosChannel=function(e,t){function r(){var e=n.l.metrics&&n.l.metrics.rapidFields||null,t="";return e&&(t=JSON.stringify({pt:e.pt,pct:e.pct,pstcat:e.pstcat,pstaid_p:e.pstaid_p,ticker:e.ticker,sport:e.sport})),t}var n=this,o="wf-channel=related-videos",s=h+"/"+o,l=n.l.getUspString(),c={video_uuid:e.videoUuid,channel_id:e.playlistId,channel_alias:e.playlistAlias,count:e.count,start:e.start,dev_type:i.mobile?"smartphone":"desktop",offnetwork:n.l.offNetwork,site:e.site,region:e.region,lang:e.lang,expn:e.expn,expb:e.expb,bckt:n.uq(),vp:0,image_sizes:d.PLAYLIST_THUMB_DIMENSION,ssl:!0,usprv:l,"context.json":r()};s+="?"+a.querystring(c),n.yq(s,t)},n.prototype.cancelAll=function(){var e=this;e.qq.forEach(function(e){e()}),e.qq=[]},n.prototype.xq=function(e,t,r,n,i,o){var s=this,l=v;switch(l+=t,l+="/"===l[l.length-1]?"":"/",r.env){case"dev":case"corp":case"int":case"int1":case"qa1":case"prev":case"perf":case"stage":l=l.replace(/video-api/i,"video-api-stage");break;case"beta":l=l.replace(/video-api/i,"video-api-beta")}l+=e+"?"+a.querystring(r),s.yq(l,n,i,o)},n.prototype.zq=function(e,t,r){var n=this;return{context:n,timeout:2e4,responseTypeJson:!0,withCookie:!0,jsonpHandler:e,successHandler:t,failureHandler:r}},n.prototype.yq=function(e,t,r,n){var i=this,c=i.getSapiRequestCacheKeyFromUrl(e);l.isNullOrUndefined(r)&&(r=E);var p=e+"&try="+(E-r+1),d=e.indexOf(v+"/streams")>-1;l.isNullOrUndefined(n)&&(n=!1);var f=function(e){var t=a.createErr("S",i.l.playbackState,o.E_WARNING,e.code,e.msg,e.debugMsg,e.prefetch);i.k.publish(s.WARNING,t)},h=function(e){if(i.Ha&&d){var t=i.Ha.getItem(s.Metrics.SAPI_REQUEST);if(t&&!t.endTime){var r=e?t.startTime:null;i.Ha.setEndTime(s.Metrics.SAPI_REQUEST,r)}}},b=function(s,l,c){if(s=s||l.error,i.qq.splice(i.qq.indexOf(L),1),i.Aq(e,l,c),s)if(i.l.playlist.getCurrentItem().tryCount++,a.replaceStrParam(e,"try",i.l.playlist.getCurrentItem().tryCount),0===r)h(!0),t(s,null,e);else{var u=o.PLAYER_CODES.E_CMS_JSONP_REQUEST_FAILURE;s.message===a.JSONP_TIMED_OUT&&(u=o.PLAYER_CODES.E_CMS_JSONP_REQ_TIMEOUT),f({code:u,msg:null,debugMsg:e+" timeout: "+Date.now(),prefetch:n}),i.yq(e,t,r-1,n)}else h(!1),t(null,l)},_=function(r,o,s){if(i.Bq(r,n,f),i.qq.splice(i.qq.indexOf(L),1),h(!1),t(null,r),o!==!0&&(i.Aq(p,r,s),c&&i.l.playlist.getCurrentItem()&&i.l.playlist.getCurrentItem().isLive())){var l={val:JSON.stringify(r),expiration:(new Date).getTime()+g,cachedVs:u.getSapiVsId(e)};0===i.l.playlist.getCurrentItem().failoverCount&&a.localStorage.put(c,l)}},A=function(o,s,c,u,d){var v=s,m=c;i.qq.splice(i.qq.indexOf(L),1),i.l.playlist.getCurrentItem()&&i.l.playlist.getCurrentItem().tryCount++,s=l.isNullOrUndefined(s)||l.isNullOrUndefined(i.sq[s])?"default":s,o.message===a.XHR_TIMEOUT?c="timeout":l.isNullOrUndefined(i.sq[s][c])&&(c="default");var y=i.sq[s][c];if(i.Aq(p,null,d),0===r){h(!0);var E=a.createErr("S",i.l.playbackState,o,y,null,"state: "+v+"; status: "+m+"; timeDiff: "+u);t(E,null,e)}else f({code:y,msg:null,debugMsg:e+"; state: "+v+"; status: "+m,prefetch:n}),a.replaceStrParam(e,"try",i.l.playlist.getCurrentItem()&&i.l.playlist.getCurrentItem().tryCount),i.yq(e,t,r-1,n)};if(c){a.localStorage.getAllKeys().forEach(function(e){/sapi\/streams/.test(e)&&a.localStorage.get(e).expiration<(new Date).getTime()&&a.localStorage.remove(e)});var T=a.localStorage.get(c);if(T){var S=JSON.parse(T.val);return i.l.CMS.cachedVs=T.cachedVs,void _(S,!0)}}d&&!n&&i.Ha&&!i.Ha.getItem(s.Metrics.SAPI_REQUEST)&&i.Ha.add(s.Metrics.SAPI_REQUEST);var I=i.zq(b,_,A);d&&(I.collectPerfData=!0);var L,R=e.indexOf(m)>-1||e.indexOf(y)>-1;L=R?a.jsonp(e,I):a.ajax(e,I),i.qq.push(L)},n.prototype.Aq=function(e,t,r){var n=this;if(r){if(r.url=e,r.instrument=t&&t.query&&t.query.results&&t.query.results.instrument?JSON.stringify(t.query.results.instrument):"none",r.perfInfo="na",r.perfStack="na",r.source="player",r.resourceTiming){var i={};if(["connectEnd","connectStart","domainLookupEnd","domainLookupStart","duration","fetchStart","redirectEnd","redirectStart","requestStart","responseEnd","responseStart","startTime"].forEach(function(e){i[e]=r.resourceTiming[e].toFixed(2)}),r.perfInfo=JSON.stringify(i),r.perfStack=[],r.resourceTimingEntries&&r.resourceTiming.requestStart-r.resourceTiming.connectStart>500)for(var a=0;a<r.resourceTimingEntries.length;a++)r.resourceTimingEntries[a].startTime<r.resourceTiming.startTime&&r.perfStack.push({url:r.resourceTimingEntries[a].name,st:r.resourceTimingEntries[a].startTime.toFixed(2),du:(r.resourceTimingEntries[a].responseEnd-r.resourceTimingEntries[a].startTime).toFixed(2)});r.perfStack=0===r.perfStack.length?"na":JSON.stringify(r.perfStack)}n.k.publish(s.API_CALLED,r)}},n.prototype.updateUserPreferences=function(e,t){var r=this;r.yq(y+"?userccp="+encodeURIComponent(JSON.stringify(t)),e)},n.prototype.getUserPreferences=function(e){var t=this;t.yq(m,e)},n.prototype.getSapiRequestCacheKeyFromUrl=function(e){var t=this,r=e.split(/\/sapi\/streams\//),n=null;return t.l.CMS.enableCache&&r.length>1&&(n=r[1].replace(/&ps=(.*?)&/g,"&"),n=n.replace(/&try=(.*?)&/g,"&"),n="sapi/streams/"+n.replace(/&srid=(.*?)&/g,"&")),n},n.prototype.Bq=function(e,t,r){var n=this,i=e&&e.query&&e.query.results&&e.query.results.mediaObj||[],a=n.Cq();if("https"===a){var s=i&&i.length?i[0]:null;if(s){var l=s.streams,c=l&&l.length?l[0].host:a;c.indexOf(a)<0&&r({code:o.WARNING_CODES.E_SSL_MISMATCH,msg:"ssl mismatch",debugMsg:"ssl mismatch",prefetch:t})}}},n.prototype.Cq=function(){return window&&window.location&&window.location.protocol},n.prototype.uq=function(){var e=this,t=e.l.playerHostingConfig&&e.l.playerHostingConfig.bucket,r=e.l.playerHostingConfig&&e.l.playerHostingConfig.env;return!t&&r&&(t=r),t||""}},{"../../lib":"/lib/index.js","./constants":7,"./error":12,"./event":"/nextgen/src/event.js","./gps-util":14,"./media-store":18,"./navigator-info":26,"./renderers/type":44,"./util":"/nextgen/src/util.js","user-agent":233}],46:[function(e,t,r){t.exports={INIT:"init",WAITING:"waiting",VIDEO:"video",END:"end"}},{}],47:[function(e,t,r){"use strict";function n(e,t){var r=this;r.version="7.86.909.1590008200",r.playerType="nextgen-desktop",r.language="en-US",r.Dq(e,r.version),r.config=e,r.Eq=Date.now(),r.mediaStore=t,r.nh,r.guid=u.generateGuid(),r.Fq(),y&&y.start(h.PERF.VP_INIT,r.guid),r.Gq(e,t),y&&y.end(h.PERF.VP_INIT,r.guid)}function i(e){var t=this;t.tc=e}function a(e){var t=this;t.tc=e}t.exports=n;var o=e("./controller"),s=e("./event"),l=e("../../lib/event-bus"),c=e("./iframe-controller"),u=e("./util"),p=e("../../lib"),d=e("./states"),f=e("./metrics/metrics"),v=e("./metrics/metrics-constants"),m=e("user-agent").userAgent,y=e("./perf"),h=e("./constants"),E=e("./visibility-manager"),g="73b2743cc7",b=(u.getWindow(),null),_=u.getSingleton("PlayerHosting")||{};if(_.theme)var A=_.theme,b=u.isThemeSupported(A)?A:null;var T=u.getCssBuildUrl(g.indexOf("local")>-1,g,b);u.loadCssAsset("yvp-css",T,function(){u.setSingleton("isCSSLoaded",!0)},function(){u.setSingleton("isCSSError",!0)}),y&&y.start(h.PERF.VP_SCRIPT_EXEC),u.inherits(n,l),n.prototype.Gq=function(e,t){function r(e){var t=d[e];u.k.subscribe(t,function(){var t=Array.prototype.slice.call(arguments,0);setTimeout(function(){u.publish.apply(u,[f[e]].concat(t))})})}var n,u=this;if(l.call(u,"API"),u.k=new l("internal"),u.isIframeEnabled(u.config)&&(u.nh=new c(e,t,u,u.k),!u.config.insideIframeConfig))return u.controls=new i(null),u.playlist=new a(null),n={iframeEnabled:!0,controlsAPI:u.controls,playlistAPI:u.playlist,iframeVID:u.nh._g,pauseLiveVideo:e.pauseLiveVideo,pauseVODVideo:e.pauseVODVideo,eventBus:u.k},void(u.oh=new E(n));var p=null;t&&(p=t.Hq||null),u.tc=new o(e,p,u.guid,u.k),u.k=u.tc.k,u.controls=new i(u.tc),u.playlist=new a(u.tc),n={iframeEnabled:!1,controller:u.tc,controlsAPI:u.controls,playlistAPI:u.playlist,pauseLiveVideo:e.pauseLiveVideo,pauseVODVideo:e.pauseVODVideo,eventBus:u.k},u.oh=new E(n);var d=[s.PLAYBACK_STARTED,s.Video.PAUSE,s.PLAYBACK_RESUMED,s.PLAYBACK_PROGRESS,s.PLAYBACK_ENDED,s.AD_PLAYBACK_STARTED,s.Ad.PAUSE,s.AD_PLAYBACK_RESUMED,s.AD_PLAYBACK_PROGRESS,s.AD_PLAYBACK_ENDED,s.AD_PLAYBACK_ERROR,s.Ad.NO_AD,s.ERROR,s.METADATA_AVAILABLE,s.CC.FETCHED,s.MULTI_LANGUAGES_AVAILABLE],f=[s.API.PLAYBACK_START,s.API.PLAYBACK_PAUSE,s.API.PLAYBACK_RESUMED,s.API.PLAYBACK_TIME_UPDATE,s.API.PLAYBACK_COMPLETE,s.API.AD_PLAYBACK_START,s.API.AD_PLAYBACK_PAUSE,s.API.AD_PLAYBACK_RESUME,s.API.AD_PLAYBACK_PROGRESS,s.API.AD_PLAYBACK_STOP,s.API.AD_ERROR,s.API.AD_NONE,s.API.PLAYER_ERROR,s.API.METADATA_READY,s.API.CC_AVAILABLE,s.API.MULTI_AUDIO_AVAILABLE];for(var v in s.API)if(f.indexOf(v)===-1){var m=s.API[v];d.push(m),f.push(m)}for(var y=0;y<d.length;y++)r(y);return u.k.subscribe(s.FULLSCREEN_CHANGE,function(e){u.publish(s.API.PLAYER_FULLSCREEN_CHANGE,e),u.tc.setContentHeightForNFL()}),u.Iq(),u},n.prototype.apiVersion=n.apiVersion=2,n.prototype.render=function(e){var t=this;if(t.Jq(),t.Kq=e,t.isIframeEnabled(t.config)){if(!t.config.insideIframeConfig)return t.nh.constructIframe(e),t.nh.routeControlsApiToIframe(),u.isIFrame()||t.oh.initialize(),t;t.nh.setupIframeToPageCommunication(),t.nh.sendClearIframeNameToPage()}else u.isIFrame()||t.oh.initialize();return t.tc.render(e),t},n.prototype.Fq=function(){var e=this,t=e.config,r=["_R","_V","_w","bckt","evt","expb","expn","host","pls","pver","t","ts","s"],n={_R:document.referrer||"",_V:"V",_w:document.location.href||"",bckt:u.getBckt(e.version)||"",evt:"p_init",expb:t.expBucket||"",expn:t.expName||"",host:document.location.host||"",pls:e.guid||"",s:t.pageSpaceId||t.Wj&&t.Wj.Spaceid||"1111",pver:e.version,t:Math.random(),ts:Date.now()-e.Eq};f.sendPlayerInitBeacon(r,n)},n.prototype.Jq=function(){var e=this;if(e.isSuspended()||!e.tc&&!e.nh)throw new Error("INVALID_STATE_ERR: An attempt was made to use videoplayer instance that is not, or no longer, usable.");return!0},n.prototype.Iq=function(){var e=this;e.Lq=function(t){t.persisted&&e.Mq()},m.safari&&window.addEventListener("pageshow",e.Lq,!1)},n.prototype.Mq=function(){var e=this;e.destroy(),e.Gq(e.config,e.mediaStore),e.render(e.Kq)},n.prototype.Dq=function(e,t){var r=this,n=u.getSingleton("PlayerHosting");e&&n&&n.config&&"object"==typeof n.config&&n.ver&&n.ver===t&&r.Nq(e,n.config.filter)&&(u.deepMerge(e,n.config),delete e.filter)},n.prototype.Nq=function(e,t){var r=this;if(!t)return!0;if(typeof e!=typeof t)return!1;if("object"!=typeof t){var n=new RegExp(t,"ig");return n.test(e)}for(var i in t)if(t.hasOwnProperty(i)){var a=r.Nq(e[i],t[i]);if(!a)return!1}return!0},n.prototype.isIframeEnabled=function(e){return e&&e.iframeRender},n.prototype.getCustomControlsNode=function(){var e=this;return e.Jq(),e.tc.getCustomControlsNode()},n.prototype.getVideoElement=function(){var e=this;return e.Jq(),e.tc.getVideoElement()},n.prototype.getEventBus=function(){var e=this;return e.Jq(),e.k},n.prototype.getOpenSimSim=function(){var e=this;return e.Jq(),e.tc.getOpenSimSim()},n.prototype.suspend=function(){var e=this;m.desktop||e.isSuspended()||(e.Jq(),e._node=e._node||e.tc.getRootElement(),e.Oq={currentTime:e.controls.getCurrentTime(),playlist:e.playlist.getItems(),position:e.playlist.getPosition(),boundEvents:e.a,mediaStore:e.getMediaStore()},e.destroy())},n.prototype.resume=function(){var e=this;if(e.isSuspended()){var t=e.Oq;e.Oq=null,delete e.Oq,e.Gq(e.config,t.mediaStore).render(e._node),e.playlist.setItems(t.playlist),e.playlist.setPosition(t.position),e.tc.l.playback.startTime=t.currentTime,e.a=t.boundEvents}},n.prototype.isSuspended=function(){var e=this;return!!e.Oq},n.prototype.destroy=function(){var e=this;return e.tc&&(e.tc.destroy(),e.tc=null),e.nh&&(e.nh.destroy(),e.nh=null),y&&y.destroy(e.guid),e.oh&&(e.oh.destroy(),e.oh=null),l.prototype.destroy.call(e),e.controls=e.playlist=e.k=null,window.removeEventListener("pageshow",e.Lq,!1),e},n.prototype.fetchMetaData=function(e){var t=this;if(t.Jq(),!p.isArray(e)||!e.every(p.isString))throw new Error("fetchMetaData called with invalid list of ids");return t.tc.prefetch(e),t},n.prototype.getMediaStore=function(){var e=this;return e.Jq(),{Hq:e.tc.getMediaStore()}},n.prototype.isRendered=function(){var e=this;return e.Jq(),e.tc.isRendered()},n.prototype.isDocked=function(){var e=this;return!e.nh&&(e.Jq(),e.tc&&e.tc.isDocked())},n.prototype.updateDockingConfig=function(e,t,r,n,i,a){var o=this;o.Jq(),o.tc.updateDockingConfig(e,t,r,n,i,a)},n.prototype.dockVideoPlayer=function(){
var e=this;e.Jq(),e.tc.dockVideoPlayer()},n.prototype.undockVideoPlayer=function(e){var t=this;t.Jq(),t.tc.undockVideoPlayer(e)},n.prototype.updateRapidConfig=function(e){var t=this;t.Jq(),t.tc.updateRapidConfig(e)},n.prototype.updatePageSpaceId=function(e){var t=this;t.Jq(),t.tc.updatePageSpaceId(e)},n.prototype.updateGeoConfig=function(e){var t=this;t.tc.updateGeoConfig(e)},n.prototype.on=n.prototype.subscribe,n.prototype.before=n.prototype.subscribe,n.prototype.after=n.prototype.subscribe,n.prototype.fire=n.prototype.publish,i.prototype.play=function(e,t){var r=this;r.tc.getPlaybackState()===d.INIT&&p.isNumber(e)&&e>0&&e<r.getDuration()&&r.tc.setStartTime(e);var n={type:v.API};t&&u.isValidRequestAction(t.requestAction)&&(n.action=t.requestAction),r.tc.play(n),r.tc.k.publish(s.CTRL_PLAYPAUSE,"play")},i.prototype.pause=function(e){var t=this,r={type:v.API};e&&u.isValidRequestAction(e.requestAction)&&(r.action=e.requestAction),t.tc.pause(r),t.tc.k.publish(s.CTRL_PLAYPAUSE,"pause")},i.prototype.preload=function(e){var t=this;t.tc.preload(e)},i.prototype.seek=function(e){var t=this;t.tc.seek(e)},i.prototype.disableControls=function(){var e=this;e.tc.disableControls()},i.prototype.enableControls=function(){var e=this;e.tc.enableControls()},i.prototype.enableCC=function(e){var t=this;t.tc.enableCC(e)},i.prototype.disableCC=function(){var e=this;e.tc.disableCC()},i.prototype.isPlaying=function(){var e=this;return e.tc.isPlaying()},i.prototype.getPlaybackState=function(){var e=this;return e.tc.getPlaybackState()},i.prototype.isLoading=function(){var e=this;return e.tc.isLoading()},i.prototype.getDuration=function(){var e=this;return e.tc.getCurrentMediaItem().duration},i.prototype.getCurrentTime=function(){var e=this;return e.tc.getCurrentTime()},i.prototype.getTimeRemaining=function(){var e=this;return e.getDuration()-e.getCurrentTime()},i.prototype.setFullscreen=function(e){var t=this;t.tc.setFullscreen(e)},i.prototype.getFullscreen=function(){var e=this;return e.tc.getFullscreen()},i.prototype.setVolume=function(e){var t=this;e=e<0?0:e,e=e>1?1:e,t.tc.setVolume(e)},i.prototype.getVolume=function(){var e=this;return e.tc.getVolume()},i.prototype.setMute=function(e){var t=this;t.tc.setMute(e)},i.prototype.getMute=function(){var e=this;return e.tc.getMute()},i.prototype.setLoop=function(e){var t=this;return t.tc.setLoop(e)},i.prototype.setContinuousPlay=function(e){var t=this;return t.tc.setContinuousPlay(e)},i.prototype.resumeContinuousPlay=function(){var e=this,t={type:v.API};e.tc.resumeContinuousPlay(t)},i.prototype.getBitrate=function(){throw new Error("getBitrate is unimplemented!")},i.prototype.setResolution=function(){throw new Error("setResolution is unimplemented!")},i.prototype.displayClosedCaptions=function(){throw new Error("displayClosedCaptions is unimplemented!")},i.prototype.endVideo=function(){var e=this;e.tc.endVideo()},i.prototype.getCurrentDate=function(){var e=this;return e.tc.getCurrentDate()},i.prototype.setAudioLanguage=function(e){var t=this;e&&t.tc.Qe(e)},a.prototype.getSize=function(){var e=this;return e.tc.getPlaylistItems().length},a.prototype.getPosition=function(){var e=this;return e.tc.getPlaylist().position},a.prototype.sendPrefetchInfo=function(e){var t=this;return t.tc.sendPrefetchInfo(e)},a.prototype.setPosition=function(e){var t=this;if(!(e in t.tc.getPlaylistItems()))throw new Error("setPosition called with invalid position");var r=t.tc.getAutoplay();if(r)var n={type:v.API,action:v.AUTOPLAY};t.tc.setPlaylistPosition(e,r,n)},a.prototype.setPositionById=function(e){var t=this,r=t.tc.getPlaylistItems().indexOf(e);if(r===-1)throw new Error("setPositionById called with id not in playlist");var n=t.tc.getAutoplay();if(n)var i={type:v.API,action:v.AUTOPLAY};t.tc.setPlaylistPosition(r,n,i)},a.prototype.addItem=function(e){var t=this;t.addItems([e])},a.prototype.addItems=function(e,t){var r=this,n=r.tc.getMediaStore(),i=r.tc.getPlaylistItems(),a=e.filter(function(e){return null===n.get(e)});a.length>0&&r.tc.prefetch(a),t?Array.prototype.splice.apply(i,[0,i.length].concat(e)):e.forEach(function(e){i.push(e)})},a.prototype.setItems=function(e){var t=this;t.addItems(e,!0)},a.prototype.getItems=function(){var e=this;return e.tc.getPlaylistItems().slice(0)},a.prototype.getItemId=function(e){var t=this,r=t.tc.getPlaylistItems();if(!(e in r))throw new Error("getItemId called with invalid position");return r[e]},a.prototype.getCurrentItemId=function(){var e=this,t=e.tc.getPlaylist();return t.position!==-1?t.items[t.position]:null},a.prototype.getCurrentItem=function(){var e=this,t=e.tc.getCurrentMediaItem();return t?e.getItemById(t.id):null},a.prototype.getCurrentItemTitle=function(){var e=this,t=e.getCurrentItem();return t?t.title:null},a.prototype.getCurrentItemLiveStatus=function(){var e=this,t=e.getCurrentItem();return t?t.isLive:null},a.prototype.getCurrentItemDescription=function(){var e=this,t=e.getCurrentItem();return t?t.description:null},a.prototype.getCurrentItemProviderName=function(){var e=this,t=e.getCurrentItem();return t&&t.provider?t.provider.name:null},a.prototype.getCurrentItemMarkers=function(){var e=this,t=e.tc.getCurrentMediaItem();return t&&t.videoMarkers||null},a.prototype.getItem=function(e){var t=this,r=t.tc.getPlaylistItems();if(!(e in r))throw new Error("getItem called with invalid position");return t.getItemById(r[e])},a.prototype.getItemById=function(e){var t=this,r=t.tc.getMediaStore().get(e);return r?{id:r.id,title:r.title,description:r.description,duration:r.duration,publishTime:r.publishTime,provider:r.provider,credits:r.credits,shareUrl:r.shareUrl,setShareUrl:function(e){this.shareUrl=e,r.shareUrl=e},thumbnail:r.images.defaultThumbnail,visualSeek:r.visualSeek,isLive:r.isLive(),closedCaptions:r.closedCaptions,streams:r.streams,videoMarkers:r.videoMarkers,languages:r.getMultiLanguages()}:null},a.prototype.getIndexForId=function(e){var t=this;return t.tc.getPlaylistItems().indexOf(e)},a.prototype.removeItem=function(e){var t=this;if(!(e in t.tc.getPlaylistItems()))throw new Error("removeItem called with invalid position");t.tc.removePlaylistItems(e,1)},a.prototype.removeItems=function(e,t){var r=this,n=r.tc.getPlaylistItems();if(!(e in n&&e+t-1 in n))throw new Error("removeItems called with invalid position/count");r.tc.removePlaylistItems(e,t)},a.prototype.removeItemById=function(e){var t=this,r=t.tc.getPlaylistItems().indexOf(e);if(r===-1)throw new Error("removeItemById called with id not in playlist");t.tc.removePlaylistItems(r,1)},a.prototype.removeItemsById=function(e){var t=this;e.forEach(function(e){t.removeItemById(e)})},a.prototype.clear=function(){var e=this;e.tc.removePlaylistItems(0,e.tc.getPlaylistItems().length)},y&&y.end(h.PERF.VP_SCRIPT_EXEC)},{"../../lib":"/lib/index.js","../../lib/event-bus":"/lib/event-bus.js","./constants":7,"./controller":8,"./event":"/nextgen/src/event.js","./iframe-controller":16,"./metrics/metrics":22,"./metrics/metrics-constants":21,"./perf":29,"./states":46,"./util":"/nextgen/src/util.js","./visibility-manager":92,"user-agent":233}],48:[function(e,t,r){"use strict";function n(e,t,r,n){var i=this;i.rootElem=e,i.l=t,i.k=r,i.Ha=n,i.Pq=G,i.Qq=null,i.Rq=null,i.Sq=M.NORMAL,i.Tq=!1,i.Uq=H,i.Vq=!1,i.lastScrollY=0,i.$l=i.l.playlist.getCurrentItem();var a=i.rootElem.clientWidth,o=i.rootElem.clientHeight;i.Sq=i.Wq(a,o);document.querySelector("#yvp-css");i.k.subscribe(c.MEDIA_ITEM_LOADED,function(e){i.toggleSettings(null,!1,!0),e.isLive()?g.classList(i.Zl).add("yvp-live"):g.classList(i.Zl).remove("yvp-live"),i.isStreamMode()&&!i.getFullscreen()&&g.classList(i.Zl).add("yvp-stream"),i.isMiniStreamMode()&&!i.getFullscreen()&&g.classList(i.Zl).add("yvp-ministream")},i),i.k.subscribe(c.PLAYBACK_STARTED,function(){(i.l.ui.docking.enableOnScrollDown||i.l.ui.docking.enableOnScrollUp)&&i.Vq&&i.Xq()}),i.k.subscribe(c.Video.SWITCHING,function(){i.Yq(k.SWITCHING,!0)}),i.k.subscribe(c.Video.SWITCHED,function(){i.Yq(k.SWITCHING,!1)});var s=i.Zq(),l=s&&s.width,u=s&&s.height;i.k.publish(c.PLAYER_DIMENSION_CHANGE,{width:a||l,height:o||u}),i.k.subscribe(c.API.PLAYER_MUTE_CHANGE,i.Be,i),i.k.subscribe(c.UP_NEXT_PG_CLICK,i.$q,i),i.k.subscribe(c.PLAYER_DIMENSION_CHANGE,i.ue,i),i.k.subscribe(c.Device.ORIENTATION_CHANGE,i._q,i),h.mobile&&E.canPlayInline&&(i.l.uiState.deviceOrientation=i.br(),i.cr())}t.exports=n;var i=e("./views/controls"),a=e("./views/nfl-branding"),o=e("./easter-egg"),s=e("./views/error-screen"),l=e("./views/age-gate-screen"),c=e("./event"),u=e("./views/open-sim-sim"),p=e("./views/ads-info-panel.js"),d=e("./renderers/modes"),f=e("./views/start-screen"),v=e("./views/loading-screen"),m=e("./views/ads-view"),y=e("./states"),h=e("user-agent").userAgent,E=e("./navigator-info"),g=e("./util"),b=e("./tap"),_=e("../../lib"),A=(e("../../lib/logger"),e("./error.js")),T=e("./views/ads-overlay"),S=e("./renderer-controller"),I=e("./playlist-controller"),L=e("./constants"),R=e("./renderers/type"),C="flash_download_logo.svg",D=e("./views/base.html"),O=e("./views/end-screen-replay.html");g.insertCssIntoHead(".yvp-vis-hidden { visibility: hidden;} .yvp-disp-none { display: none;}");var N,P={END_SCREEN:"end-screen",ERROR:"error",VIDEO:"video",START_SCREEN:"start-screen",BLOCKED:"blocked"},k={LOADING:"loading",SWITCHING:"switching",PLAYING:"playing",PAUSED:"paused",CASTING:"casting"},M={NORMAL:"normal",SMALL:"smallscreen",VERY_SMALL:"verysmallscreen"},w={SMALL_WIDTH:350,SMALL_HEIGHT:210,VERY_SMALL_WIDTH:200,VERY_SMALL_HEIGHT:175},x=["webkitfullscreenchange","mozfullscreenchange","msfullscreenchange","MSFullscreenChange","fullscreenchange"],F="yvp-state-",U="yvp-flag-",B="yvp-browser-",H=5e3,V=75,G={DESKTOP:{HEIGHT:36},MOBILE:{HEIGHT:52}};n.prototype._q=function(e){var t=this;t.l.uiState.deviceOrientation=e,t.l.uiState.isDocked&&t.l.ui.docking.width===L.DOCKED_PLAYER_FULL&&e===L.Orientation.LANDSCAPE&&!t.getFullscreen()&&t.undockVideoPlayer(!0)},n.prototype.prepareNextRenderer=function(e,t){var r=this;r.dr.prepareNextRenderer(e,t)},n.prototype.preloadNextRenderer=function(e){var t=this;return t.dr.preloadNextRenderer(e)},n.prototype.preloadNextAdRenderer=function(e){var t=this;return t.dr.preloadNextAdRenderer(e)},n.prototype.getEventBus=function(){var e=this;return e.k},n.prototype.getModel=function(){var e=this;return e.l},n.prototype.getProfiler=function(){var e=this;return e.Ha},n.prototype.setBlockedFlashState=function(){var e=this;e.er(P.BLOCKED)},n.prototype.switchAndPlayNextRenderer=function(e,t){var r=this;r.dr.switchAndPlayNextRenderer(e,t)},n.prototype.switchToNextRenderer=function(){var e=this;e.dr.switchToNextRenderer()},n.prototype.switchToNextRendererAndStartExternal=function(e){var t=this;t.dr.switchToNextRendererAndStartExternal(e)},n.prototype.didRendererTimeOut=function(){var e=this;return e.dr.didRendererTimeOut()},n.prototype.render=function(){var e=this;if(e.Zl=g.render(D,{enableDocking:e.l.ui.docking.enableOnScrollDown||e.l.ui.docking.enableOnScrollUp}),e.Yl=e.Zl.querySelector(".yvp-main"),e.rootElem.appendChild(e.Zl),g.classList(e.Zl).add(e.Sq),Object.keys(h).filter(function(e){return h[e]}).forEach(function(t){"os"===t&&(t=h.os),"ie"===t&&g.classList(e.Zl).add("yvp-"+t.toLowerCase()+h[t]),g.classList(e.Zl).add(B+t.toLowerCase())}),E.deviceType&&g.classList(e.Zl).add("yvp-device-"+E.deviceType),h.mobile&&E.canPlayInline&&g.classList(e.Zl).add(B+"playsinline"),e.l.ui.chromeless||_.isFunction(v)&&(e.gr=new v(e.k)),e.gr&&e.Yl.appendChild(e.gr.create()),e.l.ui.showControls&&E.canPlayInline){e.controls=new i(e.k,e,e.l);var t=e.controls.create();Object.keys(t).forEach(function(r){e.Yl.appendChild(t[r])})}var r=function(t){e.ir()},n=function(t){e.jr(t)};e.bindMouseEvents=function(){e.kr={},e.Zl.addEventListener("mousemove",function(t){e.kr.x!==t.clientX&&e.kr.y!==t.clientY&&(r(t),e.kr.x=t.clientX,e.kr.y=t.clientY)}),e.Zl.addEventListener("mouseover",r),e.Zl.addEventListener("mouseout",n)},e.bindTouchEvents=function(){e.lr=new b(e.Zl,function(){var t=e.getFullscreen();(!t||h.android&&g.getFullscreenElement()===e.Zl)&&e.toggleControlsVisibility()}),e.k.subscribe(c.CONTROLS_SEEKING,function(){e.nr&&clearTimeout(e.nr),e.nr=setTimeout(e.or.bind(e),e.Uq)})},h.tv||h.mobile?h.mobile&&e.controls&&E.canPlayInline&&e.bindTouchEvents():e.bindMouseEvents(),e.unbindMouseEvents=function(){e.Zl.removeEventListener("mousemove",r),e.Zl.removeEventListener("mouseover",r),e.Zl.removeEventListener("mouseout",n)},_.isFunction(e.qr.bind)&&(e.rr=e.qr.bind(e),x.forEach(function(t){document.addEventListener(t,e.rr)})),h.mobile||e.l.ui.chromeless||(e.adsOverlay=new T(e.k,e),e.Yl.appendChild(e.adsOverlay.create())),e.sr=e.getSettingsNode(),e.$e=new I(e),e.vr(),e.dr=new S(e),e.wr=new o("NORMAL",function(){e.xr||(e.xr=new u(e.l,e.k,e.Ha,e.dr,N),N=null,e.Yl.appendChild(e.xr.create())),e.xr.render()}),e.createAdsInfoPanel=function(t){e.yr||(e.yr=new o("AD",function(){e.zr||(e.zr=new p(e.l,e.k,e.Ha,t),e.Yl.appendChild(e.zr.create())),e.zr.show()}))},h.desktop&&e.Yl.addEventListener("contextmenu",function(t){if(e.l.playbackState.rendererType===R.HTML5_HLS||e.l.playbackState.rendererType===R.HTML5_RAW)return t.preventDefault(),!1});var a=document.querySelector("#yvp-css");h.ie&&h.ie<=10&&setTimeout(function(){var t=a.sheet.cssRules&&a.sheet.cssRules.length>0;t?e.Ar():e.Br()},150),h.ie&&h.ie<=10||e.l.uiState.isCSSLoaded||(g.getSingleton("isCSSLoaded")===!0?e.Ar():g.getSingleton("isCSSError")===!0?e.Br():(a&&a.addEventListener("error",e.Br.bind(e)),a&&a.addEventListener("load",e.Ar.bind(e))))},n.prototype.Zq=function(){var e,t,r=this;try{var n=window.getComputedStyle(r.rootElem),i=n.width,a=n.height;_.isString(i)&&i.indexOf("px")>-1&&(e=i.slice(0,-2),e=parseInt(e,10)),_.isString(a)&&a.indexOf("px")>-1&&(t=a.slice(0,-2),t=parseInt(t,10))}catch(e){}return{width:e||L.DEFAULT_WIDTH,height:t||L.DEFAULT_HEIGHT}},n.prototype.cr=function(){var e=this;e.Hm=e.Gm.bind(e),window.addEventListener("resize",e.Hm)},n.prototype.br=function(){var e=L.Orientation.LANDSCAPE;return window.innerHeight>window.innerWidth&&(e=L.Orientation.PORTRAIT),e},n.prototype.Gm=function(){var e=this;e.k.publish(c.Device.ORIENTATION_CHANGE,e.br())},n.prototype.toggleControlsVisibility=function(){var e=this,t=g.classList(e.Zl).contains("yvp-hide-controls");t?(g.classList(e.Zl).remove("yvp-hide-controls"),e.k.publish(c.CONTROLS_BAR_CHANGE,!0,!0),e.Cr&&g.classList(e.Cr).remove("yvp-overlay-hide-cursor"),e.nr&&clearTimeout(e.nr),e.l.playbackState.seeking||(e.nr=setTimeout(e.or.bind(e),e.Uq))):(g.classList(e.Zl).add("yvp-hide-controls"),e.k.publish(c.CONTROLS_BAR_CHANGE,!1,!1))},n.prototype.initAdsView=function(){var e=this;return e.hb||(e.hb=new m(e.k,e,e.l)),e.hb},n.prototype.updateAdDiagnostics=function(e){N=e},n.prototype.isDocked=function(){var e=this;return e.Vq},n.prototype.vr=function(){var e=this;e.Dr&&e.Er();var t=h.ie>0&&h.ie<10,r=!t&&!h.mobile||h.mobile&&E.canPlayInline;r&&(e.l.ui.docking.enableOnScrollDown||e.l.ui.docking.enableOnScrollUp)&&(e.Dr=e.Fr.bind(e),window.addEventListener("scroll",e.Dr))},n.prototype.Er=function(){var e=this;e.Dr&&(window.removeEventListener("scroll",e.Dr),e.Dr=null)},n.prototype.Fr=function(){var e=this,t=window.pageYOffset;if(t!==e.lastScrollY&&!e.Tq){e.lastScrollY=t;var r=g.getElementViewability(e.rootElem),n=r>=e.l.ui.docking.threshold;n||e.Vq||e.l.getState()!==y.VIDEO||e.l.isPaused()?n&&e.Vq&&e.undockVideoPlayer():e.dockVideoPlayer()}},n.prototype.Gr=function(){var e=this,t=e.rootElem.getBoundingClientRect(),r=document.querySelector("body").clientWidth;e.l.ui.docking.positionTop>-1&&(e.Zl.style.top=t.top+"px"),e.l.ui.docking.positionBottom>-1&&(e.Zl.style.bottom=t.bottom+"px"),e.l.ui.docking.positionRight>-1&&(e.Zl.style.right=r-t.right+"px"),e.l.ui.docking.positionLeft>-1&&(e.Zl.style.left=t.left+"px"),e.Zl.style.width=e.Hr+"px",e.Zl.style.height=e.Ir+"px",e.Zl.style.position="fixed"},n.prototype.Xq=function(){var e=this,t=e.l.ui.docking;if(t.enableOnScrollDown||t.enableOnScrollUp){e.Jr&&e.Kr||(e.Jr=e.Zl.querySelector(".yvp-docked-title"),e.Lr=e.Zl.querySelector(".yvp-docked-provider"),e.Kr=document.createElement("div"),e.Kr.setAttribute("class","yvp-docked-bg"),e.Mr=document.createElement("img"),e.Mr.setAttribute("class","yvp-docked-img"),e.Nr=document.createElement("div"),e.Nr.setAttribute("class","yvp-docked-overlay"),e.Or=document.createElement("div"),e.Or.setAttribute("class","yvp-docked-overlay-text"),e.Or.innerHTML="Scroll back up to restore default view.",e.Nr.appendChild(e.Or),e.Kr.appendChild(e.Mr),e.Kr.appendChild(e.Nr),e.Pr||(e.Pr=document.createElement("div"),e.Pr.setAttribute("class","yvp-docked-close-button"),e.Qr=new b(e.Pr),e.Rr=function(t){t.stopPropagation(),e.undockVideoPlayer(!e.l.isPaused()),e.k.publish(c.API.UI_INTERACT,{srcElement:"ui_pop_close_clk"})},e.Pr.addEventListener("tap",e.Rr),t.closeButtonFadeIn||g.classList(e.Pr).add("yvp-nofade")),e.Yl.appendChild(e.Pr),e.rootElem.appendChild(e.Kr));var r=e.l.playlist.getCurrentItem();e.Mr.setAttribute("src",r.wh),e.Jr.innerHTML=r.title,e.Lr.innerHTML=r.provider&&r.provider.name}},n.prototype.dockVideoPlayer=function(){var e=this,t=!0,r=window.scrollY,n=e.l.ui.docking.width,i=e.l.ui.docking.height;if(e.lastScrollY>r&&(t=!1),e.l.ui.docking.enableOnScrollDown===t&&e.l.ui.docking.enableOnScrollUp!==t&&!e.Sr&&(e.l.ui.docking.enableOnMuted||!e.l.getMute())){if(e.toggleSettings(null,!1,!0),e.Hr=e.Zl.clientWidth,e.Ir=e.Zl.clientHeight,n===L.DOCKED_PLAYER_FULL){if(e.l.uiState.deviceOrientation===L.Orientation.LANDSCAPE)return;n=window.innerWidth,i=e.Ir/e.Hr*n}if(e.Vq=!0,e.Xq(),e.$e.togglePlaylistUI(!0),g.classList(e.Zl).add("yvp-docked"),e.l.ui.docking.showInfoCard&&g.classList(e.Zl).add("yvp-docked-show-meta"),e.l.ui.docking.fadeInAnimation){if(g.classList(e.Zl).add("yvp-docked-fadein"),g.classList(e.rootElem).add("yvp-docked-mode"),e.l.ui.docking.positionTop>-1&&(e.Zl.style.top=e.l.ui.docking.positionTop+"px"),e.l.ui.docking.positionBottom>-1&&e.l.ui.docking.positionTop<0){var a=0;e.l.ui.docking.showInfoCard&&(a=V),e.Zl.style.bottom=a+e.l.ui.docking.positionBottom+"px"}e.l.ui.docking.positionRight>-1&&e.l.ui.docking.positionLeft<0&&(e.Zl.style.right=e.l.ui.docking.positionRight+"px"),e.l.ui.docking.positionLeft>-1&&(e.Zl.style.left=e.l.ui.docking.positionLeft+"px")}else{e.Gr();var o=e.Zl.getBoundingClientRect(),s=document.querySelector("body").clientWidth,l=window.innerHeight,u=0,p=0;if(e.l.ui.docking.positionTop>-1&&(p=e.l.ui.docking.positionTop,e.Zl.style.top="0px"),e.l.ui.docking.positionBottom>-1){var d=0;e.l.ui.docking.showInfoCard&&(d=V),p=l-i-d-e.l.ui.docking.positionBottom,e.Zl.style.bottom=""}e.l.ui.docking.positionRight>-1&&(u=s-o.left-n-e.l.ui.docking.positionRight,e.Zl.style.right=""),e.l.ui.docking.positionLeft>-1&&(u=e.l.ui.docking.positionLeft,e.Zl.style.left="0px"),e.Zl.style.transform="translate3d("+u+"px, "+p+"px, 0)",g.classList(e.Zl).add("yvp-docked-animated"),g.classList(e.rootElem).add("yvp-docked-mode")}e.Zl.style.width=n+"px",e.Zl.style.height=i+"px",e.k.publish(c.API.PLAYER_VIEWPORT_CHANGE,!1),e.k.publish(c.PLAYER_DIMENSION_CHANGE,{width:n,height:i}),e.Tr(),e.l.uiState.isDocked=!0,e.k.publish(c.API.PLAYER_DOCKED_CHANGE,!0)}},n.prototype.undockVideoPlayer=function(e){var t=this;g.classList(t.Zl).remove("yvp-docked"),g.classList(t.Zl).remove("yvp-docked-show-meta"),t.l.ui.docking.fadeInAnimation?(g.classList(t.Zl).remove("yvp-docked-fadein"),t.Zl.style.top="",t.Zl.style.right="",t.Zl.style.bottom="",t.Zl.style.left="",t.Zl.style.width="",t.Zl.style.height=""):(t.Zl.style.transform="translate3d(0, 0, 0)",t.Gr()),t.Vq=!1,t.$e.togglePlaylistUI(!1),e&&!t.l.isPaused()&&t.k.publish(c.TOGGLE_PLAY_PAUSE),setTimeout(function(){t.Vq||(t.l.uiState.isDocked=!1,t.l.ui.docking.fadeInAnimation||(t.Zl.style.width="",t.Zl.style.height="",g.classList(t.Zl).remove("yvp-docked-animated"),t.Zl.style.position="",t.Zl.style.transform="",t.Zl.style.top="",t.Zl.style.right="",t.Zl.style.bottom="",t.Zl.style.left=""),t.Kr&&(t.rootElem.removeChild(t.Kr),t.Kr=null),g.classList(t.rootElem).remove("yvp-docked-mode"),t.Tr(),t.k.publish(c.API.PLAYER_VIEWPORT_CHANGE,!0),t.k.publish(c.PLAYER_DIMENSION_CHANGE,{width:t.Hr,height:t.Ir})),t.k.publish(c.API.PLAYER_DOCKED_CHANGE,!1)},250)},n.prototype.updateDockingConfig=function(e,t,r,n,i,a){var o=this;"boolean"==typeof e&&(o.l.ui.docking.enableOnScrollDown=e),"boolean"==typeof t&&(o.l.ui.docking.enableOnScrollUp=t),isNaN(r)||(o.l.ui.docking.positionTop=r),isNaN(n)||(o.l.ui.docking.positionRight=n),isNaN(i)||(o.l.ui.docking.positionLeft=i),isNaN(a)||(o.l.ui.docking.positionBottom=a),e||t?(o.vr(),o.Vq&&o.dockVideoPlayer()):(o.Er(),o.Vq&&o.undockVideoPlayer())},n.prototype.showAirplayTargetMenu=function(){var e=this,t=e.dr.getActiveRenderer();t&&t.showAirplayTargetMenu&&t.showAirplayTargetMenu()},n.prototype.Ar=function(){var e,t=this,r=t.getContentNode(),n=r.querySelectorAll(".yvp-vis-hidden"),i=n.length;for(e=0;e<i;e++)g.classList(n[e]).remove("yvp-vis-hidden");t.l.uiState.isCSSLoaded=!0},n.prototype.Br=function(){var e,t=this,r=t.getContentNode(),n=r.querySelectorAll(".yvp-vis-hidden"),i=n.length;for(e=0;e<i;e++)g.classList(n[e]).add("yvp-disp-none");t.l.uiState.isCSSLoaded=!1,t.k.publish(c.WARNING,g.createErr("P",t.l.playbackState,A.E_WARNING,A.WARNING_CODES.E_CSS_DOWNLOAD_FAILED),!1)},n.prototype.getContentNode=function(){var e=this;return e.Zl},n.prototype.getOpenSimSim=function(){var e=this;return e.xr},n.prototype.getMainElement=function(){var e=this;return e.Yl},n.prototype.getRootElement=function(){var e=this;return e.rootElem},n.prototype.getRootElement=function(){var e=this;return e.rootElem},n.prototype.getVideoElement=function(){var e=this;return e.rootElem.getElementsByTagName("video")[0]},n.prototype.getNextRendererNode=function(){var e=this;return e.dr.getNextRendererNode()},n.prototype.getCustomControlsNode=function(){var e=this;return e.rootElem.querySelector(".yvp-custom-controls")},n.prototype.getSettingsNode=function(){var e=this;return e.rootElem.querySelector(".yvp-settings-container")},n.prototype.Gf=function(){var e=this;setTimeout(function(){e.Tr()},700)},n.prototype.Tr=function(){var e=this;if(e.Qq&&e.Zl&&e.Yl){var t=h.mobile?e.Pq.MOBILE.HEIGHT:e.Pq.DESKTOP.HEIGHT;e.Yl.style.height="calc(100% - "+t+"px)"}},n.prototype.Ur=function(){var e=this;if(!e.Qq){e.Qq=new a(e.k,e,e.l),e.Tr();var t=e.$e.getPlaylistRootElement(),r=e.$e.isPlaylistShown(),n=e.$e.getPlaylistUIPosition();e.Rq=e.Qq.create(),r&&n===L.PLAYLIST_POS_BOTTOM&&t?t.parentNode.insertBefore(e.Rq,t):e.Zl.appendChild(e.Rq)}},n.prototype.Vr=function(){var e=this;e.Yl&&(e.Yl.style.height="100%"),e.Qq&&(e.Zl.removeChild(e.Qq.node),e.Qq.destroy(),e.Qq=null,e.Rq=null)},n.prototype.getNFLBrandingNode=function(){var e=this;return e.Rq},n.prototype.setKeyboardFocus=function(){var e=this;e.Zl.focus()},n.prototype.updateViewOnEscPress=function(){var e=this;e.xr&&e.xr.isOpen()?e.xr.close():e.zr&&e.zr.isOpen()?e.zr.close():g.classList(e.Zl).contains("yvp-show-settings")?e.toggleSettings(null,!1):e.getFullscreen()&&e.setFullscreen(!1)},n.prototype.toggleSettings=function(e,t,r){var n=this;if(e&&(n.Wr=e),n.Wr||(n.Wr=n.Zl.querySelector(".yvp-setting-btn")),n.Wr){var i=n.Wr.querySelector(".yvp-setting-pointer");g.classList(n.Wr).contains("selected")&&t!==!0||t===!1?(g.classList(n.sr).remove("open"),g.classList(n.Wr).remove("selected"),g.classList(i).remove("open"),g.classList(n.Zl).remove("yvp-settings-on")):g.classList(n.Wr).contains("selected")&&t!==!0||(g.classList(n.sr).add("open"),g.classList(n.Wr).add("selected"),g.classList(i).add("open"),g.classList(n.Zl).add("yvp-settings-on")),r||n.k.publish(c.CTRL_SETTINGS)}},n.prototype.disableControls=function(){var e=this;g.classList(e.Zl).add("yvp-disable-controls")},n.prototype.enableControls=function(){var e=this;g.classList(e.Zl).remove("yvp-disable-controls")},n.prototype.hideContentRenderer=function(e){var t=this;e?g.classList(t.Zl).add("yvp-hide-content-on"):g.classList(t.Zl).remove("yvp-hide-content-on")},n.prototype.resetState=function(){var e=this;e.Xr(),e.Yr(),e.Vr()},n.prototype.checkForNFLBranding=function(){var e=this,t=e.l.playlist.getCurrentItem(),r=t?t.provider:null,n=t&&t.gameOrigin?t.gameOrigin:[];r&&"video.nflhighlights.com"===r.providerId&&n.indexOf("vzw")===-1&&e.Ur()},n.prototype.syncViewState=function(){var e,t=this,r=t.l,n=r.playbackState,i=r.castState,a=i&&i.connected,o=t.l.playlist&&t.l.playlist.getCurrentItem();t.Yq(k.CASTING,a),a&&(i.mediaLoaded&&!i.paused?g.classList(t.Zl).add("yvp-cast-playing"):g.classList(t.Zl).remove("yvp-cast-playing"));var s=g.classList(t.Zl).contains(U+k.LOADING);switch(t.Yq(k.LOADING,r.isLoading()),!s&&r.isLoading()?t.k.publish(c.API.LOADING_BEGIN):s&&!r.isLoading()&&t.k.publish(c.API.LOADING_END),r.getState()){case y.INIT:case y.WAITING:e=P.START_SCREEN,t.Qq||t.checkForNFLBranding();var l=!r.playback.autoplay||r.playbackState.waitingForUserTap,u=o&&(o.hasThumbnail()&&!h.mobile||o.fetchFinished());if(l&&u){var p=r.playback.continuousPlay&&0!==r.playlist.position,f="always"===r.skipOnError||"timebased"===r.skipOnError;p&&f&&n.hasStartedPlayback||t.Zr()}break;case y.VIDEO:var v,m=n.isVpaidAdPlaying();t.Qq||t.checkForNFLBranding(),v=m?d.VPAID:n.isAdPlaying()?d.AD:d.VIDEO,t.dr.setRendererMode(v),e=P.VIDEO;var E=!r.isPaused();E?(t.Yq(k.PLAYING,!0),t.Yq(k.PAUSED,!1)):(t.Yq(k.PLAYING,!1),t.Yq(k.PAUSED,!0)),t.dr.syncPlaybackState();break;case y.END:if(t.endVideo(),t.Vr(),n.criticalError)t.l.ui.chromeless?t.k.publish(c.API.PLAYER_ERROR,n.criticalError):t.$r(n.criticalError,o,t.l.guid),e=P.ERROR,t.stopMedia();else{var b=o&&o.isLive();t.dr.rewindAfterEnd(b);var _=function(r){if(r)return e=P.END_SCREEN,void t.syncViewState();t.l.playback.continuousPlay=!0;var n=t.l.playlist.position,i=n+1,a=t.l.playlist.getMediaItemAt(i);a&&t.k.publish(c.RELATED_ITEM_CLICK,a.id,i,!1,!0)};t.maybeFetchMoreVideos(_)||t._r(n.previousItem),e=P.END_SCREEN}}t.as=e,t.er(e),t.bs()},n.prototype.getCurrentViewState=function(){return this.as},n.prototype.er=function(e){var t=this,r=F+e,n=g.classList(t.Zl);Object.keys(P).forEach(function(e){var t=F+P[e];n.contains(t)&&t!==r&&n.remove(t)}),n.contains(r)||n.add(r)},n.prototype.setSelectedStreams=function(e){},n.prototype.play=function(e){var t=this;t.dr.play(e)},n.prototype.pause=function(){var e=this;e.dr.pause()},n.prototype.preload=function(e){var t=this;t.dr.preload(e)},n.prototype.getCurrentDate=function(){var e=this;return e.dr.getCurrentDate()},n.prototype.Yq=function(e,t){var r=this,n=g.classList(r.Zl),i=U+e,a=n.contains(i);t?a||n.add(i):a&&n.remove(i)},n.prototype.renderAgeGateScreen=function(e,t){if(e){var r=this;r.ds=new l(r.k,t),r.Yl.appendChild(r.ds.create(e))}},n.prototype.destroyAgeGateScreen=function(){var e=this;e.ds&&(e.Yl.removeChild(e.ds.node),e.ds.destroy(),e.ds=null)},n.prototype.Zr=function(){var e=this,t=null,r=null,n=e.l.YVAP;if(!e.fs){var i=function(){r&&(r(),clearTimeout(t),r=t=null),e.gs(e.l.playlist.getCurrentItem(),e.l)};h.mobile&&n&&!n.adsReady?(r=e.k.subscribe(c.ADS_READY,i,e),t=setTimeout(i,1e3)):i()}},n.prototype.gs=function(e,t){var r=this;r.fs||(t.ui.showStartScreen&&(r.fs=new f(r.k),r.Yl.appendChild(r.fs.create(e,t))),r.k.publish(c.START_SCREEN_RENDERED))},n.prototype.Xr=function(){var e=this,t=e.fs&&e.fs.node;t&&(e.Yl.removeChild(t),e.fs.destroy(),e.fs=null)},n.prototype.maybeFetchMoreVideos=function(e){var t=this,r=t.l,n=r.ui.showEndScreen,i=r.ui.showReplayOnlyEndScreen,a=r.playlist.videoRecommendations,o=r.getPlaylistRenderingType()!==L.PLAYLIST_RENDERING_TYPE.ONLY_MEDIA_ITEMS,s=r.playlist.getNextPosition(r.playback.continuousPlay,r.getLoop()),l=t.$l&&t.$l.isCCM,c=t.$e.isPlaylistShown();return o&&s===-1?(t.$e.fetchMore(L.PLAYLIST_ENDSCREEN_COUNT_PER_PAGE,e),!0):!(!l||t.hs||!n||i||c||a!==!0)&&(t.$e.fetchMore(L.PLAYLIST_ENDSCREEN_COUNT_PER_PAGE,e),!0)},n.prototype._r=function(e){var t=this,r=t.l.ui.showReplayOnlyEndScreen,n=t.Zl.querySelector(".yvp-end-replay");if(r&&!n){var i=g.render(O,{});t.js=function(){t.k.publish(c.RELATED_ITEM_CLICK,e.id,-1,!1,!1)},t.ks=new b(i),i.addEventListener("tap",function(){t.js(!1)}),t.Yl.appendChild(i),t.ns=i}!t.fs&&r&&t.Zr(),t.k.publish(c.END_SCREEN_RENDERED),t.k.publish(c.API.UI_INTERACT,{srcElement:"es-view"})},n.prototype.Yr=function(){var e=this;e.ns&&(e.ns.removeEventListener("tap",e.js),e.ks.destroy(),e.Yl.removeChild(e.ns))},n.prototype.$r=function(e,t,r){var n=this;n.us&&n.ws(),n.us=new s(n.k);var i=t?t.images.defaultThumbnail:"",a=g.getAssetUrl(n.l.isLocal(),n.l.version,C);if(n.l.isLocal())a="assets/flash_download_logo.svg";else{var o="https:"===document.location.protocol?"https://s.yimg.com":"http://l.yimg.com";a=o+"/rx/builds/"+n.l.version+"/assets/flash_download_logo.svg"}t=t?t:n.l.playlist.getCurrentItem()||{},n.Yl.appendChild(n.us.create(e,r,t.videoSession||"",i,a)),n.k.publish(c.API.UI_INTERACT,{srcElement:"err-view-"+e.category+"-"+e.subcategory})},n.prototype.ws=function(){var e=this,t=e.us&&e.us.node;t&&(e.Yl.removeChild(t),e.us.destroy(),e.us=null)},n.prototype.bs=function(){var e=this;e.controls&&e.controls.syncAriaState()},n.prototype.endVideo=function(){var e=this;e.dr.endVideo()},n.prototype.seek=function(e){var t=this;t.dr.seek(e)},n.prototype.getCurrentTime=function(){var e=this;return e.dr.getCurrentTime()},n.prototype.getDuration=function(){var e=this;return e.dr.getDuration()},n.prototype.setQuality=function(e){var t=this;t.dr.setQuality(e)},n.prototype.setFullscreen=function(e){var t=this,r=t.Zl,n=r.requestFullscreen||r.webkitRequestFullscreen||r.mozRequestFullScreen||r.msRequestFullscreen,i=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen;e?(h.ios?t.dr.enterFS():h.android&&!t.controls?t.dr.enterFS():n?n.call(r):t.xs(),t.k.publish(c.CTRL_FULLSCREEN,"ON")):(h.ios?t.dr.exitFS():i?i.call(document):t.ys(),t.k.publish(c.CTRL_FULLSCREEN,"OFF")),t.Tq===e||n||i||(t.qr(),t.k.publish(c.FULLSCREEN_CHANGE,e),t.Tq=e),e&&h.mobile&&E.autoplaySupported&&t.l.playbackState.mute&&!t.l.muteMode&&t.k.publish(c.CONTROLS_SET_MUTE,!1),t.bs()},n.prototype.xs=function(){var e=this,t=document.querySelector("body");if(!g.classList(t).contains("yvp-lightbox")){for(var r=e.Zl.parentNode;"BODY"!==r.nodeName;)g.classList(r).add("yvp-lightbox-ancestor"),r=r.parentNode;g.classList(t).add("yvp-lightbox")}},n.prototype.ys=function(){var e=this,t=document.querySelector("body");if(g.classList(t).contains("yvp-lightbox")){g.classList(t).remove("yvp-lightbox");for(var r=e.Zl.parentNode;"BODY"!==r.nodeName;)g.classList(r).remove("yvp-lightbox-ancestor"),r=r.parentNode}},n.prototype.getFullscreen=function(){var e=this,t=g.getFullscreenElement(),r=e.dr.getActiveRenderer(),n=h.mobile&&(document.isFullScreen||document.webkitIsFullScreen)||h.ios&&r&&r.node&&r.node.webkitDisplayingFullscreen;return t===e.Zl||g.classList(document.querySelector("body")).contains("yvp-lightbox")||n},n.prototype.toggleFullscreen=function(){var e=this;e.setFullscreen(!e.getFullscreen())},n.prototype.setVolume=function(e){var t=this;t.dr.setVolume(e),t.k.publish(c.API.PLAYER_VOLUME_CHANGE,e)},n.prototype.Be=function(e){var t=this;e?g.classList(t.Zl).add("yvp-muted"):g.classList(t.Zl).remove("yvp-muted")},n.prototype.setMute=function(e){var t=this;t.dr.setMute(e),t.k.publish(c.API.PLAYER_MUTE_CHANGE,e)},n.prototype.setAudioLanguage=function(e){var t=this;t.dr.setAudioLanguage(e)},n.prototype.ir=function(){var e=this;e.nr&&clearTimeout(e.nr),g.classList(e.Zl).remove("yvp-hide-controls"),e.Cr&&g.classList(e.Cr).remove("yvp-overlay-hide-cursor"),e.l.isSeeking()||e.l.isPaused()||(e.nr=setTimeout(e.or.bind(e),e.Uq)),e.k.publish(c.CONTROLS_BAR_CHANGE,!0,!0);var t=e.getFullscreen();t||e.k.publish(c.CC.POSITION_FLOAT,!0)},n.prototype.jr=function(e){var t=this;if("mouseout"===e.type){t.nr&&clearTimeout(t.nr),g.classList(t.Zl).add("yvp-hide-controls"),t.k.publish(c.CONTROLS_BAR_CHANGE,!1,!1);var r=t.getFullscreen();r||t.k.publish(c.CC.POSITION_FLOAT,!1)}},n.prototype.or=function(){var e=this;e.Cr=e.Zl&&e.Zl.querySelector(".yvp-object-overlay"),clearTimeout(e.nr),e.nr=null,g.classList(e.Zl).add("yvp-hide-controls"),
e.k.publish(c.CONTROLS_BAR_CHANGE,!1,!0)},n.prototype.$q=function(){var e=this;e.nr&&clearTimeout(e.nr),e.l.isSeeking()||(e.nr=setTimeout(e.or.bind(e),e.Uq))},n.prototype.qr=function(){var e=this,t=e.getFullscreen();t?(g.classList(e.Zl).add("yvp-state-fullscreen"),e.Vq&&(e.Sr=!0,e.undockVideoPlayer())):(g.classList(e.Zl).remove("yvp-state-fullscreen"),(e.Vq||e.Sr)&&(e.Sr=!1,e.dockVideoPlayer())),e.Tq!==t&&(e.l.uiState.isFullscreen=t,e.k.publish(c.FULLSCREEN_CHANGE,t),e.Tq=t)},n.prototype.ue=function(e){var t,r=this,n=e.width||1,i=e.height||1,a=r.Wq(n,i);(r.isStreamMode()||r.isMiniStreamMode())&&a===M.NORMAL&&r.zs(),h.desktop&&(a===M.VERY_SMALL?g.classList(r.Zl).add("yvp-ministream"):a===M.SMALL&&(g.classList(r.Zl).add("yvp-stream"),r.$e.detachUpNextMouseEvents(),t=r.getContentNode().querySelector(".yvp-upnext-playlist"),t&&g.classList(t).add("hide")))},n.prototype.zs=function(){var e,t=this,r=t.getContentNode();g.classList(r).remove("yvp-ministream"),g.classList(r).remove("yvp-stream"),t.$e.attachUpNextMouseEvents(),e=t.getContentNode().querySelector(".yvp-upnext-playlist"),e&&g.classList(e).remove("hide")},n.prototype.Wq=function(e,t){var r=M.NORMAL;return(e<=w.VERY_SMALL_WIDTH||t<=w.VERY_SMALL_HEIGHT)&&(r=M.VERY_SMALL),(e<=w.SMALL_WIDTH&&e>w.VERY_SMALL_WIDTH||t<=w.SMALL_HEIGHT&&t>w.VERY_SMALL_HEIGHT)&&(r=M.SMALL),r},n.prototype.clearAutoHideTimeout=function(){var e=this;e.nr&&clearTimeout(e.nr)},n.prototype.setOverlayActive=function(e){var t=this;e?g.classList(t.Zl).add("yvp-overlay-active"):g.classList(t.Zl).remove("yvp-overlay-active")},n.prototype.destroyFullscreenChangeListeners=function(){var e=this;e.rr&&x.forEach(function(t){document.removeEventListener(t,e.rr)})},n.prototype.getClientVideoDimension=function(){var e=this;return{width:e.Zl.clientWidth,height:e.Zl.clientHeight}},n.prototype.getControls=function(){var e=this;return e.controls},n.prototype.getPlaylistController=function(){var e=this;return e.$e},n.prototype.isStreamMode=function(){var e=this;return h.desktop&&(e.Sq===M.SMALL||g.classList(e.Zl).contains("yvp-stream"))},n.prototype.isMiniStreamMode=function(){var e=this;return h.desktop&&(e.Sq===M.VERY_SMALL||g.classList(e.Zl).contains("yvp-ministream"))},n.prototype.getVideoDimension=function(){var e=this;return{width:e.Yl&&e.Yl.clientWidth||L.DEFAULT_WIDTH,height:e.Yl&&e.Yl.clientHeight||L.DEFAULT_HEIGHT}},n.prototype.suspendStreaming=function(){var e=this;e.dr.suspendStreaming()},n.prototype.resumeStreaming=function(){var e=this;e.dr.resumeStreaming()},n.prototype.stopMedia=function(){var e=this;return e.dr.stopMedia()},n.prototype.destroy=function(){var e=this;e.controls&&e.controls.destroy(),e.wr&&e.wr.destroy(),e.yr&&e.yr.destroy(),e.hs&&e.hs.destroy(),e.us&&e.us.destroy(),e.gr&&e.gr.destroy(),e.hb&&e.hb.destroy(),e.$e&&e.$e.destroy(),e.dr&&e.dr.destroy(),e.fs&&e.fs.destroy(),e.lr&&e.lr.destroy(),e.destroyAgeGateScreen(),e.destroyFullscreenChangeListeners(),h.tv||h.mobile||e.unbindMouseEvents&&e.unbindMouseEvents(),e.Hm&&(window.removeEventListener("resize",e.Hm),e.Hm=null),e.Jf&&e.Jf.destroy(),e.xr&&e.xr.destroy(),e.zr&&e.zr.destroy(),e.rootElem.innerHTML="",e.Er()}},{"../../lib":"/lib/index.js","../../lib/logger":"/lib/logger.js","./constants":7,"./easter-egg":10,"./error.js":12,"./event":"/nextgen/src/event.js","./navigator-info":26,"./playlist-controller":30,"./renderer-controller":33,"./renderers/modes":43,"./renderers/type":44,"./states":46,"./tap":"/nextgen/src/tap.js","./util":"/nextgen/src/util.js","./views/ads-info-panel.js":51,"./views/ads-overlay":53,"./views/ads-view":57,"./views/age-gate-screen":59,"./views/base.html":60,"./views/controls":65,"./views/end-screen-replay.html":66,"./views/error-screen":68,"./views/loading-screen":70,"./views/nfl-branding":73,"./views/open-sim-sim":75,"./views/start-screen":84,"user-agent":233}],49:[function(e,t,r){var n=new(e("hogan.js/lib/template").Template)(function(e,t,r){var n=this;return n.b(r=r||""),n.b("<div>"),n.b("\n"+r),n.b("    <table border='1'>"),n.b("\n"+r),n.b("        <tr>"),n.b("\n"+r),n.b("            <th>Clip</th>"),n.b("\n"+r),n.b("            <th>Position</th>"),n.b("\n"+r),n.b("        </tr>"),n.b("\n"+r),n.b("        "),n.b("\n"+r),n.s(n.f("clipStats",e,t,1),e,t,0,143,1206,"{{ }}")&&(n.rs(e,t,function(e,t,n){n.b("            <tr>"),n.b("\n"+r),n.b("                <td>"),n.b(n.v(n.f("clipId",e,t,0))),n.b("</td>"),n.b("\n"+r),n.b("                <td>"),n.b("\n"+r),n.b("                \t<table border='1'>"),n.b("\n"+r),n.b("                \t<tr>"),n.b("\n"+r),n.s(n.f("data",e,t,1),e,t,0,303,362,"{{ }}")&&(n.rs(e,t,function(e,t,r){r.b("                \t\t<th>"),r.b(r.v(r.f("position",e,t,0))),r.b("</th>"),r.b("\n")}),e.pop()),n.b("                \t</tr>"),n.b("\n"+r),n.b("                \t<tr>"),n.b("\n"+r),n.s(n.f("data",e,t,1),e,t,0,443,1111,"{{ }}")&&(n.rs(e,t,function(e,t,n){n.b("                \t\t<td>"),n.b("\n"+r),n.s(n.f("data",e,t,1),e,t,0,495,1060,"{{ }}")&&(n.rs(e,t,function(e,t,n){n.b("\t                \t\t<ul>"),n.b("\n"+r),n.b("\t                \t\t\t<li>Ad Opportunity: "),n.b(n.v(n.f("taken",e,t,0))),n.b("</li>"),n.b("\n"+r),n.b("\t                \t\t\t<li>Communicator: "),n.b(n.v(n.f("communicator",e,t,0))),n.b("</li>"),n.b("\n"+r),n.b("\t                \t\t\t<li>Response Code: "),n.b(n.v(n.f("responseCode",e,t,0))),n.b("</li>"),n.b("\n"+r),n.b("\t                \t\t\t<li>Response Type: "),n.b(n.v(n.f("responseType",e,t,0))),n.b("</li>"),n.b("\n"+r),n.b("\t                \t\t\t<li>First Redirect: "),n.b(n.v(n.f("firstRedirect",e,t,0))),n.b("</li>"),n.b("\n"+r),n.b("\t                \t\t\t<li>Redirect count: "),n.b(n.v(n.f("redirectCount",e,t,0))),n.b("</li>"),n.b("\n"+r),n.b("\t                \t\t\t<li>Ad Delivery error: "),n.b(n.v(n.f("error",e,t,0))),n.b("</li>"),n.b("\n"+r),n.b("\t                \t\t\t<li>Ad Media Start latency: "),n.b(n.v(n.f("mediaStartLatency",e,t,0))),n.b("</li>"),n.b("\n"+r),n.b("\t                \t\t</ul>"),n.b("\n")}),e.pop()),n.b("                \t\t</td>"),n.b("\n")}),e.pop()),n.b("                \t</tr>"),n.b("\n"+r),n.b("                \t</table>"),n.b("\n"+r),n.b("\t\t\t\t</td>"),n.b("\n"+r),n.b("            </tr>"),n.b("\n")}),e.pop()),n.b("    </table>"),n.b("\n"+r),n.b("</div>"),n.b("\n"),n.fl()});t.exports={render:function(){return n.render.apply(n,arguments)},r:function(){return n.r.apply(n,arguments)},ri:function(){return n.ri.apply(n,arguments)}}},{"hogan.js/lib/template":141}],50:[function(e,t,r){var n=new(e("hogan.js/lib/template").Template)(function(e,t,r){var n=this;return n.b(r=r||""),n.b("<div class='yvp-adspanel yvp-opensimsim' style='display: none'>"),n.b("\n"+r),n.b("    <button class='yvp-opensimsim-close-btn yvp-close-btn'></button>"),n.b("\n"+r),n.b("\n"+r),n.b("    <div class='yvp-opensimsim-info'>"),n.b("\n"+r),n.b("        <div class='yvp-opensimsim-title'>Yahoo Video Ads</div>"),n.b("\n"+r),n.b("        <div>Version : "),n.b(n.v(n.f("version",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("        <div>Page SpaceID : "),n.b(n.v(n.f("spaceId",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("        <div class='yvp-sessionId'></div>"),n.b("\n"+r),n.b("        <div class='yvp-videoSpaceId'></div>"),n.b("\n"+r),n.b("        <div class='yvp-opensimsim-uuid'></div>"),n.b("\n"+r),n.b("        <div class='yvp-opensimsim-renderertype'></div>"),n.b("\n"+r),n.b("        <div>Midroll Cache Stats: <div class='yvp-midrollcache-data'></div></div>"),n.b("\n"+r),n.b("        <div class='yvp-opensimsim-title'>Ads Info</div>"),n.b("\n"+r),n.b("        <br>"),n.b("\n"+r),n.b("        <div class='yvp-adsinfopanel-adsinfo'><div style='text-align: center;'>YVAP disabled!!</div></div>"),n.b("\n"+r),n.b("    </div>"),n.b("\n"+r),n.b("\n"+r),n.b("    <section class='ad-info-table yvp-table'>"),n.b("\n"+r),n.b("        <div>"),n.b("</div>"),n.b("\n"+r),n.b("        <header class='yvp-tablerow'>"),n.b("\n"+r),n.b("            <div class='yvp-tablecell'>position</div>"),n.b("\n"+r),n.b("            <div class='yvp-tablecell'>dur</div>"),n.b("\n"+r),n.b("            <div class='yvp-tablecell'>adPbId</div>"),n.b("\n"+r),n.b("            <div class='yvp-tablecell'>crId</div>"),n.b("\n"+r),n.b("            <div class='yvp-tablecell'>vCrId</div>"),n.b("\n"+r),n.b("            <div class='yvp-tablecell'>bId</div>"),n.b("\n"+r),n.b("            <div class='yvp-tablecell'>State</div>"),n.b("\n"+r),n.b("            <div class='yvp-tablecell'>log</div>"),n.b("\n"+r),n.b("        </header>"),n.b("\n"+r),n.b("        <div class='yvp-tablerow'>"),n.b("\n"+r),n.b("            <div class='adposition yvp-tablecell'></div>"),n.b("\n"+r),n.b("            <div class='addur yvp-tablecell'></div>"),n.b("\n"+r),n.b("            <div class='adPbId yvp-tablecell'></div>"),n.b("\n"+r),n.b("            <div class='crId yvp-tablecell'></div>"),n.b("\n"+r),n.b("            <div class='vCrId yvp-tablecell'></div>"),n.b("\n"+r),n.b("            <div class='bId yvp-tablecell'></div>"),n.b("\n"+r),n.b("            <div class='pbstate yvp-tablecell'></div>"),n.b("\n"+r),n.b("            <div class='yvp-tablecell'><button class='linkbtn'>log</button></div>"),n.b("\n"+r),n.b("        </div>"),n.b("\n"+r),n.b("    </section>"),n.b("\n"+r),n.b("</div>"),n.b("\n"),n.fl()});t.exports={render:function(){return n.render.apply(n,arguments)},r:function(){return n.r.apply(n,arguments)},ri:function(){return n.ri.apply(n,arguments)}}},{"hogan.js/lib/template":141}],51:[function(e,t,r){"use strict";function n(e,t,r,n){var a=this;a.l=e,a.k=t,a.Ha=r,a.As=n,a.Bs=null!==n,a.k.subscribe(i.YVAP_MIDROLL_CACHE_UPDATE,a.Cs,a)}t.exports=n;var i=e("../event"),a=e("../util"),o=e("../tap"),s=e("./ads-info-panel.html"),l=e("../strings");n.prototype.create=function(){var e=this;e._node=a.render(s,{version:e.l.version,spaceId:e.l.baseConfig.pageSpaceId,strings:l.i18n}),e.Ds=e._node.querySelector(".yvp-midrollcache-data"),e.Es=e._node.querySelector(".yvp-adsinfopanel-adsinfo");var t=e.Fs=e._node.removeChild(e._node.querySelector(".ad-info-table"));return e.Gs=t.removeChild(t.querySelector("div.yvp-tablerow")),e.Hs=new o(e._node.querySelector(".yvp-opensimsim-close-btn"),function(t){t.stopPropagation(),e.close()}),e.Is=new o(e.Es,function(t){if("linkbtn"===t.eventSource.className)try{e.Js(t.eventSource.parentNode.parentNode.customData.playbackId)}catch(e){}}),e._node},n.prototype.show=function(){var e=this;e._node.style.display="block",e.Bs&&(e.Ks(),e.Ls(),e.Ms())},n.prototype.isOpen=function(){var e=this;return"none"!==e._node.style.display},n.prototype.close=function(){var e=this;e._node.style.display="none",e.Bs&&e.Ns()},n.prototype.Ms=function(){var e=this;e.As.registerAdStateChangeListener(e.Os.bind(e)),e.As.registerAdDataAvailableListener(e.Ps.bind(e))},n.prototype.Ns=function(){var e=this;e.As.registerAdStateChangeListener(null),e.As.registerAdDataAvailableListener(null)},n.prototype.Os=function(e,t,r){var n=this,i=n.Es.querySelector("[apbid="+e+"]");n.Qs(i,t,r)},n.prototype.Ps=function(e){var t=this,r=t.Es.querySelector("[relvideo="+e.clipId+"]");t.Rs(r,e)},n.prototype.Cs=function(e){function t(e,t){return"<div class='floated-item'>"+e+":<span> "+t+"</span></div>"}var r=this,n="",i={retryCount:"retries",targetAdsDuration:"target",totalUniqueAds:"num_uniq",totalDuplicatedAds:"num_dup",totalNoAds:"num_noad",uniqueAdsDuration:"uniq_dur"};Object.keys(e).forEach(function(r){var a=i[r]||r;n+=t(a,e[r])}),r.Ds.innerHTML=n},n.prototype.Ks=function(){var e=this,t=e.l.playlist.getCurrentItem(),r=e._node.querySelector(".yvp-opensimsim-uuid");r.innerHTML="UUID : "+(t?t.id:""),r=e._node.querySelector(".yvp-opensimsim-renderertype"),r.innerHTML="Renderer Type : "+(t?t.rendererType:""),r=e._node.querySelector(".yvp-videoSpaceId"),r.innerHTML="Video SpaceID : "+(t?t.metrics.pageSpaceId:""),r=e._node.querySelector(".yvp-sessionId"),r.innerHTML="SessionId : "+(t?t.videoSession:"none")},n.prototype.Qs=function(e,t){var r=e,n=a.classList(r);"playing"===t?n.add("currad"):n.contains("currad")&&n.remove("currad"),r=e.querySelector(".pbstate"),n=a.classList(r),n.remove("st-"+e.customData.adstate),e.customData.adstate=t,n.add("st-"+t),r.innerHTML=t},n.prototype.Ls=function(){var e=this;e.Es.innerHTML="";var t=e.As.getAllAdDiagnostics();Object.keys(t).forEach(function(r){e.Ss(t[r],r)})},n.prototype.Ss=function(e,t){var r=this,n=r.Fs.cloneNode(!0);n.children[0].innerHTML="<strong>uuid: </strong>"+t,Object.keys(e).forEach(function(t){var i=e[t];r.Rs(n,i)}),n.setAttribute("relvideo",t),r.Es.appendChild(n)},n.prototype.Rs=function(e,t){var r=this;if(e&&t){var n=r.Gs.cloneNode(!0);if(t){var i=t.playbackId,o=t.clipId;n.setAttribute("apbid",i),n.customData={playbackId:i,uuid:o,adstate:t.adstate},n.querySelector(".adPbId").innerHTML=i,n.querySelector(".addur").innerHTML=t.duration,n.querySelector(".adposition").innerHTML=t.position,n.querySelector(".crId").innerHTML=t.creativeId,n.querySelector(".vCrId").innerHTML=t.vastCreativeId,n.querySelector(".bId").innerHTML=t.bookingId,r.Qs(n,t.adstate,t.adstateData),e.rowCount=void 0===e.rowCount?0:e.rowCount+1,e.rowCount%2!==0&&a.classList(n).add("yvp-altrow")}else a.classList(n).add("emptyrow");e.appendChild(n)}},n.prototype.Js=function(e){var t=this,r=t.As.getAdDiagnosticsById(e),n=console;n.log.apply(n,["[ad diagnostics]",r])},n.prototype.destroy=function(){var e=this;e.Hs&&e.Hs.destroy(),e.Is&&e.Is.destroy()}},{"../event":"/nextgen/src/event.js","../strings":"/nextgen/src/strings.js","../tap":"/nextgen/src/tap.js","../util":"/nextgen/src/util.js","./ads-info-panel.html":50}],52:[function(e,t,r){var n=new(e("hogan.js/lib/template").Template)(function(e,t,r){var n=this;return n.b(r=r||""),n.b("<div class='yvp-ads-overlay yvp-vis-hidden'></div>"),n.b("\n"),n.fl()});t.exports={render:function(){return n.render.apply(n,arguments)},r:function(){return n.r.apply(n,arguments)},ri:function(){return n.ri.apply(n,arguments)}}},{"hogan.js/lib/template":141}],53:[function(e,t,r){"use strict";function n(e,t){var r=this;r.k=e,r.m=t,r.Ts=r.m.rootElem.querySelector(".yvp-bottom-bar"),r.Us=r.m.rootElem.querySelector(".yvp-slider"),r.k.subscribe(a.CONTROLS_BAR_CHANGE,r.Vs,r)}t.exports=n;var i=e("../util"),a=e("../event"),o=e("./ads-overlay.html");n.prototype.create=function(){var e=this;return e.node=i.render(o),e.node},n.prototype.Vs=function(e){var t,r=this,n=r.Ts&&r.Ts.offsetHeight||0,i=r.m.rootElem.offsetHeight;t=e?i-n:i,r.node.style.height=t+"px"},n.prototype.destroy=function(){var e=this;e.node=null}},{"../event":"/nextgen/src/event.js","../util":"/nextgen/src/util.js","./ads-overlay.html":52}],54:[function(e,t,r){var n=new(e("hogan.js/lib/template").Template)(function(e,t,r){var n=this;return n.b(r=r||""),n.b("<div class='yvp-ads-view-default'>"),n.b("\n"+r),n.s(n.f("showAdInfo",e,t,1),e,t,0,54,330,"{{ }}")&&(n.rs(e,t,function(e,t,n){n.b("    <div class='yvp-ads-default-header'>"),n.b("\n"+r),n.b("        <span class='yvp-ads-default-indicator'>"),n.b(n.v(n.f("adLabel",e,t,0))),n.b("</span>"),n.b("\n"+r),n.b("        <span class='yvp-ads-default-counter yvp-ads-view-counter'></span>"),n.b("\n"+r),n.b("        <span class='yvp-ads-default-progress yvp-ads-view-progress'></span>"),n.b("\n"+r),n.b("    </div>"),n.b("\n")}),e.pop()),n.b("</div>"),n.b("\n"),n.fl()});t.exports={render:function(){return n.render.apply(n,arguments)},r:function(){return n.r.apply(n,arguments)},ri:function(){return n.ri.apply(n,arguments)}}},{"hogan.js/lib/template":141}],55:[function(e,t,r){var n=new(e("hogan.js/lib/template").Template)(function(e,t,r){var n=this;return n.b(r=r||""),n.b("<div class='yvp-ads-view-gemini'>"),n.b("\n"+r),n.b("    <span class='yvp-ads-gemini-indicator'>"),n.b(n.v(n.f("adLabel",e,t,0))),n.b("</span>"),n.b("\n"+r),n.b("    <div class='yvp-ads-gemini-header'>"),n.b("\n"+r),n.b('        <div class="yvp-ads-sponsor-info">'),n.b("\n"+r),n.b("            <span class='yvp-ads-gemini-sponsorname yvp-ads-gemini-meta'>"),n.b(n.v(n.f("sponsorName",e,t,0))),n.b("</span>"),n.b("\n"+r),n.b("            <span class='yvp-ads-gemini-cta yvp-ads-view-cta'>"),n.b(n.v(n.f("callToAction",e,t,0))),n.b("</span>"),n.b("\n"+r),n.b("        </div>"),n.b("\n"+r),n.b("        <span class='yvp-ads-gemini-headline yvp-ads-gemini-meta'>"),n.b(n.v(n.f("headline",e,t,0))),n.b("</span>"),n.b("\n"+r),n.b("    </div>"),n.b("\n"+r),n.b("</div>"),n.b("\n"),n.fl()});t.exports={render:function(){return n.render.apply(n,arguments)},r:function(){return n.r.apply(n,arguments)},ri:function(){return n.ri.apply(n,arguments)}}},{"hogan.js/lib/template":141}],56:[function(e,t,r){var n=new(e("hogan.js/lib/template").Template)(function(e,t,r){var n=this;return n.b(r=r||""),n.b("<div class='yvp-ads-view'></div>"),n.b("\n"),n.fl()});t.exports={render:function(){return n.render.apply(n,arguments)},r:function(){return n.r.apply(n,arguments)},ri:function(){return n.ri.apply(n,arguments)}}},{"hogan.js/lib/template":141}],57:[function(e,t,r){"use strict";function n(e,t,r){var n=this;n.k=e,n.m=t,n.Ws=t.getContentNode(),n.Xs=t.getMainElement(),n.l=r,n.Ys||(n.Ys=n.Gq(),n.Xs.appendChild(n.Ys),n.Zs())}t.exports=n;var i=e("../yvap/common/Constants"),a=e("../event"),o=e("../util"),s=e("../strings"),l=e("../../../lib"),c=e("../tap"),u=e("./ads-view.html"),p=e("./ads-view-gemini.html"),d=e("./ads-view-default.html"),f="More";n.prototype.reset=function(e){var t=this,r=e&&e.adObj,n=r&&r.params;if(t.$s(),!e||!r)return void t._s(!1);var l,u=r.adFormat;switch(u){case i.GEMINI_AD:case i.STANDALONE_GEMINI_NATIVE:var v=n&&n.headline,m=n&&n.sponsorName,y=n&&n.callToAction||f;l=v&&m?o.render(p,{adLabel:s.i18n.ADV_SHORT,headline:v,sponsorName:m,callToAction:y}):o.render(d,{showAdInfo:t.at(),adLabel:s.i18n.ADV_SHORT});break;default:l=o.render(d,{showAdInfo:t.at(),adLabel:s.i18n.ADV_SHORT})}return l?(t.Ys.appendChild(l),e.ctaUrl?(l.classList.add("yvp-ads-gemini-click"),t.bt=new c(l,function(){var e,r=t.l.playbackState&&t.l.playbackState.ad;r&&(r.playbackProgress&&(e=r.playbackProgress),t.k.publish(a.AD_VIEW_CLICK,e))})):l.classList.remove("yvp-ads-gemini-click"),t.ct=l,void t._s(!0)):void t._s(!1)},n.prototype.Zs=function(){var e=this;e._l=[],e._l.push(e.k.subscribe(a.UPDATE_AD_COUNT,e.dt,e)),e._l.push(e.k.subscribe(a.AD_PLAYBACK_PROGRESS,e.B,e)),e.ft=new c(e.Ys,function(t){var r=o.classList(e.Ws).contains("yvp-hide-controls");r&&(t.stopImmediatePropagation(),window.setTimeout(function(){e.m.toggleControlsVisibility()},10))},!1)},n.prototype.at=function(){var e=this,t=!0,r=e.l.YVAP,n=r&&r.standaloneAd&&(r.standaloneAd.xml||r.standaloneAd.gemini);return n&&(t=!1,r.standaloneAd.showAdSlug===!0&&(t=!0)),t},n.prototype.$s=function(){var e=this;e.bt&&(e.bt.destroy(),e.bt=null),e.ct&&e.ct.parentNode&&(e.ct.parentNode.removeChild(e.ct),e.ct=null)},n.prototype.Gq=function(){return o.render(u)},n.prototype._s=function(e){var t=this;t.Ws&&(e?t.Ws.classList.add("yvp-adsview-show"):t.Ws.classList.remove("yvp-adsview-show"))},n.prototype.dt=function(e,t,r){var n=this;if(n.ct){var i=n.ct.querySelector(".yvp-ads-view-counter");i&&!l.isNullOrUndefined(t)&&!l.isNullOrUndefined(r)&&r>1&&(i.innerHTML+=" "+t+" of "+r)}},n.prototype.B=function(e,t,r){var n=this;if(n.ct){var i=n.ct.querySelector(".yvp-ads-view-progress");if(i&&l.isNumber(t)&&l.isNumber(r)){var a=Math.round(r-t);if(a>0){var c=a>1?s.i18n.NUM_SECONDS:s.i18n.NUM_SECOND;i.innerHTML=o.strSubstitute(c,{"num-seconds":a})}else i.innerHTML=""}}},n.prototype.destroy=function(){var e=this;e.Ys&&e.Ys.parentNode&&(e.Ys.parentNode.removeChild(e.Ys),e.Ys=null),e._l&&e._l.length&&(e._l.forEach(function(e){e()}),e._l=[]),e.ft&&(e.ft.destroy(),e.ft=null)}},{"../../../lib":"/lib/index.js","../event":"/nextgen/src/event.js","../strings":"/nextgen/src/strings.js","../tap":"/nextgen/src/tap.js","../util":"/nextgen/src/util.js","../yvap/common/Constants":99,"./ads-view-default.html":54,"./ads-view-gemini.html":55,"./ads-view.html":56}],58:[function(e,t,r){var n=new(e("hogan.js/lib/template").Template)(function(e,t,r){var n=this;return n.b(r=r||""),n.b("<div class='yvp-agegate-container "),n.s(n.f("isBirthday",e,t,1),e,t,0,49,69,"{{ }}")&&(n.rs(e,t,function(e,t,r){r.b("yvp-agegate-birthday")}),e.pop()),n.b("'>"),n.b("\n"+r),n.b("    <img class='yvp-agegate-back-image' src='"),n.b(n.v(n.f("imageSrc",e,t,0))),n.b("' width='"),n.b(n.v(n.f("width",e,t,0))),n.b("' height='"),n.b(n.v(n.f("height",e,t,0))),n.b("'>"),n.b("\n"+r),n.b("    <div class='yvp-agegate-info-wrapper'>"),n.b("\n"+r),n.b("        <h3 class='yvp-agegate-title'>"),n.b(n.v(n.f("title",e,t,0))),n.b("</h3>"),n.b("\n"+r),n.b("        <p class='yvp-agegate-desc'>"),n.b(n.v(n.f("desc",e,t,0))),n.b("</p>"),n.b("\n"+r),n.b("        <div class='yvp-agegate-action-wrapper'>"),n.b("\n"+r),n.s(n.f("isBirthday",e,t,1),e,t,0,406,830,"{{ }}")&&(n.rs(e,t,function(e,t,n){n.b("                <p class='yvp-agegate-input'>"),n.b("\n"+r),n.b("                    <input type='text' name='month' class='yvp-agegate-date-input' maxlength='2' placeholder='MM'>"),n.b("\n"+r),n.b("                    <input type='text' name='day' class='yvp-agegate-date-input' maxlength='2' placeholder='DD'>"),n.b("\n"+r),n.b("                    <input type='text' name='year' class='yvp-agegate-date-input' maxlength='4' placeholder='YYYY'>"),n.b("\n"+r),n.b("                </p>"),n.b("\n")}),e.pop()),n.s(n.f("isBlock",e,t,1),e,t,1,0,0,"")||(n.b("                <button class='yvp-agegate-btn'>"),n.b(n.v(n.f("button",e,t,0))),n.b("</button>"),n.b("\n")),n.b("        </div>"),n.b("\n"+r),n.b("    </div>"),n.b("\n"+r),n.b("</div>"),n.b("\n"),n.fl()});t.exports={render:function(){return n.render.apply(n,arguments)},r:function(){return n.r.apply(n,arguments)},ri:function(){return n.ri.apply(n,arguments)}}},{"hogan.js/lib/template":141}],59:[function(e,t,r){"use strict";function n(e,t){var r=this;r.k=e,r.tc=t}t.exports=n;var i=e("../util"),a=e("../tap"),o=e("./age-gate-screen.html");n.prototype.create=function(e){var t=this;if(t.node=i.render(o,e),t.gt=e,t.ht=t.node.querySelector(".yvp-agegate-btn"),t.gt.isBirthday){var r=t.node.querySelectorAll(".yvp-agegate-date-input");t.jt="month"===r[0].name?r[0]:null,t.kt="day"===r[1].name?r[1]:null,t.mt="year"===r[2].name?r[2]:null}return t.nt(),t.node},n.prototype.nt=function(){var e=this;e.gt.isBlock||(e.ot=new a(e.ht),e.qt=function(t){t.stopPropagation();var r=e.gt.isBirthday&&{inputMonth:e.jt,inputDay:e.kt,inputYear:e.mt};e.tc.handleClickEvent(t,r)},e.ht.addEventListener("tap",e.qt)),e.gt.isBirthday&&(e.De=function(t){e.tc.filterNonDigitInput(t)},e.jt.addEventListener("keydown",e.De),e.kt.addEventListener("keydown",e.De),e.mt.addEventListener("keydown",e.De))},n.prototype.tt=function(){var e=this;e.gt.isBlock||(e.ot.destroy(),e.ht.removeEventListener("tap",e.qt)),e.gt.isBirthday&&(e.jt.removeEventListener("keydown",e.De),e.kt.removeEventListener("keydown",e.De),e.mt.removeEventListener("keydown",e.De))},n.prototype.getNode=function(){var e=this;return e.node},n.prototype.destroy=function(){var e=this;e.tt(),e.node=null}},{"../tap":"/nextgen/src/tap.js","../util":"/nextgen/src/util.js","./age-gate-screen.html":58}],60:[function(e,t,r){var n=new(e("hogan.js/lib/template").Template)(function(e,t,r){var n=this;return n.b(r=r||""),n.b("<div tabindex='0' class='yvp-content yvp-hide-controls' aria-label='Yahoo Video Player'>"),n.b("\n"+r),n.b("    <div class='yvp-main' tabindex='0'></div>"),n.b("\n"+r),n.b("    <div class='yvp-docked-meta'>"),n.b("\n"+r),n.b('        <div class="yvp-docked-title"></div>'),n.b("\n"+r),n.b('        <div class="yvp-docked-provider"></div>'),n.b("\n"+r),n.b("    </div>"),n.b("\n"+r),n.b("</div>"),n.b("\n"),n.fl()});t.exports={render:function(){return n.render.apply(n,arguments)},r:function(){return n.r.apply(n,arguments)},ri:function(){return n.ri.apply(n,arguments)}}},{"hogan.js/lib/template":141}],61:[function(e,t,r){var n=new(e("hogan.js/lib/template").Template)(function(e,t,r){var n=this;return n.b(r=r||""),n.b("<div class='yvp-cc-options-more close'>"),n.b("\n"+r),n.b("    <div class='yvp-cc-back'>"),n.b("\n"+r),n.b("         <div class='yvp-settings-caret-icon left'></div>"),n.b("\n"+r),n.b("         <div class='yvp-cc-back-header'>"),n.b(n.v(n.d("strings.BACK",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("    </div>"),n.b("\n"+r),n.b('    <div class="yvp-tab-container">'),n.b("\n"+r),n.b('        <ul class="yvp-tabs-nav">'),n.b("\n"+r),n.b('            <li class="yvp-tab tab-selected">'),n.b(n.v(n.d("strings.PRESETS",e,t,0))),n.b("</li>"),n.b("\n"+r),n.b('            <li class="yvp-tab">'),n.b(n.v(n.d("strings.TEXT",e,t,0))),n.b("</li>"),n.b("\n"+r),n.b('            <li class="yvp-tab">'),n.b(n.v(n.d("strings.BACKGROUND",e,t,0))),n.b("</li>"),n.b("\n"+r),n.b('            <li class="yvp-tab">'),n.b(n.v(n.d("strings.EFFECTS",e,t,0))),n.b("</li>"),n.b("\n"+r),n.b("        </ul>"),n.b("\n"+r),n.b('        <div class="yvp-tabs-content">'),n.b("\n"+r),n.b('            <div class="yvp-tabcontent preset-container tab-show">'),n.b("\n"+r),n.b('                <div class="yvp-cc-preset">Aa</div>'),n.b("\n"+r),n.b('                <div class="yvp-cc-preset">Aa</div>'),n.b("\n"+r),n.b('                <div class="yvp-cc-preset">Aa</div>'),n.b("\n"+r),n.b('                <div class="yvp-cc-preset">Aa</div>'),n.b("\n"+r),n.b('                <div class="yvp-cc-preset">Aa</div>'),n.b("\n"+r),n.b('                <div class="yvp-cc-preset">Aa</div>'),n.b("\n"+r),n.b('                <div class="yvp-cc-preset">Aa</div>'),n.b("\n"+r),n.b('                <div class="yvp-cc-preset">Aa</div>'),n.b("\n"+r),n.b("            </div>"),n.b("\n"+r),n.b('            <div class="yvp-tabcontent font-list">'),n.b("\n"+r),n.b('                <div class="yvp-colorpicker fontcolorpicker"></div>'),n.b("\n"+r),n.b("            </div>"),n.b("\n"+r),n.b('            <div class="yvp-tabcontent bg-opacity-list">'),n.b("\n"+r),n.b('                <div class="yvp-colorpicker bgcolorpicker"></div>'),n.b("\n"+r),n.b("            </div>"),n.b("\n"+r),n.b('            <div class="yvp-tabcontent effects">'),n.b("\n"+r),n.b('                <div class="yvp-effect none">'),n.b("\n"+r),n.b("                    <p>Aa</p>"),n.b("\n"+r),n.b("                    <div class='yvp-cc-effect-header'>"),n.b(n.v(n.d("strings.PLAIN",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("                </div>"),n.b("\n"+r),n.b('                <div class="yvp-effect dropshadow">'),n.b("\n"+r),n.b("                    <p>Aa</p>"),n.b("\n"+r),n.b("                    <div class='yvp-cc-effect-header'>"),n.b(n.v(n.d("strings.SHADOW",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("                </div>"),n.b("\n"+r),n.b('                <div class="yvp-effect raised">'),n.b("\n"+r),n.b("                    <p>Aa</p>"),n.b("\n"+r),n.b("                    <div class='yvp-cc-effect-header'>"),n.b(n.v(n.d("strings.RAISED",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("                </div>"),n.b("\n"+r),n.b('                <div class="yvp-effect depressed">'),n.b("\n"+r),n.b("                    <p>Aa</p>"),n.b("\n"+r),n.b("                    <div class='yvp-cc-effect-header'>"),n.b(n.v(n.d("strings.LOWERED",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("                </div>"),n.b("\n"+r),n.b('                <div class="yvp-effect uniform">'),n.b("\n"+r),n.b("                    <p>Aa</p>"),n.b("\n"+r),n.b("                    <div class='yvp-cc-effect-header'>"),n.b(n.v(n.d("strings.OUTLINE",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("                </div>"),n.b("\n"+r),n.b("            </div>"),n.b("\n"+r),n.b("        </div>"),n.b("\n"+r),n.b("    </div>"),n.b("\n"+r),n.b('    <div class="yvp-cc-style-preview">'),n.b("\n"+r),n.b('        <div class="yvp-cc-options-message">'),n.b(n.v(n.d("strings.CC_PREVIEW_MESSAGE",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("    </div>"),n.b("\n"+r),n.b("</div>"),n.b("\n"),n.fl()});t.exports={render:function(){return n.render.apply(n,arguments)},r:function(){return n.r.apply(n,arguments)},ri:function(){return n.ri.apply(n,arguments)}}},{"hogan.js/lib/template":141}],62:[function(e,t,r){var n=new(e("hogan.js/lib/template").Template)(function(e,t,r){var n=this;return n.b(r=r||""),n.b("<div class='yvp-cc-options-main close'>"),n.b("\n"+r),n.b("    <div class='yvp-cc-back-to-settings'>"),n.b("\n"+r),n.b("        <div class='yvp-settings-caret-icon left'></div>"),n.b("\n"+r),n.b("        <div class='yvp-back-to-settings'>"),n.b(n.v(n.d("strings.BACK",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("    </div>"),n.b("\n"+r),n.b("\n"+r),n.b("    <div class='yvp-cc-box'>"),n.b("\n"+r),n.b("        <div class='yvp-cc-header yvp-cc-item'>"),n.b(n.v(n.d("strings.CC",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("        <div class='yvp-cc-toggle'>"),n.b("\n"+r),n.b("            <div data-cc-state='on' class='yvp-settings-item yvp-cc-on'>"),n.b(n.v(n.d("strings.ON",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("            <div data-cc-state='off' class='yvp-settings-item yvp-cc-off'>"),n.b(n.v(n.d("strings.OFF",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("        </div>"),n.b("\n"+r),n.b("        <div class='yvp-cc-header yvp-cc-item'>"),n.b(n.v(n.d("strings.LANGUAGE",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("        <div class='yvp-cc-language yvp-cc-item'></div>"),n.b("\n"+r),n.b("    </div>"),n.b("\n"+r),n.b("\n"+r),n.b("    <div class='yvp-cc-divider yvp-cc-position-size-divider'></div>"),n.b("\n"+r),n.b("    <div class='yvp-cc-box yvp-cc-position-size-ctn'>"),n.b("\n"+r),n.b("        <div class='yvp-cc-position yvp-cc-item'>"),n.b("\n"+r),n.b("            <div class='yvp-cc-header yvp-cc-item'>"),n.b(n.v(n.d("strings.POSITION",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("            <div class='yvp-cc-pos-wrapper'>"),n.b("\n"+r),n.b("                <ul class='yvp-cc-pos-selection'></ul>"),n.b("\n"+r),n.b("            </div>"),n.b("\n"+r),n.b("        </div>"),n.b("\n"+r),n.b("        <div class='yvp-cc-size yvp-cc-item'>"),n.b("\n"+r),n.b("            <div class='yvp-cc-header yvp-cc-item'>"),n.b(n.v(n.d("strings.CC_TYPE_SIZE",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("            <div class='yvp-cc-size-selector'>"),n.b("\n"+r),n.b("                <div class='yvp-cc-size-indicators'>"),n.b("\n"+r),n.b("                    <div class='yvp-cc-indicator yvp-cc-indicator-0' data-size-value='0'>A</div>"),n.b("\n"+r),n.b("                    <div class='yvp-cc-indicator yvp-cc-indicator-25' data-size-value='25'>A</div>"),n.b("\n"+r),n.b("                    <div class='yvp-cc-indicator yvp-cc-indicator-50' data-size-value='50'>A</div>"),n.b("\n"+r),n.b("                    <div class='yvp-cc-indicator yvp-cc-indicator-75' data-size-value='75'>A</div>"),n.b("\n"+r),n.b("                    <div class='yvp-cc-indicator yvp-cc-indicator-100' data-size-value='100'>A</div>"),n.b("\n"+r),n.b("                </div>"),n.b("\n"+r),n.b("            </div>"),n.b("\n"+r),n.b("        </div>"),n.b("\n"+r),n.b("    </div>"),n.b("\n"+r),n.b("\n"+r),n.b("    <div class='yvp-cc-divider yvp-cc-style-preview-divider'></div>"),n.b("\n"+r),n.b("    <div class='yvp-cc-box yvp-cc-style-preview-ctn'>"),n.b("\n"+r),n.b("        <div class='yvp-cc-style yvp-cc-item'>"),n.b("\n"+r),n.b("            <div class='yvp-cc-style-preview'>Aa</div>"),n.b("\n"+r),n.b("            <div class='yvp-cc-style-more'>"),n.b("\n"+r),n.b("                <div class='yvp-cc-item'>"),n.b(n.v(n.d("strings.STYLE_OPTIONS",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("                <div class='yvp-settings-caret-icon right'></div>"),n.b("\n"+r),n.b("            </div>"),n.b("\n"+r),n.b("        </div>"),n.b("\n"+r),n.b("\n"+r),n.b("        <div class='yvp-cc-feedback-link yvp-cc-item'>"),n.b("\n"+r),n.b("            <a href='http://info.yahoo.com/legal/us/yahoo/cc/en-us/' target='_blank'>"),n.b("\n"+r),n.b("                <div class='yvp-cc-item'>"),n.b(n.v(n.d("strings.SUBMIT_FEEDBACK",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("            </a>"),n.b("\n"+r),n.b("        </div>"),n.b("\n"+r),n.b("        <div class='yvp-cc-preview'>"),n.b("\n"+r),n.b("            <div class='yvp-cc-preview-message'>"),n.b(n.v(n.d("strings.CC_PREVIEW_MESSAGE",e,t,0))),
n.b("</div>"),n.b("\n"+r),n.b("        </div>"),n.b("\n"+r),n.b("    </div>"),n.b("\n"+r),n.b("</div>"),n.b("\n"),n.fl()});t.exports={render:function(){return n.render.apply(n,arguments)},r:function(){return n.r.apply(n,arguments)},ri:function(){return n.ri.apply(n,arguments)}}},{"hogan.js/lib/template":141}],63:[function(e,t,r){"use strict";function n(e,t){var r=this;r.k=e,r.l=t,r.k.subscribe(u.CC.FONT_SIZE_CHANGE,r.ut,r),r.k.subscribe(u.CC.FETCHED,r.vt,r),r.k.subscribe(u.CC.LANGUAGE_CHANGE,r.wt,r),r.k.subscribe(u.CC.TOGGLE,r.xt,r),r.k.subscribe(u.CC.USER_STYLE_PREFERENCES_CHANGE,r.M,r),r.k.subscribe(u.CC.FONT_FACE_CHANGE,r.yt,r),r.k.subscribe(u.CC.BG_OPACITY_CHANGE,r.zt,r),r.k.subscribe(u.CC.TOGGLE_SIMPLE_MODE,r.At,r),r.k.subscribe(u.PLAYBACK_STARTED,r.M,r)}t.exports=n;var i=e("../states"),a=e("../strings"),o=e("../util"),s=e("../../../lib"),l=e("../tap"),c=e("../cc"),u=e("../event"),p=e("../constants"),d=e("../views/uiwidgets/drop-down-menu"),f=e("../views/uiwidgets/slider"),v=e("./cc-options.html"),m=e("./cc-more-options.html"),y="data-cc-state",h=["on","off"],E=["bottom","top"],g={0:16,25:20,50:24,75:28,100:32},b="yvp-settings-activated",_="yvp-cc-preview-activated",A="yvp-cc-preview-",T="top",S="on",I={Font:"font",Background:"bg"};n.prototype.render=function(){var e=this;return e.node=o.render(v,{strings:a.i18n}),e.ccMoreOptionsNode=o.render(m,{strings:a.i18n}),e.Bt(),e.Ct(),e.nt(),e.Dt=[e.node,e.ccMoreOptionsNode],e.Et=0,e.Dt},n.prototype.At=function(e){var t=this;t.node&&(e?t.node.classList.add("yvp-cc-options-simple"):t.node.classList.remove("yvp-cc-options-simple"))},n.prototype.wt=function(e,t){var r=this;if(e&&t&&!(t.length<0)){var n=c.prototype.getLanguageForCode.call(null,e||r.l.userPreferences.closedCaptions.lang);r.Ft&&r.Ft.syncData({selected:n,items:t?t.map(function(e){return c.prototype.getLanguageForCode.call(null,e)}):null,itemsData:t})}},n.prototype.M=function(){function e(e,t,n,i){var a=e.querySelectorAll(t);Array.prototype.forEach.call(a,function(e){r.l.userPreferences.closedCaptions[i]===e.val?o.classList(e).add(n):o.classList(e).remove(n)})}var t,r=this;for(var n in g)if(g.hasOwnProperty(n)&&g[parseInt(n)]===r.l.userPreferences.closedCaptions.fontSize){t=n;break}var i=r.Gt.querySelector(".yvp-cc-indicator-"+t);i&&o.classList(i).add("size-active"),e(r.Ht,".color-option","color-selected","fontColor"),e(r.It,".color-option","color-selected","bgColor"),e(r.Jt,".yvp-effect","effect-selected","fontEffect"),e(r.Kt,".yvp-settings-item",b,"ccPos"),r.Lt=r.Kt.querySelector("."+b),r.Mt.syncData({items:[],itemsData:[],selected:r.Nt(r.l.userPreferences.closedCaptions.fontName).name}),r.Ot.syncData({items:[],itemsData:[],selected:r.Pt(100*r.l.userPreferences.closedCaptions.bgOpacity)}),r.Qt.setValue(t,!0),r.Rt()},n.prototype.Bt=function(){var e=this;e.St(),e.Tt(),e.Ut(),e.Vt(),e.Wt()},n.prototype.St=function(){var e=this,t=e.l.userPreferences.closedCaptions.show;e.Xt=e.node.querySelector(".yvp-cc-toggle"),e.Yt=[],h.forEach(function(r){var n=e.Xt.querySelector(".yvp-cc-"+r),i=r===S;(t&&i||!t&&!i)&&(o.classList(n).add(b),e.Zt=n),e.Yt.push(n)})},n.prototype.Tt=function(){var e=this;if(e.$t=e.node.querySelector(".yvp-cc-language"),e.l.userPreferences.closedCaptions&&e.l.userPreferences.closedCaptions.lang){var t={selected:c.prototype.getLanguageForCode.call(null,e.l.userPreferences.closedCaptions.lang),items:null,noItemsText:a.i18n.NO_ITEM_AVAILABLE};e.Ft=new d(p.DDM_CSS_SETTINGS,t,e.k),e.$t.appendChild(e.Ft.create()),e.k.publish(u.CC.REQUEST_UI_DATA_FOR_MEDIA_ITEM,e.l.playlist.getCurrentItem())}},n.prototype.vt=function(e){var t=this,r="top"===t.l.userPreferences.closedCaptions.ccPos;t.wt(e.selectedLang,e.langList),t.xt(t.l.userPreferences.closedCaptions.show),t.k.publish(u.CC.POSITION_CHANGE,r)},n.prototype.Ut=function(){var e,t,r=this,n=r.node.querySelector(".yvp-cc-size-selector"),i={wrapper:"yvp-slider-wrapper",track:"yvp-slider-track",handle:"yvp-slider-handle",anchor:"yvp-slider-anchor"},a={anchors:5,minValue:0,maxValue:100,initialValue:r.l.userPreferences.closedCaptions.fontSize},s=[];r.Qt=new f(i,a,r.k),n.appendChild(r.Qt.create()),r._t=r.node.querySelectorAll(".yvp-slider-anchor");var c=r._t.length;for(e=0;e<c;e++){var u=r._t[e].style.left.trim();s.push(parseFloat(u))}r.au=function(e){var t=e.target,n=t.getAttribute("data-size-value")||"";switch(n){case"0":r.Qt.setValue(s[0]);break;case"25":r.Qt.setValue(s[1]);break;case"50":r.Qt.setValue(s[2]);break;case"75":r.Qt.setValue(s[3]);break;case"100":r.Qt.setValue(s[4])}Array.prototype.forEach.call(r.Gt.children,function(e){o.classList(e).remove("size-active")}),o.classList(t).add("size-active")},r.Gt=r.node.querySelector(".yvp-cc-size-indicators"),r.bu=[];var p=r.Gt.children.length;for(t=0;t<p;t++)r.bu[t]=new l(r.Gt.children[t]),r.Gt.children[t].addEventListener("tap",r.au)},n.prototype.Rt=function(){var e=this,t=o.cssHexToRgb(e.l.userPreferences.closedCaptions.bgColor)||{r:0,g:0,b:0};Array.prototype.forEach.call(e.cu,function(r){r.style.fontSize=e.l.userPreferences.closedCaptions.fontSize,r.style.fontFamily=e.l.userPreferences.closedCaptions.fontName,r.style.color=e.l.userPreferences.closedCaptions.fontColor,r.style.textShadow=O[e.l.userPreferences.closedCaptions.fontEffect],r.style.backgroundColor="rgba("+t.r+","+t.g+","+t.b+","+e.l.userPreferences.closedCaptions.bgOpacity+")"}),e.l.getState()!==i.INIT&&e.k.publish(u.CC.SAVE_TO_LOCAL_STORAGE,{ccSettings:e.l.userPreferences.closedCaptions})},n.prototype.yt=function(e){for(var t=this,r=0;r<N.length;r++)if(N[r].name===e){t.l.userPreferences.closedCaptions.fontName=e,t.k.publish(u.CC.UPDATE_STYLE,"font: "+e),t.Rt();break}},n.prototype.zt=function(e){var t=this;t.l.userPreferences.closedCaptions.bgOpacity=e/100,t.k.publish(u.CC.UPDATE_STYLE,"opacity: "+e),t.Rt()},n.prototype.Nt=function(e){for(var t=0;t<N.length;t++)if(N[t].name===e)return N[t];return N[3]},n.prototype.eu=function(){var e=this,t=e.ccMoreOptionsNode.querySelector(".font-list"),r=N.map(function(e){return e.name}),n=e.Nt(e.l.userPreferences.closedCaptions.fontName),i={selected:n.name,items:r,noItemsText:a.i18n.NO_ITEM_AVAILABLE};e.Mt=new d(p.DDM_CSS_SETTINGS,i,e.k),t.insertBefore(e.Mt.create(),t.querySelector(".fontcolorpicker")),e.Mt.registerEvent(u.CC.FONT_FACE_CHANGE)},n.prototype.Pt=function(e){return 100===e?e+"% (opaque)":e+"% (transparency)"},n.prototype.fu=function(){var e=this,t=e.ccMoreOptionsNode.querySelector(".bg-opacity-list"),r=100*e.l.userPreferences.closedCaptions.bgOpacity,n={selected:100===r?r+"% (opaque)":r+"% (transparency)",items:P.map(e.Pt),itemsData:P,noItemsText:a.i18n.NO_ITEM_AVAILABLE};e.Ot=new d(p.DDM_CSS_SETTINGS,n,e.k),t.insertBefore(e.Ot.create(),t.querySelector(".bgcolorpicker")),e.Ot.registerEvent(u.CC.BG_OPACITY_CHANGE)},n.prototype.Ct=function(){var e=this;e.Ht=e.ccMoreOptionsNode.querySelector(".fontcolorpicker"),e.It=e.ccMoreOptionsNode.querySelector(".bgcolorpicker"),e.Jt=e.ccMoreOptionsNode.querySelector(".yvp-tabcontent:nth-child(4)"),e.iu(),e.ju(),e.eu(),e.fu(),e.ku()},n.prototype.iu=function(){for(var e=this,t=e.ccMoreOptionsNode.querySelectorAll(".yvp-cc-preset"),r=0;r<t.length;r++){var n=t[r];n.presetIndex=r,n.style.color=C[r].fontColor,n.style.backgroundColor=C[r].bgColor}},n.prototype.ju=function(){function e(e,t,r){for(var n,i=0;i<e.length;i++)n=document.createElement("div"),o.classList(n).add("color-option"),n.style.backgroundColor=e[i].color,n.val=e[i].color,"transparent"===e[i].color&&o.classList(n).add("nocolor"),n.colorpickerType=r,t.appendChild(n)}var t=this;e(L,t.Ht,I.Font),e(R,t.It,I.Background)},n.prototype.ku=function(){for(var e=this,t=e.Jt.querySelectorAll(".yvp-effect"),r=0;r<t.length;r++){var n=t[r];n.val=D[r].name}},n.prototype.Vt=function(){var e=this;e.cu=[e.node,e.ccMoreOptionsNode].map(function(e){return e.querySelector(".yvp-cc-style-preview")}),this.Rt()},n.prototype.Wt=function(){var e=this;e.Kt=e.node.querySelector(".yvp-cc-pos-selection"),e.lu=[];var t="top"===e.l.userPreferences.closedCaptions.ccPos,r=document.createDocumentFragment();E.forEach(function(n){var i=document.createElement("li");o.classList(i).add("yvp-settings-item"),o.classList(i).add("yvp-cc-position-"+n),i.setAttribute("cc-pos-data",n),i.val=n;var s;s=document.createTextNode(a.i18n[n.toUpperCase()]),(t&&n===T||!t&&n!==T)&&(o.classList(i).add(b),e.Lt=i),e.lu.push(i),i.appendChild(s),r.appendChild(i)}),e.Kt.appendChild(r)},n.prototype.nt=function(){var e=this;e.mu(),e.nu(),e.ou(),e.pu(),e.qu(),e.su()},n.prototype.tt=function(){var e=this;e.tu(),e.uu(),e.vu(),e.wu(),e.xu(),e.yu(),e.zu()},n.prototype.xt=function(e){var t=this,r=t.Xt.querySelector(".yvp-cc-"+(e?"on":"off"));o.classList(r).contains(b)||(o.classList(t.Zt).remove(b),o.classList(r).add(b),t.Zt=r)},n.prototype.mu=function(){var e=this;e.Au=[],e.Bu=function(t){var r=t.target.getAttribute(y)===S;e.k.publish(u.CC.UI_TOGGLE,r,!0)},e.Yt.forEach(function(t){var r=new l(t);e.Au.push(r),t.addEventListener("tap",e.Bu)})},n.prototype.tu=function(){var e=this;e.Au.forEach(function(e){e.destroy()}),e.Yt.forEach(function(t){t.removeEventListener("tap",e.Bu)})},n.prototype.nu=function(){var e=this;e.Ft&&e.Ft.registerEvent(u.CC.LANGUAGE_CHANGE)},n.prototype.uu=function(){var e=this;e.Ft.destroy()},n.prototype.ou=function(){var e=this;e.Qt.registerEvent(u.CC.FONT_SIZE_CHANGE)},n.prototype.ut=function(e){var t=this,r=g[e];t.l.userPreferences.closedCaptions.fontSize=r,t.l.getState()!==i.INIT&&(t.k.publish(u.CC.UPDATE_STYLE,"size: "+e),t.k.publish(u.CC.SAVE_TO_LOCAL_STORAGE,{ccSettings:t.l.userPreferences.closedCaptions})),t.Cu()},n.prototype.vu=function(){for(var e=this,t=0;t<e.Gt.children.length;t++)e.Gt.children[t].removeEventListener("tap",e.au);e.Qt.destroy()},n.prototype.su=function(){var e=this;e.Du=e.node.querySelector(".yvp-cc-feedback-link"),e.Eu=new l(e.Du),e.Fu=function(t){e.l.playbackState;e.l.isPaused()||e.k.publish(u.TOGGLE_PLAY_PAUSE)},e.Du.addEventListener("tap",e.Fu)},n.prototype.zu=function(){var e=this;e.Eu.destroy()},n.prototype.pu=function(){var e=this;e.Gu=function(t){e.Et=1,o.classList(e.Dt[0]).remove("open"),o.classList(e.Dt[0]).add("close"),o.classList(e.Dt[1]).remove("close"),o.classList(e.Dt[1]).add("open"),e.M()},e.Hu=function(t){e.Et=0,o.classList(e.Dt[1]).remove("open"),o.classList(e.Dt[1]).add("close"),o.classList(e.Dt[0]).remove("close"),o.classList(e.Dt[0]).add("open")},e.Iu=e.node.querySelector(".yvp-cc-style-more"),e.Ju=new l(e.Iu),e.Iu.addEventListener("tap",e.Gu),e.Ku=e.ccMoreOptionsNode.querySelector(".yvp-cc-back"),e.Lu=new l(e.Ku),e.Ku.addEventListener("tap",e.Hu),e.Mu(),e.Nu(),e.Ou(),e.Pu()},n.prototype.wu=function(){var e=this;e.Iu&&e.Ju&&(e.Ju.destroy(),e.Iu.removeEventListener("tap",e.Gu)),e.Ku&&e.Lu&&(e.Lu.destroy(),e.Ku.removeEventListener("tap",e.Hu)),e.Qu&&e.Ru&&(e.Ru.destroy(),e.Qu.removeEventListener("tap",e.Su)),e.Tu&&e.Tu(),e.Uu&&e.Uu(),e.Vu&&e.Vu(),e.Mt.destroy(),e.Ot.destroy()},n.prototype.Wu=function(e){var t=this,r=e.getAttribute("cc-pos-data")===T;o.classList(t.Lt).remove(b),o.classList(e).add(b),t.Lt=e,t.k.publish(u.CC.POSITION_CHANGE,r),t.l.userPreferences.closedCaptions.ccPos=r?"top":"bottom",t.k.publish(u.CC.SAVE_TO_LOCAL_STORAGE,{ccSettings:t.l.userPreferences.closedCaptions})},n.prototype.qu=function(){var e=this;e.Xu=[],e.Yu=function(t){var r=t.target;e.Wu(r)},e.lu.forEach(function(t){var r=new l(t);e.Xu.push(r),t.addEventListener("tap",e.Yu)})},n.prototype.xu=function(){var e=this;e.Xu.forEach(function(e){e.destroy()}),e.lu.forEach(function(t){t.removeEventListener("tap",e.Wu)})},n.prototype.Cu=function(e){var t=this,r=t.node.querySelector(".yvp-cc-preview"),n=t.l.userPreferences.closedCaptions,i=A+e,a=600;e&&(o.classList(r).remove(t.Zu),o.classList(r).add(i),t.Zu=i),r.style.fontSize=n.fontSize+"px",r.style.color=n.fontColor,r.style.backgroundColor=n.bgColor,r.style.fontFamily=n.fontName,o.classList(r).add(_),t.$u&&clearTimeout(t.$u),t.$u=setTimeout(function(){o.classList(r).remove(_),t.$u=null},a)},n.prototype.Mu=function(){var e=this;e.Su=function(t){var r=t.eventTarget||t.eventSource;if(t.currentTarget!==r&&!o.classList(r).contains("preset-separator")){var n=r.presetIndex;if(s.isNumber(n)){var i=C[n];e.l.userPreferences.closedCaptions.fontColor=i.fontColor,e._u(i.bgColor),e.Cu(),e.k.publish(u.CC.USER_STYLE_PREFERENCES_CHANGE),e.k.publish(u.CC.SAVE_TO_LOCAL_STORAGE,{ccSettings:e.l.userPreferences.closedCaptions})}}},e.Qu=e.ccMoreOptionsNode.querySelector(".preset-container"),e.Ru=new l(e.Qu),e.Qu.addEventListener("tap",e.Su)},n.prototype.Nu=function(){var e=this,t=function(e){var t=e.eventTarget||e.eventSource;e.currentTarget!==t&&(Array.prototype.forEach.call(i,function(e,n){t===e?(o.classList(e).add("tab-selected"),o.classList(r[n]).add("tab-show")):(o.classList(e).remove("tab-selected"),o.classList(r[n]).remove("tab-show"))}),e.stopPropagation())},r=e.ccMoreOptionsNode.querySelectorAll(".yvp-tabcontent"),n=e.ccMoreOptionsNode.querySelector(".yvp-tabs-nav"),i=n.querySelectorAll(".yvp-tab"),a=new l(n);n.addEventListener("tap",t),e.Tu=function(){a.destroy(),n.removeEventListener("tap",t)}},n.prototype.Ou=function(){var e=this,t=function(t){var r=t.eventTarget||t.eventSource;r.colorpickerType===I.Font?e.l.userPreferences.closedCaptions.fontColor=r.val:r.colorpickerType===I.Background&&e._u(r.val),e.Cu(),e.k.publish(u.CC.USER_STYLE_PREFERENCES_CHANGE),e.k.publish(u.CC.SAVE_TO_LOCAL_STORAGE,{ccSettings:e.l.userPreferences.closedCaptions})},r=new l(e.Ht);e.Ht.addEventListener("tap",t);var n=new l(e.It);e.It.addEventListener("tap",t),e.Uu=function(){r.destroy(),e.Ht.removeEventListener("tap",t),n.destroy(),e.It.removeEventListener("tap",t)}},n.prototype._u=function(e){var t=this,r=t.l.userPreferences.closedCaptions;r.bgColor=e,"transparent"===e?r.bgOpacity=0:0===r.bgOpacity&&(r.bgOpacity=.75),t.av(e)},n.prototype.av=function(e){var t=this,r=t.ccMoreOptionsNode.querySelector(".bg-opacity-list"),n=r.querySelector(".yvp-ddm-selected-wrapper");"transparent"===e?o.classList(n).add("hide"):o.classList(n).remove("hide")},n.prototype.Pu=function(){var e=this,t=function(t){var r=t.eventTarget||t.eventSource,n=r.parentNode.val;n&&(e.l.userPreferences.closedCaptions.fontEffect=n,e.Cu(),e.k.publish(u.CC.USER_STYLE_PREFERENCES_CHANGE),e.k.publish(u.CC.SAVE_TO_LOCAL_STORAGE,{ccSettings:e.l.userPreferences.closedCaptions}))},r=new l(e.Jt);e.Jt.addEventListener("tap",t),e.Vu=function(){r.destroy(),e.Jt.removeEventListener("tap",t)}},n.prototype.yu=function(){var e=this;e.$u&&(clearTimeout(e.$u),e.$u=null)},n.prototype.showHideCurrentNode=function(e){var t=this;o.showHide(t.Dt[t.Et],e)},n.prototype.destroy=function(){var e=this;e.tt(),e.node=null,e.ccMoreOptionsNode=null};var L=[{color:"#E7E7E7",name:"grey"},{color:"#000000",name:"black"},{color:"#FC2525",name:"red"},{color:"#29FD2F",name:"green"},{color:"#2CFEFE",name:"turquoise"},{color:"#EC369C",name:"pink"},{color:"#FEF149",name:"yellow"},{color:"#2524FB",name:"blue"}],R=[{color:"transparent",name:"none"},{color:"#eaeaea",name:"grey1"},{color:"#c7c7c7",name:"grey2"},{color:"#919191",name:"grey3"},{color:"#5b5b5b",name:"grey4"},{color:"#000000",name:"black"},{color:"#29FD2F",name:"green"},{color:"#2424FB",name:"blue"},{color:"#2CFDFD",name:"turquoise"},{color:"#EC359B",name:"pink"},{color:"#FDF048",name:"yellow"},{color:"#FC2424",name:"red"}],C=[{fontColor:"#cdcdcd",bgColor:"#060606"},{fontColor:"#282828",bgColor:"#c8c8c8"},{fontColor:"#fef149",bgColor:"#0a0908"},{fontColor:"#cdcdcd",bgColor:"transparent"},{fontColor:"#29fd2f",bgColor:"#0a0908"},{fontColor:"#ec369c",bgColor:"#0a0a09"},{fontColor:"#2cfefe",bgColor:"#0a0a09"},{fontColor:"#29fd2f",bgColor:"transparent"}],D=[{name:"none"},{name:"dropshadow"},{name:"raised"},{name:"depressed"},{name:"uniform"}],O={none:"",dropshadow:"2px 1px 1px rgba(0, 0, 0, 1)",raised:"3px 3px 4px rgba(0, 0, 0, 0.75)",depressed:"0px -4px 4px rgba(0, 0, 0, 0.54)",uniform:"-2px -2px 0 #000, -2px 2px 0 #000, -2px 0 0 #000, 2px -2px 0 #000, 2px 2px 0 #000, 2px 0 0 #000, 0 -2px 0 #000, 0 2px 0 #000"},N=[{name:"Georgia",fontFamily:"Georgia, serif"},{name:"Palatino Linotype",fontFamily:'"Palatino Linotype", "Book Antiqua", Palatino, serif'},{name:"Times New Roman",fontFamily:'"Times New Roman", Times, serif'},{name:"Arial",fontFamily:"Arial, Helvetica, sans-serif"},{name:"Arial Black",fontFamily:'"Arial Black", Gadget, sans-serif'},{name:"Comic Sans MS",fontFamily:'"Comic Sans MS", cursive, sans-serif'},{name:"Impact",fontFamily:"Impact, Charcoal, sans-serif"},{name:"Lucida Sans Unicode",fontFamily:'"Lucida Sans Unicode", "Lucida Grande", sans-serif'},{name:"Tahoma",fontFamily:"Tahoma, Geneva, sans-serif"},{name:"Trebuchet MS",fontFamily:'"Trebuchet MS", Helvetica, sans-serif'},{name:"Verdana",fontFamily:"Verdana, Geneva, sans-serif"},{name:"Courier New",fontFamily:'"Courier New", Courier, monospace'},{name:"Lucida Console",fontFamily:'"Lucida Console", Monaco, monospace'}],P=[100,75,50,25]},{"../../../lib":"/lib/index.js","../cc":"/nextgen/src/cc.js","../constants":7,"../event":"/nextgen/src/event.js","../states":46,"../strings":"/nextgen/src/strings.js","../tap":"/nextgen/src/tap.js","../util":"/nextgen/src/util.js","../views/uiwidgets/drop-down-menu":86,"../views/uiwidgets/slider":87,"./cc-more-options.html":61,"./cc-options.html":62}],64:[function(e,t,r){var n=new(e("hogan.js/lib/template").Template)(function(e,t,r){var n=this;return n.b(r=r||""),n.b("<div>"),n.b("\n"+r),n.b("    <div class='yvp-top-bar yvp-vis-hidden'>"),n.b("\n"+r),n.b("        <div class='yvp-content-type hide'></div>"),n.b("\n"+r),n.b("    </div>"),n.b("\n"+r),n.b("    <div class='yvp-playing-item-title-header yvp-vis-hidden'></div>"),n.b("\n"+r),n.b("    <div class='yvp-playing-item-title yvp-vis-hidden'></div>"),n.b("\n"+r),n.b("    <a class='yvp-provider-logo yvp-vis-hidden' target='_blank' aria-hidden='true'>"),n.b("\n"+r),n.b("        <img class='yvp-provider-logo-img' />"),n.b("\n"+r),n.b("    </a>"),n.b("\n"+r),n.b("    <div class='yvp-bottom-bar yvp-vis-hidden'>"),n.b("\n"+r),n.b("        <div class='yvp-bottom-container'>"),n.b("\n"+r),n.b("            <div class='yvp-slider' role='slider' tabindex='0'>"),n.b("\n"+r),n.b("                <div class='yvp-slider-extension' aria-hidden='true'></div>"),n.b("\n"+r),n.b("                <div class='yvp-handle'>"),n.b("\n"+r),n.b('                    <div class="yvp-handle-touch-target"></div>'),n.b("\n"+r),n.b("                </div>"),n.b("\n"+r),n.b("                <div class='yvp-buffer-bar'></div>"),n.b("\n"+r),n.b("                <div class='yvp-playback-bar'></div>"),n.b("\n"+r),n.b("                <div class='yvp-visual-seek'>"),n.b("\n"+r),n.b("                    <div class='yvp-vs-thumbnail'></div>"),n.b("\n"+r),n.b("                    <div class='yvp-vs-time'></div>"),n.b("\n"+r),n.b("                </div>"),n.b("\n"+r),n.b("            </div>"),n.b("\n"+r),n.b("            <div class='yvp-play-controls'>"),n.b("\n"+r),n.b("                <div class='yvp-play-btn' role='button' tabindex='0'></div>"),n.b("\n"+r),n.b("                <div class='yvp-upnext-container hide'>"),n.b("\n"+r),n.b("                    <div class='yvp-upnext-btn' role='button'>"),n.b("\n"+r),n.b("                    </div>"),n.b("\n"+r),n.b("                    <div class='yvp-upnext-playlist' role='dialog'>"),n.b("\n"+r),n.b("                        <div class='yvp-hover-elem'></div>"),n.b("\n"+r),n.b("                    </div>"),n.b("\n"+r),n.b("                </div>"),n.b("\n"+r),n.b("                <div class='yvp-time-container' tabindex='-1' aria-hidden='true'>"),n.b("\n"+r),n.b("                    <div class='yvp-current-time yvp-pb-time'></div>"),n.b("\n"+r),n.b("                    <div class='yvp-total-time yvp-pb-time'></div>"),n.b("\n"+r),n.b("                </div>"),n.b("\n"+r),n.b("            </div>"),n.b("\n"+r),n.b("            <div class='yvp-menu-controls'>"),n.b("\n"+r),n.b("                <div class='yvp-airplay-btn button yvp-hidden' role='button' tabindex='0' aria-label='"),n.b(n.v(n.d("strings.AIRPLAY",e,t,0))),n.b("'></div>"),n.b("\n"+r),n.b("                <div class='yvp-multiaudio-btn button yvp-hidden' role='button' tabindex='0' aria-label='"),n.b(n.v(n.d("strings.MULTI_AUDIO",e,t,0))),n.b("'></div>"),n.b("\n"+r),n.b("                <div class='yvp-cc-btn button hide' role='button' tabindex='0' aria-label='"),n.b(n.v(n.d("strings.CC",e,t,0))),n.b("'></div>"),n.b("\n"+r),n.b("                <div class='yvp-volume-btn button' role='button' tabindex='0'></div>"),n.b("\n"+r),n.b("                <div class='yvp-fullscreen-btn button' role='button' tabindex='0'></div>"),n.b("\n"+r),n.b("            </div>"),n.b("\n"+r),n.b("        </div>"),n.b("\n"+r),n.b("    </div>"),n.b("\n"+r),n.b("    <div class='yvp-multi-audio yvp-hidden'></div>"),n.b("\n"+r),n.b("    <div class='yvp-object-overlay yvp-vis-hidden'></div>"),n.b("\n"+r),n.b("</div>"),n.b("\n"),n.fl()});t.exports={render:function(){return n.render.apply(n,arguments)},r:function(){return n.r.apply(n,arguments)},ri:function(){return n.ri.apply(n,arguments)}}},{"hogan.js/lib/template":141}],65:[function(e,t,r){"use strict";function n(e,t,r){var n=this;n.k=e,n.m=t,n.l=r,n.bv=[],n.cv=!1,n.ev=!1,n.fv=null,n.hv=!0,n.k.subscribe(i.MEDIA_ITEM_LOADED,n.D,n),n.k.subscribe(i.PLAYBACK_PROGRESS,n.A,n),n.k.subscribe(i.AD_PLAYBACK_PROGRESS,n.A,n),n.k.subscribe(i.CAST.PLAYBACK_PROGRESS,n.A,n),n.k.subscribe(i.Ad.PLAYING,n.gm,n),n.k.subscribe(i.Ad.ENDED,n.jv,n),n.k.subscribe(i.Ad.CANCELED,n.jv,n),n.k.subscribe(i.CC.SHOW_CONTROLS,n.Gi,n),n.k.subscribe(i.CC.UI_TOGGLE,n.kv,n),n.k.subscribe(i.CC.TOGGLE,n.kv,n),n.k.subscribe(i.CC.REMOVED,function(){n.hv=!1}),n.k.subscribe(i.CAST.CAPTION_AVAILABILITY_CHANGED,n.Gi,n),n.k.subscribe(i.PLAYBACK_STARTED,n.Kf,n),n.k.subscribe(i.AD_PLAYBACK_STARTED,n.u,n),n.k.subscribe(i.RELATED_ITEM_CLICK,n.$d,n),n.k.subscribe(i.CONTROLS_BAR_CHANGE,n.mv,n),n.k.subscribe(i.FULLSCREEN_CHANGE,function(){n.nv(n.m.getFullscreen())}),n.k.subscribe(i.CONTROLS_SET_VOLUME,function(e){n.ov(e)}),n.k.subscribe(i.CAST.VOLUME_CHANGED,function(e){n.ov(e)}),n.k.subscribe(i.CONTROLS_SET_MUTE,function(e){n.ov(n.l.getVolume(),e)}),n.k.subscribe(i.CAST.MUTE_CHANGED,function(e){n.ov(n.l.getVolume(),e)}),n.k.subscribe(i.API.AIRPLAY_AVAILABILITY_CHANGE,function(e){n.pv&&o.classList(n.pv)[e?"remove":"add"]("yvp-hidden")}),n.k.subscribe(i.API.AIRPLAY_CONNECTION_STATE_CHANGE,function(e){n.pv&&o.classList(n.pv)[e.connected?"add":"remove"]("yvp-airplay-on")})}t.exports=n;var i=e("../event"),a=e("../tap"),o=e("../util"),s=e("../../../lib"),l=e("user-agent").userAgent,c=e("../strings"),u=e("../navigator-info"),p=e("./yahoo-controls"),d=e("./controls.html"),f=e("./multi-audio.html"),v="end-screen",m=6e3,y=300,h=5e3,E="on";n.prototype.create=function(){var e,t=this;s.isFunction(p)?(t.qv=new p(t.k,t.m,t.l),e=t.qv.create()):e={providerLogo:o.render(d).querySelector(".yvp-provider-logo"),multiAudioList:o.render(d).querySelector(".yvp-multi-audio"),bottomBar:o.render(d).querySelector(".yvp-bottom-bar"),topBar:o.render(d,{strings:c.i18n}).querySelector(".yvp-top-bar"),titleBar:o.render(d).querySelector(".yvp-playing-item-title")},t.qm=e.bottomBar,t.rv=t.qm.querySelector(".yvp-slider"),t.uv=t.qm.querySelector(".yvp-buffer-bar"),t.vv=t.qm.querySelector(".yvp-time-container"),t.wv=t.qm.querySelector(".yvp-current-time"),t.xv=t.qm.querySelector(".yvp-total-time"),t.yv=t.qm.querySelector(".yvp-handle"),t.zv=t.qm.querySelector(".yvp-playback-bar"),t.Av=t.qm.querySelector(".yvp-play-btn"),t.Bv=t.qm.querySelector(".yvp-seek"),t.Cv=t.qm.querySelector(".yvp-visual-seek"),t.Dv=t.qm.querySelector(".yvp-cc-btn"),t.pv=t.qm.querySelector(".yvp-airplay-btn"),t.Ev=t.qm.querySelector(".yvp-fullscreen-btn"),t.Fv=t.qm.querySelector(".yvp-volume-btn"),t.Gv=t.qm.querySelector(".yvp-volume-bar-container"),t.Hv=t.qm.querySelector(".yvp-volume-level"),t.Iv=t.qm.querySelector(".yvp-volume-bar"),t.Jv=t.qm.querySelector(".yvp-volume-value"),t.Kv=t.qm.querySelector(".yvp-volume-handle"),t.Lv=e.multiAudioList||t.qm.querySelector(".yvp-multi-audio"),t.Mv=t.qm.querySelector(".yvp-multiaudio-btn"),t.Nv=e.providerLogo,t.Ov=e.titleBar,t.Pv=t.qm.parentNode.querySelector(".yvp-playing-item-title-header"),t.Qv=e.topBar,t.bp=t.Qv&&t.Qv.querySelector(".yvp-content-type"),t.Rv=t.l.ui.showTitleOnHover;var r=t.Ev&&l.ie&&l.ie<=10&&o.isIFrame();if(r=r||!t.l.ui.showFullscreen){var n=document.createElement("div");o.classList(n).add("yvp-fullscreen-btn-replacement"),t.Ev.parentNode.insertBefore(n,t.Ev),t.Ev.parentNode.removeChild(t.Ev),t.Ev=null}return u.airplaySupported&&!t.l.disableCasting||(t.pv.parentNode.removeChild(t.pv),t.pv=null,delete t.pv),t.Sv(),t.Pg(),t.Dv&&(t.qv?t.qv.createCCBtnTooltip(t.Dv):!l.mobile||l.chrome&&u.hasNativeAutoplaySupport||(t.Dv.style.display="none")),e},n.prototype.gm=function(){var e=this;e.Tv(),e.Uv()},n.prototype.u=function(){var e=this;e.Vv(),o.classList(e.bp).add("hide")},n.prototype.jv=function(){var e=this;e.Wv()},n.prototype.Kf=function(){var e=this;e._?e.Xv():e.Yv(),e.Vv(),e.Zv(),e.$v(),e.Lv&&e._v()},n.prototype.$v=function(){var e=this,t=e.Nv,r=e.Nv.querySelector(".yvp-provider-logo-img"),n=e.l.playlist.getCurrentItem(),i=n.provider,a=i.providerLogoUrl,s=i.providerUrl;a?(o.classList(t).remove("yvp-hide"),r.setAttribute("src",a),t.setAttribute("href",s),e.aw()):o.classList(t).add("yvp-hide")},n.prototype.aw=function(){var e=this,t=e.Nv,r=e.l.ui.logoOverlay,n="yvp-provider-logo-"+r;o.classList(t).add(n)},n.prototype.bw=function(e){var t=this;!t.l.playback.autoplay||t.m.isDocked()&&t.l.ui.docking.showInfoCard||(o.classList(t.Ov).add("yvp-title-standard"),t.cw(!0),t.ew=setTimeout(function(){o.classList(t.Ov).add("yvp-hide"),t.fw(e)},m))},n.prototype.Zv=function(){var e=this;e.ew&&clearTimeout(e.ew),e.fv=e.l.playlist.getCurrentItem().header,e.gw(),o.classList(e.Ov).remove("yvp-title-standard"),o.classList(e.Ov).remove("yvp-secondary"),o.classList(e.Ov).remove("yvp-hide"),e.fv&&e.Pv&&(o.classList(e.Pv).remove("yvp-title-header-standard"),o.classList(e.Pv).remove("yvp-hide"));var t=e.l.ui.showTitleOnStart||"";switch(t){case"fadeoutall":e.bw(!0);break;case"standard":e.bw(!1)}},n.prototype.gw=function(){var e=this,t=e.l.playlist.getCurrentItem();e.hw(),e.Ov.innerHTML=t&&t.title},n.prototype.hw=function(){var e=this,t=e.Pv;if(!e.iw())return void(t&&""!==t.innerHTML&&(t.innerHTML="",o.classList(t).add("yvp-hide")));var r=e.fv,n=r.open_label||r.label||"";t.innerHTML=e.jw(n)},n.prototype.cw=function(e){var t=this;if(t.iw()){var r=o.classList(t.Pv);r.remove("yvp-hide"),r.add("yvp-title-header-standard"),o.classList(t.Ov).add("yvp-secondary"),e?r.add("yvp-title-shown"):r.remove("yvp-title-shown")}},n.prototype.fw=function(e){var t=this;if(t.kw&&clearTimeout(t.kw),t.lw&&clearTimeout(t.lw),t.iw()){var r=t.Pv,n=o.classList(r);n.remove("yvp-title-shown"),n.add("yvp-hide");var i=t.fv,a=i.label||"";t.kw=setTimeout(function(){r.innerHTML=t.jw(a),n.remove("yvp-hide"),e&&(t.lw=setTimeout(function(){r.innerHTML="",n.add("yvp-hide")},h))},y)}},n.prototype.iw=function(){var e=this;return e.Pv&&e.fv},n.prototype.jw=function(e){if(!e||""===e)return"";var t=this,r=t.l&&t.l.playbackState&&t.l.playbackState.loadedItem?t.l.playbackState.loadedItem.getHeaderIcon("original"):null,n=r&&r.url?'<img class="yvp-playlist-icon header" src="'+r.url+'">':"",i=/\*\*([^\*]+(\s[^\*]+)*)\*\*/gi;return n+e.replace(i,"<strong>$1</strong>")},n.prototype.mv=function(e){var t=this;!t.Rv||t.m.isDocked()&&t.l.ui.docking.showInfoCard||(e?t.mw():(t.nw(),o.classList(t.yv).remove("active"),o.classList(t.rv).remove("yvp-thick-slider"),t.Tv()))},n.prototype.mw=function(){var e=this;o.classList(e.Ov).add("yvp-title-standard"),o.classList(e.Ov).remove("yvp-hide"),e.cw(!0)},n.prototype.nw=function(){var e=this;o.classList(e.Ov).add("yvp-title-standard"),o.classList(e.Ov).add("yvp-hide"),e.cw(!1)},n.prototype.Xv=function(){var e=this;o.classList(e.rv).add("yvp-disable"),o.classList(e.vv).add("yvp-hide");var t=e.l.ui.contentTypeLabel;s.isString(t)&&""!==t?(e.bp.innerHTML=t,e.bp.setAttribute("aria-label",t),o.classList(e.bp).remove("hide"),o.classList(e.Ov).add("yvp-live")):e.ow&&"live"===e.ow&&(e.bp.innerHTML=c.i18n.LIVE,e.bp.setAttribute("aria-label",c.i18n.LIVE),o.classList(e.bp).remove("hide"),o.classList(e.Ov).add("yvp-live"))},n.prototype.Yv=function(){var e=this;o.classList(e.rv).remove("yvp-disable"),o.classList(e.vv).remove("yvp-hide"),o.classList(e.Ov).remove("yvp-live")},n.prototype.Pg=function(){var e=this;e.pw=new a(e.Av),e.qw=function(t){t.stopPropagation();var r=e.m.getCurrentViewState(),n=e.l.playlist.getCurrentItem().id,a=e.l.isPaused()?"ctrl-play-btn":"ctrl-pause-btn";r===v?(e.k.publish(i.RELATED_ITEM_CLICK,n,-1,!1,!1),e.rw()):(e.k.publish(i.API.UI_INTERACT,{srcElement:a}),e.k.publish(i.TOGGLE_PLAY_PAUSE))},e.Av.addEventListener("tap",e.qw),e.Ev&&(e.sw=new a(e.Ev),e.tw=function(t){t.stopPropagation(),e.m.toggleFullscreen(),e.k.publish(i.API.UI_INTERACT,{srcElement:"ctrl-fullscr-btn"})},e.Ev.addEventListener("tap",e.tw)),e.uw=new a(e.qm),e.vw=function(e){e.stopPropagation()},e.qm.addEventListener("tap",e.vw),e.pv&&(e.ww=new a(e.pv,function(){e.m.showAirplayTargetMenu(),e.k.publish(i.API.UI_INTERACT,{srcElement:"ctrl-airplay-btn"})})),e.Mv&&(e.xw=new a(e.Mv,function(){o.classList(e.Lv).remove("yvp-hidden"),e.k.publish(i.API.UI_INTERACT,{srcElement:"ctrl-multi-audio-btn"})})),e.Dv&&(e.yw=new a(e.Dv,function(t){if(t.stopPropagation(),e.hv){var r=o.classList(e.Dv).contains(E),n=!r,a=!(!e.l.castState||!e.l.castState.connected),s="cc-"+(n?"on":"off")+(a?"-cast":"");e.k.publish(i.API.UI_INTERACT,{srcElement:s}),e.k.publish(i.CC.UI_TOGGLE,n,!0)}})),e.Wv(),e.zw()},n.prototype.kv=function(e){var t=this;e?(o.classList(t.Dv).add(E),t.Aw(c.i18n.CAPTIONS_ON)):(o.classList(t.Dv).remove(E),t.Aw(c.i18n.CAPTIONS_OFF)),t.hv||t.Aw(c.i18n.CAPTIONS_NOT_AVAILABLE)},n.prototype.Gi=function(e){var t=this;t.hv=e,e?(o.classList(t.Dv).remove("hide"),t.Aw(c.i18n.CAPTIONS_AVAILABLE)):(o.classList(t.Dv).add("hide"),t.Aw(c.i18n.CAPTIONS_NOT_AVAILABLE))},n.prototype.Aw=function(e){var t=this;t.qv&&t.qv.updateCCTooltip(e)},n.prototype.$d=function(){var e=this;e.rw(),e.gw()},n.prototype.rw=function(){var e=this;e.wv.innerHTML="0:00",e.xv.innerHTML="0:00"},n.prototype.nv=function(e){var t=this;t.Ev&&(e?(o.classList(t.Ev).add("fullscreen"),t.Bw(c.i18n.EXIT_FULLSCREEN)):(o.classList(t.Ev).remove("fullscreen"),t.Bw(c.i18n.FULLSCREEN_SPACE))),t.Cw(e),t.syncAriaState()},n.prototype.Bw=function(e){var t=this;if(t.Ev){var r=t.Ev.querySelector(".yvp-tooltip-content");r&&(r.innerHTML=e)}},n.prototype.Wv=function(){var e=this;e.Bv&&(e.Dw=new a(e.Bv),e.Ew=function(t){t.stopPropagation();var r=t.clientX||t.touches&&t.touches[0]&&t.touches[0].clientX||t.pageX,n=r-e.Bv.getBoundingClientRect().left,i=n/e.Bv.clientWidth,a=Math.min(i*e.Fw,Math.max(e.Fw-1,0));e.m.seek(a)},e.Bv.addEventListener("tap",e.Ew)),e.Gw=function(t){e.k.publish(i.SEEK_BAR_MOUSEOVER,t),o.classList(e.yv).add("active"),o.classList(e.rv).add("yvp-thick-slider"),e.Hw(t),e.Iw(t)},e.Jw=function(t){e.k.publish(i.SEEK_BAR_MOUSEOUT,t),o.classList(e.yv).remove("active"),o.classList(e.rv).remove("yvp-thick-slider"),e.Tv(t),e.Iw(t)},e.Kw(e.rv,e.Gw,e.Jw),e.Lw=function(t){if(!isNaN(e.Fw)){o.classList(e.yv).add("active"),e.Iw(t),e.gk=!0,e.k.publish(i.CONTROLS_SEEK_START);var r=e.Mw(t),n=Math.min(r*e.Fw,Math.max(e.Fw-1,0));e.k.publish(i.CTRL_SEEK,Math.round(n)),e.Nw(t)}},e.Nw=function(t){if(e.gk){e.Iw(t),o.classList(e.qm).add("yvp-drag"),o.classList(e.yv).add("active"),o.classList(e.rv).add("yvp-thick-slider"),e.Hw(t);var r=e.Mw(t),n=Math.min(r*e.Fw,Math.max(e.Fw-1,0));n=n>1?n:1,e.zv.setAttribute("style","width: "+100*r+"%;"),e.uv.setAttribute("style","width: 0%;"),e.yv.setAttribute("style","left: "+100*r+"%;"),e.k.publish(i.CONTROLS_SEEKING,n)}},e.Ow=function(t){e.gk&&(o.classList(e.qm).remove("yvp-drag"),o.classList(e.yv).remove("active"),o.classList(e.rv).remove("yvp-thick-slider"),e.Tv(t),e.Iw(t),e.gk=!1,e.k.publish(i.CONTROLS_SEEK_END))},e.Pw(e.rv,e.Lw,e.Nw,e.Ow)},n.prototype.Uv=function(){
var e=this;e.Qw(e.rv,e.Gw,e.Jw),e.Rw(e.rv,e.Lw,e.Nw,e.Ow)},n.prototype.Iw=function(e){e.type.indexOf("touch")!==-1&&e.preventDefault()},n.prototype.D=function(e){var t=this;t._=e.isLive(),t.ow=e.liveState,t.bp.innerHTML="",t.bp.setAttribute("aria-label",""),o.classList(t.bp).add("hide"),t._?t.Xv():t.Yv()},n.prototype.A=function(e,t,r,n){var i=this;void 0!==r&&i.Fw!==r&&(i.Fw=r),n&&i.Sw(n),void 0!==t&&(i.Hd(t),i.Pp=t)},n.prototype.Hd=function(e){var t=this,r=t.Fw,n=e/t.Fw*100;t.wv&&s.isNumber(e)&&s.isNumber(t.Fw)&&(r-=e,t.wv.innerHTML=o.formatTime(e)),t.xv&&s.isNumber(t.Fw)&&(t.xv.innerHTML=o.formatTime(t.Fw)),s.isNumber(e)&&s.isNumber(t.Fw)&&(t.zv.setAttribute("style","width: "+n+"%;"),t.gk||t.yv.setAttribute("style","left: "+n+"%;"),t.rv.setAttribute("aria-valuemax",t.Fw),t.rv.setAttribute("aria-valuenow",e),t.rv.setAttribute("aria-valuetext",o.formatTime(e)+" of "+o.formatTime(t.Fw)))},n.prototype.Sw=function(e){var t=this,r=0;e.length>0&&(r=e.end(0)/t.Fw*100),t.uv.setAttribute("style","width: "+r+"%;")},n.prototype.Hw=function(e){var t=this,r=t.l.playlist.getCurrentItem().visualSeek;if(0!==Object.keys(r).length){var n,i=t.Mw(e);n=i<.09?.09:i>.91?.91:i,t.Cv.style.display="block",t.Cv.style.left=100*n+"%";var a=i*t.Fw;t.Cv.querySelector(".yvp-vs-time").innerHTML=o.formatTime(a);var s=10,l=10,c=s*l,u=Math.ceil(Math.floor(a)/r.frequency),p=r.images[Math.floor(u/c)];if(p){var d=u%c,f=d%l,v=Math.floor(d/l),m=f*r.width,y=v*r.height,h=t.Cv.querySelector(".yvp-vs-thumbnail");h.style.width=r.width+"px",h.style.height=r.height+"px",h.style.background="url('"+p.url+"')",h.style.backgroundPosition="-"+m+"px -"+y+"px"}}},n.prototype.Pw=function(e,t,r,n){["mousedown","touchstart"].forEach(function(r){e.addEventListener(r,t)}),["mousemove","touchmove"].forEach(function(e){document.addEventListener(e,r)}),["mouseup","touchend"].forEach(function(e){document.addEventListener(e,n)})},n.prototype.Rw=function(e,t,r,n){["mousedown","touchstart"].forEach(function(r){e.removeEventListener(r,t)}),["mousemove","touchmove"].forEach(function(e){document.removeEventListener(e,r)}),["mouseup","touchend"].forEach(function(e){document.removeEventListener(e,n)})},n.prototype.Kw=function(e,t,r){["mouseenter","touchstart"].forEach(function(r){e.addEventListener(r,t)}),["mousemove","touchmove"].forEach(function(r){e.addEventListener(r,t)}),["mouseleave","touchend"].forEach(function(t){e.addEventListener(t,r)})},n.prototype.Qw=function(e,t,r){["mouseenter","touchstart"].forEach(function(r){e.removeEventListener(r,t)}),["mousemove","touchmove"].forEach(function(r){e.removeEventListener(r,t)}),["mouseleave","touchend"].forEach(function(t){e.removeEventListener(t,r)})},n.prototype.Vv=function(){var e=this;e.Fv&&e.ov(e.l.getVolume(),e.l.getMute())},n.prototype.Tw=function(){var e=this;e.Uw=new a(e.Fv),e.Vw=function(t){var r;e.Ww||(t.stopPropagation(),e.Xw(),e.m.clearAutoHideTimeout(),e.Yw&&clearTimeout(e.Yw),r=!e.l.getMute(),e.k.publish(i.API.UI_INTERACT,{srcElement:"ctrl-mute-btn-"+(r?"on":"off")}),e.k.publish(i.CONTROLS_SET_MUTE,r),e.Zw(r))},e.Fv.addEventListener("tap",e.Vw)},n.prototype.$w=function(){var e=this;e.ax=function(t){var r,n=e.m.getFullscreen()&&(l.chrome||l.safari);return r=n?t.pageY-o.getOffsetTopFromEl(e.Hv,"yvp-main"):t.pageY-o.getOffsetTopFromDocument(e.Hv),e.Hv.getBoundingClientRect().top?1-Math.max(0,Math.min(1,r/e.Hv.clientHeight)):1},e.cx=new a(e.Hv),e.dx=function(t){t.stopPropagation(),e.Xw(),e.ex(t)},e.fx=function(t){e.l.getMute()!==t&&(e.k.publish(i.API.UI_INTERACT,{srcElement:"ctrl-mute-btn-"+(t?"on":"off")}),e.k.publish(i.CONTROLS_SET_MUTE,t))},e.ex=function(t){var r=e.ax(t);e.fx(0===r),e.k.publish(i.CONTROLS_SET_VOLUME,r)},e.Gv.addEventListener("tap",e.dx),e.gx=function(t){e.Iw(t),e.Ww=!0,e.Xw(),e.hx(t)},e.hx=function(t){e.Ww&&(e.Iw(t),e.Xw(),e.ex(t),e.ix(t))},e.jx=function(t){e.Ww&&(e.Iw(t),e.Ww=!1)},e.Pw(e.Hv,e.gx,e.hx,e.jx)},n.prototype.Zw=function(e){var t=this;t.l.ui.ccOnMute&&(e?t.k.publish(i.CC.UI_TOGGLE,!0,!1):t.k.publish(i.CC.UI_TOGGLE,!1,!1))},n.prototype.Xw=function(){var e=this;e.Kv&&(e.kx&&clearTimeout(e.kx),o.classList(e.Kv).add("show"))},n.prototype.lx=function(){var e=this;e.Yw=null,e.mx=!1,e.ix=function(t){e.Iw(t),o.classList(e.Gv).add("open"),e.mx||(e.Vv(),e.mx=!0),e.Xw(),e.k.publish(i.VOLUME_HOVER)},e.nx=function(t){e.Iw(t),e.Yw&&clearTimeout(e.Yw),e.Yw=setTimeout(function(){o.classList(e.Gv).remove("open")},500)},e.ox=function(t){e.Iw(t),e.Yw&&clearTimeout(e.Yw)},e.Kw(e.Fv,e.ix,e.nx),e.Kw(e.Gv,e.ox,e.nx)},n.prototype.zw=function(){var e=this;e.Fv&&e.Tw(),e.Gv&&e.Fv&&(e.$w(),e.lx()),e.Lv&&(e.px=new a(e.Lv,function(t){t.stopPropagation();var r=o.findClosest(t.eventTarget,".yvp-audio-item",e.Lv);if(!r)return void("close"===t.eventTarget.getAttribute("data-action")&&o.classList(e.Lv).add("yvp-hidden"));var n=e.Lv.querySelector(".yvp-audio-item-selected"),a=n.getAttribute("data-name");n&&o.classList(n).remove("yvp-audio-item-selected"),o.classList(r).add("yvp-audio-item-selected"),e.k.publish(i.CONTROLS_AUDIO_CHANGE,r.getAttribute("data-name"),a)}))},n.prototype.qx=function(){var e=this;e.Fv&&(e.Uw.destroy(),e.Fv.removeEventListener("tap",e.Vw)),e.Gv&&(e.cx.destroy(),e.Gv.removeEventListener("tap",e.dx),e.Rw(e.Gv,e.gx,e.hx,e.jx),e.Qw(e.Fv,e.ix,e.nx),e.Qw(e.Gv,e.ox,e.nx))},n.prototype.rx=function(e){var t=this,r=t.m.getContentNode();t.Fv&&(e?(o.classList(t.Fv).add("muted"),o.classList(r).add("yvp-muted")):(o.classList(t.Fv).remove("muted"),o.classList(r).remove("yvp-muted"))),t.syncAriaState()},n.prototype.sx=function(e){var t=this;if(t.Iv){var r=Math.ceil(100*(1-e)),n=100-r;t.Iv.setAttribute("style","height:"+r+"%"),t.Jv.setAttribute("style","height:"+n+"%")}if(t.Kv){var i=Math.ceil((1-(1===e?.99:e))*(t.Hv.clientHeight-t.Kv.offsetHeight));i>0&&(i=i<=3?0:i,t.Kv.setAttribute("style","top:"+i+"px"))}},n.prototype.ov=function(e,t){var r=this;s.isNullOrUndefined(t)?r.rx(!e):(r.rx(t),e=t?0:e),r.sx(e)},n.prototype._v=function(){var e=this,t=e.l.playlist.getCurrentItem().isMultiAudioAvailable();t?(e.tx(),o.classList(e.Gv).add("yvp-multi-audio-available"),e.Mv&&o.classList(e.Mv).remove("yvp-hidden")):(o.classList(e.Gv).remove("yvp-multi-audio-available"),e.Mv&&o.classList(e.Mv).add("yvp-hidden"),e.Lv.innerHTML="")},n.prototype.tx=function(){var e=this,t=o.render(f,{isMobile:l.mobile,items:e.l.playlist.getCurrentItem().languages});e.Lv.appendChild(t)},n.prototype.Mw=function(e){var t=this,r=e.clientX||e.touches&&e.touches[0]&&e.touches[0].clientX||e.pageX,n=r-t.rv.getBoundingClientRect().left,i=n/t.rv.clientWidth;return Math.max(0,Math.min(1,i))},n.prototype.Tv=function(){var e=this;e.Cv.style.display="none"},n.prototype.Cw=function(e){var t=this,r=t.m.getContentNode(),n=t.m.isStreamMode()||t.m.isMiniStreamMode(),i=t.m.isMiniStreamMode()?"yvp-ministream":"yvp-stream";n&&(e?o.classList(r).remove(i):(o.classList(r).add(i),t.qv&&t.qv.resetSettings()))},n.prototype.Sv=function(){var e=this;e.Av.setAttribute("aria-label",c.i18n.PLAY_VIDEO),e.rv.setAttribute("aria-label",c.i18n.SEEK_SLIDER),e.rv.setAttribute("aria-valuemin",0),e.Ev&&e.Ev.setAttribute("aria-label",c.i18n.GO_TO_FULLSCREEN),e.Fv&&(o.classList(e.Fv).contains("muted")?e.Fv.setAttribute("aria-label",c.i18n.UNMUTE):e.Fv.setAttribute("aria-label",c.i18n.MUTE))},n.prototype.syncAriaState=function(){var e=this;e.l.playbackState;e.l.isPaused()?e.Av.setAttribute("aria-label",c.i18n.PLAY_VIDEO):e.Av.setAttribute("aria-label",c.i18n.PAUSE_VIDEO),e.Ev&&(e.m.getFullscreen()?e.Ev.setAttribute("aria-label",c.i18n.GO_TO_NORMAL_SCREEN):e.Ev.setAttribute("aria-label",c.i18n.GO_TO_FULLSCREEN)),e.Fv&&(o.classList(e.Fv).contains("muted")?e.Fv.setAttribute("aria-label",c.i18n.UNMUTE):e.Fv.setAttribute("aria-label",c.i18n.MUTE)),e.qv&&e.qv.syncAriaState()},n.prototype.getBottomBar=function(){var e=this;return e.qm},n.prototype.destroy=function(){var e=this;e.qv&&e.qv.destroy(),e.yw&&e.yw.destroy(),e.ww&&e.ww.destroy(),e.pw&&e.Av&&(e.pw.destroy(),e.Av.removeEventListener("tap",e.qw),e.Ev&&e.sw&&(e.sw.destroy(),e.Ev.removeEventListener("tap",e.tw)),e.Dw&&e.Bv&&(e.Dw.destroy(),e.Bv.removeEventListener("tap",e.Ew)),e.Uv(),e.qx()),e.sm&&(e.tm.removeEventListener("tap",e.mm),e.sm.destroy()),e.px&&e.px.destroy(),e.xw&&e.xw.destroy()}},{"../../../lib":"/lib/index.js","../event":"/nextgen/src/event.js","../navigator-info":26,"../strings":"/nextgen/src/strings.js","../tap":"/nextgen/src/tap.js","../util":"/nextgen/src/util.js","./controls.html":64,"./multi-audio.html":71,"./yahoo-controls":91,"user-agent":233}],66:[function(e,t,r){var n=new(e("hogan.js/lib/template").Template)(function(e,t,r){var n=this;return n.b(r=r||""),n.b("<div class='yvp-end-screen yvp-end-replay'>"),n.b("\n"+r),n.b('    <div class="yvp-end-rep-icon"></div>'),n.b("\n"+r),n.b("</div>"),n.fl()});t.exports={render:function(){return n.render.apply(n,arguments)},r:function(){return n.r.apply(n,arguments)},ri:function(){return n.ri.apply(n,arguments)}}},{"hogan.js/lib/template":141}],67:[function(e,t,r){var n=new(e("hogan.js/lib/template").Template)(function(e,t,r){var n=this;return n.b(r=r||""),n.b("<div class='yvp-error-screen yvp-vis-hidden'>"),n.b("\n"+r),n.b("    <img class='yvp-error-screen-image "),n.s(n.f("showBgImage",e,t,1),e,t,0,101,109,"{{ }}")&&(n.rs(e,t,function(e,t,r){r.b("yvp-show")}),e.pop()),n.b("' src='"),n.b(n.v(n.f("imageSrc",e,t,0))),n.b("'>"),n.b("\n"+r),n.b("    <div class='yvp-error-screen-background'></div>"),n.b("\n"+r),n.b("    <div class='yvp-error-title "),n.s(n.f("showGeoButton",e,t,1),e,t,0,249,263,"{{ }}")&&(n.rs(e,t,function(e,t,r){r.b("yvp-geo-header")}),e.pop()),n.b("'>"),n.b(n.v(n.d("error.title",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("    <div class='yvp-error-desc "),n.s(n.f("showGeoButton",e,t,1),e,t,0,354,362,"{{ }}")&&(n.rs(e,t,function(e,t,r){r.b("yvp-hide")}),e.pop()),n.b("' id='yvp-error-message'>"),n.b(n.v(n.d("error.message",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("    <div class='yvp-error-code "),n.s(n.f("showGeoButton",e,t,1),e,t,0,478,486,"{{ }}")&&(n.rs(e,t,function(e,t,r){r.b("yvp-hide")}),e.pop()),n.b("'>"),n.b(n.v(n.d("error.rep",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("    <div class='yvp-geo-request-btn "),n.s(n.f("showGeoButton",e,t,1),e,t,0,580,588,"{{ }}")&&(n.rs(e,t,function(e,t,r){r.b("yvp-show")}),e.pop()),n.b("'>Enable Location</div>"),n.b("\n"+r),n.b("</div>"),n.b("\n"),n.fl()});t.exports={render:function(){return n.render.apply(n,arguments)},r:function(){return n.r.apply(n,arguments)},ri:function(){return n.ri.apply(n,arguments)}}},{"hogan.js/lib/template":141}],68:[function(e,t,r){"use strict";function n(e){var t=this;t.k=e}t.exports=n;var i=e("../util"),a=(e("../tap"),e("../strings")),o=e("../event"),s=e("../error"),l=e("./error-screen.html");n.prototype.create=function(e,t,r,n,c){var u=this,p=!1;return e.category===s.E_INFO&&e.subcategory===s.INFO_CODES.E_SAPI_GEO_POSITION_REQUIRED&&(p=!0),u.node=i.render(l,{error:e,guid:t,sessionId:r,imageSrc:n,strings:a.i18n,showGeoButton:p,showBgImage:!!n}),u.errorMsg=u.node.querySelector("#yvp-error-message"),u.errorMsg.innerHTML=e.message,u.flashIcon=u.node.querySelector(".yvp-error-flash-download-icon"),u.flashIcon&&c&&(u.flashIcon.src=c),u.ux=u.node.querySelector(".yvp-error-code"),u.vx=u.node.querySelector(".yvp-geo-request-btn"),u.vx&&u.vx.addEventListener("click",function(){u.k.publish(o.REQUEST_GEO_POSITION)}),i.classList(u.node).remove("yvp-vis-hidden"),u.node},n.prototype.destroy=function(){var e=this;e.node=null}},{"../error":12,"../event":"/nextgen/src/event.js","../strings":"/nextgen/src/strings.js","../tap":"/nextgen/src/tap.js","../util":"/nextgen/src/util.js","./error-screen.html":67}],69:[function(e,t,r){var n=new(e("hogan.js/lib/template").Template)(function(e,t,r){var n=this;return n.b(r=r||""),n.b("<div class='yvp-loading-screen yvp-vis-hidden'>"),n.b("\n"+r),n.b("    <div class='yvp-loading-spinner yvp-spinner-icon'></div>"),n.b("\n"+r),n.b("</div>"),n.b("\n"),n.fl()});t.exports={render:function(){return n.render.apply(n,arguments)},r:function(){return n.r.apply(n,arguments)},ri:function(){return n.ri.apply(n,arguments)}}},{"hogan.js/lib/template":141}],70:[function(e,t,r){"use strict";function n(e){var t=this;t.wx=e,t.xx=!1,t.wx.subscribe(a.FULLSCREEN_CHANGE,t.yx,t),t.yx()}t.exports=n;var i=e("../util"),a=e("../event"),o=(e("../tap"),e("../strings")),s=e("./loading-screen.html"),l=60;n.prototype.create=function(){var e=this;return e.node=i.render(s,{strings:o.i18n}),e.wx.subscribe(a.API.LOADING_BEGIN,e.zx,e),e.wx.subscribe(a.API.LOADING_END,e.hide,e),e.node},n.prototype.eq=function(){var e=this,t=Math.min(2*e.node.clientWidth/640,1),r=e.node.querySelector(".yvp-loading-spinner");r.style.width=t*l+"px",r.style.height=t*l+"px",r.style.marginLeft=-1*(t*l/2)+"px",r.style.marginTop=-1*(t*l/2)+"px"},n.prototype.yx=function(){var e=this;if(!e.xx){var t=e.wx.subscribe(a.API.LOADING_BEGIN,function(){e.xx=!1,e.eq(),t()},e);e.xx=!0}},n.prototype.zx=function(){var e=this;i.forceDOMRedrawOnElement(e.node),i.classList(e.node).add("yvp-show-spinner")},n.prototype.hide=function(){var e=this;i.classList(e.node).remove("yvp-show-spinner")},n.prototype.destroy=function(){var e=this;e.node=null}},{"../event":"/nextgen/src/event.js","../strings":"/nextgen/src/strings.js","../tap":"/nextgen/src/tap.js","../util":"/nextgen/src/util.js","./loading-screen.html":69}],71:[function(e,t,r){var n=new(e("hogan.js/lib/template").Template)(function(e,t,r){var n=this;return n.b(r=r||""),n.b("<div>"),n.b("\n"+r),n.s(n.f("isMobile",e,t,1),e,t,0,23,231,"{{ }}")&&(n.rs(e,t,function(e,t,n){n.b("        <div class='yvp-audio-header'>"),n.b("\n"+r),n.b("            <span class='yvp-audio-list-title'>Audio Track</span>"),n.b("\n"+r),n.b('            <span class="yvp-audio-list-close" data-action="close">&#x2715;</span>'),n.b("\n"+r),n.b("        </div>"),n.b("\n")}),e.pop()),n.s(n.f("items",e,t,1),e,t,0,259,563,"{{ }}")&&(n.rs(e,t,function(e,t,n){n.b("        <div class='yvp-audio-item "),n.s(n.f("selected",e,t,1),e,t,0,308,331,"{{ }}")&&(n.rs(e,t,function(e,t,r){r.b("yvp-audio-item-selected")}),e.pop()),n.b("' data-selected=\""),n.b(n.v(n.f("selected",e,t,0))),n.b('" data-language="'),n.b(n.v(n.f("language",e,t,0))),n.b('" data-name="'),n.b(n.v(n.f("name",e,t,0))),n.b('">'),n.b("\n"+r),n.b("            <span class='yvp-audio-item-title'>"),n.b(n.v(n.f("name",e,t,0))),n.b("</span>"),n.b("\n"+r),n.b("            <span class='yvp-audio-item-check'></span>"),n.b("\n"+r),n.b("        </div>"),n.b("\n")}),e.pop()),n.b("</div>"),n.b("\n"+r),n.b("\n"),n.fl()});t.exports={render:function(){return n.render.apply(n,arguments)},r:function(){return n.r.apply(n,arguments)},ri:function(){return n.ri.apply(n,arguments)}}},{"hogan.js/lib/template":141}],72:[function(e,t,r){var n=new(e("hogan.js/lib/template").Template)(function(e,t,r){var n=this;return n.b(r=r||""),n.b("<div class='yvp-nfl-branding-container'>"),n.b("\n"+r),n.b("    <div class='yvp-nfl-branding'>"),n.b("\n"+r),n.b("      <a href='http://www.nfl.com/' target='nfl_site'>"),n.b("\n"+r),n.b("          <span class='yvp-nfl-brand-span'></span>"),n.b("\n"+r),n.b("          <span class='yvp-nfl-brand-logo'></span>"),n.b("\n"+r),n.b("      </a>"),n.b("\n"+r),n.b("    </div>"),n.b("\n"+r),n.b("</div>"),n.b("\n"),n.fl()});t.exports={render:function(){return n.render.apply(n,arguments)},r:function(){return n.r.apply(n,arguments)},ri:function(){return n.ri.apply(n,arguments)}}},{"hogan.js/lib/template":141}],73:[function(e,t,r){"use strict";function n(){}t.exports=n;var i=e("../util"),a=e("./nfl-branding.html");n.prototype.create=function(){var e=this;return e.node=i.render(a),e.node},n.prototype.destroy=function(){var e=this;e.node=null}},{"../util":"/nextgen/src/util.js","./nfl-branding.html":72}],74:[function(e,t,r){var n=new(e("hogan.js/lib/template").Template)(function(e,t,r){var n=this;return n.b(r=r||""),n.b("<div class='yvp-opensimsim' style='display: none'>"),n.b("\n"+r),n.b("    <button class='yvp-opensimsim-close-btn yvp-close-btn'></button>"),n.b("\n"+r),n.b("    <div class='yvp-opensimsim-info'>"),n.b("\n"+r),n.b("        <div class='yvp-opensimsim-title'>YAHOO FIREBALL VIDEO PLAYER</div>"),n.b("\n"+r),n.b("        <div>"),n.b(n.v(n.f("version",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("        <div class='yvp-nav'>"),n.b("\n"+r),n.b("            <span class='yvp-profile-btn'>Profile</span>"),n.b("\n"+r),n.b("        </div>"),n.b("\n"+r),n.b("        <div class='yvp-opensimsim-title'>CURRENT MEDIA</div>"),n.b("\n"+r),n.b("            <div class='yvp-opensimsim-renderertype'></div>"),n.b("\n"+r),n.b("            <div class='yvp-opensimsim-uuid'></div>"),n.b("\n"+r),n.b("            <div class='yvp-opensimsim-lmsid'></div>"),n.b("\n"+r),n.b("            <div class='yvp-opensimsim-tv'></div>"),n.b("\n"+r),n.b("        <br>"),n.b("\n"+r),n.b("        <div class='yvp-opensimsim-graphs'></div>"),n.b("\n"+r),n.b("        <div class='yvp-opensimsim-detail'></div>"),n.b("\n"+r),n.b("        <div class='yvp-swf-ready'></div>"),n.b("\n"+r),n.b("        <div class='yvp-opensimsim-title yvp-section-expand-context yvp-expanded'>CONTEXT</div>"),n.b("\n"+r),n.b("        <div class='yvp-opensimsim-current-context yvp-hide'>"),n.b("\n"+r),n.b("            <div class='yvp-opensimsim-expSiteName'></div>"),n.b("\n"+r),n.b("            <div class='yvp-opensimsim-expBucketName'></div>"),n.b("\n"+r),n.b("            <div class='yvp-opensimsim-expName'></div>"),n.b("\n"+r),n.b("            <div class='yvp-opensimsim-expType'></div>"),n.b("\n"+r),n.b("            <div><span class='yvp-details'>Page SpaceID: </span>"),n.b(n.v(n.f("spaceId",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("            <div class='yvp-sessionId'></div>"),n.b("\n"+r),n.b("            <div class='yvp-videoSpaceId'></div>"),n.b("\n"+r),n.b("            <div class='yvp-opensimsim-platform'></div>"),n.b("\n"+r),n.b("        </div>"),n.b("\n"+r),n.b("        <!-- <div class='yvp-profile-btn'>Profile</div> -->"),n.b("\n"+r),n.b("\n"+r),n.b("        <div class='yvp-opensimsim-title yvp-section-expand-config yvp-expanded'>PLAYER CONFIG</div>"),n.b("\n"+r),n.b("        <div class='yvp-opensimsim-current-config yvp-hide'>"),n.b("\n"+r),n.b("            <pre class='yvp-opensimsim-profile'></pre>"),n.b("\n"+r),n.b("        </div>"),n.b("\n"+r),n.b("        <div class='yvp-opensimsim-title yvp-section-expand-hosting yvp-expanded'>HOSTING CONFIG</div>"),n.b("\n"+r),n.b("        <div class='yvp-opensimsim-hosting-config yvp-hide'>"),n.b("\n"+r),n.b("        <pre class='yvp-opensimsim-hosting'></pre>"),n.b("\n"+r),n.b("    </div>"),n.b("\n"+r),n.b("\n"+r),n.b("        <!-- <div class='yvp-opensimsim-title'>AD CONTEXT</div> -->"),n.b("\n"+r),n.b("        <div class='yvp-inviewport'>"),n.b("\n"+r),n.b("        <div class='yvp-opensimsim-title yvp-section-expand-ads yvp-expanded'>AD HISTORY CONTEXT</div>"),n.b("\n"+r),n.b("        <!-- <br> -->"),n.b("\n"+r),n.b("        <div class='yvp-adinfo-section yvp-hide' style=\"padding-bottom: 15px;\">"),n.b("\n"+r),n.b("            <div class='yvp-details'>Midroll Cache Stats: <div class='yvp-midrollcache-data'></div></div>"),n.b("\n"+r),n.b("        </div>"),n.b("\n"+r),n.b("        <div class='yvp-adsinfopanel-adsinfo yvp-hide'><div style='text-align: center;'>YVAP disabled!!</div></div>"),n.b("\n"+r),n.b("    </div>"),n.b("\n"+r),n.b("    </div>"),n.b("\n"+r),n.b("\n"+r),n.b("    <section class='ad-info-table yvp-table'>"),n.b("\n"+r),n.b("\n"+r),n.b("        <div class='yvp-opensimsim-adinfo-uuid'>"),n.b("</div>"),n.b("\n"+r),n.b("        <header class='yvp-tablerow'>"),n.b("\n"+r),n.b("            <div class='yvp-tablecell yvp-tablecell-header'>position</div>"),n.b("\n"+r),n.b("            <div class='yvp-tablecell yvp-tablecell-header'>dur</div>"),n.b("\n"+r),n.b("            <div class='yvp-tablecell yvp-tablecell-header'>adPbId</div>"),n.b("\n"+r),n.b("            <div class='yvp-tablecell yvp-tablecell-header'>crId</div>"),n.b("\n"+r),n.b("            <div class='yvp-tablecell yvp-tablecell-header'>vCrId</div>"),n.b("\n"+r),n.b("            <div class='yvp-tablecell yvp-tablecell-header'>bId</div>"),n.b("\n"+r),n.b("            <div class='yvp-tablecell yvp-tablecell-header'>State</div>"),n.b("\n"+r),n.b("            <div class='yvp-tablecell yvp-tablecell-header'>log</div>"),n.b("\n"+r),n.b("        </header>"),n.b("\n"+r),n.b("        <div class='yvp-tablerow'>"),n.b("\n"+r),n.b("            <div class='adposition yvp-tablecell'></div>"),n.b("\n"+r),n.b("            <div class='addur yvp-tablecell'></div>"),n.b("\n"+r),n.b("            <div class='adPbId yvp-tablecell'></div>"),n.b("\n"+r),n.b("            <div class='crId yvp-tablecell'></div>"),n.b("\n"+r),n.b("            <div class='vCrId yvp-tablecell'></div>"),n.b("\n"+r),n.b("            <div class='bId yvp-tablecell'></div>"),n.b("\n"+r),n.b("            <div class='pbstate yvp-tablecell'></div>"),n.b("\n"+r),n.b("            <div class='yvp-tablecell'><button class='linkbtn'>log</button></div>"),n.b("\n"+r),n.b("        </div>"),n.b("\n"+r),n.b("\n"+r),n.b("    </section>"),n.b("\n"+r),n.b("\n"+r),n.b("</div>"),n.b("\n"),n.fl()});t.exports={render:function(){return n.render.apply(n,arguments)},r:function(){return n.r.apply(n,arguments)},ri:function(){return n.ri.apply(n,arguments)}}},{"hogan.js/lib/template":141}],75:[function(e,t,r){"use strict";function n(e,t,r,n,a){var o=this;o.l=e,o.k=t,o.Ha=r,o.dr=n,o.Ax=a,o.Bx=!1,o.Cx={},o.Dx=null,o.Ex=[],o.Fx={bitrate:{title:"Bit Rate History",data:[]},speed:{title:"Download Speed History",data:[]},bufferLength:{title:"Buffer Length History",data:[]},frameRate:{title:"Frame Rate History",data:[]}},o.k.subscribe(i.PLAYBACK_INFO,function(e){o.Cx=e,o.Ex.push(Date.now()/1e3),o.Fx.bitrate.data.push(parseFloat(e.currentStreamBitrate)),o.Fx.speed.data.push(parseFloat(e.currentKbps)),o.Fx.bufferLength.data.push(parseFloat(e.bufferLength)),o.Fx.frameRate.data.push(parseFloat(e.frameRate?e.frameRate:0)),o.Gx()}),o.k.subscribe(i.SWF_READY,function(){o.Bx=!0}),o.k.subscribe(i.YVAP_INFO_UPDATE,function(e){o.Hx=e}),o.k.subscribe(i.API.PLAYLIST_POSITION_CHANGE,function(){o.Ks()}),o.k.subscribe(i.RENDERER_SWITCHED,o.Ne,o),o.k.subscribe(i.YVAP_MIDROLL_CACHE_UPDATE,o.Cs,o)}t.exports=n;var i=e("../event"),a=e("user-agent"),o=a.capabilities,s=a.userAgent,l=e("../util"),c=e("../../../lib"),u=e("../tap"),p=e("../vtt-fetcher"),d=e("./open-sim-sim.html"),f=e("../strings"),v=e("../renderers/type"),m=e("../navigator-info"),y=m.network,h=45,E=40;n.prototype.Cs=function(e){function t(e,t){return"<div class='floated-item'>"+e+":<span> "+t+"</span></div>"}var r=this,n="",i={retryCount:"retries",targetAdsDuration:"target",totalUniqueAds:"num_uniq",totalDuplicatedAds:"num_dup",totalNoAds:"num_noad",uniqueAdsDuration:"uniq_dur"};Object.keys(e).forEach(function(r){var a=i[r]||r;n+=t(a,e[r])}),r.Ds.innerHTML=n},n.prototype.Ix=function(e,t){var r=this,n=l.classList(e).contains("yvp-hide"),i=l.classList(e).contains("yvp-adsinfopanel-adsinfo");if(i)var a=r._node.querySelector(".yvp-adinfo-section");if(n){if(l.classList(e).remove("yvp-hide"),l.classList(t).remove("yvp-expanded"),l.classList(t).add("yvp-collapsed"),i){l.classList(a).remove("yvp-hide");var o=r._node.querySelector(".yvp-inviewport");r.Jx(o)}}else l.classList(e).add("yvp-hide"),l.classList(t).remove("yvp-collapsed"),l.classList(t).add("yvp-expanded"),i&&l.classList(a).add("yvp-hide")},n.prototype.create=function(){var e=this;e._node=l.render(d,{version:e.l.version,spaceId:e.l.baseConfig.pageSpaceId,strings:f.i18n}),e.Ds=e._node.querySelector(".yvp-midrollcache-data"),e.Es=e._node.querySelector(".yvp-adsinfopanel-adsinfo");var t=e.Fs=e._node.removeChild(e._node.querySelector(".ad-info-table"));e.Gs=t.removeChild(t.querySelector("div.yvp-tablerow"));var r=e._node.querySelector(".yvp-opensimsim-close-btn");e.Hs=new u(r),e.Kx=function(t){t.stopPropagation(),e.close()},r.addEventListener("tap",e.Kx);var n=e._node.querySelector(".yvp-profile-btn");e.Lx=new u(n),e.Mx=function(t){t.stopPropagation(),e.Ha.render(e.Hx)},n.addEventListener("tap",e.Mx),e.Nx(),e.Is=new u(e.Es,function(t){var r=t.eventSource||t.eventTarget;if(r&&"linkbtn"===r.className)try{e.Js(r.parentNode.parentNode.customData.playbackId)}catch(e){}});var i=e._node.querySelector(".yvp-section-expand-config");e.Ox=new u(i),e.Px=function(){var t=e._node.querySelector(".yvp-opensimsim-current-config");e.Ix(t,i)},i.addEventListener("tap",e.Px);var a=e._node.querySelector(".yvp-section-expand-ads");e.Qx=new u(a),e.Rx=function(){var t=e._node.querySelector(".yvp-adsinfopanel-adsinfo");e.Ix(t,a)},a.addEventListener("tap",e.Rx);var o=e._node.querySelector(".yvp-section-expand-hosting");e.Sx=new u(o),e.Tx=function(){var t=e._node.querySelector(".yvp-opensimsim-hosting-config");e.Ix(t,o)},o.addEventListener("tap",e.Tx);var s=e._node.querySelector(".yvp-section-expand-context");return e.Ux=new u(s),e.Vx=function(){var t=e._node.querySelector(".yvp-opensimsim-current-context");e.Ix(t,s)},s.addEventListener("tap",e.Vx),e._node},n.prototype.fetchInfo=function(){var e=this;return{history:e.Fx,playbackInfo:e.Cx,profile:e.Ha}},n.prototype.Jx=function(e){e&&e.scrollIntoView()},n.prototype.render=function(){var e=this;e.Wx(),e.Xx(),e.Yx(),e.Ks(),e.Gx(),e.Ax&&(e.Ls(),e.Ms()),e._node.style.display="block",e.k.publish(i.API.OPSS_VISIBILITY_CHANGED,!0)},n.prototype.Ls=function(){var e=this;e.Es.innerHTML="";var t=e.Ax.getAllAdDiagnostics();Object.keys(t).forEach(function(r){e.Ss(t[r],r)})},n.prototype.Ss=function(e,t){var r=this,n=r.Fs.cloneNode(!0);n.children[0].innerHTML="<strong>MEDIA UUID: </strong>"+t,Object.keys(e).forEach(function(t){var i=e[t];r.Zx(n,i)}),n.setAttribute("relvideo",t),r.Dx=t,r.Es.appendChild(n)},n.prototype.Zx=function(e,t){var r=this;if(e&&t){var n=r.Gs.cloneNode(!0);if(t){var i=t.playbackId,a=t.clipId;n.setAttribute("apbid",i),n.customData={playbackId:i,uuid:a,adstate:t.adstate},n.querySelector(".adPbId").innerHTML=i,n.querySelector(".addur").innerHTML=t.duration,n.querySelector(".adposition").innerHTML=t.position,n.querySelector(".crId").innerHTML=t.creativeId,n.querySelector(".vCrId").innerHTML=t.vastCreativeId,n.querySelector(".bId").innerHTML=t.bookingId,r.Qs(n,t.adstate,t.adstateData),e.rowCount=void 0===e.rowCount?0:e.rowCount+1,e.rowCount%2!==0&&l.classList(n).add("yvp-altrow")}else l.classList(n).add("emptyrow");e.appendChild(n)}},n.prototype.Qs=function(e,t){var r=e,n=l.classList(r);"playing"===t?n.add("currad"):n.contains("currad")&&n.remove("currad"),r=e.querySelector(".pbstate"),n=l.classList(r),n.remove("st-"+e.customData.adstate),e.customData.adstate=t,n.add("st-"+t),r.innerHTML=t},n.prototype.Ls=function(){var e=this;e.Es.innerHTML="";var t=e.Ax.getAllAdDiagnostics();Object.keys(t).forEach(function(r){e.Ss(t[r],r)})},n.prototype.Ms=function(){var e=this;e.Ax.registerAdStateChangeListener(e.Os.bind(e)),e.Ax.registerAdDataAvailableListener(e.Ps.bind(e))},n.prototype.Ns=function(){var e=this;e.Ax.registerAdStateChangeListener(null),e.Ax.registerAdDataAvailableListener(null)},n.prototype.Os=function(e,t,r){var n=this,i=n.Es.querySelector("[apbid="+e+"]");n.Qs(i,t,r)},n.prototype.Ps=function(e){var t=this;t.Ls(),t.Dx=e.clipId},n.prototype.Wx=function(e){var t=this;return t.$x()?(e=e||t.dr&&t.dr.getActiveRenderer(),void(e&&(t.ay=e.node,t._x(!0)))):void t._x(!1)},n.prototype.Xx=function(){var e=this,t=window.YAHOO,r=t&&t.VideoPlatform&&t.VideoPlatform.PlayerHosting||"local",n=e._node.querySelector(".yvp-opensimsim-hosting");n.innerHTML=JSON.stringify(r,void 0,2)},n.prototype.Yx=function(){var e=this,t=e.l.getConfig(),r=e._node.querySelector(".yvp-opensimsim-expSiteName");r.innerHTML="<span class='yvp-details'>site: </span>"+t.site;var n=e._node.querySelector(".yvp-opensimsim-expName");n.innerHTML="<span class='yvp-details'>expName: </span>"+t.expName;var i=e._node.querySelector(".yvp-opensimsim-expBucketName");i.innerHTML="<span class='yvp-details'>expBucketName: </span>"+t.expBucket;var a=e._node.querySelector(".yvp-opensimsim-expType");a.innerHTML="<span class='yvp-details'>expType: </span>"+t.expType},n.prototype.isOpen=function(){var e=this;return"none"!==e._node.style.display},n.prototype.close=function(){var e=this;e._node.style.display="none",e.k.publish(i.API.OPSS_VISIBILITY_CHANGED,!1),e._x(!1),e.Ax&&e.Ns()},n.prototype.Ne=function(e){var t=this;t.Wx(e.active),t.Ks(),t.Gx()},n.prototype.$x=function(){var e=this;return s.tv||s.safari&&l.isHtmlRenderer(e.l.playbackState.rendererType)},n.prototype.by=function(e,t,r,n,i){for(var a=t.length-1,o=0,s=e[a],l=t[a],c=t[a],u=a-1;u>=0;u--)if(l=Math.min(l,t[u]),c=Math.max(c,t[u]),u>0&&s-e[u-1]>h){o=u;break}var p=e[o];l>0&&(l=0),l===c&&(c=l+1),r.save(),r.translate(E,i),r.scale((n-E)/h,-1*i/(c-l)),r.beginPath(),r.moveTo(0,t[o]-l);for(var d=o+1;d<t.length;d++)r.lineTo(e[d]-p,t[d]-l);r.restore(),r.lineWidth=1,r.lineCap="round",r.lineJoin="round",r.strokeStyle="white",r.stroke(),r.font="8pt Monospace",r.fillStyle="white",r.fillText(c.toFixed(1),0,10),r.fillText(l.toFixed(1),0,60)},n.prototype.cy=function(e){var t="",r=Object.keys(e);return r.forEach(function(r){var n=e[r];t+="<div><span class='yvp-details'>"+r+":</span> "+n+"</div>"}),t},n.prototype.dy=function(e,t){var r=this,n="",i=Object.keys(e);return i.forEach(function(i){var a=e[i];a&&"object"==typeof a?isNaN(i)?(n+="<div>"+i+" :</div>",n+='<div style="padding-left: 10px">'+r.dy(a)+"</div>"):n+="<div>"+r.dy(a,i)+"</div>":n+="<div>"+(t?t+" : ":"")+i+" : "+a+"</div>"}),n},n.prototype.ey=function(e){return'<div class="yvp-opensimsim-title">'+e+"</div>"},n.prototype.Nx=function(){var e=this,t={OS:s.os,Mobile:s.mobile,"User Agent":s.ua};s.mobile&&(t["Can Play Inline"]=m.canPlayInline,t["Autoplay Supported"]=m.autoplaySupported,m.autoplaySupported&&(t["Has Native Autoplay Support"]=m.hasNativeAutoplaySupport),t["Network Info Available"]=y.available,t["Network Connection Type (SAPI)"]=y.connectionType,t["Network Connection Type (User Agent)"]=o.getConnectionType()||"n/a",t["Is Mobile Network"]="boolean"==typeof y.mobile?y.mobile:"n/a");var r=e._node.querySelector(".yvp-opensimsim-platform");r.innerHTML=e.cy(t)},n.prototype.Ks=function(){var e=this,t=e.l.playlist.getCurrentItem(),r=e._node.querySelector(".yvp-opensimsim-uuid");r.innerHTML="<span class='yvp-details'>UUID:</span> "+(t?t.id:""),r=e._node.querySelector(".yvp-opensimsim-lmsid"),r.innerHTML="<span class='yvp-details'>License Id (LMS ID):</span> "+(t?t.license.licenseId:""),r=e._node.querySelector(".yvp-videoSpaceId"),r.innerHTML="<span class='yvp-details'>Video SpaceID:</span> "+(t?t.metrics.pageSpaceId:""),r=e._node.querySelector(".yvp-sessionId"),r.innerHTML="<span class='yvp-details'>SessionId:</span> "+(t?t.videoSession:"none"),e.$x()&&!s.samsung&&(r=e._node.querySelector(".yvp-opensimsim-url"),t.isLive()?r.innerHTML="Master Playlist URL : "+e.ay.currentSrc:s.tv&&(r.innerHTML="Current Source URL : "+e.ay.currentSrc),r=e._node.querySelector(".yvp-opensimsim-config"),r&&(r.innerHTML=e.ey("Config")+e.dy(e.l.getConfig())))},n.prototype.Gx=function(){var e=this,t=e.l.playlist.getCurrentItem(),r=e.Cx,n=r.deliveryProtocol;t&&(n+=" / "+t.getType());var i=e._node.querySelector(".yvp-opensimsim-graphs");i.innerHTML="";var a=Object.keys(e.Fx);a.forEach(function(t){var r=e.Fx[t].data;if(r.some(function(e){return c.isNumber(e)})){var n=150,a=60,o=document.createElement("div");l.classList(o).add("yvp-opensimsim-graph");var s=document.createElement("div");s.innerHTML=e.Fx[t].title,o.appendChild(s);var u=document.createElement("canvas");u.width=n,u.height=a,o.appendChild(u),i.appendChild(o);var p=u.getContext("2d");e.by(e.Ex,r,p,n,a)}});var o={"Total Quality Levels":r.qualityLevels,"Encoding Method":t.streams.length>0?t.streams[0].rcMode:"na","Current Bitrate":r.currentStreamBitrate+" kbps",Protocol:n,CDN:t?t.getCDN():"","Recovery count":t?t.failoverCount:0,"Buffer Length / Time":r.bufferLength+" secs / "+r.bufferTime+" secs","Frame Rate":r.frameRate,"Download Speed":r.currentKbps+" kbps","Dropped Frames":r.droppedFrames,"Hardware Acceleration Used":r.hwAccelUsed?"Yes":"No",
"Hardware Acceleration Enabled":r.hwAccelEnabled?"Yes":"No","Memory Used":r.totalMemory+" MB","Media Size":r.mediaWidth+" x "+r.mediaHeight,"Stream Playback Rate":r.playbackBytesPerSecond+" kbps"};t&&t.rendererType===v.HTML5_HLS&&(o["Buffering Count"]=r.bufferingCount,o["Total buffering time"]=r.totalBufferingTime+" ms");var s=e._node.querySelector(".yvp-opensimsim-detail");s.innerHTML=e.cy(o),s=e._node.querySelector(".yvp-opensimsim-renderertype");var u=e.l.playbackState.rendererType===v.HTML5_HLS?e.l.playbackState.rendererType+" "+e.l.jshlsVersion:e.l.playbackState.rendererType;s.innerHTML="<span class='yvp-details'>Renderer Type:</span> "+(u||"(no renderer yet)"),s=e._node.querySelector(".yvp-swf-ready"),s.innerHTML="<span class='yvp-details'>Is SWF ready?: </span>"+e.Bx,s=e._node.querySelector(".yvp-opensimsim-profile"),s.innerHTML=JSON.stringify(e.l.getConfig(),void 0,2)},n.prototype._x=function(e){var t=this,r=t._node.querySelector(".yvp-opensimsim-tv");if(t.fy(),t.gy(),r.innerHTML="",e){r.innerHTML+='<div class="yvp-opensimsim-url"></div>',r.innerHTML+=t.ey("HTML5 Video States");var n={"Current Time":'<span class="yvp-opensimsim-time"></span>',"Playback State":'<span class="yvp-opensimsim-playback"></span>',"Player State":'<span class="yvp-opensimsim-state"></span>',"Buffering State":'<span class="yvp-opensimsim-buffering"></span>',"Network State":'<span class="yvp-opensimsim-network"></span>',"Ready State":'<span class="yvp-opensimsim-ready"></span>',"Error State":'<span class="yvp-opensimsim-error">none</span>'};if(r.innerHTML+=t.cy(n),s.tv&&c.isFunction(p)){r.innerHTML+=t.ey("VTT Info");var i={"VTT Index":'<span class="yvp-opensimsim-vttindex"></span>',"VTT URL":'<span class="yvp-opensimsim-vtturl"></span>',"STREAM BITRATES":'<span class="yvp-opensimsim-bitrate-list"></span>'};r.innerHTML+=t.cy(i)}r.innerHTML+='<div class="yvp-opensimsim-config"></div>',t.hy(),t.iy()}},n.prototype.fy=function(){var e=this;e.jy&&e.jy.forEach(function(e){e()}),e.jy=[]},n.prototype.iy=function(){var e=this;e.jy.push(e.k.subscribe(i.Video.TIMEUPDATE,function(t){e._node.querySelector(".yvp-opensimsim-time").innerHTML=t}));var t=["PLAYING","PAUSE","SEEKING","SEEKED"];t.forEach(function(t){e.jy.push(e.k.subscribe(i.Video[t],function(){e._node.querySelector(".yvp-opensimsim-playback").innerHTML=t}))}),e.jy.push(e.k.subscribe(i.Video.WAITING,function(t){e._node.querySelector(".yvp-opensimsim-buffering").innerHTML=t.value}));var r=[null,"aborted","network","decode","source not supported"];e.jy.push(e.k.subscribe(i.Video.ERROR,function(t){e._node.querySelector(".yvp-opensimsim-error").innerHTML=r[t.code]})),s.tv&&c.isFunction(p)&&(e.jy.push(e.k.subscribe(i.VTT_SEGMENT_LOADED,function(t,r,n,i){e._node.querySelector(".yvp-opensimsim-vttindex").innerHTML=n,e._node.querySelector(".yvp-opensimsim-vtturl").innerHTML=i})),e.jy.push(e.k.subscribe(i.CTV.GET_BITRATE_FOR_OPSS,function(t){var r=e._node.querySelector(".yvp-opensimsim-bitrate-list");r.innerHTML="Bitrates : "+JSON.stringify(t)})))},n.prototype.hy=function(){var e=this;e.ky=setInterval(function(){e._node.querySelector(".yvp-opensimsim-state").innerHTML=e.l.getState()},1e3);var t=["network empty","network idle","network loading","network no source"];if(!s.samsung){e.ly=setInterval(function(){var r=t[e.ay.networkState];e._node.querySelector(".yvp-opensimsim-network").innerHTML=r},1e3);var r=["have nothing","have metadata","have current data","have future data","have enough data"];e.my=setInterval(function(){e._node.querySelector(".yvp-opensimsim-ready").innerHTML=r[e.ay.readyState]},1e3)}},n.prototype.gy=function(){var e=this;e.ky&&clearInterval(e.ky),e.ly&&clearInterval(e.ly),e.my&&clearInterval(e.my)},n.prototype.Js=function(e){var t=this,r=t.Ax.getAdDiagnosticsById(e),n=console;n.log.apply(n,["[ad diagnostics]",r])},n.prototype.destroy=function(){var e=this;e._x(!1),e.Hs&&e.Hs.destroy(),e.Lx&&e.Lx.destroy(),e.Is&&e.Is.destroy()}},{"../../../lib":"/lib/index.js","../event":"/nextgen/src/event.js","../navigator-info":26,"../renderers/type":44,"../strings":"/nextgen/src/strings.js","../tap":"/nextgen/src/tap.js","../util":"/nextgen/src/util.js","../vtt-fetcher":139,"./open-sim-sim.html":74,"user-agent":233}],76:[function(e,t,r){"use strict";function n(e){var t=this,r=document.createElement("canvas"),n=r.getContext("2d");r.setAttribute("width",80),r.setAttribute("height",80),r.classList.add("yvp-360-pie"),e.appendChild(r),t.Qp=r,t.ny=n,t.oy=1}t.exports=n,n.prototype.render=function(){var e=this;e.py()},n.prototype.addClickListener=function(e){var t=this;t.qy=function(t){t.preventDefault(),t.stopPropagation(),e&&e()},t.ry=function(e){e.preventDefault(),e.stopPropagation()},t.Qp.addEventListener("click",t.qy,!1),t.Qp.addEventListener("mousedown",t.ry,!1),t.Qp.addEventListener("mouseup",t.ry,!1)},n.prototype.destroy=function(){var e=this;e.Qp.removeEventListener("click",e.qy,!1),e.Qp.removeEventListener("mousedown",e.ry,!1),e.Qp.removeEventListener("mouseup",e.ry,!1),e.Qp.parentNode.removeChild(e.Qp),e.Qp=null},n.prototype.py=function(){var e=this,t=e.ny;t.clearRect(0,0,80,80),t.beginPath(),t.arc(40,40,28,0,2*Math.PI),t.shadowColor="rgba(18, 23, 23, 0.5)",t.shadowBlur=10,t.lineWidth=4,t.strokeStyle="#fff",t.stroke(),t.beginPath(),t.arc(40,3,2,0,2*Math.PI),t.fillStyle="#fff",t.fill();var r=-.5*Math.PI*e.oy;t.beginPath(),t.arc(40,40,28,Math.PI/4+r,-Math.PI/4+r,!0),t.lineTo(40,40),t.fillStyle="rgba(255, 255, 255, 0.6)",t.fill()},n.prototype.update=function(e){var t=this,r=e%360;r<0&&(r=360+r),r*=-1,t.oy=r/90+Math.PI/4-3.79,t.py()}},{}],77:[function(e,t,r){var n=new(e("hogan.js/lib/template").Template)(function(e,t,r){var n=this;return n.b(r=r||""),n.b('<div class="yvp-playlist-item-container">'),n.b("\n"+r),n.s(n.f("items",e,t,1),e,t,0,56,892,"{{ }}")&&(n.rs(e,t,function(e,t,n){n.b('        <li class="yvp-playlist-item" data-id=\''),n.b(n.v(n.f("id",e,t,0))),n.b("' data-idx="),n.b(n.v(n.f("idx",e,t,0))),n.b(">"),n.b("\n"+r),n.b('            <img class="yvp-playlist-item-image" src=\''),n.b(n.v(n.f("thumbnail",e,t,0))),n.b("'/>"),n.b("\n"+r),n.b('            <div class="yvp-playlist-item-watched">'),n.b("\n"+r),n.b("                <div class='yvp-watched'>"),n.b(n.v(n.d("strings.WATCHED",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("            </div>"),n.b("\n"+r),n.b('            <div class="yvp-playlist-border"></div>'),n.b("\n"+r),n.b('            <div class="yvp-playlist-item-gradient">'),n.b("\n"+r),n.b('                <div class="yvp-pl-meta">'),n.b("\n"+r),n.b("                    <span class='yvp-pl-title'>"),n.b(n.v(n.f("title",e,t,0))),n.b("</span>"),n.b("\n"+r),n.b("                    <span class='yvp-now-playing'>"),n.b(n.v(n.d("strings.NOW_PLAYING",e,t,0))),n.b("</span>"),n.b("\n"+r),n.s(n.f("isWideMode",e,t,1),e,t,0,666,761,"{{ }}")&&(n.rs(e,t,function(e,t,r){r.b("                        <span class='yvp-pl-provider'>"),r.b(r.v(r.f("provider",e,t,0))),r.b("</span>"),r.b("\n")}),e.pop()),n.b("                </div>"),n.b("\n"+r),n.b("            </div>"),n.b("\n"+r),n.b("            <div class='yvp-pl-dur'>"),n.b(n.v(n.f("duration",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("        </li>"),n.b("\n")}),e.pop()),n.b("</div>"),n.b("\n"),n.fl()});t.exports={render:function(){return n.render.apply(n,arguments)},r:function(){return n.r.apply(n,arguments)},ri:function(){return n.ri.apply(n,arguments)}}},{"hogan.js/lib/template":141}],78:[function(e,t,r){var n=new(e("hogan.js/lib/template").Template)(function(e,t,r){var n=this;return n.b(r=r||""),n.b("<div tabindex='0' class='yvp-playlist-container "),n.b(n.v(n.f("modeClass",e,t,0))),n.b(" yvp-pl-loading yvp-playlist-theme-"),n.b(n.v(n.f("theme",e,t,0))),n.b(" "),n.b(n.v(n.f("streamModeClass",e,t,0))),n.b(" yvp-vis-hidden'>"),n.b("\n"+r),n.s(n.f("isHiddenMode",e,t,1),e,t,0,160,221,"{{ }}")&&(n.rs(e,t,function(e,t,r){r.b('    <div class="yvp-upnext-title">'),r.b(r.v(r.d("strings.UP_NEXT",e,t,0))),r.b("</div>"),r.b("\n")}),e.pop()),n.b('    <div class="yvp-playlist-pg-btn yvp-playlist-pg-btn-prev disabled"></div>'),n.b("\n"+r),n.b('    <div class="yvp-playlist-pg-btn yvp-playlist-pg-btn-next"></div>'),n.b("\n"+r),n.b('    <div class="yvp-playlist-strip">'),n.b("\n"+r),n.b('        <ul class="yvp-playlist-strip-list strip-animate">'),n.b("\n"+r),n.b("\n"+r),n.b("        </ul>"),n.b("\n"+r),n.b('        <div class="yvp-pl-loader-bg"></div>'),n.b("\n"+r),n.b("    </div>"),n.b("\n"+r),n.b('    <div class="yvp-pl-loader yvp-spinner-icon"></div>'),n.b("\n"+r),n.b("</div>"),n.b("\n"),n.fl()});t.exports={render:function(){return n.render.apply(n,arguments)},r:function(){return n.r.apply(n,arguments)},ri:function(){return n.ri.apply(n,arguments)}}},{"hogan.js/lib/template":141}],79:[function(e,t,r){"use strict";function n(e,t,r){var n=this;n.k=e,n.k.subscribe(i.PLAYER_DIMENSION_CHANGE,n.ue,n),n.k.subscribe(i.FULLSCREEN_CHANGE,n.sy,n),n.k.subscribe(i.AD_PLAYBACK_STARTED,n.u,n),n.k.subscribe(i.PLAYBACK_STARTED,n.Kf,n),n.l=r,n.m=t,n.$e=n.m.getPlaylistController()}t.exports=n;var i=e("../event"),a=e("../tap"),o=e("../strings"),s=e("../util"),l=e("../constants"),c=e("../../../lib"),u=e("user-agent").userAgent,p=e("./playlist.html"),d=e("./playlist-items.html"),f=5,v=14;n.prototype.create=function(e){var t=this,r=[l.PLAYLIST_POS_BOTTOM,l.PLAYLIST_POS_RIGHT,l.PLAYLIST_POS_HIDDEN];if(r.indexOf(e)===-1)return null;var n="yvp-playlist-mode-"+e;t.ty=e===l.PLAYLIST_POS_HIDDEN?l.PLAYLIST_HIDDEN_COUNT_PER_PAGE:l.PLAYLIST_COUNT_PER_PAGE,t.uy=0,t.vy=0,t.wy=0,t.xy=[],t.yy=t.zy(e),t.Ay=e,t.By=function(){s.classList(t._node).remove("open"),t.k.publish(i.RELATED_ITEM_CLICK,this.getAttribute("data-id"),this.itemIndex,!1),t.k.publish(i.API.UI_INTERACT,{srcElement:"ui_pl_thmb_clk"})};var a=t.$e.isPlaylistInStream()?"yvp-playlist-in-stream":"",c=s.render(p,{strings:o.i18n,modeClass:n,isHiddenMode:e===l.PLAYLIST_POS_HIDDEN||!1,theme:t.yy,streamModeClass:a});return t.l.uiState&&t.l.uiState.isCSSLoaded?s.classList(c).remove("yvp-vis-hidden"):s.classList(c).add("yvp-disp-none"),t.Cy(c),t.renderPlaylist(t.l.playlist.getItems()),t.Pg(!0),c},n.prototype.Pg=function(e){var t=this;if(t.Dy=new a(t.Ey),t.Ey.addEventListener("tap",function(){t.Fy(!1)}),t.Gy=new a(t.Hy),t.Hy.addEventListener("tap",function(){t.Fy(!0)}),u.mobile&&t.Iy.addEventListener("scroll",function(){e&&t.Jy&&t.Jy.length<100&&t.Iy.scrollLeft+t.Iy.offsetWidth>=t.Iy.scrollWidth&&!t.Ky&&t.Ly()}),t.Ay===l.PLAYLIST_POS_RIGHT&&(t.My.addEventListener("scroll",function(){e&&t.Jy&&t.Jy.length<100&&t.My.scrollTop+t.My.offsetHeight>=t.My.scrollHeight&&!t.Ky&&(t.Ly(),t.k.publish(i.API.UI_INTERACT,{srcElement:"ui_pl_scrl"}))}),!u.mobile)){var r=function(e){var r=t.My.scrollTop,n=t.My.scrollHeight,i=t.My.offsetHeight,a="DOMMouseScroll"===e.type?e.detail*-40:e.wheelDelta,o=a>0,s=function(){return e.stopPropagation(),e.preventDefault(),e.returnValue=!1,!1};return!o&&-a>n-i-r?(t.My.scrollTop=n,s()):o&&a>r?(t.My.scrollTop=0,s()):void 0};t.Iy.addEventListener("mousewheel",r),t.Iy.addEventListener("DOMMouseScroll",r)}},n.prototype.upNextBtnTapHandler=function(){var e=this,t=e.l.playlist.position,r=t+1,n=e.l.playlist.getMediaItemAt(r),a=n.id;e.k.publish(i.API.UI_INTERACT,{srcElement:"ctrl-next-click"}),e.k.publish(i.API.UI_INTERACT,{srcElement:"ui_pl_nxt_clk"}),e.k.publish(i.RELATED_ITEM_CLICK,a,r,!1)},n.prototype.renderFirstBatch=function(){var e=this;!e.Ny&&e.Oy()&&(e.$e.fetchMore(e.ty,function(t,r){e.$e.initDrawPlaylist(t,r)}),e.Ny=!0)},n.prototype.renderPlaylist=function(e){var t=this;t.Jy=[],t.vy=0,t.wy=0,t.xy=[],t.Ky=!1,t.My.parentElement.scrollLeft=0,s.classList(t.Ey).add("disabled"),s.classList(t.Hy).remove("disabled"),e&&t.Py(e)},n.prototype.Py=function(e){var t=this,r=d,n=[],i=u.chrome>43,a=!1;if(e){for(var p=0;p<e.length;p++){var v=e[p],m="",y="";v.duration&&c.isNumber(v.duration)&&(m=s.formatTime(v.duration)),t.Ay===l.PLAYLIST_POS_RIGHT&&v.provider&&v.provider.name&&(y=v.provider.name);var h=v.title;h&&h.length>40&&!i&&(h=h.substring(0,40)+"...");var E=t.Qy({mediaItem:v,title:h,showUpNext:0===p||a,upNextTime:f,duration:m,provider:y,idx:t.uy++}),g='.yvp-playlist-item[data-id="'+E.id+'"]',b=t.My.querySelector(g)||null;E.thumbnail&&!b?(n.push(E),a=!1):E.showUpNext&&(a=!0)}t.Ry({template:r,items:n,strings:o.i18n}),t.Jy=t.Jy.concat(e),t.Sy(),s.classList(t.Ty).remove("yvp-pl-loading");var _=t.m.getFullscreen();_||t.Uy(t.Ay,!1)}},n.prototype.Qy=function(e){return{id:e.mediaItem.id,title:e.title,showUpNext:e.showUpNext,upNextTime:e.upNextTime,thumbnail:e.mediaItem.images.small||e.mediaItem.images.thumbnail,duration:e.duration,provider:e.provider,idx:e.idx}},n.prototype.Ry=function(e){for(var t=this,r=s.render(e.template,{items:e.items,strings:e.strings,isWideMode:t.Ay===l.PLAYLIST_POS_RIGHT}),n=Array.prototype.slice.call(r.querySelectorAll(".yvp-playlist-item"),0),i=0;i<n.length;i++){var o=n[i];o.itemIndex=i+t.Jy.length,t.xy.push(new a(o)),o.addEventListener("tap",t.By),t.My.appendChild(o)}},n.prototype.Sy=function(){var e=this;e.Vy=e.Iy.offsetWidth||e.Iy.Wy,e.Xy=134,e.Yy=parseInt(e.Vy/e.Xy)},n.prototype.Oy=function(){var e=this,t=e.l.getPlaylistRenderingType(),r=e.l.playlist.videoRecommendations;return!e.l.playlist.endOfPlaylist&&(!(r||t!==l.PLAYLIST_RENDERING_TYPE.PLAYLIST_ID&&t!==l.PLAYLIST_RENDERING_TYPE.PLAYLIST_ID_AND_MEDIA_ITEMS)||r)},n.prototype.Fy=function(e){var t=this,r=t.m.getFullscreen();if(t.Ay!==l.PLAYLIST_POS_RIGHT||r){t.k.publish(i.UP_NEXT_PG_CLICK);var n="next-";n=e?n+"right":n+"left",t.k.publish(i.API.UI_INTERACT,{srcElement:n}),t.Vy=t.My.offsetWidth||t.My.Wy;var a=t.My.children.length>12?t.My.children.length:10,o=(a-t.Yy)*t.Xy;t.wy=t.Zy?t.wy:t.My.parentElement.scrollLeft;var c=t.wy%t.Vy,u=s.classList(t.Ey).contains("disabled");if(!u||e){!e&&c&&(c=(t.Vy-c)*-1);var p=parseInt((o-t.wy)/t.Xy)>=t.Yy,d=t.wy>=o;if((d||!p)&&e)return void(t.Ky||(s.classList(t.Hy).add("disabled"),t.Jy&&t.Jy.length<100?t.Ly():t.Ky=!0));t.vy=e?t.vy-t.Vy:t.vy+t.Vy,t.wy=e?t.wy+t.Vy:t.wy-t.Vy,t.vy+=c,t.wy-=c,t.wy<=o&&s.classList(t.Hy).remove("disabled"),t.wy>0?s.classList(t.Ey).remove("disabled"):s.classList(t.Ey).add("disabled"),s.classList(t.My).add("strip-animate"),t.My.style.left=t.vy+"px",t.Zy&&(clearTimeout(t.Zy),t.Zy=null),t.Zy=setTimeout(function(){s.classList(t.My).remove("strip-animate"),t.My.style.left="0px",t.vy=0,t.Zy=null,t._node.querySelector(".yvp-playlist-strip").scrollLeft=t.wy,t.Iy.scrollLeft=t.wy},1e3)}}},n.prototype.Uy=function(e,t){var r=this,n=r.l.playlist.getCurrentItem(),i=n&&n.id,a=r.My.querySelector(".yvp-currently-playing"),o='.yvp-playlist-item[data-id="'+i+'"]',c=r.My.querySelector(o);if(a&&(s.classList(a).remove("yvp-currently-playing"),e!==l.PLAYLIST_POS_RIGHT)){var u=a.querySelector(".yvp-pl-title"),p=a.querySelector(".yvp-pl-dur"),d=a.querySelector(".yvp-playlist-item-gradient"),f=a.querySelector(".yvp-now-playing");s.classList(u).remove("yvp-show"),s.classList(p).remove("yvp-hide"),s.classList(d).remove("yvp-playlist-item-gradient-duration"),s.classList(f).remove("yvp-show")}if(c){var m=c.offsetLeft,y=c.offsetWidth,h=Number(c.getAttribute("data-idx"))||0;if(s.classList(c).add("yvp-currently-playing"),e!==l.PLAYLIST_POS_RIGHT){var E=c.querySelector(".yvp-pl-dur"),g=c.querySelector(".yvp-playlist-item-gradient"),b=c.querySelector(".yvp-now-playing");s.classList(E).add("yvp-hide"),s.classList(g).add("yvp-playlist-item-gradient-duration"),s.classList(b).add("yvp-show");var _=y+v;m="hidden"===e?m+_:m,r.My.parentElement.scrollLeft=m}else if(e===l.PLAYLIST_POS_RIGHT&&t){var A=c.offsetTop;r.My.scrollTop=A-5}r.My.children.length-h<r.Yy&&r.Jy.length<100&&r.Ly(!0),r.My.parentElement.scrollLeft>0?s.classList(r.Ey).remove("disabled"):s.classList(r.Ey).add("disabled")}},n.prototype.Ly=function(e){var t=this;return!!t.Oy()&&(s.classList(t.Ty).add("yvp-pl-loading"),void t.$e.fetchMore(t.ty,function(r,n){n&&n.length>0?(t.Py(n),u.mobile||e||t.Fy(!0)):(s.classList(t.Ty).remove("yvp-pl-loading"),t.Ky=!0)}))},n.prototype.zy=function(e){var t,r=this,n="dark",i=r.l.ui.playlistUI&&r.l.ui.playlistUI.theme||n;switch(e){case l.PLAYLIST_POS_BOTTOM:case l.PLAYLIST_POS_RIGHT:t=i;break;case l.PLAYLIST_POS_HIDDEN:t=n;break;default:t=n}return t},n.prototype.Cy=function(e){var t=this;t._node=e,t.My=e.querySelector(".yvp-playlist-strip-list"),t.Iy=e.querySelector(".yvp-playlist-strip"),t.Ty=e,t.Ey=e.querySelector(".yvp-playlist-pg-btn-prev"),t.Hy=e.querySelector(".yvp-playlist-pg-btn-next"),t.$y=e.querySelector(".yvp-pl-loader-bg")},n.prototype.sy=function(){var e,t,r,n,i,o,c=this,u=c.m.getFullscreen(),p=c.m.getContentNode(),d=[];if(c.$e.isPlaylistShown()&&c.Sy(),c.Ay===l.PLAYLIST_POS_BOTTOM||c.Ay===l.PLAYLIST_POS_RIGHT){if(i=p.querySelector(".yvp-upnext-playlist"),e=p.querySelector(".yvp-playlist-mode-hidden"),t=p.querySelector(".yvp-playlist-mode-"+c.Ay),r=e.querySelector(".yvp-playlist-strip-list"),n=t.querySelector(".yvp-playlist-strip-list"),u)r.innerHTML=n.innerHTML,n.innerHTML="",s.classList(i).remove("hide"),s.classList(e).remove("yvp-pl-loading"),c.Cy(e),c.$e&&c.$e.attachUpNextMouseEvents(),setTimeout(function(){c.Uy("hidden",!0)},500);else{n.innerHTML=r.innerHTML,r.innerHTML="",o=c.Ay===l.PLAYLIST_POS_RIGHT,s.classList(i).add("hide"),c.Cy(t),c.$e&&c.$e.detachUpNextMouseEvents();var f=c.My.querySelector(".yvp-currently-playing");f&&s.classList(f).remove("yvp-hide"),setTimeout(function(){c.Uy(c.Ay,o)},500)}c._y(),c.xy&&c.xy.forEach(function(e){e.destroy()}),c.xy=[],c.Pg(!1),d=Array.prototype.slice.call(c.My.querySelectorAll(".yvp-playlist-item"),0),d.forEach(function(e){c.xy.push(new a(e)),e.addEventListener("tap",c.By)})}},n.prototype.ue=function(){var e=this;e.$e.isPlaylistShown()&&(e.wy=0,e.vy=0,setTimeout(function(){e.Sy()},1e3))},n.prototype.Kf=function(){var e,t,r=this;t=r.m.getFullscreen(),e=t?"hidden":r.Ay,r.Uy(e,!0),r.renderFirstBatch()},n.prototype.u=function(){var e=this;e.renderFirstBatch()},n.prototype.az=function(){var e=this;e.xy&&e.xy.forEach(function(e){e.destroy()}),e.xy=[];var t=Array.prototype.slice.call(e.My.querySelectorAll(".yvp-playlist-item"),0);t.forEach(function(t){t.removeEventListener("tap",e.By)}),e.My.innerHTML=""},n.prototype._y=function(){var e=this;e.Gy&&e.Gy&&(e.Gy.destroy(),e.Gy.destroy(),e.Ey.removeEventListener("tap",e.Fy),e.Hy.removeEventListener("tap",e.Fy))},n.prototype.destroy=function(){var e=this;if(e._y(),e.xy&&e.xy.forEach(function(e){e.destroy()}),e.xy=[],e.My){var t=Array.prototype.slice.call(e.My.querySelectorAll(".yvp-playlist-item"),0);t.forEach(function(t){t.removeEventListener("tap",e.By)})}}},{"../../../lib":"/lib/index.js","../constants":7,"../event":"/nextgen/src/event.js","../strings":"/nextgen/src/strings.js","../tap":"/nextgen/src/tap.js","../util":"/nextgen/src/util.js","./playlist-items.html":77,"./playlist.html":78,"user-agent":233}],80:[function(e,t,r){var n=new(e("hogan.js/lib/template").Template)(function(e,t,r){var n=this;return n.b(r=r||""),n.b("<div>"),n.b("\n"+r),n.b("    <pre>"),n.b("\n"+r),n.b(n.v(n.f("config",e,t,0))),n.b("\n"+r),n.b("    </pre>"),n.b("\n"+r),n.b("    <table border='1'>"),n.b("\n"+r),n.b("        <style>"),n.b("\n"+r),n.b("            .bars {"),n.b("\n"+r),n.b("                white-space: nowrap;"),n.b("\n"+r),n.b("            }"),n.b("\n"+r),n.b("            .bars div {"),n.b("\n"+r),n.b("                display: inline-block;"),n.b("\n"+r),n.b("                height: 25px;"),n.b("\n"+r),n.b("            }"),n.b("\n"+r),n.b("            .bar {"),n.b("\n"+r),n.b("                background-color: #714fff;"),n.b("\n"+r),n.b("                border: 1px solid #000;"),n.b("\n"+r),n.b("            }"),n.b("\n"+r),n.b("        </style>"),n.b("\n"+r),n.b("        <tr>"),n.b("\n"+r),n.b("            <th>Type</th>"),n.b("\n"+r),n.b("            <th>Description</th>"),n.b("\n"+r),n.b("            <th>Start</th>"),n.b("\n"+r),n.b("            <th>End</th>"),n.b("\n"+r),n.b("            <th>Diff</th>"),n.b("\n"+r),n.b("            <th>Bar</th>"),n.b("\n"+r),n.b("        </tr>"),n.b("\n"+r),n.s(n.f("profileItems",e,t,1),e,t,0,602,1024,"{{ }}")&&(n.rs(e,t,function(e,t,n){n.b("            <tr>"),n.b("\n"+r),n.b("                <td>"),n.b(n.v(n.f("type",e,t,0))),n.b("</td>"),n.b("\n"+r),n.b("                <td>"),n.b(n.v(n.f("desc",e,t,0))),n.b("</td>"),n.b("\n"+r),n.b("                <td>"),n.b(n.v(n.f("startTime",e,t,0))),n.b("</td>"),n.b("\n"+r),n.b("                <td>"),n.b(n.v(n.f("endTime",e,t,0))),n.b("</td>"),n.b("\n"+r),n.b("                <td>"),n.b(n.v(n.f("timeDiff",e,t,0))),n.b("</td>"),n.b("\n"+r),n.b("                <td class='bars'>"),n.b("\n"+r),n.b("                    <div style='width: "),n.b(n.v(n.f("startWidth",e,t,0))),n.b("px;'></div>"),n.b("\n"+r),n.b("                    <div class='bar' style='width: "),n.b(n.v(n.f("barWidth",e,t,0))),n.b("px;'></div>"),n.b("\n"+r),n.b("                </td>"),n.b("\n"+r),n.b("            </tr>"),n.b("\n")}),e.pop()),n.b("    </table>"),n.b("\n"+r),n.b("</div>"),n.b("\n"),n.fl()});t.exports={render:function(){return n.render.apply(n,arguments)},r:function(){return n.r.apply(n,arguments)},ri:function(){return n.ri.apply(n,arguments)}}},{"hogan.js/lib/template":141}],81:[function(e,t,r){var n=new(e("hogan.js/lib/template").Template)(function(e,t,r){var n=this;return n.b(r=r||""),n.b("<div class='yvp-settings-container yvp-vis-hidden' tabindex='0'>"),n.b("\n"+r),n.b("    <div class='yvp-main-settings open'>"),n.b("\n"+r),n.b("        <div class='yvp-settings-embed'>"),n.b("\n"+r),n.b("            <div class='yvp-settings-header' tabindex='0' aria-label='"),n.b(n.v(n.d("strings.EMBED",e,t,0))),n.b("'>"),n.b(n.v(n.d("strings.EMBED",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("            <div class='yvp-input-container yvp-embed-input-container'>"),n.b("\n"+r),n.b("                <input type='text' class='yvp-embed-input' value='' data-link-type='emb' readonly />"),n.b("\n"+r),n.b("            </div>"),n.b("\n"+r),n.b("            <div class='yvp-settings-divider'></div>"),n.b("\n"+r),n.b("        </div>"),n.b("\n"+r),n.b("        <div class='yvp-settings-quality'>"),n.b("\n"+r),n.b("            <div class='yvp-settings-header' tabindex='0' aria-label='"),n.b(n.v(n.d("strings.VIDEO_QUALITY",e,t,0))),n.b("'>"),n.b(n.v(n.d("strings.VIDEO_QUALITY",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("            <div class='yvp-settings-item "),n.b(n.v(n.d("qualityMap.auto.btnClass",e,t,0))),n.b(" yvp-settings-activated' tabindex='1'>"),n.b(n.v(n.d("strings.AUTO",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("            <div class='yvp-settings-item "),n.b(n.v(n.d("qualityMap.high.btnClass",e,t,0))),n.b(" yvp-disabled' tabindex='2'>"),n.b(n.v(n.d("strings.HIGH",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("            <div class='yvp-settings-item "),n.b(n.v(n.d("qualityMap.medium.btnClass",e,t,0))),n.b(" yvp-disabled' tabindex='3'>"),n.b(n.v(n.d("strings.MEDIUM",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("            <div class='yvp-settings-item last-item "),n.b(n.v(n.d("qualityMap.low.btnClass",e,t,0))),n.b(" yvp-disabled' tabindex='4'>"),n.b(n.v(n.d("strings.LOW",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("            <div class='yvp-settings-divider'></div>"),n.b("\n"+r),n.b("        </div>"),n.b("\n"+r),n.b("        <div class='yvp-settings-cc'>"),n.b("\n"+r),n.b("            <div class='yvp-settings-header last-item' tabindex='0' aria-label='"),n.b(n.v(n.d("strings.CC_SETTINGS",e,t,0))),n.b("'>"),n.b(n.v(n.d("strings.CC_SETTINGS",e,t,0))),n.b("</div>"),n.b("\n"+r),n.b("            <div class='yvp-settings-caret-icon right'></div>"),n.b("\n"+r),n.b("        </div>"),n.b("\n"+r),n.b("    </div>"),n.b("\n"+r),n.b("</div>"),n.fl()});t.exports={render:function(){return n.render.apply(n,arguments)},r:function(){return n.r.apply(n,arguments)},ri:function(){return n.ri.apply(n,arguments)}}},{"hogan.js/lib/template":141}],82:[function(e,t,r){"use strict";function n(e,t){var r=this;r.k=e,r.l=t,r.bz=new c(r.k,r.l),r.cz={auto:{btnClass:"yvp-quality-auto",bitrate:0},low:{btnClass:"yvp-quality-low",bitrate:0},medium:{btnClass:"yvp-quality-medium",bitrate:0},high:{btnClass:"yvp-quality-high",bitrate:0}},r.dz={},r.ez=0,r.k.subscribe(i.PLAYBACK_STARTED,r.Kf,r),r.k.subscribe(i.MEDIA_ITEM_LOADED,r.fz,r)}t.exports=n;var i=e("../event"),a=e("../tap"),o=e("../strings"),s=e("../util"),l=(e("../../../lib/logger"),e("../../src/stream")),c=e("./cc-options"),u=e("./settings.html");n.prototype.create=function(){var e=this,t=s.render(u,{strings:o.i18n,qualityMap:e.cz}),r=e.bz.render();return e._node=t,e.gz=t.querySelector(".yvp-main-settings"),e.hz=e.gz.querySelector(".yvp-settings-quality"),e.iz=e.gz.querySelector("."+e.cz.auto.btnClass),e.jz=e.gz.querySelector("."+e.cz.low.btnClass),e.kz=e.gz.querySelector("."+e.cz.medium.btnClass),e.lz=e.gz.querySelector("."+e.cz.high.btnClass),e.mz=e.gz.querySelector(".yvp-settings-cc"),e.nz=e.iz,r.length>0&&(r.forEach(function(t){e._node.appendChild(t)}),e.oz=r[0],e.pz=e.oz.querySelector(".yvp-cc-back-to-settings")),e.Pg(),t},n.prototype.Pg=function(){var e=this;e.qz=new a(e.mz),e.rz=function(t){t.stopPropagation(),e.sz()},e.mz.addEventListener("tap",e.rz),e.tz=new a(e.pz),e.uz=function(t){t.stopPropagation(),e.vz()},e.pz.addEventListener("tap",e.uz),e.wz=new a(e._node),e.xz=function(e){e.stopPropagation()},e._node.addEventListener("tap",e.xz)},n.prototype.sz=function(){var e=this;s.classList(e.gz).remove("open"),s.classList(e.gz).add("close"),s.classList(e.oz).remove("close"),s.classList(e.oz).add("open")},n.prototype.vz=function(){var e=this;s.classList(e.gz).remove("close"),s.classList(e.gz).add("open"),s.classList(e.oz).remove("add"),s.classList(e.oz).add("close")},n.prototype.yz=function(e,t,r,n,o){var l=this;null!==e?(s.classList(t).remove("yvp-disabled"),"auto"!==o&&(l.ez++,l.zz=o),l.cz[o].bitrate=e.bitrate,l[r]=function(r){r.stopPropagation(),l.Az(t);var n="sr-"+o;l.k.publish(i.API.UI_INTERACT,{srcElement:n}),l.k.publish(i.QUALITY_SELECTED,{preference:o,stream:e}),l.l.playback.quality=o},l[n]=new a(t),t.addEventListener("tap",l[r])):s.classList(t).add("yvp-disabled")},n.prototype.Bz=function(){var e=this;e.Cz(),e.yz(e.dz.low,e.jz,"_onQualityLowTap","_qualityLowTap","low"),e.yz(e.dz.medium,e.kz,"_onQualityMediumTap","_qualityMediumTap","medium"),e.yz(e.dz.high,e.lz,"_onQualityHighTap","_qualityHighTap","high"),e.yz(e.dz.auto,e.iz,"_onQualityAutoTap","_qualityAutoTap","auto"),e.Dz()},n.prototype.Cz=function(){var e,t=this,r=t.l.playlist.getCurrentItem().streams,n=t.l.playlist.getCurrentItem().streamProfiles,i=t.l.capabilities[t.l.playbackState.rendererType];r.length>1?t.dz=s.mapStreamsToQualities(r):n.length>1?t.dz=s.mapStreamsToQualities(n):t.dz=s.mapStreamsToQualities({bitrates:t.l.playback.bitrates,heights:t.l.playback.heights}),e=l.findStreamByProperty(r,"bitrate",t.l.playback.desiredBitrate,i),t.dz.auto=e},n.prototype.Dz=function(){var e=this;if(1===e.ez){var t=e.cz[e.zz].btnClass,r=e.hz.querySelector("."+t);s.classList(r).add("yvp-disabled")}},n.prototype.Kf=function(){var e,t=this,r=s.shouldEnableQualitySelector(t.l);r?(t.Bz(),e=t.hz.querySelector("."+t.cz.auto.btnClass),t.Az(e),s.classList(t.hz).add("yvp-quality-enabled")):s.classList(t.hz).remove("yvp-quality-enabled")},n.prototype.Az=function(e){var t=this;s.classList(t.nz).remove("yvp-settings-activated"),t.nz=e?e:t.iz,s.classList(t.nz).add("yvp-settings-activated")},n.prototype.Ez=function(e,t,r,n){t&&r&&(r.destroy(),e.removeEventListener("tap",n))},n.prototype.fz=function(){var e=this,t=e.l.playlist.getCurrentItem(),r=e.Fz(),n=t.embedCode||r,l=t.embedRights,c=e._node.querySelector(".yvp-settings-embed");e.Gz=e._node.querySelector(".yvp-embed-input"),e.Hz=new a(e.Gz),e.Iz=function(t){t.target.focus(),t.target.setSelectionRange(0,t.target.value.length),e.k.publish(i.API.UI_INTERACT,{srcElement:"settings-embed"})},e.Gz.addEventListener("tap",e.Iz),r?(e.Gz.value=l?e.generateEmbedCode(n):o.i18n.EMBED_NOT_ALLOWED,s.classList(c).add("open"),s.classList(c).remove("close")):(s.classList(c).add("close"),s.classList(c).remove("open"))},n.prototype.Fz=function(){var e=this,t=e.l.playlist&&e.l.playlist.getCurrentItem(),r=t&&t.shareUrl;return!e.l.playback.playInlineVideo&&window.location.pathname.indexOf(".html")>-1&&(r=window.location.protocol+"//"+window.location.host+window.location.pathname),r},n.prototype.generateEmbedCode=function(e){return e.match(/<iframe/)?e:"<iframe width='640' height='360' scrolling='no' frameborder='0' src='"+e+"?format=embed' allowfullscreen='true' mozallowfullscreen='true' webkitallowfullscreen='true' allowtransparency='true' allow='autoplay; fullscreen; encrypted-media'></iframe>"},n.prototype.destroy=function(){var e=this;e.qz&&e.mz&&(e.qz.destroy(),e.mz.removeEventListener("tap",e.rz)),e.Hz&&e.Gz&&(e.Hz.destroy(),e.Gz.removeEventListener("tap",e.Iz)),e.tz&&e.pz&&(e.tz.destroy(),e.pz.removeEventListener("tap",e.uz)),e.wz&&e._node&&(e.wz.destroy(),e._node.removeEventListener("tap",e.xz)),e.Ez(e.iz,e.dz.auto,e.Jz,e.Kz),e.Ez(e.jz,e.dz.low,e.Lz,e.Mz),e.Ez(e.kz,e.dz.medium,e.Nz,e.Oz),e.Ez(e.lz,e.dz.high,e.Pz,e.Qz),e.bz=null,e.hz=null,e._node=null}},{"../../../lib/logger":"/lib/logger.js","../../src/stream":"/nextgen/src/stream.js","../event":"/nextgen/src/event.js","../strings":"/nextgen/src/strings.js","../tap":"/nextgen/src/tap.js","../util":"/nextgen/src/util.js","./cc-options":63,"./settings.html":81}],83:[function(e,t,r){var n=new(e("hogan.js/lib/template").Template)(function(e,t,r){var n=this;return n.b(r=r||""),n.b("<div class='yvp-start-screen "),n.s(n.f("show",e,t,1),e,t,1,0,0,"")||n.b("yvp-vis-hidden yvp-disp-none"),n.b("' tabindex='-1'>"),n.b("\n"+r),n.b("    <img class='yvp-start-screen-image' src='"),n.b(n.v(n.f("imageSrc",e,t,0))),n.b("' width='"),n.b(n.v(n.f("width",e,t,0))),n.b("' height='"),n.b(n.v(n.f("height",e,t,0))),n.b("' aria-hidden='true'>"),n.b("\n"+r),n.s(n.d("config.showButton",e,t,1),e,t,0,235,355,"{{ }}")&&(n.rs(e,t,function(e,t,r){r.b("        <div class='yvp-start-screen-button' tabindex='0' aria-label='"),r.b(r.v(r.d("strings.PLAY_VIDEO",e,t,0))),r.b("' role='button'></div>"),r.b("\n")}),e.pop()),n.b("    <div class='yvp-start-screen-bar-wrapper'>"),n.b("\n"+r),n.b("        <div class='yvp-start-screen-bar' tabindex='-1'>"),n.b("\n"+r),n.s(n.d("config.showProvider",e,t,1),e,t,0,518,626,"{{ }}")&&(n.rs(e,t,function(e,t,r){r.b("                <h4 class='yvp-start-screen-provider' tabindex='1'>"),r.b(r.v(r.d("item.provider.name",e,t,0))),r.b("</h4>"),r.b("\n")}),e.pop()),n.s(n.d("config.showTitle",e,t,1),e,t,0,684,781,"{{ }}")&&(n.rs(e,t,function(e,t,r){r.b("                <h3 class='yvp-start-screen-title' tabindex='2'>"),r.b(r.v(r.d("item.title",e,t,0))),r.b("</h3>"),r.b("\n")}),e.pop()),n.s(n.d("config.showDescription",e,t,1),e,t,0,842,949,"{{ }}")&&(n.rs(e,t,function(e,t,r){r.b("                <p class='yvp-start-screen-description' tabindex='3'>"),r.b(r.v(r.d("item.description",e,t,0))),r.b("</p>"),r.b("\n")}),e.pop()),n.b("        </div>"),n.b("\n"+r),n.b("    </div>"),n.b("\n"+r),n.b("</div>"),n.b("\n"),n.fl()});t.exports={render:function(){return n.render.apply(n,arguments)},r:function(){return n.r.apply(n,arguments)},ri:function(){return n.ri.apply(n,arguments)}}},{"hogan.js/lib/template":141}],84:[function(e,t,r){"use strict";function n(e){var t=this;t.k=e}t.exports=n;var i=e("../event"),a=e("../tap"),o=e("../util"),s=e("../strings"),l=e("user-agent").userAgent,c=e("./start-screen.html");n.prototype.create=function(e,t){var r=this,n=t.ui.startScreenConfig,u={showTitle:n.showTitle&&e.title,showButton:n.showButton,showDescription:n.showDescription&&e.description,showProvider:n.showProvider&&e.provider&&e.provider.name},p=e.images.large||e.images.thumbnail||e.images.medium||e.images.small||e.images.provider;return r.node=o.render(c,{item:e,config:u,width:t.uiState.width,height:t.uiState.height,imageSrc:p,strings:s.i18n,show:t.uiState&&t.uiState.isCSSLoaded}),r.Rz=new a(r.node),r.Sz=function(){var e=function(){r.k.publish(i.START_SCREEN_CLICK),r.k.publish(i.API.UI_INTERACT,{srcElement:"startScreen"})};l.htc_one?setTimeout(e,500):e()},r.node.addEventListener("tap",r.Sz),r.node;
},n.prototype.destroy=function(){var e=this;e.Rz.destroy(),e.node.removeEventListener("tap",e.Sz),e.node=null}},{"../event":"/nextgen/src/event.js","../strings":"/nextgen/src/strings.js","../tap":"/nextgen/src/tap.js","../util":"/nextgen/src/util.js","./start-screen.html":83,"user-agent":233}],85:[function(e,t,r){"use strict";function n(e,t,r){var n=this;a.call(n,e,t,r),n.k.subscribe(s.PLAYBACK_PROGRESS,n.Tz,n),n.k.subscribe(s.PLAYBACK_ENDED,n.Uz,n)}t.exports=n;var i=e("../util"),a=e("./playlist"),o=e("../tap"),s=e("../event"),l=e("../constants");i.inherits(n,a),n.prototype.create=function(e){var t=this;return n.super_.prototype.create.call(t,e)},n.prototype.Ly=i.noop,n.prototype.Qy=function(e){var t="",r="",n=this;t=e.mediaItem.thumbnail,!t&&e.mediaItem.images&&(t=e.mediaItem.images.defaultThumbnail||e.mediaItem.images.thumbnail),t=t||e.mediaItem.wh;var i=e.mediaItem.getLabelIcon(l.PLAYLIST_LABEL_ICON_DIMENSION);return null!==i&&(r=i.url),e.mediaItem.isBumper()&&(t=null,r=null,e.mediaItem.title="",e.title=""),!e.mediaItem.isWatched()&&n.l.watchHistory&&n.l.watchHistory.isWatched(e.mediaItem.id,e.mediaItem.duration)&&e.mediaItem.setWatched(!0),{id:e.mediaItem.id,title:e.title,showUpNext:e.showUpNext,upNextTime:e.upNextTime,thumbnail:t,labelIcon:r,sectionLabel:e.mediaItem.getSectionLabel(),sectionLabelIcon:e.mediaItem.getSectionIcon(l.PLAYLIST_SECTION_ICON_DIMENSION),duration:e.duration,provider:e.provider,idx:e.idx,isWatched:e.mediaItem.isWatched()}},n.prototype.Ry=function(e){for(var t,r=this,n={items:e.items,strings:e.strings,isWideMode:r.Ay===l.PLAYLIST_POS_RIGHT},a=i.render(e.template,n),s=Array.prototype.slice.call(a.querySelectorAll(".yvp-playlist-item"),0),c=0;c<s.length;c++){var u=e.items[c];if(u.sectionLabel){var p=document.createElement("li");i.classList(p).add("yvp-pl-section-label"),i.classList(p).add("yvp-show");var d="";u.sectionLabelIcon&&(d='<img class="yvp-playlist-icon section" src="'+u.sectionLabelIcon.url+'" />'),p.innerHTML=d+u.sectionLabel,r.My.appendChild(p)}if(t=s[c],t.itemIndex=c+r.Jy.length,r.xy.push(new o(t)),t.addEventListener("tap",r.By),r.My.appendChild(t),u.isWatched&&r.Vz(t),u.labelIcon){var f=t.querySelector(".yvp-pl-title");f.innerHTML=u.title,t.innerHTML='<span class="yvp-playlist-icon-wrapper"><img class="yvp-playlist-icon item" src="'+u.labelIcon+'" /></span>'+t.innerHTML}}i.hasUnwatchedClips(e.items)||(r.l.playback.skipWatchedVideos=!1)},n.prototype.Tz=function(e,t){var r=this,n=r.l.playlist.getMediaItemById(e);n.progress.position%10===0&&r.Wz(e,n.isWatched())},n.prototype.Uz=function(e){var t=this,r=t.l.playlist.getMediaItemById(e);r.isBumper()||(t.l.watchHistory&&t.l.watchHistory.saveProgress(r,!0),t.Wz(e,r.isWatched()))},n.prototype.Wz=function(e,t){var r=this,n='.yvp-playlist-item[data-id="'+e+'"]',i=r.My.querySelector(n);i&&(t?r.Vz(i):r.Xz(i))},n.prototype.Vz=function(e){var t=e.querySelector(".yvp-playlist-item-watched");i.classList(t).add("yvp-show")},n.prototype.Xz=function(e){var t=e.querySelector(".yvp-playlist-item-watched");i.classList(t).remove("yvp-show")}},{"../constants":7,"../event":"/nextgen/src/event.js","../tap":"/nextgen/src/tap.js","../util":"/nextgen/src/util.js","./playlist":79}],86:[function(e,t,r){"use strict";function n(e,t,r){var n=this;n.Yz=e,n._b=t,n.k=r,n.a=[],n._b.items=n._b.items||[]}t.exports=n;var i=e("../../util"),a=e("../../tap"),o=e("../../../../lib");n.prototype.create=function(){var e=this;return e.node=document.createElement("div"),i.classList(e.node).add(e.Yz.wrapper),e.Zz=document.createElement("div"),i.classList(e.Zz).add(e.Yz.selectedWrapper),e.$z=document.createElement("div"),i.classList(e.$z).add(e.Yz.selected),e._z=document.createElement("span"),i.classList(e._z).add(e.Yz.availability),e.aA=document.createElement("span"),i.classList(e.aA).add(e.Yz.dropDownIcon),e.Zz.appendChild(e.$z),e.Zz.appendChild(e.aA),e.node.appendChild(e.Zz),e.bA(),e.node.appendChild(e.cA),e.dA(e._b.selected),e.nt(),e.node},n.prototype.bA=function(){var e=this;e.cA?(e.eA(),e.cA.innerHTML=""):e.cA=document.createElement("ul"),i.classList(e.cA).add(e.Yz.list);var t,r=document.createDocumentFragment();e._b.items.length>0?e._b.items.forEach(function(n,a){t=document.createElement("li"),e._b.itemsData&&(t.val=e._b.itemsData[a]),i.classList(t).add(e.Yz.listItem),t.appendChild(document.createTextNode(n));var o=document.createElement("span");i.classList(o).add(e.Yz.availability),t.appendChild(o),r.appendChild(t)}):(t=document.createElement("li"),i.classList(t).add(e.Yz.listItem),t.appendChild(document.createTextNode(e._b.noItemsText)),r.appendChild(t)),e.cA.innerHTML="",e.cA.appendChild(r),e.fA()},n.prototype.syncData=function(e){var t=this;e.items&&(t._b.items=e.items.length>0?e.items:t._b.items,t._b.itemsData=e.itemsData.length>0?e.itemsData:t._b.itemsData,t.bA()),t._b.selected=e.selected,t.dA(t._b.selected)},n.prototype.dA=function(e){var t=this,r=document.createTextNode(e);t.$z.firstChild?t.$z.replaceChild(r,t.$z.firstChild):(t.$z.appendChild(r),t.$z.appendChild(t._z)),t._b.items.length>0?i.classList(t._z).remove(t.Yz.notAvailable):i.classList(t._z).add(t.Yz.notAvailable)},n.prototype.nt=function(){var e=this;e.gA=new a(e.Zz),e.hA=function(t){t.stopPropagation(),e.iA()},e.Zz.addEventListener("tap",e.hA)},n.prototype.fA=function(){var e=this;e.jA=function(t){t.stopPropagation(),e.dA(t.target.textContent),e.iA(),e.kA(t.target)},e.lA=[],Array.prototype.forEach.call(e.cA.childNodes,function(t){var r=new a(t);e.lA.push(r),t.childNodes[0].nodeValue!==e._b.noItemsText&&t.addEventListener("tap",e.jA)})},n.prototype.iA=function(){var e=this;e.mA?i.classList(e.cA).remove("open"):i.classList(e.cA).add("open"),e.mA=!e.mA},n.prototype.tt=function(){var e=this;e.gA&&e.gA.destroy(),e.gA&&e.aA.removeEventListener("tap",e.hA),e.eA()},n.prototype.eA=function(){var e=this;e.cA.childNodes&&(Array.prototype.forEach.call(e.cA.childNodes,function(t){t.removeEventListener("tap",e.jA)}),e.lA.forEach(function(e){e.destroy()}))},n.prototype.registerEvent=function(e){var t=this;t.a.indexOf(e)===-1&&t.a.push(e)},n.prototype.removeEvent=function(e){var t=this,r=t.a.indexOf(e);r!==-1&&t.a.splice(r,1)},n.prototype.kA=function(e){var t=this,r=o.isNullOrUndefined(e.val)?null:e.val;if(null===r&&(r=e.textContent),t.a)for(var n=0;n<t.a.length;n++)t.k.publish(t.a[n],r)},n.prototype.destroy=function(){var e=this;e.tt(),e.events=null,e.node=null,e.cA=null,e.lA=null}},{"../../../../lib":"/lib/index.js","../../tap":"/nextgen/src/tap.js","../../util":"/nextgen/src/util.js"}],87:[function(e,t,r){"use strict";function n(e,t,r){var n=this;n.Yz=e,n._b=t,n.k=r,n.a=[],n.nA()}t.exports=n;var i=e("../../util"),a=e("../../../../lib"),o=e("../../tap");n.prototype.nA=function(){var e=this;if(!e._b)throw new Error("No config object provided for slider");if(e._b.minValue>=e._b.maxValue)throw new Error("Slider's min value is bigger/equal than max value");if(e._b.minValue>e._b.initialValue)throw new Error("Slider's min value is bigger than initial value");if(e._b.maxValue<e._b.initialValue)throw new Error("Slider's max value is smaller than initial value")},n.prototype.create=function(){var e=this;e.node=document.createElement("div"),i.classList(e.node).add(e.Yz.wrapper),e.oA=document.createElement("div"),i.classList(e.oA).add(e.Yz.track);var t=100/(e._b.anchors-1),r=0;if(e.pA=[],e._b.anchors>0)for(var n=0;n<e._b.anchors;n++){var a=document.createElement("div");i.classList(a).add(e.Yz.anchor),a.setAttribute("style","left: "+r+"%"),e.pA.push(r),r+=t,e.oA.appendChild(a)}return e.qA=document.createElement("div"),i.classList(e.qA).add(e.Yz.handle),e._b.initialValue&&(e.qA.setAttribute("style","left: "+e._b.initialValue+"%"),e.rA=e._b.initialValue/e._b.maxValue),e.oA.appendChild(e.qA),e.node.appendChild(e.oA),e.nt(),e.node},n.prototype.dA=function(e,t){var r,n=this;if(n._b.anchors>0){var i=100;n.pA.forEach(function(t){Math.abs(t-e)<i&&(i=Math.abs(t-e),r=t)})}e=a.isNullOrUndefined(r)?e:r,n.sA(e),t||n.kA(e)},n.prototype.tA=function(e){var t=this,r=t.uA(e);this.dA(r)},n.prototype.nt=function(){var e=this;e.node&&(e.vA=new o(e.node),e.wA=function(t){t.stopPropagation(),e.tA(t)},e.node.addEventListener("tap",e.wA),e.xA=function(t){e.Iw(t),e.yA=!0,e.Gw(t)},e.Gw=function(t){e.yA&&(e.Iw(t),e.tA(t))},e.zA=function(t){e.yA&&(e.Iw(t),e.yA=!1)},["mousedown","touchstart"].forEach(function(t){e.node.addEventListener(t,e.xA)}),["mousemove","touchmove"].forEach(function(t){document.addEventListener(t,e.Gw)}),["mouseup","touchend"].forEach(function(t){document.addEventListener(t,e.zA)}))},n.prototype.tt=function(){var e=this;e.vA&&e.vA.destroy(),e.node.removeEventListener("tap",e.wA),["mousedown","touchstart"].forEach(function(t){e.node.removeEventListener(t,e.xA)}),["mousemove","touchmove"].forEach(function(t){document.removeEventListener(t,e.Gw)}),["mouseup","touchend"].forEach(function(t){document.removeEventListener(t,e.zA)})},n.prototype.Iw=function(e){e.type.indexOf("touch")!==-1&&e.preventDefault()},n.prototype.sA=function(e){var t=this;t.qA.setAttribute("style","left: "+e+"%")},n.prototype.uA=function(e){var t=this,r=e.pageX-t.node.getBoundingClientRect().left;return t.rA=r/t.node.clientWidth,100*Math.max(0,Math.min(1,t.rA))},n.prototype.registerEvent=function(e){var t=this;t.a.indexOf(e)===-1&&t.a.push(e)},n.prototype.removeEvent=function(e){var t=this,r=t.a.indexOf(e);r!==-1&&t.a.splice(r,1)},n.prototype.kA=function(e){var t=this;t.a.forEach(function(r){t.k.publish(r,e)})},n.prototype.getValue=function(){var e=this;if(e.rA)return e._b.maxValue&&e.rA*e._b.maxValue},n.prototype.setValue=function(e,t){var r=this;r.rA=r._b.maxValue&&e/r._b.maxValue,r.dA(e,t)},n.prototype.destroy=function(){var e=this;e.tt(),e.events=null,e.node=null}},{"../../../../lib":"/lib/index.js","../../tap":"/nextgen/src/tap.js","../../util":"/nextgen/src/util.js"}],88:[function(e,t,r){var n=new(e("hogan.js/lib/template").Template)(function(e,t,r){var n=this;return n.b(r=r||""),n.b("<div class='yvp-tooltip-wrapper'>"),n.b("\n"+r),n.b("    <div class='yvp-tooltip-content yvp-vis-hidden'>"),n.b("\n"+r),n.b("        "),n.b(n.v(n.f("tooltip-msg",e,t,0))),n.b("\n"+r),n.b("    </div>"),n.b("\n"+r),n.b("</div>"),n.b("\n"),n.fl()});t.exports={render:function(){return n.render.apply(n,arguments)},r:function(){return n.r.apply(n,arguments)},ri:function(){return n.ri.apply(n,arguments)}}},{"hogan.js/lib/template":141}],89:[function(e,t,r){"use strict";function n(e,t,r){var n=this;n.node=e,n.AA=a.isString(t)?t:"";var o=i.render(s,{"tooltip-msg":n.AA});n.BA=o.querySelector(".yvp-tooltip-content"),n.CA=o,n.node.appendChild(o),n.setEnabled(!0),n.DA=function(e){e.stopPropagation(),i.classList(n.node).remove("yvp-tooltip-hidden")},r&&(r.hideUponClick&&n.hideOnClick(),r.positionBottom&&n.setPositionBottom())}t.exports=n;var i=e("../../util"),a=e("../../../../lib"),o=e("../../tap"),s=e("./tooltip.html");n.prototype.setText=function(e){var t=this;t.AA=e,t.BA.innerHTML=t.AA},n.prototype.setEnabled=function(e){var t=this;t.EA=e,e?i.classList(t.node).add("yvp-tooltip"):i.classList(t.node).remove("yvp-tooltip")},n.prototype.hideOnClick=function(){var e=this;e.FA||(e.GA=new o(e.node),e.HA=function(t){e.node&&i.classList(e.node).add("yvp-tooltip-hidden")},e.node.addEventListener("tap",e.HA,e),["mouseleave","touchend"].forEach(function(t){e.node.addEventListener(t,e.DA)}),e.FA=!0)},n.prototype.setPositionBottom=function(){var e=this;i.classList(e.CA).add("yvp-tooltip-pos-bottom")},n.prototype.destroy=function(){var e=this;e.node&&(e.GA&&(e.GA.destroy(),e.node.removeEventListener("tap",e.HA)),["mouseleave","touchend"].forEach(function(t){e.node.removeEventListener(t,e.DA)})),e.BA=null,e.node=null}},{"../../../../lib":"/lib/index.js","../../tap":"/nextgen/src/tap.js","../../util":"/nextgen/src/util.js","./tooltip.html":88}],90:[function(e,t,r){var n=new(e("hogan.js/lib/template").Template)(function(e,t,r){var n=this;return n.b(r=r||""),n.b("<div>"),n.b("\n"+r),n.b("    <div class='yvp-top-bar yvp-vis-hidden'>"),n.b("\n"+r),n.b("        <div class='yvp-content-type hide' tabindex='0'></div>"),n.b("\n"+r),n.b("    </div>"),n.b("\n"+r),n.b("    <div class='yvp-login-prompt yvp-vis-hidden' id='yvp-login-prompt' role='dialog' tabindex='0'>"),n.b("\n"+r),n.b("        <div class='yvp-login-prompt-close' role='button' tabindex='0'></div>"),n.b("\n"+r),n.b("        <p class='yvp-login-prompt-msg' tabindex='0'>"),n.b(n.v(n.d("strings.LOGIN_MESSAGE",e,t,0))),n.b("</p>"),n.b("\n"+r),n.b("        <div class='yvp-login-yahoo-icn' role='button' tabindex='0'></div>"),n.b("\n"+r),n.b("    </div>"),n.b("\n"+r),n.b("    <div class='yvp-playing-item-title-header yvp-vis-hidden'></div>"),n.b("\n"+r),n.b("    <div class='yvp-playing-item-title yvp-vis-hidden'></div>"),n.b("\n"+r),n.b("    <a class='yvp-provider-logo yvp-vis-hidden' target='_blank' aria-hidden='true'>"),n.b("\n"+r),n.b("        <img class='yvp-provider-logo-img' />"),n.b("\n"+r),n.b("    </a>"),n.b("\n"+r),n.b("    <div class='yvp-bottom-bar yvp-vis-hidden'>"),n.b("\n"+r),n.b("        <div class='yvp-slider' role='slider' tabindex='0'>"),n.b("\n"+r),n.b("            <div class='yvp-slider-extension' aria-hidden='true'></div>"),n.b("\n"+r),n.b("            <div class='yvp-handle'></div>"),n.b("\n"+r),n.b("            <div class='yvp-buffer-bar'></div>"),n.b("\n"+r),n.b("            <div class='yvp-playback-bar'></div>"),n.b("\n"+r),n.b("            <div class='yvp-visual-seek'>"),n.b("\n"+r),n.b("                <div class='yvp-vs-thumbnail'></div>"),n.b("\n"+r),n.b("                <div class='yvp-vs-time'></div>"),n.b("\n"+r),n.b("            </div>"),n.b("\n"+r),n.b("        </div>"),n.b("\n"+r),n.b("        <div class='yvp-bottom-container'>"),n.b("\n"+r),n.b("            <div class='yvp-play-controls'>"),n.b("\n"+r),n.b("                <div class='yvp-play-btn' role='button' tabindex='0'></div>"),n.b("\n"+r),n.b("                <div class='yvp-upnext-container hide'>"),n.b("\n"+r),n.b("                    <div class='yvp-upnext-btn' role='button'>"),n.b("\n"+r),n.b("                    </div>"),n.b("\n"+r),n.b("                    <div class='yvp-upnext-playlist' role='dialog'>"),n.b("\n"+r),n.b("                        <div class='yvp-hover-elem'></div>"),n.b("\n"+r),n.b("                    </div>"),n.b("\n"+r),n.b("                </div>"),n.b("\n"+r),n.b("                <div class='yvp-time-container' tabindex='-1' aria-hidden='true'>"),n.b("\n"+r),n.b("                    <div class='yvp-current-time'></div>"),n.b("\n"+r),n.b("                    <div class='yvp-total-time'></div>"),n.b("\n"+r),n.b("                </div>"),n.b("\n"+r),n.b("            </div>"),n.b("\n"+r),n.b("            <div class='yvp-menu-controls'>"),n.b("\n"+r),n.b("                <div class='yvp-airplay-btn button yvp-hidden' role='button' tabindex='0' aria-label='"),n.b(n.v(n.d("strings.AIRPLAY",e,t,0))),n.b("'></div>"),n.b("\n"+r),n.b("                <div class='yvp-cc-btn button hide' role='button' tabindex='0' aria-label='"),n.b(n.v(n.d("strings.CC",e,t,0))),n.b("'></div>"),n.b("\n"+r),n.b("                <div class='yvp-volume-btn button' role='button' tabindex='0'>"),n.b("\n"+r),n.b("                    <div class='yvp-volume-bar-container'>"),n.b("\n"+r),n.b("                        <div class='yvp-multi-audio'></div>"),n.b("\n"+r),n.b("                        <div class='yvp-volume-level'>"),n.b("\n"+r),n.b("                            <div class='yvp-volume-bar'>"),n.b("\n"+r),n.b("                                <div class='yvp-volume-handle'></div>"),n.b("\n"+r),n.b("                            </div>"),n.b("\n"+r),n.b("                            <div class='yvp-volume-value'></div>"),n.b("\n"+r),n.b("                        </div>"),n.b("\n"+r),n.b("                    </div>"),n.b("\n"+r),n.b("                </div>"),n.b("\n"+r),n.b("                <div class='yvp-setting-btn button' role='button' tabindex='0' aria-label='"),n.b(n.v(n.d("strings.SETTINGS",e,t,0))),n.b("'>"),n.b("\n"+r),n.b("                    <div class='yvp-setting-pointer' aria-hidden='true'></div>"),n.b("\n"+r),n.b("                </div>"),n.b("\n"+r),n.b("                <div class='yvp-chromecast-btn button' role='button' tabindex='0' style='display:none;' aria-label='"),n.b(n.v(n.d("strings.CHROMECAST",e,t,0))),n.b("'></div>"),n.b("\n"+r),n.b("                <div class='yvp-fullscreen-btn button' role='button' tabindex='0'></div>"),n.b("\n"+r),n.b("            </div>"),n.b("\n"+r),n.b("        </div>"),n.b("\n"+r),n.b("    </div>"),n.b("\n"+r),n.b("    <div class='yvp-cast-overlay yvp-vis-hidden'>"),n.b("\n"+r),n.b("        <div>"),n.b("\n"+r),n.b("            <div class='cast-overlay-header'>"),n.b("\n"+r),n.b("                <div class='cast-device-info'>"),n.b("\n"+r),n.b("                    <p class='cast-device-name'>"),n.b(n.v(n.d("strings.CAST_PLAYING_RECEIVER",e,t,0))),n.b("</p>"),n.b("\n"+r),n.b("                    <small class='cast-device-type'>"),n.b(n.v(n.d("strings.CHROMECAST",e,t,0))),n.b("</small>"),n.b("\n"+r),n.b("                </div>"),n.b("\n"+r),n.b("            </div>"),n.b("\n"+r),n.b("            <div class='cast-overlay-content'></div>"),n.b("\n"+r),n.b("            <div class='cast-overlay-footer'>"),n.b("\n"+r),n.b("                <small class='cast-disconnect-btn'>"),n.b(n.v(n.d("strings.DISCONNECT",e,t,0))),n.b("</small>"),n.b("\n"+r),n.b("            </div>"),n.b("\n"+r),n.b("        </div>"),n.b("\n"+r),n.b("    </div>"),n.b("\n"+r),n.b("    <div class='yvp-mute-indicator yvp-vis-hidden'></div>"),n.b("\n"+r),n.b("    <div class='yvp-custom-controls yvp-vis-hidden'></div>"),n.b("\n"+r),n.b("    <div class='yvp-object-overlay yvp-vis-hidden'></div>"),n.b("\n"+r),n.b("</div>"),n.b("\n"),n.fl()});t.exports={render:function(){return n.render.apply(n,arguments)},r:function(){return n.r.apply(n,arguments)},ri:function(){return n.ri.apply(n,arguments)}}},{"hogan.js/lib/template":141}],91:[function(e,t,r){"use strict";function n(e,t,r){var n=this;n.k=e,n.m=t,n.l=r,n._=!1,n.ow=null,n.hv=!0,n.k.subscribe(a.MEDIA_ITEM_LOADED,n.D,n),n.k.subscribe(a.Video.PLAYING,n.IA,n),n.k.subscribe(a.AD_PLAYBACK_STARTED,n.gm,n),n.k.subscribe(a.PLAYBACK_PROGRESS,n.A,n),n.k.subscribe(a.PLAYBACK_REQUEST,n.gi,n),n.k.subscribe(a.UPDATE_AD_BREAKS,n.JA,n),n.k.subscribe(a.API.CAST_AVAILABILITY_CHANGE,n.KA,n),n.k.subscribe(a.CAST.CONNECTION_STATUS_CHANGED,n.Ye,n),n.k.subscribe(a.CAST.MEDIA_CHANGED,n.LA,n),n.k.subscribe(a.CAST.CAPTION_AVAILABILITY_CHANGED,n.MA,n),n.k.subscribe(a.CC.REMOVED,function(){n.hv=!1}),n.k.subscribe(a.CC.SHOW_CONTROLS,function(e){n.hv=e}),n.k.subscribe(a.CONTROLS_BAR_CHANGE,n.mv,n),n.k.subscribe(a.KEYDOWN,n.De,n),n.k.subscribe(a.Video.CLICK,n.ee,n)}t.exports=n;var i=e("user-agent").userAgent,a=e("../event"),o=e("../strings"),s=e("../tap"),l=e("../util"),c=e("../../../lib"),u=e("./settings"),p=e("../views/uiwidgets/tooltip"),d=e("./yahoo-controls.html"),f="on",v=.04;n.prototype.create=function(){var e,t=this,r={hideUponClick:!0},n=l.render(d,{strings:o.i18n});t.Qv=n.querySelector(".yvp-top-bar"),t.qm=n.querySelector(".yvp-bottom-bar"),t.Ov=n.querySelector(".yvp-playing-item-title"),t.Pv=n.querySelector(".yvp-playing-item-title-header"),t.NA=n.querySelector(".yvp-custom-controls"),t.Cr=n.querySelector(".yvp-object-overlay"),t.OA=n.querySelector(".yvp-mute-indicator"),t.PA=n.querySelector(".yvp-cast-overlay"),t.Nv=n.querySelector(".yvp-provider-logo"),t.rv=t.qm.querySelector(".yvp-slider"),t.vv=t.qm.querySelector(".yvp-time-container"),t.Wr=t.qm.querySelector(".yvp-setting-btn"),t.QA=t.qm.querySelector(".yvp-fullscreen-btn"),t.RA=t.qm.querySelector(".yvp-chromecast-btn"),t.SA=t.qm.querySelector(".yvp-menu-controls"),t.bp=t.Qv.querySelector(".yvp-content-type"),e=new u(t.k,t.l),t.sr=e.create(),t.SA.parentNode.insertBefore(t.sr,t.SA.nextSibling),t.TA=new p(t.Wr,o.i18n.SETTINGS,r),t.vA=new s(t.rv),t.wA=function(e){e.stopPropagation()},t.rv.addEventListener("tap",t.wA,t),t.UA=new p(t.QA,o.i18n.FULLSCREEN_SPACE,r);var a={providerLogo:t.Nv,bottomBar:t.qm,topBar:t.Qv,titleBar:t.Ov,customControls:t.NA,objectOverlay:t.Cr,muteIndicator:t.OA,headerTitleBar:t.Pv};return i.chrome>=32&&!t.l.disableCasting?(a.castOverlay=t.PA,t.VA=new p(t.RA,o.i18n.CHROMECAST,r)):(t.PA.parentNode.removeChild(t.PA),t.PA=null,t.RA.parentNode.removeChild(t.RA),t.RA=null),t.Pg(),a},n.prototype.Pg=function(){var e=this;e.WA(),e.Wr&&(e.XA=new s(e.Wr),e.YA=function(t){t.stopPropagation(),e.m.toggleSettings(e.Wr)},e.Wr.addEventListener("tap",e.YA),e.ZA=new s(e.qm),e.$A=function(t){t.stopPropagation(),e._A()},e.qm.addEventListener("tap",e.$A)),e.RA&&(e.aB=new s(e.RA),e.bB=function(t){t.stopPropagation();var r="ctrl-cast-"+(e.RA.connected?"stop":"start");e.k.publish(a.API.UI_INTERACT,{srcElement:r})},e.RA.addEventListener("tap",e.bB),e.cB=e.PA.querySelector(".cast-overlay-content"),e.dB=new s(e.cB),e.eB=function(t){t.stopPropagation(),e.k.publish(a.API.UI_INTERACT,{srcElement:"ctrl-cast-overlay"})},e.cB.addEventListener("tap",e.eB),e.fB=e.PA.querySelector(".cast-disconnect-btn"),e.gB=new s(e.fB),e.hB=function(t){t.stopPropagation(),e.k.publish(a.API.UI_INTERACT,{srcElement:"ctrl-cast-disconnect"})},e.fB.addEventListener("tap",e.hB)),e.iB=function(t){var r=function(){t.preventDefault()};e.k.publish(a.KEYDOWN,{keyCode:t.keyCode,shiftDown:t.shiftKey,ctrlDown:t.ctrlKey,altDown:t.altKey,target:t.target,preventDefault:r})},e.m.getContentNode().addEventListener("keydown",e.iB,!1)},n.prototype.WA=function(){var e,t=this;t.jB=function(r){r.stopPropagation(),e||(e=setTimeout(function(){t.k.publish(a.API.UI_INTERACT,{srcElement:"ctrl-mute-btn-off"}),e=null},600))},["mouseenter","touchstart"].forEach(function(e){t.OA.addEventListener(e,t.jB)}),["mousemove","touchmove"].forEach(function(e){t.OA.addEventListener(e,t.jB)})},n.prototype.De=function(e){var t=this,r=t.l.getVolume(),n=t.m.getCurrentTime(),i=t.m.getDuration(),o=.05;switch(e.keyCode){case 13:t.k.publish(a.TOGGLE_PLAY_PAUSE);break;case 27:t.m.updateViewOnEscPress();break;case 32:t.k.publish(a.TOGGLE_PLAY_PAUSE);break;case 37:var s=n-5;t._||t.k.publish(a.CONTROLS_SEEKING,s>=0?s:0);break;case 38:var c=r+o;t.k.publish(a.CONTROLS_SET_VOLUME,c>1?1:c);break;case 39:s=n+5,t._||t.k.publish(a.CONTROLS_SEEKING,s<=i?s:i);break;case 40:var u=r-o;t.k.publish(a.CONTROLS_SET_VOLUME,u<0?0:u);break;case 67:t.Dv&&t.k.publish(a.CC.UI_TOGGLE,!l.classList(t.Dv).contains(f),!0);break;case 70:t.m.toggleFullscreen();break;case 77:t.k.publish(a.CONTROLS_SET_MUTE,!t.l.getMute());break;case 191:e.shiftDown&&t.m.toggleSettings()}if(e.keyCode>=48&&e.keyCode<=57){var p=(e.keyCode-48)/10;i>0&&t.k.publish(a.CONTROLS_SEEKING,i*p)}},n.prototype.kB=function(){var e=this;e.lB&&(e.bp.innerHTML=o.i18n.MATURE,e.bp.setAttribute("aria-label",o.i18n.MATURE),l.classList(e.bp).remove("hide"))},n.prototype.D=function(e){var t=this;t._=e.isLive(),t.ow=e.liveState,t.lB=e&&e.ageGate&&"none"!==e.ageGate,t.bp.innerHTML="",t.bp.setAttribute("aria-label",""),l.classList(t.bp).add("hide"),t._?t.Xv():t.Yv(),t.mB(e),t.nB(e)},n.prototype.createCCBtnTooltip=function(e){var t=this;t.Dv=e,t.oB=new p(t.Dv,o.i18n.CAPTIONS_AVAILABLE,{hideUponClick:!0})},n.prototype.updateCCTooltip=function(e){var t=this,r=t.Dv.querySelector(".yvp-tooltip-content");r.innerHTML=e},n.prototype.KA=function(e){var t=this;t.RA.style.display=e?"":"none"},n.prototype.Ye=function(e,t){var r=this,n=r.PA&&r.PA.querySelector(".cast-device-name");if(n&&e){var i=l.sanitizeAndUnescape(t.receiverName);n.innerHTML=l.strSubstitute(o.i18n.CAST_PLAYING_RECEIVER,{"device-name":i})}r.RA&&(r.RA.connected=e,r.RA.setAttribute("data-connected",e),r.VA.setText(e?o.i18n.DISCONNECT:o.i18n.CHROMECAST))},n.prototype.gm=function(){var e=this;e.pB()},n.prototype.IA=function(){var e=this;e._?e.Xv():e.Yv()},n.prototype.LA=function(e,t){var r=this;if(r.PA){var n=t?t.thumbnail:"";r.PA.style.backgroundImage="url("+n+")"}},n.prototype.JA=function(e){var t=this;if(t.bv=e,t.Fw){for(var r=t.rv.querySelectorAll(".yvp-ad-break"),n=0;n<r.length;n++)t.rv.removeChild(r[n]);e&&e.forEach(function(e){var r=document.createElement("div");l.classList(r).add("yvp-ad-break"),e.occurred&&l.classList(r).add("occurred"),r.style.left=e.time/t.Fw*100+"%",t.rv.appendChild(r)})}},n.prototype.mB=function(e){var t=this;if(l.classList(t.qm).remove("yvp-markers-present"),e.duration&&t.l.ui.displayMarkers&&t.l.ui.displayMarkers.type){for(var r=t.rv.querySelectorAll(".yvp-video-marker"),n=0;n<r.length;n++)t.rv.removeChild(r[n]);if(e.videoMarkers&&0!==e.videoMarkers.length){var i=e.videoMarkers.filter(function(e){return e.type===t.l.ui.displayMarkers.type});if(0!==i.length){i=JSON.parse(JSON.stringify(i)),i.sort(function(e,t){return e.start_time-t.start_time});var a=t.l.ui.displayMarkers&&t.l.ui.displayMarkers.group,s=v*e.duration,c=e.primaryVideoMarker,u=a?t.qB(i,s,c):i;u.forEach(function(r){var n=document.createElement("div");l.classList(n).add("yvp-video-marker"),n.style.left=r.start_time/e.duration*100+"%";var i=document.createElement("div");if(l.classList(i).add("yvp-video-marker-label"),i.innerHTML=r.label,r.accumulated>0){var a=document.createElement("div");l.classList(a).add("yvp-video-marker-accumulated"),a.innerHTML=l.strSubstitute(o.i18n.MORE_MARKERS,{count_markers:r.accumulated}),i.appendChild(a)}n.appendChild(i),t.rv.appendChild(n)}),l.classList(t.qm).add("yvp-markers-present")}}}},n.prototype.qB=function(e,t,r){if(!e)return null;if(!t)return e;for(var n=[],i=0,a=0,o=!1,s=e.length,l=0;l<s;l++){var c=l+1;if(c>=s){e[l].accumulated=0;break}r&&e[l].label===r&&(o=!0);var u=e[l].start_time,p=e[c].start_time;p-u<=t?(a+=1,e[i].accumulated=a,o&&e[i].label!==r&&(e[i].label=r)):(a=0,i=c,o=!1,e[i].accumulated=0)}for(l=0;l<s;l++)e[l].accumulated&&e[l].accumulated>0?(n.push(e[l]),l+=e[l].accumulated):n.push(e[l]);return n},n.prototype.A=function(e,t,r,n){var i=this;c.isNumber(r)&&(i.Fw!==r&&(i.Fw=r,i.JA(i.bv)),i.rB(t))},n.prototype.pB=function(){var e=this;l.classList(e.rv).add("yvp-disable"),l.classList(e.bp).add("hide"),l.classList(e.vv).add("yvp-hide")},n.prototype.Xv=function(){var e=this;l.classList(e.rv).add("yvp-disable"),l.classList(e.vv).add("yvp-hide");var t=e.l.ui.contentTypeLabel;c.isString(t)&&""!==t?(e.bp.innerHTML=t,e.bp.setAttribute("aria-label",t),l.classList(e.bp).remove("hide")):e.ow&&"live"===e.ow&&(e.bp.innerHTML=o.i18n.LIVE,e.bp.setAttribute("aria-label",o.i18n.LIVE),l.classList(e.bp).remove("hide"))},n.prototype.Yv=function(){var e=this;l.classList(e.rv).remove("yvp-disable"),l.classList(e.vv).remove("yvp-hide"),e.kB()},n.prototype.nB=function(e){var t,r=this,n=e&&e.itemConfig;(n.playbackStart||n.playbackEnd)&&(t=r.m.getMainElement(),l.classList(t).remove("yvp-smart-seek-start"),l.classList(t).remove("yvp-smart-seek-end"))},n.prototype.gi=function(){var e=this;e.sB()},n.prototype.sB=function(){var e,t=this,r=t.l.playlist.getCurrentItem(),n=r&&r.itemConfig;n&&n.playbackStart&&(e=t.m.getMainElement(),l.classList(e).add("yvp-smart-seek-start"),t.tB&&(clearTimeout(t.tB),t.tB=null),t.l.playback.startTime=n.playbackStart)},n.prototype.rB=function(e){var t,r=this,n=r.l.playlist.getCurrentItem(),i=n&&n.duration,o=n&&n.itemConfig;o&&o.playbackEnd&&Math.round(e)===o.playbackEnd&&i!==o.playbackEnd&&(t=r.m.getMainElement(),l.classList(t).remove("yvp-smart-seek-start"),l.classList(t).add("yvp-smart-seek-end"),r.tB&&(clearTimeout(r.tB),r.tB=null),r.tB=setTimeout(function(){r.l.playback.continuousPlay=!0,r.k.publish(a.Video.ENDED),r.tB=null},2e3))},n.prototype.mv=function(e,t){var r=this,n=r.sr&&l.classList(r.sr).contains("open"),i=n&&r.qm.querySelector(".yvp-settings-container:hover");t&&n&&e===!1&&!i&&r.resetSettings();var o=!(!r.qm.querySelector(":hover")&&r.qm.parentNode.querySelector(":hover")!==r.qm);if(t&&r.hv&&!o){var s=r.m.getFullscreen();s||r.k.publish(a.CC.POSITION_FLOAT,e)}},n.prototype.ee=function(){var e=this;e._A()},n.prototype._A=function(){var e=this,t=l.classList(e.m.getContentNode()).contains("yvp-settings-on");t&&e.resetSettings()},n.prototype.resetSettings=function(){var e=this,t=e.sr.querySelector(".yvp-main-settings"),r=e.sr.querySelector(".yvp-cc-options-main"),n=e.sr.querySelector(".yvp-cc-options-more");e.m.toggleSettings(e.Wr,!1),l.classList(t).add("open"),l.classList(t).remove("close"),l.classList(r).add("close"),l.classList(r).remove("open"),l.classList(n).add("close"),l.classList(n).remove("open")},n.prototype.uB=function(){var e=this;["mouseenter","touchstart"].forEach(function(t){e.OA.removeEventListener(t,e.jB)}),["mousemove","touchmove"].forEach(function(t){e.OA.removeEventListener(t,e.jB)})},n.prototype.syncAriaState=function(){},n.prototype.destroy=function(){var e=this;e.m.getContentNode().removeEventListener("keydown",e.iB,!1),e.vA&&e.rv&&(e.vA.destroy(),e.rv.removeEventListener("tap",e.wA)),e.XA&&e.Wr&&(e.XA.destroy(),e.Wr.removeEventListener("tap",e.YA),e.TA.destroy()),e.aB&&e.RA&&(e.aB.destroy(),e.RA.removeEventListener("tap",e.bB),e.VA&&(e.VA.destroy(),e.VA=null)),e.PA&&(e.dB&&(e.dB.destroy(),e.cB.removeEventListener("tap",e.eB)),e.gB&&(e.gB.destroy(),e.fB.removeEventListener("tap",e.hB))),e.ZA&&e.qm&&(e.ZA.destroy(),e.qm.removeEventListener("tap",e.$A)),e.UA.destroy(),e.oB&&e.oB.destroy(),e.uB(),e.node=null}},{"../../../lib":"/lib/index.js","../event":"/nextgen/src/event.js","../strings":"/nextgen/src/strings.js","../tap":"/nextgen/src/tap.js","../util":"/nextgen/src/util.js","../views/uiwidgets/tooltip":89,"./settings":82,"./yahoo-controls.html":90,"user-agent":233}],92:[function(e,t,r){"use strict";function n(e){if(this.vB=e.iframeEnabled,this.wB="undefined"==typeof e.pauseLiveVideo||e.pauseLiveVideo,this.xB="undefined"==typeof e.pauseVODVideo||e.pauseVODVideo,this.setTimeoutRef=null,this.k=e.eventBus,!this.k)throw new Error("InvalidArguments: EventBus is not passed");this.vB?this._g=e.iframeVID:(this.tc=e.controller,this.l=e.controller&&e.controller.getModel()),this.yB="",this.zB="hidden",this.Rl=!0}var i=e("./event");t.exports=n,n.prototype.initialize=function(){var e=this,t="";e.zB in document?t="visibilitychange":(e.zB="mozHidden")in document?t="mozvisibilitychange":(e.zB="webkitHidden")in document?t="webkitvisibilitychange":(e.zB="msHidden")in document&&(t="msvisibilitychange"),e.yB=t,t&&(e.AB=e.AB.bind(e),document.addEventListener(t,e.AB,!1))},n.prototype.onReceiveFromIframe=function(e){e&&e[0]&&this.k.publish(e[0])},n.prototype.BB=function(){return document[this.zB]},n.prototype.AB=function(){this.k.publish(i.PAGE_VISIBILITY_CHANGED,!this.BB())},n.prototype.destroy=function(){var e=this;e.yB&&(document.removeEventListener(e.yB,e.AB,!1),e.yB="")}},{"./event":"/nextgen/src/event.js"}],93:[function(e,t,r){var n={AD_P_PROGRESS:"ad-playback-progress",AD_P_ED:"ad-playback-ended",AD_CLICK:"ad-exposed-click",AD_P_STARTED:"ad-playback-started",Ad:{E:"ad-error",ED:"ad-ended"}};t.exports=n},{}],94:[function(e,t,r){"use strict";function n(e){var t=this;t.isEnabled=e.watchHistoryEnabled||!1,t.watchedPeriod=e.watchedPeriod||s,t.expirationPeriod=e.watchHistoryExpiry||o}var i=e("./util"),a="yvpResumeTimeItems",o=129600,s=.5;t.exports=n,n.prototype.isWatched=function(e,t){var r=this;if(!r.isEnabled)return!1;if(!e)throw new Error("UUID not passed for isWatched!");var n=i.localStorage.get(a);if(!n||!n[e])return!1;var o=n[e].position;return r.isDeemedWatched(o,t)},n.prototype.clearExpired=function(){var e=i.localStorage.get(a),t=(new Date).getTime(),r=!1;e&&(Object.keys(e).forEach(function(n,i){var a=e[n].expiryTime;a&&t-a>0&&(delete e[n],r=!0)}),r&&i.localStorage.put(a,e))},n.prototype.saveProgress=function(e,t){var r=this,n=i.localStorage.get(a)||{},o=r.expirationPeriod;n[e.id]=e.progress,t&&(n[e.id].expiryTime=(new Date).getTime()+1e3*o,r.isDeemedWatched(e.progress.position,e.duration)?e.setWatched(!0):e.setWatched(!1)),i.localStorage.put(a,n)},n.prototype.getProgress=function(e){if(!e)throw new Error("UUID not passed for getProgress!");var t=i.localStorage.get(a);return t?t[e]:null},n.prototype.isDeemedWatched=function(e,t){var r=this,n=r.watchedPeriod;return!(!r.isEnabled||!t)&&(n>=0&&n<=1?e>=t*n:t<=n?e>=t-5:e>=n);
}},{"./util":"/nextgen/src/util.js"}],95:[function(e,t,r){"use strict";function n(e,t,r,a,o,s,l,c,u){var p=this;p.playbackId=e,p.pos=n.AD_ORDER[t]||"",p.position=t||"",p.adId=l||"",p.streams=r||[],p.clickUrl=a||null,p.ctaUrl=o||null,p.type=s||n.ADTYPES.NO_AD,p.duration=c||i.DEFAULT_AD_DURATION,p.adObj=u}t.exports=n;var i=e("./common/Constants");n.AD_ORDER={bumper:"start1",preroll:"start0",postroll:"end",midroll:"immediate"},n.POSITION={bumper:"start0",preroll:"start1",postroll:"end",midroll:"immediate"},n.ADTYPES={NORMAL:i.AD,NO_AD:i.NOAD,VPAID:i.VPAID}},{"./common/Constants":99}],96:[function(e,t,r){"use strict";function n(e){var t=this;t.communicatorName=e}t.exports=n},{}],97:[function(e,t,r){"use strict";function n(e,t,r){var n=this;n.timestamp=(new Date).getTime(),n.payload=t,n.key=e,n.cacheIdentifier=r}t.exports=n},{}],98:[function(e,t,r){"use strict";function n(e){var t=this;t.CB=e,o.call(t,"cachemanager-bus"),t.DB="adCache"+Math.floor(100*Math.random())+(new Date).getTime(),t.EB={},t.FB={},t.GB={},t.HB={},t.IB=new i,t.JB=[c.BUMPER,c.PREROLL,c.POSTROLL],t.KB={},t.LB={}}t.exports=n;var i=e("../engine/AdEngine"),a=e("../../util"),o=e("../../../../lib/event-bus"),s=e("./CacheEntry"),l=e("../common/Events"),c=e("../common/Constants"),u=e("user-agent").userAgent,p=(e("../../../../lib/logger"),e("xhr"));a.inherits(n,o);var d=12e5,f=10;n.prototype.prefetchCompleteHandler=function(e,t,r){var n=this;n.CB.publish(l.AD_CALL_END,r,e),n.addAdResponseForKey(e,t)},n.prototype.prefetchFailureHandler=function(e,t,r,n){var i,a=this;i=e.adSpec,a.CB.publish(l.AD_CALL_END,r,e),e&&e.setNewRedirectUrl&&(e.adCallSequence=i.adCallSequence,e.errorState=n,a.addAdResponseForKey(e,t))},n.prototype.updateAdCache=function(e,t){var r=this;e&&t&&(r.LB[t]=e)},n.prototype.getAd=function(e,t,r){var n=this,i=null;if(e&&t&&r){var a=n.LB[e],o=a.adBreakMap,s=r.type;if(o.hasOwnProperty(s)){var c=o[s],u=n.getPlayerDataForClipId(e);if(t.subscribe(l.AD_READY,n.prefetchCompleteHandler,n),t.subscribe(l.AD_FAILURE,n.prefetchFailureHandler,n),n.CB.publish(l.AD_CALL_START,t),c){t.prefetchAd(c,r,u);var p=t.getKey(r,u);i=n.getAdResponseForKey(p)}}}return i},n.prototype.getNewAd=function(e,t,r,n,i){var a=this;e&&(e.subscribe(l.AD_READY,a.prefetchCompleteHandler,a),e.subscribe(l.AD_FAILURE,a.prefetchFailureHandler,a),a.CB.publish(l.AD_CALL_START,e),e.getNewAd(t,r,n,i))},n.prototype.getMidrollAdTagUri=function(e,t,r,n){var i,a,o,s=this;if(s.LB&&s.LB.hasOwnProperty(t)){var l=s.LB[t].adBreakMap;if(l.hasOwnProperty(r)){var c=l[r];n?(a=c.adSourcesObj||{},o=a[n]):(a=c.adSources||[],o=a[0]),e.medT=c.mediation||0,e.ibn=c.ibn,e.ibnc=c.ibnc,e.liveClickDisabled=c.liveClickDisabled,e.vodClickDisabled=c.vodClickDisabled,o&&(e.adCallSequence=o.sequence||1,e.ibn=e.ibn||o.ibn,e.adNetwork=o.network||"",o.vastAdData?(i=o.vastAdData[0].redirectUrl||"",e.pbbid=o.vastPbbid):(i=o.adTagURI||"",e.pbbid=o.pbbid))}}return i},n.prototype.getMidrollPrimaryAdSource=function(e,t,r){var n,i,a=this;if(a.LB&&a.LB.hasOwnProperty(e)){var o=a.LB[e].adBreakMap;if(o.hasOwnProperty(t)){var s=o[t];n=s.adSourcesObj||{},i=n[r]}}return i},n.prototype.getNewIceBreakerResponseVMAPXml=function(e,t){try{var r={url:e,method:"GET",sync:!1};p(r,function(e,r,n){e||t(n)})}catch(e){}},n.prototype.isMyOwn=function(e){var t=this;return e&&e.cacheIdentifier===t.DB},n.prototype.hasEntryExpired=function(e){return e&&(new Date).getTime()-e.timestamp>=d},n.prototype.hasBucketExpired=function(e){return e&&(new Date).getTime()-e.timestamp>=d},n.prototype.MB=function(e,t){return e.timestamp>t.timestamp},n.prototype.NB=function(e){for(var t,r=this,n=[],i=0;i<e.length;i++)t=e[i],r.hasEntryExpired(t)||n.push(t);return n},n.prototype.sync=function(){var e,t,r,n,i,o,s=this,l=[],c=0;for(e in s.HB)if(s.HB.hasOwnProperty(e)){if(t=s.HB[e]||[],l=s.NB(t),l.length>0&&!u.tv){for(i=a.localStorage.get(e),o=[],i&&(s.hasBucketExpired(i)?a.localStorage.remove(e):o=i.bucket||[]),o=s.NB(o),c=o.length,r=0;r<f-c;r++)n=l.shift(),n&&o.push(n);if(o.length>0){if(i={},i.bucket=o,i.timestamp=(new Date).getTime(),!a.localStorage.put(e,i)){for(c=l.length,r=0;r<f-c;r++)n=o.shift(),n&&!s.hasEntryExpired(n)&&l.push(n);a.localStorage.remove(e)}}else a.localStorage.remove(e)}s.HB[e]=l}},n.prototype.addAdResponseForKey=function(e,t){var r=this,n=new s(t,e,r.DB),i=r.HB[t]||[];i.push(n),r.HB[t]=i,e.isCached=!0,r.CB.publish(l.CACHE_UPDATE,t,e)},n.prototype.getAdResponseForKey=function(e){var t,r,n,i,o=this,s=null;for(r=o.HB[e]||[],i=0;i<r.length;i++)if(t=r[i],!o.hasEntryExpired(t)){r.splice(i,1);break}if(t)s=t.payload;else if(n=a.localStorage.get(e)){for(o.hasBucketExpired(n)?(a.localStorage.remove(e),r=[]):r=n.bucket||[],i=0;i<r.length;i++)if(t=r[i],!o.hasEntryExpired(t)){r.splice(i,1);break}r.length>0?(n.bucket=r,n.timestamp=(new Date).getTime(),a.localStorage.put(e,n)):a.localStorage.remove(e)}return t&&(s=t.payload,s.cacheState=o.isMyOwn(t)?"l0":"l1"),s},n.prototype.addRuleForClipId=function(e,t){var r=this;e&&t&&(r.EB[t]=e)},n.prototype.getRuleForClipId=function(e){var t=this;return t.EB[e]},n.prototype.addPlayerDataForClipId=function(e,t){var r=this;e&&t&&(r.FB[t]=e)},n.prototype.getPlayerDataForClipId=function(e){var t=this;return t.FB[e]},n.prototype.addCuePointsForClipId=function(e,t){var r=this;e&&t&&(r.KB[t]=e)},n.prototype.getCuePointsForClipId=function(e){var t=this;return t.KB[e]}},{"../../../../lib/event-bus":"/lib/event-bus.js","../../../../lib/logger":"/lib/logger.js","../../util":"/nextgen/src/util.js","../common/Constants":99,"../common/Events":102,"../engine/AdEngine":121,"./CacheEntry":97,"user-agent":233,xhr:248}],99:[function(e,t,r){"use strict";r.MARKETING_AD_BREAK=3,r.DEFAULT_VPAID_TIMEOUT=10,r.AD_CACHE_EXPTIME=12e5,r.HTTP="http://",r.HTTPS="https://",r.SSL="https:",r.HTML="html",r.PROGRESSIVE="progressive",r.AD="ad",r.NOAD="noad",r.VPAID="vpaid",r.OVERLAY="overlay",r.MP4_FORMAT="video/mp4",r.WEBM_FORMAT="video/webm",r.XFLV_FORMAT="video/x-flv",r.M3U8_FORMAT="application/vnd.apple.mpegurl",r.VPAID_FLASH_FORMAT="application/x-shockwave-flash",r.VPAID_JS_FORMAT="application/javascript",r.VPAID_X_JS_FORMAT="application/x-javascript",r.VPAID_TEXT_JS_FORMAT="text/javascript",r.STANDALONE_GEMINI_BRX="standalone_gemini_brx",r.STANDALONE_GEMINI_NATIVE="standalone_gemini_native",r.GEMINI_AD="gemini_ad",r.STANDALONE_BRXD="standalone_brxd",r.STATIC_RESORUCE="static",r.IFRAME_RESORUCE="iframe",r.HTML_RESORUCE="html",r.VIEWABILITY_RULES="ViewabilityRules",r.VIEWABILITY_3P="Viewability3P",r.ONE_VIDEO_FEACONS="one_video_feacons",r.ADAPTV_SCRIPT="adaptv_scripts",r.OVERLAY_IMAGE="image/jpeg",r.BUMPER="bumper",r.PREROLL="preroll",r.POSTROLL="postroll",r.NON_LINEAR="overlay",r.MIDROLL="midroll",r.CLIP_START="clip-start",r.CLIP_END="clip-end",r.CACHE_L0="l0",r.CACHE_L1="l1",r.CACHE_L2="l2",r.MME="MME",r.PREVIEW="PREVIEW",r.REFRESH="REFRESH",r.VENDOR_ONEVIDEO="OneVideo",r.VENDOR_GEMINI="Gemini",r.VENDOR_ONEVIDEO_VIP="OneVideo VIP",r.YVAP_INFO_AD_BREAKS="adBreaks",r.MAX_VOD_ADS_MIDROLL=4,r.MIDROLL_PREFETCH_TIMER=18e5,r.DEFAULT_AD_DURATION=30,r.AD_VIEW_DURATION=2,r.VIEWABILITY_ON=!0,r.ADBLOCKER=!1,r.INTERNAL_POLLING_INTERVAL=200,r.VIEWABILITY_THRESHOLD=.5,r.VIEWABILITY_MEASURABLE=1,r.VIEWABILITY_NOT_MEASURABLE_IFRAME=2,r.VIEWABILITY_NOT_MEASURABLE_NO_DARLA=3,r.PLAYER_AUTO_PLAY_ON=1,r.PLAYER_AUTO_PLAY_OFF=2,r.PLAYER_SOUND_ON=1,r.PLAYER_SOUND_OFF=2,r.PLAYER_IN_BANNER=1,r.PLAYER_NOT_IN_BANNER=2,r.PLAYER_LOCATION_ABOVE_THE_FOLD=1,r.PLAYER_LOCATION_BELOW_THE_FOLD=2,r.VIEWABILITY_VISIBLE=1,r.VIEWABILITY_NOT_VISIBLE=2,r.VIEWABILITY_NOT_MEASURABLE=3,r.PLAYER_FULLSCREEN_OFF=0,r.PLAYER_FULLSCREEN_ON=1,r.UNKNOWN=3,r.VIEWABILITY_RULE_TYPE="t",r.VIEWABILITY_RULE_MIN_DURATION="d",r.VIEWABILITY_RULE_CONSECUTIVE_PLAYBACK="c",r.VIEWABILITY_RULE_MIN_PIXELS="p",r.VIEWABILITY_RULE_AUDIO="a",r.STATUS_INITIALIZATION=0,r.STATUS_SWF_LOADED=1,r.STATUS_AD_INITED=2,r.VIDEO_START="VIDEO_START",r.VIDEO_QUARTILE_25="VIDEO_QUARTILE_25",r.VIDEO_QUARTILE_50="VIDEO_QUARTILE_50",r.VIDEO_QUARTILE_75="VIDEO_QUARTILE_75",r.VIDEO_QUARTILE_100="VIDEO_QUARTILE_100",r.VIDEO_VIEW="VIDEO_VIEW",r.VIDEO_VIEW_3P="VIDEO_VIEW_3P",r.GEMINI_IMP="GEMINI_IMP",r.GEMINI_VIDEO_PRIMARY="VIDEO_PRIMARY",r.ADENGINE_TYPE_GEMINI="GEMINI"},{}],100:[function(e,t,r){"use strict";function n(){var e=a.getCookie("yvapF");return e?JSON.parse(e):{}}function i(e){var t=JSON.stringify(e);a.setCookie("yvapF",t,{expires:new Date(Date.now()+1e5),path:"/",session:!0})}var a=e("../../util");r.getTotalClipCount=function(){var e=n(),t=e.cc;return t?t:0},r.incrementTotalClipCount=function(){var e=n(),t=e.cc;t=t?t+1:1,e.cc=t,i(e)},r.resetTotalClipCount=function(){var e=n();e.cc=0,i(e)},r.getRecentClipCount=function(){var e=n(),t=e.rcc||0;return t},r.incrementRecentClipCount=function(){var e=n();e.rcc=(e.rcc||0)+1,i(e)},r.resetRecentClipCount=function(){var e=n();e.rcc=0,i(e)},r.getTotalVideoLength=function(){var e=n(),t=e.vl||0;return t},r.incrementTotalVideoLength=function(e){var t=n(),r=e||1;t.vl=(t.vl||0)+r,i(t)},r.resetTotalVideoLength=function(){var e=n();e.vl=0,i(e)},r.getRecentVideoLength=function(){var e=n(),t=e.rvl||0;return t},r.incrementRecentVideoLength=function(e){var t=n(),r=e||1;t.rvl=(t.rvl||0)+r,i(t)},r.resetRecentVideoLength=function(){var e=n();e.rvl=0,i(e)},r.getAdLength=function(){var e=n(),t=e.al||0;return t},r.incrementAdLength=function(e){var t=n(),r=e||1;t.al=(t.al||0)+r,i(t)},r.resetAdLength=function(){var e=n();e.al=0,i(e)},r.getAdCount=function(){var e=n(),t=e.ac||0;return t},r.incrementAdCount=function(){var e=n();e.ac=(e.ac||0)+1,i(e)},r.resetAdCount=function(){var e=n();e.ac=0,i(e)}},{"../../util":"/nextgen/src/util.js"}],101:[function(e,t,r){"use strict";r.AD_CALL_TIMEOUT="ERR_AD_CALL_TIMEOUT",r.XML_PARSING="ERR_XML_PARSING",r.RESPONSE_GENERIC="ERR_RESPONSE_GENERIC",r.ICEBREAKER_ERROR="ERR_ICEBREAKER_ERROR",r.EMPTY_RESPONSE="ERR_EMPTY_RESPONSE",r.NO_PARSER="ERR_NO_PARSER",r.MISSING_ADTGT="ERR_MISSING_ADTGT",r.REQUEST_GENERIC="ERR_REQUEST_GENERIC",r.INCOMPATIBLE_MEDIA="ERR_INCOMPATIBLE_MEDIA",r.MEDIA_PLAYBACK="ERR_MEDIA_PLAYBACK",r.PLAYER_TIMEOUT="PLAYER_TIMEOUT",r.GENERIC="ERR_GENERIC",r.VPAID_TIMEOUT="ERR_VPAID_TIMEOUT",r.THIRD_PARTY_NO_AD="THIRD_PARTY_NO_AD",r.SSL_MISMATCH="SSL_MISMATCH",r.MISSING_SPACEID="MISSING_SPACEID",r.ADBLOCKER="ADBLOCKER",r.VPAID_AD_RENDER_ERROR="VPAID_AD_RENDER_ERROR",r.VPAID_AD_LOAD_ERROR="VPAID_AD_LOAD_ERROR",r.VPAID_AD_INIT_ERROR="VPAID_AD_INIT_ERROR",r.VPAID_AD_INIT_TIMEOUT="VPAID_AD_INIT_TIMEOUT",r.VPAID_AD_START_ERROR="VPAID_AD_START_ERROR",r.VPAID_AD_START_TIMEOUT="VPAID_AD_START_TIMEOUT",r.MIDROLL_NO_AD="MIDROLL_NO_AD",r.VPAID_AD_STOP_ERROR="VPAID_AD_STOP_ERROR"},{}],102:[function(e,t,r){"use strict";r.AD_READY="ad-ready",r.AD_PROCESSED_COMPLETED="ad-processed-completed",r.AD_FAILURE="ad-failure",r.CACHE_UPDATE="cache-update",r.AD_METRIC="ad-metric",r.BEGIN_AD_EXP="begin-ad-experience",r.AD_OPPORTUNITY="ad-opportunity",r.NULL_AD_OPPORTUNITY="null-ad-opportunity",r.AD_CALL_START="ad-call-start",r.AD_CALL_END="ad-call-end",r.AD_REQUESTED="ad-requested",r.AD_SUBMITTED="ad-submitted",r.AD_DELIVERED="ad-delivered",r.AD_DELIVERY_ERROR="ad-delivery-error",r.VIDEO_START="video-start",r.VIDEO_END="video-end",r.AD_PAUSED="ad-paused",r.AD_RESUMED="ad-resumed",r.AD_STOPPED="ad-stopped",r.AD_STARTED="ad-started",r.AD_INITED="ad-inited",r.AD_HANDLE_FALLBACK="ad-handle-fallback",r.AD_PROGRESS="ad-progress",r.PLAYER_FULLSCREEN="player-fullscreen",r.VPAID_AD_RENDERED="vpaid-ad-rendered",r.VPAID_AD_STARTED="vpaid-ad-started",r.VPAID_AD_QUARTILE="vpaid-ad-quartile",r.ADBREAK_START="adbreak-start",r.MIDROLL_START="midroll_start",r.AD_BREAK_ENDED="ad-break-ended",r.AD_BREAK_SUBMITTED="ad-break-sumbitted",r.MIDROLL_CACHE_UPDATE="midroll-cache-update",r.MIDROLL_PLAY_CUE="midroll-play-cue",r.VPAID_AD_INITED="vpaid-ad-inited",r.OVERLAY_CLICK="overlay-click",r.OVERLAY_RENDERED="overlay-rendered",r.VPAID_AD_LATENCY_UPDATE="vpaid-ad-latency-update",r.STANDALONE_AD_UPDATE="standalone-ad-update"},{}],103:[function(e,t,r){"use strict";function n(){var e=this;e.adId=null,e.vastCreativeId=null,e.creativeId=null,e.bookingId=null,e.placementId=null,e.redirectUrl="",e.adFormat=null,e.adSystem="",e.streams=[],e.beacons={},e.params={},e.url="",e.type="",e.mtype="",e.nonLinearAd=null,e.isSkippable=!1,e.skipCountdown=5,e.timestamp=0,e.adXmlParseErr=null,e.cjs=0,e.cswf=0,e.cmp4=0,e.cwbm=0,e.cflv=0,e.seq=0}t.exports=n,n.prototype.addBeaconOfType=function(e,t){var r,n=this;t&&e&&(t=t.toLowerCase(),r=n.beacons[t]||[],e=e.trim(),r.push(e),n.beacons[t]=r)},n.prototype.addScriptExtension=function(e,t){var r,n=this;t&&e&&(t=t.toLowerCase(),n.scripts=n.scripts||{},r=n.scripts[t]||[],e=e.trim(),r.push(e),n.scripts[t]=r)},n.prototype.addMedia=function(e,t,r,n,i){if(e&&r&&("VPAID"===i||t)){var a=this;a.streams.push({url:r,format:e,bitrate:t,deliveryType:n,apiFramework:i})}},n.prototype.merge=function(e){var t,r,n,i,a=this;if(e&&e.merge){for(n in e.beacons)e.beacons.hasOwnProperty(n)&&(t=e.beacons[n]||[],t.length>0&&(r=(a.beacons[n]||[]).concat(t),a.beacons[n]=r));for(i in e.params)e.params.hasOwnProperty(i)&&(a.params[i]=e.params[i]);a.creativeId=e.creativeId,a.bookingId=e.bookingId,a.placementId=e.placementId,a.timestamp=e.timestamp,a.impressionId=e.impressionId,a.serveTime=e.serveTime,a.serveId=e.serveId,a.spaceId=e.spaceId,a.position=e.position,a.adSystem=e.adSystem,a.rules=e.rules}},n.prototype.addParamOfName=function(e,t){var r=this;t&&e&&(r.params[t.toLowerCase()]=e)},n.prototype.getParamOfName=function(e){var t=this;if(e)return t.params[e.toLowerCase()]},n.prototype.getBeaconsOfType=function(e){var t=this;if(e)return t.beacons[e.toLowerCase()]},n.prototype.getScriptExtension=function(e){var t=this;if(e&&t.scripts)return t.scripts[e.toLowerCase()]}},{}],104:[function(e,t,r){"use strict";function n(){var e=this;e.adSpec=null,e.adObj=null,e.adSources=null,e.index=0,e.httpTimeout=null,e.isCached=!1,e.communicatorSpec=null,e.cacheState=null,e.errorState=null,e.redirectList=[],e.firstCall="",e.type="",e.midrollbreak=null,e.midrolladsequence=0,e.adDuration=0,e.adIdBeacon=0,e.vim=null}t.exports=n,n.prototype.toString=function(){return JSON.stringify(this)},n.prototype.setNewRedirectUrl=function(e){var t=this;t.redirectList&&t.redirectList.push(e)},n.prototype.clone=function(e){var t=this;if(e&&e.setNewRedirectUrl)for(var r in e)e.hasOwnProperty(r)&&("redirectList"===r?t.redirectList=[].concat(e.redirectList):t[r]=e[r])}},{}],105:[function(e,t,r){"use strict";function n(e){var t=this;a.call(t,"communicator"),t.spec=e||{}}t.exports=n;var i=e("../../util"),a=(e("../../../../lib/logger"),e("../../../../lib/event-bus")),o=e("./ParserManager"),s=e("./VastValidator"),l=e("./AdResponse"),c=(e("../engine/AdSpec"),e("../common/Events")),u=e("../common/Errors"),p=e("../common/Constants"),d=e("user-agent").userAgent,f=e("xhr"),v=e("../yvap-util");i.inherits(n,a);var m={"openx.net":!1,"simpli.fi":!1,"wirewax.com":!1,"s.yimg.com":!1,"quantserve.com":!1,"bs.serving-sys.com":!1};n.prototype.getNewAd=function(e,t,r){var n=this,i=n.getNewAdResponseObject(e,r,t);n.key=n.getKey(e,t);try{n.fireRequest(r,i)}catch(e){n.publish(c.AD_FAILURE,i,n.key,n,e.message)}},n.prototype.handleAdResponse=function(e){var t,r=this,n=e.adObj;n&&("redirect"===n.type?(t=n.redirectUrl,r.setNewRedirect(t,e)):(s.validateAdObj(n),r.publish(c.AD_READY,e,r.key,r)))},n.prototype.processAdObjects=function(e,t){for(var r,n,i,a=this,o=e&&e.adSpec&&e.adSpec.type,s=0;s<t.length&&(r=t[s],r.seq=r.seq||s+1,i=new l,i.clone(e),n=e.adObj,n&&r.merge(n),i.adObj=r,a.handleAdResponse(i),o===p.MIDROLL);s++);},n.prototype.getKey=function(){return"null-key"},n.prototype.getFirstCall=function(){return"null-first-call"},n.prototype.getNewAdResponseObject=function(e,t,r,n){var i=this,a=new l;return a.adSpec=e,a.type=e.type,a.communicatorSpec=i.spec,a.firstCall=t||i.getFirstCall(),a.httpTimeout=i.httpTimeout,n&&(a.adSources=n.adSources,a.index=n.index,a.httpTimeout=n.httpTimeout),a},n.prototype.processAdXml=function(e){return o.parseAdXml(e)},n.prototype.prefetchAd=function(e,t,r,n,i){var a,o,s=this;if(e){o=s.getNewAdResponseObject(t,null,r),o.adSystem=n,o.brId=i,s.key=s.getKey(t,r);try{a=s.processAdXml(e),s.processAdObjects(o,a)}catch(e){s.publish(c.AD_FAILURE,o,s.key,s,e.message)}}},n.prototype.OB=function(e){if(!e||""===e)return!0;for(var t in m)if(m.hasOwnProperty(t)&&e.indexOf(t)>-1)return m[t];return!0},n.prototype.PB=/\[TIMESTAMP\]/g,n.prototype.QB=/\[SS_REQ\]/g,n.prototype.RB=function(e){var t=this;if(!e||0===e.length)return null;var r=v.getTimeStamp();return e=e.replace(t.PB,r),e=e.replace(t.QB,"0")},n.prototype.fireRequest=function(e,t){var r=this,n=(new Date).getTime(),a=i.parseDomain(e),o=r.OB(a),s=t.httpTimeout||3e3;if(e=r.RB(e),window.location.protocol===p.SSL&&0!==e.indexOf(p.SSL))throw new Error(u.SSL_MISMATCH);try{var l={url:e,method:"GET",cors:o,sync:!1,timeout:s};d.ie&&d.ie<10&&(l.responseType="text"),f(l,function(e,i,a){var o,l=i.statusText;o=(new Date).getTime(),o-n>=s?r.onAdCallFailure(t,"timeout"):e?(t.httpTimeout=s-(o-n),r.onAdCallFailure(t,l)):r.onAdCallSuccess(t,a)})}catch(e){throw new Error(u.REQUEST_GENERIC)}},n.prototype.setNewRedirect=function(e,t){var r=this;t.setNewRedirectUrl(e),r.fireRequest(e,t)},n.prototype.onAdCallSuccess=function(e,t){var r,n=this;if(t)try{r=n.processAdXml(t),n.processAdObjects(e,r),n.publish(c.AD_PROCESSED_COMPLETED,e)}catch(t){n.publish(c.AD_FAILURE,e,n.key,n,t.message)}else n.publish(c.AD_FAILURE,e,n.key,n,u.EMPTY_RESPONSE)},n.prototype.onAdCallFailure=function(e,t){var r,n=this;r="timeout"===t?u.AD_CALL_TIMEOUT:"SSLMismatch"===t?u.SSL_MISMATCH:p.ADBLOCKER?u.ADBLOCKER:u.RESPONSE_GENERIC,n.publish(c.AD_FAILURE,e,n.key,n,r)}},{"../../../../lib/event-bus":"/lib/event-bus.js","../../../../lib/logger":"/lib/logger.js","../../util":"/nextgen/src/util.js","../common/Constants":99,"../common/Errors":101,"../common/Events":102,"../engine/AdSpec":122,"../yvap-util":138,"./AdResponse":104,"./ParserManager":109,"./VastValidator":119,"user-agent":233,xhr:248}],106:[function(e,t,r){"use strict";function n(e,t){var r=t.ads;!r||r.length<=0||i(e,r[0])}function i(e,t){e.creativeId=t.creativeId;var r=t.tag;r&&(o(e,r),a(e,t.actionUrls),t.beacon&&e.addBeaconOfType(t.beacon,f[d.GEMINI_IMP]),e.rules=t.rules)}function a(e,t){if(t)for(var r in t)if(t.hasOwnProperty(r)){var n=f[r];if(n)for(var i=t[r],a=0;a<i.length;a++){var o=i[a];e.addBeaconOfType(o,n)}}}function o(e,t){var r;try{r=JSON.parse(t)}catch(e){r={}}s(e,r);var n=r.assets;if(n&&!(n.length<=0)){for(var i,a=0;a<n.length;a++){var o=n[a];if(o&&o.usageType===d.GEMINI_VIDEO_PRIMARY){i=o.mediaInfo;break}}if(i&&!(i.length<=0)){if(r.imprTrackingUrls&&r.imprTrackingUrls.length>=0)for(var c=0;c<r.imprTrackingUrls.length;c++){var u=r.imprTrackingUrls[c];e.addBeaconOfType(u,f[d.GEMINI_IMP])}l(e,i[0])}}}function s(e,t){var r={};r.clickurl=t.clickUrl,r.headline=t.headline,r.sponsorName=t.source,r.callToAction=t.callToAction,e.params=r}function l(e,t){var r={url:t.url,format:c(t.contentType),bitrate:t.bitrate,deliveryType:"progressive",duration:t.length,apiFramework:null};e.streams=[r]}function c(e){var t;switch(e){case d.MP4_FORMAT:t="mp4";break;case d.M3U8_FORMAT:t="m3u8";break;default:t=e}return t}function u(e,t){var r,n=[],i=t.mediaInfo;!i||i.length<1||(i.forEach(function(e){r={url:e.url,format:c(e.contentType),bitrate:e.bitrate,deliveryType:"progressive",duration:e.length,apiFramework:null},n.push(r)}),e.duration=n[0].duration||0,e.streams=n)}var p=(e("../engine/AdSpec"),e("./Ad")),d=(e("./Communicator"),e("../allocation/CommunicatorSpec"),e("../common/Constants")),f={};f[d.VIDEO_START]="playback0",f[d.VIDEO_QUARTILE_25]="playback25",f[d.VIDEO_QUARTILE_50]="playback50",f[d.VIDEO_QUARTILE_75]="playback75",f[d.VIDEO_QUARTILE_100]="playback100",f[d.VIDEO_VIEW]="impression",f[d.VIDEO_VIEW_3P]="impression3p",f[d.GEMINI_IMP]="geminiimpression";var v=function(e,t){var r=new p;return r.adId=d.STANDALONE_GEMINI_NATIVE,r.adFormat=d.GEMINI_AD,r.creativeId=null,r.vastCreativeId=null,r.bookingId=null,r.redirectUrl="",r.url="",r.type=d.AD,r.nonLinearAd="",r.isSkippable=!1,r.skipCountdown=5,r.timestamp=0,r.adXmlParseErr=null,r.rules=t,u(r,e),s(r,e),r},m=function(e){var t=new p;if(!e)return t.type=d.NOAD,[t];var r;try{r=JSON.parse(e)}catch(e){}return r?(n(t,r),!t.streams||t.streams.length<=0?(t.type=d.NOAD,[t]):(t.type=d.AD,t.adFormat=d.GEMINI_AD,t.params&&(t.params.ctaurl=t.params.clickurl,t.params.clickurl=null),[t])):(t.type=d.NOAD,[t])};t.exports={constructAdObj:v,constructAd:m}},{"../allocation/CommunicatorSpec":96,"../common/Constants":99,"../engine/AdSpec":122,"./Ad":103,"./Communicator":105}],107:[function(e,t,r){"use strict";function n(e,t){var r=this;r.CB=e,r.SB=t,r.TB=[],r.UB=new l(a.REFRESH),r.VB=new s(r.UB),r.WB=0,r.XB=0,r.YB=0,r.ZB=0,r.$B=0,r._B=0,r.aC=[],r.bC=1}t.exports=n;var i=(e("../../../../lib/logger"),e("../common/Events")),a=e("../common/Constants"),o=e("../engine/AdSpec"),s=e("./RefreshCommunicator"),l=e("../allocation/CommunicatorSpec"),c=(e("../yvap-util"),/\[CDT_BREAK\]/g),u=/\[TIMESTAMP\]/g,p=/\[AD_BREAK_DURATION\]/g,d=/\[AD_BREAK_LENGTH\]/g,f=function(e){};n.prototype.cC=function(e,t){var r=this,n=new o(a.MIDROLL,["clickable"]);t=t||a.DEFAULT_AD_DURATION,r.dC=e.hasLiveMidrolls?e.liveMidrollsMaxDur:t,r.WB=0,r._B=0,r.$B=0,r.ZB=Math.ceil(r.dC/a.DEFAULT_AD_DURATION),r.aC.push(r.VB.subscribe(i.AD_READY,r.eC,r)),r.aC.push(r.VB.subscribe(i.AD_FAILURE,r.fC,r));var s=r.SB.getMidrollAdTagUri(n,e.clipId,a.MIDROLL);s&&(s=r.RB(s,r.bC,t,r.ZB),r.VB.getMidrollAd(n,e,s))},n.prototype.gC=function(e,t){var r=this,n=r.SB.getPlayerDataForClipId(e);n?(r.Zn(),r.XB=0,r.YB=0,r.cC(n,t)):f("playerdata missing")},n.prototype.hC=function(){var e,t,r=this,n=0,a={};for(e=0;e<r.TB.length;e++)t=r.TB[e],n+=t&&t.adObj&&t.adObj.duration||0;f("Updated prefetched ads="+n+", total ads="+r.TB.length+", askDuration="+r.dC),a={targetAdsDuration:r.dC,totalUniqueAds:r.TB.length,totalDuplicatedAds:r.YB,totalNoAds:r.XB,uniqueAdsDuration:n},r.CB.publish(i.MIDROLL_CACHE_UPDATE,a)},n.prototype.eC=function(e,t,r,n){var o=this,s=[];e.type=a.MIDROLL,s=o.TB,o.iC(e),o.jC(n),o.CB.publish(i.AD_CALL_END,r,e)},n.prototype.jC=function(e){var t=this;t.WB++,e?t._B++:t.$B++,t.WB>=t.ZB&&(f("SuccessAdCount="+t.$B+", failAdCount="+t._B),t.hC())},n.prototype.fC=function(e,t,r,n){var o=this;e.type=a.MIDROLL,e.errorState=n,o.iC(e),o.jC(n),o.CB.publish(i.AD_CALL_END,r,e)},n.prototype.startMidRollsFetchThread=function(e){var t=this,r=t.SB.getPlayerDataForClipId(e);r?(t.resetCDTBreak(),t.gC(e),t.midRollFetchThread=setInterval(function(){t.gC(e)},a.MIDROLL_PREFETCH_TIMER)):f("playerdata missing")},n.prototype.stopMidRollsFetchThread=function(){var e=this;e.kC=null,e.midRollFetchThread&&clearInterval(e.midRollFetchThread)},n.prototype.Zn=function(){for(var e=this,t=null,r=0;r<e.aC.length;r++)(t=e.aC[r])()},n.prototype.play=function(e,t,r){var n,s=this,l=s.TB||[],c=[],u=s.SB.getPlayerDataForClipId(e),p=[],d=-1,v=new o(a.MIDROLL,["clickable"]),m=s.SB.getCuePointsForClipId(e),y=0,h=0,E=0;p=l.map(function(e){return e.timestamp||-1}),d=Math.max.apply(null,p);var g=t||s.getCDTBreak();if(u&&(m||u.hasLiveMidrolls)){var b;u.isLive?b=l.length:(b=a.MAX_VOD_ADS_MIDROLL,g===a.MARKETING_AD_BREAK&&b++);for(var _=0;_<b;_++){var A=_+1;if(s.CB.publish(i.AD_OPPORTUNITY,e,a.MIDROLL,v,s.UB,A),u.isLive||l.length>_&&l[_].timestamp===d){n=l[_],n.midrollbreak=g,n.midrolladsequence=A,n.adSpec&&(n.adSpec.duration=r);var T=n.adObj;T&&(T.type===a.AD?h++:T.type===a.NOAD?y++:T.type===a.VPAID&&E++),c.push(n)}}s.CB.publish(i.AD_BREAK_SUBMITTED,e,a.MIDROLL,b,c.length,y,h,E,g),s.clearMidrollsAdCache()}return s.incrementCDTBreak(),f("AdsToSendToPlayer size="+c.length),f("Start prefill next midroll ads cache"),s.gC(e,r),c},n.prototype.clearMidrollsAdCache=function(){var e=this;e.TB=[]},n.prototype.updateMidrollsAdCache=function(e){var t=this;t.TB=e},n.prototype.iC=function(e){var t,r,n=this,i=n.TB,o=e.adObj;if(o)if(o.adId&&o.type!==a.NOAD){for(t=0;t<i.length;++t)if(r=i[t].adObj,null!==r.adId&&(o.adId.toUpperCase()===r.adId.toUpperCase()&&o.vastCreativeId===r.vastCreativeId||o.vastCreativeId&&o.vastCreativeId.toUpperCase()===r.vastCreativeId.toUpperCase()))return void n.YB++;n.TB.push(e)}else n.XB++},n.prototype.resetCDTBreak=function(){var e=this;e.bC=1},n.prototype.getCDTBreak=function(){var e=this;return e.bC},n.prototype.incrementCDTBreak=function(){var e=this;e.bC++},n.prototype.RB=function(e,t,r,n){var i=Date.now();return e=e.replace(c,t).replace(u,i).replace(p,r).replace(d,n)}},{"../../../../lib/logger":"/lib/logger.js","../allocation/CommunicatorSpec":96,"../common/Constants":99,"../common/Events":102,"../engine/AdSpec":122,"../yvap-util":138,"./RefreshCommunicator":110}],108:[function(e,t,r){"use strict";function n(e,t){var r=this;r.CB=e,r.SB=t,r.lC={},r.UB=new l(a.REFRESH),r.VB=new s(r.UB),r.dC=0,r.ZB=0,r.aC=[]}t.exports=n;var i=(e("../../util"),e("../../../../lib/logger"),e("../common/Events")),a=e("../common/Constants"),o=e("../engine/AdSpec"),s=e("./RefreshCommunicator"),l=e("../allocation/CommunicatorSpec"),c=(e("../yvap-util"),/\[CDT_BREAK\]/g),u=/\[TIMESTAMP\]/g,p=/\[ID3_TAG\]/g,d=/\[AD_BREAK_DURATION\]/g,f=/\[AD_BREAK_DURATION_MINUS_(\d+)\]/g,v=/\[AD_BREAK_LENGTH\]/g,m=/\[AD_BREAK_LENGTH_MINUS_(\d+)\]/g,y=function(e){};n.prototype.cue=function(e,t,r,n,i,a){var o=this,s=o.lC,l=t+"_"+n+"_"+r+"_"+i;if(!s.hasOwnProperty(l)){o.lC={};var c=o.SB.getPlayerDataForClipId(e);c?(o.unsubscribeEvents(),o.cC(c,t,r,n,i,a)):y("playerdata missing")}},n.prototype.play=function(e,t,r,n,s){var l=this,c=[],u=null,p=0,d=null,f=t+"_"+n+"_"+r+"_"+s;if(l.lC.hasOwnProperty(f)){c=l.lC[f].slice(0),u=new o(a.MIDROLL,["clickable"]);for(var v=0,m=c.length;v<m;v++)p=v+1,l.CB.publish(i.AD_OPPORTUNITY,e,a.MIDROLL,u,l.UB,p),d=c[v],d.midrollbreak=s,d.midrolladsequence=p;return c}return null},n.prototype.cC=function(e,t,r,n,s,l){var c=this,u=new o(a.MIDROLL,["clickable"]);u.label=t,u.adBreakTag=n,u.adBreakId=s,u.duration=r,u.midrollCB=l,c.ZB=Math.ceil(r/a.DEFAULT_AD_DURATION),c.aC.push(c.VB.subscribe(i.AD_READY,c.eC,c)),c.aC.push(c.VB.subscribe(i.AD_FAILURE,c.fC,c)),c.aC.push(c.VB.subscribe(i.AD_PROCESSED_COMPLETED,c.mC,c));var p=c.SB.getMidrollAdTagUri(u,e.clipId,a.MIDROLL,t);p&&(p=c.RB(p,s,r,n,c.ZB),c.VB.getMidrollAd(u,e,p))},n.prototype.eC=function(e,t,r,n){var o=this,s=e.adSpec,l=s.label+"_"+s.adBreakTag+"_"+s.duration+"_"+s.adBreakId;e.type=a.MIDROLL,o.iC(e,l),o.CB.publish(i.AD_CALL_END,r,e)},n.prototype.mC=function(e){var t=this,r=e.adSpec,n=r.label+"_"+r.adBreakTag+"_"+r.duration+"_"+r.adBreakId,a=r.midrollCB;t.lC[n]&&t.lC[n].sort(function(e,t){return e.midrolladsequence-t.midrolladsequence}),a&&t.CB.publish(i.MIDROLL_PLAY_CUE,r.label,r.duration,r.adBreakTag,r.adBreakId,a,!0)},n.prototype.resetState=function(){var e=this;e.lC={}},n.prototype.unsubscribeEvents=function(){for(var e=this,t=0;t<e.aC.length;t++){var r=e.aC[t];r()}},n.prototype.iC=function(e,t){var r,n,i=this,a=i.lC.hasOwnProperty(t)?i.lC[t].slice(0):[],o=e.adObj;if(e.midrolladsequence=o.seq,o){if(o.adId)for(r=0;r<a.length;++r)if(n=a[r].adObj,null!==n.adId&&(o.adId.toUpperCase()===n.adId.toUpperCase()&&o.vastCreativeId===n.vastCreativeId||o.vastCreativeId&&o.vastCreativeId.toUpperCase()===n.vastCreativeId.toUpperCase()))return;a.push(e),i.lC[t]=a}},n.prototype.fC=function(e,t,r,n){var o=this;e.type=a.MIDROLL,e.errorState=n,o.CB.publish(i.AD_CALL_END,r,e)},n.prototype.RB=function(e,t,r,n,i){var a,o,s=Date.now();return n=n||"",e=e.replace(c,t).replace(u,s).replace(p,n).replace(d,r).replace(f,function(e,t){return a=r-parseInt(t),a<0?r:a}).replace(v,i).replace(m,function(e,t){return o=i-parseInt(t),o<0?i:o})}},{"../../../../lib/logger":"/lib/logger.js","../../util":"/nextgen/src/util.js","../allocation/CommunicatorSpec":96,"../common/Constants":99,"../common/Events":102,"../engine/AdSpec":122,"../yvap-util":138,"./RefreshCommunicator":110}],109:[function(e,t,r){"use strict";var n=e("./VASTParser"),i=e("./VMAPParser"),a=e("./VRMParser"),o=e("../common/Errors");r.parseVRMResponse=function(e){return a.parse(e)},r.parseAdXml=function(e){var t,n,i=null;if(!e)return null;e=r.cleanXml(e);try{t=r.parseXml(e,!0)}catch(e){throw new Error(o.XML_PARSING)}if(t.xml&&(n=t.xml.childNodes[0],i=r.parseDom(n)),"object"==typeof i&&null!==t.xmlParseErr)for(var a=0;a<i.length;a++)i[a].adXmlParseErr=t.xmlParseErr;return i},r.cleanXml=function(e){return e&&(e=e.replace(/>\s+</g,"><"),e=e.replace(/<!--[\s\S]*?-->/g,""),e=e.replace(/<\?xml.+\?>/g,"")),e},r.parseXml=function(e,t){var r=null,n=null;if("undefined"!=typeof DOMParser){r=(new DOMParser).parseFromString(e,"text/xml");var i=r.getElementsByTagName("parsererror");i.length&&(n="NonIE")}else"undefined"!=typeof ActiveXObject?(r=document.implementation.createDocument(),r.loadXML(e),0!==r.parseError&&(n="IE")):n="All";return t===!0?{xml:r,xmlParseErr:n}:r},r.parseDom=function(e){var t,n,i;if(!e)throw new Error(o.XML_PARSING);if(t=r.getParser(e),!t)throw i=e.nodeName,"parsererror"===i?new Error(o.XML_PARSING):new Error(o.NO_PARSER);return n=t.parse(e)},r.getParser=function(e){var t=e?e.nodeName:"";return"VAST"===t?n:t.indexOf("VMAP")>-1?i:null}},{"../common/Errors":101,"./VASTParser":115,"./VMAPParser":117,"./VRMParser":118}],110:[function(e,t,r){"use strict";function n(e){var t=this;o.call(t,e)}t.exports=n;var i=e("../../util"),a=e("../../../../lib"),o=e("./Communicator"),s=e("./Ad"),l=e("../common/Events"),c=e("../common/Constants"),u=e("../common/Errors"),p=e("./ParserManager");i.inherits(n,o),n.prototype.getMidrollAd=function(e,t,r){var n=this,i=n.getNewAdResponseObject(e,r,t);i.timestamp=(new Date).getTime()/1e3,n.key=n.getKey(e,t);try{n.fireRequest(r,i)}catch(e){n.publish(l.AD_FAILURE,i,n.key,n,e.message)}},n.prototype.getNewAd=function(e,t,r,n){var i=this;if(r)if(n=r.vastAdData?i.getNewAdResponseObject(e,null,t,n):i.getNewAdResponseObject(e,r.adTagURI,t,n),n.timestamp=(new Date).getTime()/1e3,i.key=i.getKey(e,t),e.viewability=r.viewability,e.medS=r.mediation,e.label=r.label,e.adCallSequence=r.sequence,e.sadl=r.sadl,e.adNetwork=r.network,e.gdprnoad=r.extensions&&r.extensions.GDPRFlags&&r.extensions.GDPRFlags.GDPRNoAd,r.vastAdData)try{var a=r.vastAdData;r.vastAdData=null,e.pbbid=r.vastPbbid,i.processAdObjects(n,a)}catch(e){i.publish(l.AD_FAILURE,n,i.key,i,e.message)}else if(r.customAdData)try{var o=r.customAdData;r.customAdData=null,e.pbbid=r.custPbbid,i.processAdObjects(n,o)}catch(e){i.publish(l.AD_FAILURE,n,i.key,i,e.message)}else r.adTagURI?(e.pbbid=r.pbbid,i.fireRequest(r.adTagURI,n)):i.publish(l.AD_FAILURE,n,i.key,i,u.ICEBREAKER_ERROR)},n.prototype.prefetchAd=function(e,t,r){var n,i=this;if(e){i.key=i.getKey(t,r);var o=e.adSources||[];a.isFunction(window.showAdInfo)&&i.subscribe(l.AD_READY,function(e){window.showAdInfo(e.adObj)});var s=o[0]||{};if(a.isFunction(window.getAdXmlForPreview)&&"PREVIEW"===s.network){var c=window.getAdXmlForPreview();"tag"===c.type?(s.vastAdData=null,s.adTagURI=c.value):(s.vastAdData=p.parseAdXml(c.value),s.adTagURI=null)}t.medT=e.mediation,t.ibn=e.ibn||s.ibn,t.ibnc=e.ibnc,t.liveClickDisabled=e.liveClickDisabled,t.vodClickDisabled=e.vodClickDisabled,n=s.vastAdData||s.customAdData?i.getNewAdResponseObject(t,null,r):i.getNewAdResponseObject(t,s.adTagURI,r),n.adSources=o,i.getNewAd(t,r,s,n)}},n.prototype.setNewRedirect=function(e,t){var r=this;t.setNewRedirectUrl(e),r.fireRequest(e,t)},n.prototype.getKey=function(e,t){var r=t.spaceId||"",n=t.licenseId||"",i=e.type||"";return"Refresh_"+r+"_"+i+"_"+n},n.prototype.processAdXml=function(e){var t=p.parseAdXml(e);if(t&&t.adBreakMap){var r,n,i,a,o,l,u;r=t.adBreakMap.preroll||{};var d=r.adSources||[];if(n=d[0],!n||!n.vastAdData&&!n.adTagURI)return u=new s,u.adFormat="vmap",u.type=c.NOAD,[u];n.vastAdData?i=n.vastAdData:n.adTagURI&&(u=new s,u.type=c.AD,u.redirectUrl=n.adTagURI,u.type="redirect",i=[u]),a=r.trackingEvents||{},o=a.trackings||[];for(var f=0;f<o.length;f++)"breakStart"===o[f].event&&(l=o[f]);if(l)for(f=0;f<i.length;f++)i[f].addBeaconOfType(l.url,"ad-break-start");return i}return t}},{"../../../../lib":"/lib/index.js","../../util":"/nextgen/src/util.js",
"../common/Constants":99,"../common/Errors":101,"../common/Events":102,"./Ad":103,"./Communicator":105,"./ParserManager":109}],111:[function(e,t,r){"use strict";function n(e,t){var r=this;r.nC={},r.nC[i.VIDEO_START]="playback0",r.nC[i.VIDEO_QUARTILE_25]="playback25",r.nC[i.VIDEO_QUARTILE_50]="playback50",r.nC[i.VIDEO_QUARTILE_75]="playback75",r.nC[i.VIDEO_QUARTILE_100]="playback100",r.nC[i.VIDEO_VIEW]="impression",r.nC[i.VIDEO_VIEW_3P]="impression3p",r.CB=e,r.oC=t,r.pC=t.beacons,r.qC=null,r.rC=!1}t.exports=n;var i=e("../common/Constants"),a=e("../common/Events");n.prototype.getAd=function(e){var t=this;return t.qC},n.prototype.sC=function(e){var t,r,n,i=this;if(i.pC)for(var a in i.nC)if(i.nC.hasOwnProperty(a)&&(t=i.pC[a])){r=i.nC[a];for(var o=0;o<t.length;o++)n=t[o],e.addBeaconOfType(n,r)}},n.prototype.tC=function(e){var t=this;t.CB.publish(a.STANDALONE_AD_UPDATE,e),t.rC=!1,t.qC=null},n.prototype.uC=function(e,t,r){var n=this;n.CB.publish(a.AD_CALL_END,r,e),e&&e.adObj&&n.sC(e.adObj),n.qC=e,n.rC===!0&&n.tC(e)},n.prototype.vC=function(e,t,r,n){var i=this;e&&(e.adCallSequence=e.adSpec&&e.adSpec.adCallSequence,e.errorState=n),i.uC(e,t,r)}},{"../common/Constants":99,"../common/Events":102}],112:[function(e,t,r){"use strict";function n(e,t){var r=this,i=null;n.super_.call(r,e,t),r.wC=t.brxd,r.UB=new c(o.STANDALONE_BRXD),r.xC=new s(o.PREROLL,["clickable"]),r.xC.viewability=!0,r.VB=new l(r.UB),r.VB&&(r.VB.subscribe(a.AD_READY,r.uC,r),r.VB.subscribe(a.AD_FAILURE,r.vC,r),r.CB.publish(a.AD_CALL_START,r.VB),r.VB.prefetchAd(r.wC,r.xC,i,o.STANDALONE_BRXD,parseInt(1e5*Math.random())))}t.exports=n;var i=e("../../util"),a=e("../common/Events"),o=e("../common/Constants"),s=e("../engine/AdSpec"),l=e("./Communicator"),c=e("../allocation/CommunicatorSpec"),u=e("./StandaloneAdHelper");i.inherits(n,u),n.prototype.getAd=function(e){var t=this;t.CB.publish(a.AD_OPPORTUNITY,e,t.xC.type,t.xC,t.UB);var r=t.qC;return r?t.qC=null:t.rC=!0,r}},{"../../util":"/nextgen/src/util.js","../allocation/CommunicatorSpec":96,"../common/Constants":99,"../common/Events":102,"../engine/AdSpec":122,"./Communicator":105,"./StandaloneAdHelper":111}],113:[function(e,t,r){"use strict";function n(e,t){var r=this,i=null;n.super_.call(r,e,t),r.wC=t.xml,r.UB=new c(o.STANDALONE_GEMINI_BRX),r.xC=new s(o.PREROLL,["clickable"]),r.VB=new l(r.UB),r.VB&&(r.VB.subscribe(a.AD_READY,r.uC,r),r.VB.subscribe(a.AD_FAILURE,r.vC,r),r.CB.publish(a.AD_CALL_START,r.VB),r.VB.prefetchAd(r.wC,r.xC,i,o.STANDALONE_GEMINI_BRX,parseInt(1e5*Math.random())))}t.exports=n;var i=e("../../util"),a=e("../common/Events"),o=e("../common/Constants"),s=e("../engine/AdSpec"),l=e("./Communicator"),c=e("../allocation/CommunicatorSpec"),u=e("./StandaloneAdHelper");i.inherits(n,u),n.prototype.getAd=function(e){var t=this;t.CB.publish(a.AD_OPPORTUNITY,e,t.xC.type,t.xC,t.UB);var r=t.qC;return r||(t.rC=!0),r}},{"../../util":"/nextgen/src/util.js","../allocation/CommunicatorSpec":96,"../common/Constants":99,"../common/Events":102,"../engine/AdSpec":122,"./Communicator":105,"./StandaloneAdHelper":111}],114:[function(e,t,r){"use strict";function n(e,t){var r=this;n.super_.call(r,e,t),r.yC=t.gemini,r.zC=t.rules,r.UB=new p(l.STANDALONE_GEMINI_NATIVE),r.xC=new c(l.PREROLL,["clickable"]),r.xC.viewability=!0,r.VB=new u(r.UB);var i=o.constructAdObj(r.yC,r.zC);if(i&&r.sC(i),r.VB){var a=r.VB.getNewAdResponseObject(r.xC);a.adSystem=l.STANDALONE_GEMINI_NATIVE,a.adObj=i,r.qC=a}}t.exports=n;var i=e("../../util"),a=e("./StandaloneAdHelper"),o=e("./GeminiNativeParser"),s=e("../common/Events"),l=e("../common/Constants"),c=e("../engine/AdSpec"),u=e("./Communicator"),p=e("../allocation/CommunicatorSpec");i.inherits(n,a),n.prototype.getAd=function(e){var t=this;return t.CB.publish(s.AD_OPPORTUNITY,e,t.xC.type,t.xC,t.UB),t.qC}},{"../../util":"/nextgen/src/util.js","../allocation/CommunicatorSpec":96,"../common/Constants":99,"../common/Events":102,"../engine/AdSpec":122,"./Communicator":105,"./GeminiNativeParser":106,"./StandaloneAdHelper":111}],115:[function(e,t,r){"use strict";function n(e,t,r){for(var n,i,a=e.childNodes,o=0;o<a.length;o++)n=a[o],i=t[n.nodeName],i&&i.call(void 0,r,n)}function i(e,t){var r={MediaFile:function(e,t){var r,n,i=t.getAttribute("type"),a=t.getAttribute("apiFramework"),o=t.getAttribute("delivery");r=t.getAttribute("bitrate")||100,r=parseInt(r,10),n=O.getTextFromNode(t),e.addMedia(i,r,n,o,a),e.placementId||n.indexOf(x)===-1||(e.placementId=O.extractValueFromUrl("placementId",n))}};n(t,r,e)}function a(e,t){var r={"#cdata-section":function(e,t){var r=e.adParameters||{};e.adParameters=r;var n=r.AdParameters||"";r.AdParameters=n+t.nodeValue},"#text":function(e,t){e.adParameters={AdParameters:t.nodeValue}}};n(t,r,e)}function o(e,t){var r={Tracking:function(e,t){var r,n=t.getAttribute("event");n&&t.textContent&&(r=M[n],r?e.addBeaconOfType(t.textContent,r):e.addBeaconOfType(t.textContent,n))}};n(t,r,e)}function s(e,t){var r={ClickThrough:function(e,t){t.textContent&&e.addParamOfName(t.textContent,"clickurl")},ClickTracking:function(e,t){var r=t.nodeName;r&&t.textContent&&e.addBeaconOfType(t.textContent,"clicktracking")}};n(t,r,e)}function l(e,t){var r={MediaFiles:i,AdParameters:a,TrackingEvents:o,VideoClicks:s,Duration:function(e,t){if(N.isNullOrUndefined(e.duration)){var r=O.getTextFromNode(t);e.duration=P.convertTimeToSeconds(r)}}};e.streams=[];for(var l in e.beacons)e.beacons.hasOwnProperty(l)&&"impression"!==l&&"errorimpression"!==l&&"feacons"!==l&&"attempt"!==l&&"impression3p"!==l&&delete e.beacons[l];n(t,r,e)}function c(e,t){var r,n;e=e||{},t.textContent&&(r=t.getAttribute("creativeType")||"",n=t.textContent||"",e.resourceUrl=n.trim(),e.resourceType=r.trim())}function u(e,t){var r;t.textContent&&(r=t.textContent||"",r=r.trim(),e.addParamOfName(r,"clickurl"))}function p(e,t){var r={StaticResource:c,NonLinearClickThrough:u,AdParameters:a},i=e.nonLinearAd||{},o=t.getAttribute("width"),s=t.getAttribute("height"),l=t.getAttribute("scalable"),p=t.getAttribute("apiFramework");i.width=o,i.height=s,i.scalable=l,i.apiFramework=p,e.nonLinearAd=i,n(t,r,e),r={StaticResource:c},n(t,r,e.nonLinearAd)}function d(e,t){var r={TrackingEvents:o,NonLinear:p};n(t,r,e)}function f(e,t){var r={Linear:l,NonLinearAds:d};n(t,r,e),e.vastCreativeId||(e.vastCreativeId=t.getAttribute("id")||""),e.creativeId=e.creativeId||t.getAttribute("id")}function v(e,t){var r={Creative:f};n(t,r,e)}function m(e,t){var r=O.getTextFromNode(t);e.addBeaconOfType(r,"impression"),e.placementId||r.indexOf(w)===-1||(e.placementId=O.extractValueFromUrl("5",r))}function y(e,t){var r=O.getTextFromNode(t);e.addBeaconOfType(r,"attempt")}function h(e,t){var r,i=t.getAttribute("type");i===k.VIEWABILITY_RULES?(r={viewabilityDefVideo3P:g},n(t,r,e)):i===k.VIEWABILITY_3P?(r={Beacon:E},n(t,r,e)):i===k.ONE_VIDEO_FEACONS?(r={Feacons:L},n(t,r,e)):i===k.ADAPTV_SCRIPT&&(r={Script:C},n(t,r,e))}function E(e,t){var r=t.getAttribute("type");"VIDEO_VIEW_3P"===r&&t.textContent&&e.addBeaconOfType(t.textContent,"impression3p")}function g(e,t){var r={rule:b};n(t,r,e)}function b(e,t){var r=parseInt(t.getAttribute(k.VIEWABILITY_RULE_TYPE),10),n=parseInt(t.getAttribute(k.VIEWABILITY_RULE_MIN_DURATION),10),i=parseInt(t.getAttribute(k.VIEWABILITY_RULE_CONSECUTIVE_PLAYBACK),10),a=parseInt(t.getAttribute(k.VIEWABILITY_RULE_MIN_PIXELS),10),o=parseInt(t.getAttribute(k.VIEWABILITY_RULE_AUDIO),10);if(r||n||i||a||o){var s={};r&&(s[k.VIEWABILITY_RULE_TYPE]=r),n&&(s[k.VIEWABILITY_RULE_MIN_DURATION]=n),i&&(s[k.VIEWABILITY_RULE_CONSECUTIVE_PLAYBACK]=i),a&&(s[k.VIEWABILITY_RULE_MIN_PIXELS]=a),o&&(s[k.VIEWABILITY_RULE_AUDIO]=o),e.rules=e.rules||{},e.rules.viewabilityDefVideo3P=e.rules.viewabilityDefVideo3P||[],e.rules.viewabilityDefVideo3P.push(s)}}function _(e,t){var r=O.getTextFromNode(t);r=r.replace(/\[ERRORCODE\]/g,"{err_code}"),r=r.replace(/%5BERRORCODE%5D/g,"{err_code}"),e.addBeaconOfType(r,"errorimpression")}function A(e,t){var r={Extension:h};n(t,r,e)}function T(e,t){var r={VASTAdTagURI:function(e,t){e.redirectUrl=O.getTextFromNode(t),e.type="redirect"},Impression:m,Creatives:v,Extensions:A,Error:_,Attempt:y,AdSystem:function(e,t){e.adSystem=O.getTextFromNode(t)}};n(t,r,e)}function S(e,t){var r={Impression:m,Creatives:v,Extensions:A,Error:_,Attempt:y,AdSystem:function(e,t){e.adSystem=O.getTextFromNode(t)}};n(t,r,e)}function I(e,t){var r=t.getAttribute("id"),i=parseInt(t.getAttribute("sequence"),10);r&&(e.adId=r),isNaN(i)||(e.seq=i);var a={Wrapper:T,InLine:S};return n(t,a,e),e}function L(e,t){var r={Feacon:R};n(t,r,e)}function R(e,t){var r=O.getTextFromNode(t);e.addBeaconOfType(r,"feacons")}function C(e,t){var r=t.getAttribute("resourceType"),n=O.getTextFromNode(t);e.addScriptExtension(n,r)}var D=e("./Ad"),O=e("../../util"),N=e("../../../../lib"),P=e("../yvap-util"),k=e("../common/Constants"),M={start:"playback0",firstQuartile:"playback25",midpoint:"playback50",thirdQuartile:"playback75",complete:"playback100"},w="log.adaptv.advertising.com",x="acds.prod.vidible.tv";r.parse=function(e){var t,r,i,a=[];if(!e||"VAST"!==e.nodeName)return a;var o={Error:function(e,t){r=O.getTextFromNode(t)},Ad:function(e,t){e=new D,e.adFormat="vast",I(e,t),r&&e.addBeaconOfType(r,"noaderror"),i&&A(e,i),a.push(e)},Extensions:function(e,t){return e?void A(e,t):void(i=t)}};return n(e,o,t),0===a.length&&(t=new D,t.adFormat="vast",t.type=k.NOAD,r&&t.addBeaconOfType(r,"noaderror"),i&&A(t,i),a.push(t)),a}},{"../../../../lib":"/lib/index.js","../../util":"/nextgen/src/util.js","../common/Constants":99,"../yvap-util":138,"./Ad":103}],116:[function(e,t,r){"use strict";function n(){var e=this;e.adBreakMap={},e.version=""}function i(){var e=this;e.adSources=[],e.trackingEvents=null,e.timeOffset="",e.breakType=[],e.breakId="",e.repeatAfter="",e.extensions=null,e.mediation=0,e.ibn="",e.ibnc="",e.adSourcesObj={},e.liveClickDisabled=!1,e.vodClickDisabled=!1}function a(){var e=this;e.id="",e.allowMultipleAds=0,e.followRedirects=0,e.adTagURI="",e.customAdData="",e.vastAdData="",e.network="",e.sequence=0,e.mediation=0,e.sadl=null,e.label="",e.extensions=null,e.viewability=!1,e.ibn=""}function o(){var e=this;e.trackings=[]}function s(){var e=this;e.event="",e.url=""}function l(){var e=this;e.extensions=[],e.clientRules=null}function c(){var e=this;e.extensions=[],e.GDPRFlags=null}function u(){var e=this;e.xml="",e.type="",e.data={}}t.exports={VMAPObject:n,AdBreak:i,AdSource:a,TrackingEvents:o,Tracking:s,Extensions:l,Extension:u,AdSourceExtensions:c}},{}],117:[function(e,t,r){"use strict";function n(e,t,r){for(var n,i,a=e.childNodes,o=0;o<a.length;o++)n=a[o],i=t[n.nodeName],i&&i.call(void 0,r,n)}function i(e,t){var r=new p.TrackingEvents,i={"vmap:Tracking":function(e,t){var r=new p.Tracking,n=t.getAttribute("event")||"";r.event=n,r.url=t.textContent,e.trackings.push(r)}};n(t,i,r),e.trackingEvents=r}function a(e,t){var r=new p.Extensions,i={ClientRules:s};n(t,i,r),e.extensions=r}function o(e){var t=new p.AdSourceExtensions,r={GDPRFlags:l};return n(e,r,t),t}function s(e,t){var r={},i={MinDuration:function(e,t){var r=t.textContent||0;e.MinDuration=r},StartAtClip:function(e,t){var r=t.textContent||0;e.StartAtClip=r},Frequency:function(e,t){var r=t.textContent||0;e.Frequency=r},Length:function(e,t){var r=t.textContent||0;e.Length=r},Offset:function(e,t){var r=t.textContent||0;e.Offset=r},AdDuration:function(e,t){var r=t.textContent||0;e.AdDuration=r},Repeat:function(e,t){var r=t.textContent||0;e.Repeat=r},Placement:function(e,t){var r=t.textContent||0;e.Placement=r}};n(t,i,r),e.clientRules=r}function l(e,t){var r={},i={GDPRNoAd:function(e,t){var r=t.textContent||0;e.GDPRNoAd=r}};n(t,i,r),e.GDPRFlags=r}function c(e,t){var r=new p.AdSource,i={"vmap:VASTAdData":function(e,t){var r=t.childNodes[0],n=d.getParser(r);e.vastAdData=n.parse(r),e.vastPbbid=t.getAttribute("pbbid")||""},"vmap:VASTData":function(e,t){var r=t.childNodes[0],n=d.getParser(r);e.vastAdData=n.parse(r),e.vastPbbid=t.getAttribute("pbbid")||""},"vmap:AdTagURI":function(e,t){e.adTagURI=t.textContent,e.pbbid=t.getAttribute("pbbid")||""},"vmap:Extensions":function(e,t){e.extensions=o(t)},"vmap:CustomAdData":function(e,t){var r=t.childNodes[0];r&&(e.customAdData=f.constructAd(r.nodeValue)),e.custPbbid=t.getAttribute("pbbid")||""}};n(t,i,r),r.network=t.getAttribute("network")||"",r.sequence=t.getAttribute("seq")||"1",r.mediation=t.getAttribute("mediation")||"0",r.label=t.getAttribute("label")||"",r.sadl=t.getAttribute("latency"),"ADAP"!==r.network&&"VIP"!==r.network&&"GMN"!==r.network&&"PREVIEW"!==r.network||(r.viewability=!0);var a=r.label;a&&(e.adSourcesObj[a]=r),e.adSources.push(r)}function u(e,t){var r=new p.AdBreak,o=t.getAttribute("breakId")||"",s=t.getAttribute("timeOffset")||"";"start"===s||o.indexOf("pre")>-1?r.breakId="preroll":"end"===s?r.breakId="postroll":r.breakId=o,r.breakType=(t.getAttribute("breakType")||"").split(","),r.timeOffset=s,r.mediation=t.getAttribute("mediation")||"",r.ibn=t.getAttribute("ibn")||"0",r.ibnc=t.getAttribute("ibnc")||"",r.liveClickDisabled="1"===t.getAttribute("liveClickDisabled"),r.vodClickDisabled="1"===t.getAttribute("vodClickDisabled");var l={"vmap:AdSource":c,"vmap:TrackingEvents":i,"vmap:Extensions":a};n(t,l,r),e.adBreakMap[r.breakId]=r}var p=e("./VMAP"),d=e("./ParserManager"),f=e("./GeminiNativeParser");r.parse=function(e){var t=null;if(!e||"vmap:VMAP"!==e.nodeName)return t;t=new p.VMAPObject;var r={"vmap:AdBreak":u};return n(e,r,t),t}},{"./GeminiNativeParser":106,"./ParserManager":109,"./VMAP":116}],118:[function(e,t,r){"use strict";function n(e,t){if(e){var r=new p.AdSource;r.network=e.vendorName||"",r.sequence=t.sequence.toString(),t.sequence++,r.adTagURI=e.url,r.pbbid=e.pblobId,r.mediation=1,r.ibn=e.name||"";var n=e.vendorName;n&&(n.indexOf(u.VENDOR_ONEVIDEO)>-1||n.indexOf(u.VENDOR_GEMINI)>-1||n===u.PREVIEW)&&(r.viewability=!0);var i=e.vastXml,a=e.adEngineType;if(a&&a===u.ADENGINE_TYPE_GEMINI&&(r.adTagURI=""),i)if(t.mediation=2,r.mediation=3,a&&a===u.ADENGINE_TYPE_GEMINI){var o;try{o=f.constructAd(i)}catch(e){r.mediation=4}o&&o[0]&&o[0].type!==u.NOAD&&(r.mediation=2,r.customAdData=o)}else{var s;try{s=d.parseAdXml(i)}catch(e){r.mediation=4}s&&s[0]&&(s[0].type!==u.NOAD||n&&n.indexOf(u.VENDOR_ONEVIDEO_VIP)>-1)&&(r.mediation=2,r.vastAdData=s)}t.adSources.push(r)}}function i(e,t){if(e&&!(e.length<=0))for(var r=0;r<e.length;r++)n(e[r],t)}function a(e,t){if(e&&!(e.length<=0))for(var r=0;r<e.length;r++)i(e[r],t)}function o(e,t){if(e&&"SHOW_ADS"===e.adxResult&&e.type&&e.aeg&&!(e.aeg.length<=0)){var r=v[e.type];if(r){var n=new p.AdBreak;n.breakId=r,n.liveClickDisabled=!1,n.vodClickDisabled=!1,n.sequence=1,n.mediation=1,n.extensions=new p.Extensions,n.extensions.clientRules={StartAtClip:1,Frequency:1},t.adBreakMap[n.breakId]=n,a(e.aeg,n)}}}function s(e,t){if(e&&!(e.length<=0))for(var r=0;r<e.length;r++)o(e[r],t)}function l(e,t){!e||!e.slots||e.slots.length<=0||s(e.slots,t)}function c(e,t){if(e&&!(e.length<=0))for(var r=0;r<e.length;r++)l(e[r],t)}var u=e("../common/Constants"),p=e("./VMAP"),d=e("./ParserManager"),f=e("./GeminiNativeParser"),v={PREROLL:"preroll",BUMPER:"bumper",POSTROLL:"postroll"};r.parse=function(e){if(!e)return null;var t=new p.VMAPObject;return e.status&&"OK"===e.status.code&&e.schema&&e.schema.pods?(c(e.schema.pods,t),t):t}},{"../common/Constants":99,"./GeminiNativeParser":106,"./ParserManager":109,"./VMAP":116}],119:[function(e,t,r){"use strict";var n=e("../common/Constants");r.AC=function(e){return e===n.VPAID},r.BC=function(e){return e===n.VPAID_JS_FORMAT||e===n.VPAID_TEXT_JS_FORMAT||e===n.VPAID_X_JS_FORMAT},r.DC=function(e){return e===n.MP4_FORMAT},r.EC=function(e){return e===n.WEBM_FORMAT},r.FC=function(e){return e===n.XFLV_FORMAT},r.GC=function(e){var t=n.NOAD,i="";if(e.nonLinearAd)t=n.OVERLAY;else if(e.streams&&e.streams.length>0){var a=e.streams,o=[],s=[];a.forEach(function(t){var n=t.apiFramework&&t.apiFramework.toLowerCase()||"",i=t.format&&t.format.toLowerCase()||"";r.AC(n)?r.BC(i)?(e.cjs+=1,s.push(t)):e.cswf+=1:(r.DC(i)?e.cmp4+=1:r.EC(i)?e.cwbm+=1:r.FC(i)&&(e.cflv+=1),o.push(t))}),o.length>0?(t=n.AD,e.streams=o):s.length>0&&(t=n.VPAID,i="vp-js",e.streams=s)}e.type=t,e.mtype=i},r.validateAdObj=function(e){for(var t=[r.GC],n=0;n<t.length;n++)e=t[n](e)}},{"../common/Constants":99}],120:[function(e,t,r){"use strict";function n(){var e=this;e.actionValues=null,e.placement=null,e.ruleFunctions=[],e.cookieUtil=a}var i=e("../../../../lib"),a=e("../common/CookieUtil");t.exports=n,n.evaluateDefault=function(){var e=this,t=e.cookieUtil.getTotalClipCount()+1,r=e.start||1;return t>=r},n.evaluateStart=function(){var e=this,t=e.cookieUtil.getTotalClipCount()+1,r=e.start||1;return t===r},n.evaluateOverlay=function(){var e,t,r,n,i=this,a=i.clipDuration,o=i.timeUpdate,s=i.overlayStart||0,l=i.repeat||0,c=i.lastShown||0,u=i.padding||0,p=i.duration||0;return c=o<=c?0:c,e=o-c,t=o-s,r=o+p+u,n=t>=0&&(!c||e>=l)&&r<=a,n&&(i.lastShown=o),n},n.evaluateFrequency=function(){var e=this,t=e.cookieUtil.getRecentClipCount(),r=e.interval||0;return t>=r||1===r},n.evaluateLength=function(){var e=this,t=e.length||0,r=e.cookieUtil.getRecentVideoLength();return r>=t},n.evaluateRatio=function(){var e=this,t=e.ratio||0,r=e.cookieUtil.getAdLength(),n=e.cookieUtil.getTotalVideoLength(),i=n/r;return!isNaN(i)&&i>=t},n.evaluateMinimumDuration=function(){var e=this,t=e.clipDuration||0,r=e.minimumDuration||0;return t>=r},n.evaluatefirstAdProbability=function(){var e=this,t=e.probability||100,r=100*Math.random(),n=e.cookieUtil.getTotalClipCount()+1,i=e.start||1;return n===i&&r<=t},n.prototype.addRuleFunction=function(e){var t=this;i.isFunction(e)&&t.ruleFunctions.push(e)},n.prototype.evaluate=function(e,t){var r=this,n=0,i=r.ruleFunctions,a=!0;for(r.clipDuration=e||0,r.timeUpdate=t||0,n=0;n<i.length;n++)a=a&&i[n].call(this);return a}},{"../../../../lib":"/lib/index.js","../common/CookieUtil":100}],121:[function(e,t,r){"use strict";function n(){}var i=e("./ActionRule"),a=e("./RuleGroup"),o=e("./AdSpec");e("../../util");t.exports=n;var s={bumper:"clipGateway",preroll:"preroll",postroll:"postroll",overlay:"videoTimeline",midroll:"immediate"};n.prototype.understandRules=function(e){var t=this,r=new a,n=e.adBreakMap||{};for(var o in n)if(n.hasOwnProperty(o)){var l=n[o],c=s[o],u=r[c],p=l.extensions||{},d=p.clientRules;if(d){var f=new i;f.type=c,"videoTimeline"===c?t.HC(f,d):t.IC(f,d),u.push(f)}}return r},n.prototype.HC=function(e,t){if(e&&t){e.start=parseInt(t.StartAtClip,10),e.duration=parseInt(t.AdDuration,10),e.interval=parseInt(t.Frequency,10),e.overlayStart=parseInt(t.Offset,10),e.repeat=parseInt(t.Repeat,10);var r=parseInt(t.Placement,10);1===r?e.placement="top":e.placement="bottom",e.addRuleFunction(i.evaluateOverlay)}},n.prototype.IC=function(e,t){var r=this,n=function(){return!0};e.addRuleFunction(i.evaluateDefault);var a=t.MinDuration>0,o=t.Length>0,s=t.Frequency>0,l=t.StartAtClip>0;a&&(e.minimumDuration=parseInt(t.MinDuration,10),e.addRuleFunction(i.evaluateMinimumDuration));var c=i.evaluateStart;l&&(e.start=parseInt(t.StartAtClip,10));var u;o?(e.length=60*parseInt(t.Length,10),u=i.evaluateLength):s?(e.interval=parseInt(t.Frequency,10),u=i.evaluateFrequency):u=n,e.addRuleFunction(r.JC(c,u,"OR"))},n.prototype.JC=function(e,t,r){var n=function(){return!1};return"AND"===r?n=function(){var r=this;return e.call(r)&&t.call(r)}:"OR"===r&&(n=function(){var r=this;return e.call(r)||t.call(r)}),n},n.prototype.onAdEvent=function(e,t,r,n){var i=s[e],a=null,l=null;return t&&t.preEvaluate&&(l=t.evaluate(i,r,n),l&&(a=new o(e,l.actionValues,l.placement,l.duration))),a}},{"../../util":"/nextgen/src/util.js","./ActionRule":120,"./AdSpec":122,"./RuleGroup":123}],122:[function(e,t,r){"use strict";function n(e,t,r,n){var i=this;i.type=e||"",i.actionValues=t||[],i.placement=r||"",i.adCallSequence=1,i.duration=n||0,i.adCount=0,i.fallbackParam=!0,i.adIdBeacon=0,i.adNetwork="",i.medT="0",i.medS="0",i.sadl="0",i.ibnc="",i.ibn="",i.label="",i.adBreakTag="",i.adBreakId="",i.liveClickDisabled=!1,i.vodClickDisabled=!1,i.midrollCB=null,i.gdprnoad=0,i.viewability=!1}t.exports=n},{}],123:[function(e,t,r){"use strict";function n(){var e=this;e.preroll=[],e.clipGateway=[],e.videoTimeline=[],e.postroll=[],e.immediate=[]}t.exports=n,n.prototype.evaluate=function(e,t,r){var n,i,a=this,o=a[e]||[],s=null;for(i=0;i<o.length;i++)n=o[i],n.type===e&&n.evaluate(t,r)&&(s=n);return s},n.prototype.preEvaluate=function(e){var t=this;return t[e]||[]}},{}],124:[function(e,t,r){"use strict";var n=function(e,t,r){var n,i,a,o,s,l,c=100,u=0,p=null,d=[],f=e.length;for(o=r+1;o<=f;o++){for(n=0,i=[],a=0,l=-1,s=r;s<f&&(u++,n+=e[s],a=n-t,i.push(s),!(a>=0));s=o+l)l++;if((null===p||a>=0&&a<=p)&&(p=a,d=i),0===p||u>c)break}return{indexCombo:d,exceed:p}},i=function(e,t){var r,i,a=null,o=[],s=[],l=[],c=[];for(e.sort(function(e,t){var r=e&&e.adObj&&parseInt(e.adObj.duration,10)||NaN,n=t&&t.adObj&&parseInt(t.adObj.duration,10)||NaN;return isNaN(r)&&(r=0),isNaN(n)&&(n=0),r-n}),l=e.map(function(e){var t=e&&e.adObj&&parseInt(e.adObj.duration,10)||NaN;return isNaN(t)&&(t=0),t}),r=0;r<l.length&&(s=n(l,t,r),(null===a||s.exceed>=0&&s.exceed<=a)&&(a=s.exceed,o=s.indexCombo),0!==a);r++);for(i=0;i<o.length;i++)c.push(e[o[i]]);return c};t.exports={findBestCombination:i}},{}],125:[function(e,t,r){!function(){function r(){var e=this;e.KC={}}var n=e("../node/analytic-profile-node");r.prototype.set=function(e){var t=this;return!e||t.KC[e]?null:(t.KC[e]=new n,t.KC[e])},r.prototype.get=function(e){var t=this;return e&&t.KC[e]?t.KC[e]:null},t.exports=r}()},{"../node/analytic-profile-node":131}],126:[function(e,t,r){"use strict";function n(e,t){if(!t||0===t.length)return e;if(!e||0===e.length)return e;var r,n=/\{(\w)+\}/g;return r=e.replace(n,function(e){var r,n=/(\w)+/g,i=e.match(n),a=i[0];return r=t[a],null!==t[a]&&void 0!==t[a]||(r=e),r})}function i(e,t){if(!e||0===e.length)return e;for(var r,n=[],i=0;i<e.length;i++)r=e[i],r&&0!==r.length&&(r=p.expandViewabilityMacros(r,t),l.sendImageBeacon(r),n.push(r));return n}function a(e,t){if(!e||0===e.length)return e;for(var r,i=[],a=0;a<e.length;a++)r=e[a],r&&0!==r.length&&(r=n(r,t),l.sendImageBeacon(r),i.push(r));return i}function o(e){var t=e.adObj||{},r=[];if(t.beacons&&t.beacons.feacons){var n=t.beacons.feacons;r=r.concat(a(n)),t.beacons.feacons=null}return r}function s(e){var t=e.adObj||{},r=[];if(t.beacons&&t.beacons.attempt){var n=t.beacons.attempt;r=r.concat(a(n)),t.beacons.attempt=null}return r}var l=e("../../util"),c=e("../common/Errors"),u=e("../common/Constants"),p=e("../yvap-util"),d={};d[u.NOAD]=303,d[c.AD_CALL_TIMEOUT]=301,d[c.EMPTY_RESPONSE]=912,d[c.XML_PARSING]=100,d[c.NO_PARSER]=101,d[c.MISSING_ADTGT]=913,d[c.PLAYER_TIMEOUT]=402,d[c.REQUEST_GENERIC]=900,d[c.INCOMPATIBLE_MEDIA]=200,d[c.MEDIA_PLAYBACK]=405,d[c.VPAID_TIMEOUT]=901,d[c.ADBLOCKER]=400,d[c.SSL_MISMATCH]=405,d[c.RESPONSE_GENERIC]=400,d[c.ICEBREAKER_ERROR]=900,d[c.VPAID_AD_RENDER_ERROR]=901,d[c.VPAID_AD_LOAD_ERROR]=901,d[c.VPAID_AD_INIT_ERROR]=901,d[c.VPAID_AD_INIT_TIMEOUT]=901,d[c.VPAID_AD_START_ERROR]=901,d[c.VPAID_AD_START_TIMEOUT]=901,d[c.VPAID_AD_STOP_ERROR]=901,r.onAdProgress=function(e,t,r,n){var o=e.adObj||{};r=Math.floor(r),t=Math.round(t);var s=25*Math.floor(4*t/r),l="playback"+s,c=[];if(o.beacons){var p,d=o.adFormat===u.GEMINI_AD,f=o.type===u.VPAID;0!==s||f||d||(p=o.beacons.impression||[],c=c.concat(a(p)),o.beacons.impression=null),f||(p=o.beacons[l]||[],c=e.adSpec&&e.adSpec.viewability?c.concat(i(p,n)):c.concat(a(p)),o.beacons[l]=null)}return c},r.onVPAIDAdQuartile=function(e,t,r,n){var o=e.adObj||{},s="playback"+t,l=[];if(o.beacons){var c=o.beacons[s]||[];l=e.adSpec&&e.adSpec.viewability?l.concat(i(c,n)):l.concat(a(c)),o.beacons[s]=null}return l},r.onAdStart=function(e){var t=e.adObj||{},r=[],n=t.type===u.VPAID,i=t.type===u.OVERLAY;if(t.beacons&&(n||i)){var s=t.beacons.impression||[];r=r.concat(a(s)),t.beacons.impression=null}return r=r.concat(o(e))},r.onAdBreakStart=function(e){var t=e.adObj||{},r=[];if(t.beacons){var n=t.beacons["ad-break-start"]||[];r=r.concat(a(n)),t.beacons["ad-break-start"]=null}return r=r.concat(s(e))},r.onAdClick=function(e){var t=e.adObj||{},r=[];if(t.beacons){var n=t.beacons.clicktracking||[];r=r.concat(a(n))}return r},r.onNoAd=function(e,t){var r,n=e.redirectList.length,i=n>0,s=[],l=e.adObj||{};if(l.beacons)if(i||l.type!==u.NOAD){var p=e.errorState||c.RESPONSE_GENERIC,f=d[p];r=l.beacons.errorimpression||[],s=s.concat(a(r,{err_code:f})),l.beacons.errorimpression=null}else r=l.beacons.noaderror||[],s=s.concat(a(r)),l.beacons.noaderror=null;return s=s.concat(o(e))}},{"../../util":"/nextgen/src/util.js","../common/Constants":99,"../common/Errors":101,"../yvap-util":138}],127:[function(e,t,r){"use strict";function n(){var e=this;e.bumper=null,e.preroll=null,e.midroll=null,e.postroll=null}function i(){var e=this;e.adOppEvents=[],e.adCallEvents=[],e.adCallFailEvents=[],e.adDeliveryEvents=[]}function a(){var e=this;e.networkName="",e.adPosition="none",e.taken=!1}function o(){var e=this;e.responseCode="",e.responseType="",e.firstRedirect="",e.redirectCount=0,e.adCallSequence=0,e.networkName="",e.adNetwork="",e.creativeId="",e.bookingId="",e.placementId="",e.cacheHit="",e.cacheId="",e.latency=null,e.midrollAdBreak="",e.midrollAdPos="",e.midrollAdBreakDur=0,e.adSystem="",e.mtype=null,e.cjs=null,e.cswf=null,e.cmp4=null,e.cwbm=null,e.cflv=null,e.label=null,e.gdprnoad=0,e.vim=null}function s(){var e=this;e.mediaStartLatency=null,e.serveId=null,e.error=""}function l(){}function c(e,t,r,n){var i=this;i.CB=e,i.yvapVersion=t||"default",i.playerTimeout=r,i.vpaidTimeout=n||f.DEFAULT_VPAID_TIMEOUT,i.LC=new v,i.MC={},i.NC={},i.OC={},i.CB.subscribe(p.BEGIN_AD_EXP,i.PC,i),i.CB.subscribe(p.AD_OPPORTUNITY,i.QC,i),i.CB.subscribe(p.NULL_AD_OPPORTUNITY,i.RC,i),i.CB.subscribe(p.AD_CALL_START,i.SC,i),i.CB.subscribe(p.AD_CALL_END,i.TC,i),i.CB.subscribe(p.AD_SUBMITTED,i.UC,i),i.CB.subscribe(p.AD_HANDLE_FALLBACK,i.VC,i),i.CB.subscribe(p.AD_DELIVERED,i.WC,i),i.CB.subscribe(p.AD_DELIVERY_ERROR,i.XC,i),i.CB.subscribe(p.AD_PROGRESS,i.YC,i),i.CB.subscribe(p.VIDEO_START,i.ZC,i),i.CB.subscribe(p.VIDEO_END,i.$C,i),i.CB.subscribe(p.AD_BREAK_ENDED,i._C,i),i.CB.subscribe(p.AD_BREAK_SUBMITTED,i.aD,i),i.CB.subscribe(p.VPAID_AD_RENDERED,i.bD,i),i.CB.subscribe(p.VPAID_AD_STARTED,i.cD,i),i.CB.subscribe(p.VPAID_AD_INITED,i.dD,i),i.CB.subscribe(p.VPAID_AD_INIT_ERROR,i.eD,i)}var u=e("../../util"),p=e("../common/Events"),d=e("../common/Errors"),f=e("../common/Constants"),v=e("../model/analytic-profile-model");t.exports=c;var m={};m[f.NOAD]=2,m[f.AD]=2,m[f.VPAID]=4,m.ERROR=106;var y={};y[f.NOAD]=1,y[f.AD]=2,y[f.VPAID]=2,y[d.AD_CALL_TIMEOUT]=102,y[d.EMPTY_RESPONSE]=5122,y[d.XML_PARSING]=108,y[d.NO_PARSER]=5125,y[d.MISSING_ADTGT]=122,y[d.PLAYER_TIMEOUT]=105,y[d.REQUEST_GENERIC]=104,y[d.THIRD_PARTY_NO_AD]=125,y[d.SSL_MISMATCH]=121,y[d.MISSING_SPACEID]=131,y[d.RESPONSE_GENERIC]=5130,y[d.ICEBREAKER_ERROR]=100,y[d.ADBLOCKER]=124;var h=1,E={};E[f.CACHE_L0]=1,E[f.CACHE_L1]=2,E[f.CACHE_L2]=3;var g=[f.PREROLL,f.BUMPER,f.CLIP_START,f.MIDROLL,f.POSTROLL,f.CLIP_END],b={};b[d.INCOMPATIBLE_MEDIA]=120,b[d.MEDIA_PLAYBACK]=114,b[d.GENERIC]=112,b[d.VPAID_TIMEOUT]=115,b[d.ADBLOCKER]=124,b[d.VPAID_AD_RENDER_ERROR]=201,b[d.VPAID_AD_LOAD_ERROR]=202,b[d.VPAID_AD_INIT_ERROR]=203,b[d.VPAID_AD_INIT_TIMEOUT]=204,b[d.VPAID_AD_START_ERROR]=301,b[d.VPAID_AD_START_TIMEOUT]=302,b[d.VPAID_AD_STOP_ERROR]=401;var _=1,A=2;o.prototype.translate=function(e){var t,r,n,i,a=this;e&&(a.vim=e.vim,t=e.adObj||{},e.errorState?a.responseType=m.ERROR:t.type&&(a.responseType=m[t.type]),r=e.errorState||t.type,a.responseCode=y[r]||"",a.firstCall=u.parseDomain(e.firstCall)||"",a.firstRedirect=u.parseDomain(e.redirectList[0])||"",a.redirectCount=e.redirectList.length,r===f.NOAD&&a.redirectCount>0&&(a.responseCode=y[d.THIRD_PARTY_NO_AD]),n=e.cacheState||"",a.cacheHit=E[n]||"",a.vastCreativeId=t.vastCreativeId,a.creativeId=t.creativeId||"",a.bookingId=t.bookingId||"",a.placementId=t.placementId||"",a.adSystem=t.adSystem||"",a.adId=t.adId||"",a.adXmlParseErr=t.adXmlParseErr||"",i=e.adSpec||{},e.type===f.MIDROLL&&(a.midrollAdBreak=e.midrollbreak,a.midrollAdPos=e.midrolladsequence,a.midrollAdBreakDur=i.duration),a.medT=i.medT,a.medS=i.medS,a.label=i.label,a.sadl=i.sadl,a.adCallSequence=i.adCallSequence,a.adNetwork=i.adNetwork||"",a.ibn=i.ibn,a.ibnc=i.ibnc,a.gdprnoad=i.gdprnoad||0,a.mtype=t.mtype,a.cjs=t.cjs,a.cswf=t.cswf,a.cmp4=t.cmp4,a.cwbm=t.cwbm,a.cflv=t.cflv,a.pbbid=i.pbbid)},c.prototype.PC=function(e){var t=this;e&&(t.NC[e]=!1,t.MC[e]=null)},c.prototype.RC=function(e,t){var r=this,n=new a;n.adPosition=t,n.taken=A,r.fD(n)},c.prototype.QC=function(e,t,r,n,i){var o,s=this,l=null!==r&&null!==n,c=new a;i||(i=0),c.adPosition=t,n&&(c.networkName=n.communicatorName),c.taken=l?_:A,e&&(o=s.gD(e,t),o.adOppEvents[i]=c)},c.prototype.SC=function(e){var t,r,n=this;e&&(t="adCall"+Math.floor(100*Math.random())+(new Date).getTime(),r=n.LC.set(t),r.start(),e.adCallIdentifier=t)},c.prototype.TC=function(e,t){var r,n,i=this;e&&t&&(r=e.adCallIdentifier||"",n=i.LC.get(r),n&&(n.end(),t.adCallIdentifier=r))},c.prototype.UC=function(e,t){var r,n,i,a,s,l,c,u,p,d=this,v=0;t&&e&&(r=t.adCallIdentifier,l=t.type,s=d.LC.get(r),u=t.communicatorSpec,p=t.adSpec,l===f.MIDROLL&&(v=t.midrolladsequence),n=new o,n.position=l,c=d.gD(e,l),c.adCallEvents[v]=n,n.latency=s?s.getLatency():0,n.startTime=s?s.getStartTime():0,n.adCallSequence=p.adCallSequence,n.networkName=u.communicatorName,n.translate(t),d.hD(e,t),d.NC[e]&&l!==f.MIDROLL&&(d.iD(e,l),c=d.gD(e,l),c&&(i=c.adOppEvents[v],n=c.adCallEvents[v],a=c.adCallFailEvents[v],d.fD(i,n),d.jD(i,a),d.kD(i,n)),c=d.lD(e,l),c&&(i=c.adOppEvents[v],d.jD(i,a),d.kD(i,n)),d.mD(e,l,v)))},c.prototype.hD=function(e,t){var r,n,i,a,o,s,l=this,c=0;if(t&&e){if(o=t.type,o!==f.PREROLL)return;if(s=l.gD(e,o),s&&(n=s.adOppEvents[c],r=s.adCallEvents[c],i=s.adCallFailEvents[c]),n){if(Array.isArray(i))for(var u=0,p=i.length;u<p;u++)a=i[u],l.nD(n,a);r&&l.nD(n,r)}}},c.prototype.VC=function(e,t){var r,n,i,a,s,l,c,u,p=this,d=0;t&&e&&(r=t.adCallIdentifier,s=t.type,a=p.LC.get(r),c=t.communicatorSpec,u=t.adSpec,s===f.MIDROLL&&(d=t.midrolladsequence),n=new o,n.position=s,l=p.gD(e,s),i=l.adCallFailEvents[d],Array.isArray(i)?i.push(n):i=[n],l.adCallFailEvents[d]=i,n.latency=a?a.getLatency():0,n.startTime=a?a.getStartTime():0,n.adCallSequence=u.adCallSequence,n.networkName=c.communicatorName,n.translate(t))},c.prototype.aD=function(e,t,r,n,i,a,o,s){var l,c=this;r=r||0,n=n||0,i=i||0,a=a||0,o=o||0,s=s||0,e&&t===f.MIDROLL&&(l={evt:"ad_mbrk",adbrk:s,n_adopp:r,n_adsub:n,n_noad:i,n_ads:a,n_vpads:o,tmout:c.playerTimeout,vptm:c.vpaidTimeout,yvap:!0},c.CB.publish(p.AD_METRIC,{ult:l}))},c.prototype.lD=function(e,t){var r,n=this;return r=n.OC[e],r?r[t]:null},c.prototype.gD=function(e,t){var r,a,o=this;return r=o.MC[e]||new n,o.MC[e]=r,a=r[t]||new i,r[t]=a,a},c.prototype.mD=function(e,t,r){var a,o,s,l,c,u,p,d=this;r=r||0,a=d.MC[e],s=a[t],s&&(l=s.adOppEvents[r],p=s.adDeliveryEvents[r],c=s.adCallEvents[r],u=s.adCallFailEvents[r],s.adOppEvents[r]=null,s.adCallEvents[r]=null,s.adDeliveryEvents[r]=null,s.adCallFailEvents[r]=null),o=d.OC[e]||new n,o[t]=o[t]||new i,l&&(o[t].adOppEvents[r]=l),c&&(o[t].adCallEvents[r]=c),p&&(o[t].adDeliveryEvents[r]=p),u&&(o[t].adCallFailEvents[r]=u),d.OC[e]=o},c.prototype.iD=function(e,t){for(var r,n,i,a,o=this,s=0;s<g.length&&g[s]!==t;s++){if(r=o.gD(e,g[s]))for(var l=0;l<r.adOppEvents.length;l++)n=r.adOppEvents[l],i=r.adCallEvents[l],a=r.adCallFailEvents[l],o.fD(n,i),o.jD(n,a),o.kD(n,i);o.mD(e,g[s])}},c.prototype.WC=function(e,t,r,n,i,a,o,l,c,u,d){var v,m,y,h,E,g,b,_=this,A=i||0,T=a||0,S=o||0,I=l||0,L=c||0,R=u||0,C=0,D=0;if(_.iD(e,t),n&&(D=n.adObj.duration||f.DEFAULT_AD_DURATION),d&&(D=d),n&&n.type===f.MIDROLL&&(C=n.midrolladsequence),e&&t){v=_.gD(e,t),h=v.adOppEvents[C],E=v.adCallEvents[C],g=v.adCallFailEvents[C];var O=n&&n.adObj;if(O&&E&&(E.mtype=O.mtype),_.fD(h,E),_.jD(h,g),_.kD(h,E),m=_.lD(e,t),m&&(h=h||m.adOppEvents[C],E=E||m.adCallEvents[C]),y=new s,y.mediaStartLatency=r,y.vsl=A,y.vil=T,y.vst=A,y.sVsl=I,y.sVil=L,y.sVst=R,D=Math.round(D),y.duration=D,O&&(O.serveId&&(y.serveId=O.serveId),
E&&!E.mtype&&(E.mtype=O.mtype)),v.adDeliveryEvents[C]=y,h&&E&&(b={evt:"ad_dlv",ntwk:E.networkName+E.adNetwork,medT:E.medT,medS:E.medS,adlbl:E.label,sadl:E.sadl,ibn:E.ibn,ibnc:E.ibnc,pos:h.adPosition,f_hop:E.firstRedirect,n_hop:E.redirectCount,r_code:E.responseCode,gdprnoad:E.gdprnoad,r_type:E.responseType,crid:E.creativeId,bkid:E.bookingId,plcid:E.placementId,cchit:E.cacheHit,ms_lat:y.mediaStartLatency,adseq:E.adCallSequence,ad_lng:D,mrtime:E.midrollAdBreak,mrpos:E.midrollAdPos,mrdur:E.midrollAdBreakDur,tmout:_.playerTimeout,vptm:_.vpaidTimeout,vsl:A,vil:T,vst:S,s_vsl:I,s_vil:L,s_vst:R,serv_id:y.serveId,adid:E.adId,ad_xml_err:E.adXmlParseErr,v_cr_id:E.vastCreativeId,ad_sys:E.adSystem,f_call:E.firstCall,yvap:!0,mtype:E.mtype,cjs:E.cjs,cswf:E.cswf,cmp4:E.cmp4,cwbm:E.cwbm,cflv:E.cflv,pbbid:E.pbbid,vim:E.vim},_.CB.publish(p.AD_METRIC,{ult:b}),window.showLatencies)){var N={vsl:A,vil:T,vst:S,aml:y.mediaStartLatency};window.showLatencies(N,!0)}_.mD(e,t,C)}},c.prototype.XC=function(e,t,r,n,i,a,o){var l,c,u,v,m,y,h,E=this,g=0;if(r!==f.NOAD&&(E.iD(e,t),n&&n.type===f.MIDROLL&&(g=n.midrolladsequence),e&&t)){y=E.gD(e,t),l=y.adOppEvents[g],c=y.adCallEvents[g],u=y.adCallFailEvents[g];var _=n&&n.adObj;_&&c&&(c.mtype=_.mtype),E.fD(l,c),E.jD(l,u),E.kD(l,c),h=E.lD(e,t),h&&(l=l||h.adOppEvents[g],c=c||h.adCallEvents[g]),v=new s,v.error=r||d.GENERIC,_&&c&&!c.mtype&&(c.mtype=_.mtype),y.adDeliveryEvent=v,l&&c&&(m={evt:"ad_err",ntwk:c.networkName+c.adNetwork,medT:c.medT,medS:c.medS,adlbl:c.label,sadl:c.sadl,ibn:c.ibn,ibnc:c.ibnc,pos:l.adPosition,f_hop:c.firstRedirect,n_hop:c.redirectCount,r_code:c.responseCode,gdprnoad:c.gdprnoad,r_type:c.responseType,crid:c.creativeId,bkid:c.bookingId,plcid:c.placementId,a_dlv_err:b[v.error],adseq:c.adCallSequence,mrtime:c.midrollAdBreak,mrpos:c.midrollAdPos,mrdur:c.midrollAdBreakDur,tmout:E.playerTimeout,vptm:E.vpaidTimeout,vsl:i,vil:a,vpaidS:o,adid:c.adId,serv_id:v.serveId,ad_xml_err:c.adXmlParseErr,v_cr_id:c.vastCreativeId,ad_sys:c.adSystem,f_call:c.firstCall,yvap:!0,mtype:c.mtype,cjs:c.cjs,cswf:c.cswf,cmp4:c.cmp4,cwbm:c.cwbm,cflv:c.cflv,pbbid:c.pbbid,vim:c.vim},E.CB.publish(p.AD_METRIC,{ult:m})),E.mD(e,t,g)}},c.prototype.YC=function(e,t,r,n){var i,a,o,s,l,c,u,d,v=this,m=0;v.iD(e,t),r&&r.type===f.MIDROLL&&(m=r.midrolladsequence),e&&t&&(i=v.gD(e,t),s=i.adOppEvents[m],l=i.adCallEvents[m],c=i.adCallFailEvents[m],o=i.adDeliveryEvents[m],v.fD(s,l),v.jD(s,c),v.kD(s,l),a=v.lD(e,t),a&&(s=s||a.adOppEvents[m],l=l||a.adCallEvents[m],o=o||a.adDeliveryEvents[m]),s&&l&&o&&(d=2===n?2:Math.round(o.duration*n/100),u={evt:"ad_prog",ntwk:l.networkName+l.adNetwork,medT:l.medT,medS:l.medS,adlbl:l.label,sadl:l.sadl,ibn:l.ibn,ibnc:l.ibnc,pos:s.adPosition,f_hop:l.firstRedirect,n_hop:l.redirectCount,r_code:l.responseCode,gdprnoad:l.gdprnoad,r_type:l.responseType,crid:l.creativeId,bkid:l.bookingId,plcid:l.placementId,cchit:l.cacheHit,ms_lat:o.mediaStartLatency,adseq:l.adCallSequence,ad_lng:o.duration,q:n,dur:d,mrtime:l.midrollAdBreak,mrpos:l.midrollAdPos,mrdur:l.midrollAdBreakDur,tmout:v.playerTimeout,vptm:v.vpaidTimeout,vsl:o.vsl,vil:o.vil,vst:o.vst,s_vsl:o.sVsl,s_vil:o.sVil,s_vst:o.sVst,serv_id:o.serveId,adid:l.adId,ad_xml_err:l.adXmlParseErr,v_cr_id:l.vastCreativeId,ad_sys:l.adSystem,f_call:l.firstCall,yvap:!0,mtype:l.mtype,cjs:l.cjs,cswf:l.cswf,cmp4:l.cmp4,cwbm:l.cwbm,cflv:l.cflv,pbbid:l.pbbid,vim:l.vim},100===n&&(u.evt="ad_comp"),2===n&&(u.evt="ad_view",delete u.q),v.CB.publish(p.AD_METRIC,{ult:u})),v.mD(e,t,m))},c.prototype.bD=function(e,t,r){var n,i,a,o,s=this,l=0;r&&r.type===f.MIDROLL&&(l=r.midrolladsequence),e&&t&&(n=s.gD(e,t),i=n.adOppEvents[l],a=n.adCallEvents[l],o=n.adCallFailEvents[l],s.fD(i,a),s.jD(i,o),s.kD(i,a),s.mD(e,t,l))},c.prototype.cD=function(e,t,r){var n,i,a,o,s,c,u=this,d=0,v=0;r&&(v=r.adObj.duration||0),r&&r.type===f.MIDROLL&&(d=r.midrolladsequence),e&&t&&(a=new l,r&&r.adObj&&r.adObj.serveId&&(a.serveId=r.adObj.serveId),n=u.gD(e,t),i=u.lD(e,t),n.adStartEvents=a,o=n.adOppEvents[d],s=n.adCallEvents[d],i&&(o=o||i.adOppEvents[d],s=s||i.adCallEvents[d]),o&&s&&(c={evt:"ad_beg",ntwk:s.networkName+s.adNetwork,medT:s.medT,medS:s.medS,adlbl:s.label,sadl:s.sadl,ibn:s.ibn,ibnc:s.ibnc,pos:o.adPosition,f_hop:s.firstRedirect,n_hop:s.redirectCount,r_code:s.responseCode,r_type:s.responseType,crid:s.creativeId,bkid:s.bookingId,plcid:s.placementId,cchit:s.cacheHit,adseq:s.adCallSequence,mrtime:s.midrollAdBreak,mrpos:s.midrollAdPos,mrdur:s.midrollAdBreakDur,duration:v,tmout:u.playerTimeout,vptm:u.vpaidTimeout,serv_id:a.serveId,adid:s.adId,ad_xml_err:s.adXmlParseErr,v_cr_id:s.vastCreativeId,ad_sys:s.adSystem,f_call:s.firstCall,yvap:!0,mtype:s.mtype,cjs:s.cjs,cswf:s.cswf,cmp4:s.cmp4,cwbm:s.cwbm,cflv:s.cflv,pbbid:s.pbbid,vim:s.vim},u.CB.publish(p.AD_METRIC,{ult:c})),u.mD(e,t,d))},c.prototype.dD=function(e,t,r){var n=this;n.oD(e,t,r,h)},c.prototype.ZC=function(e){var t=this;t.NC[e]=!0,t.iD(e,f.CLIP_START)},c.prototype._C=function(e){var t=this;t.NC[e]=!0,t.iD(e,f.POSTROLL)},c.prototype.$C=function(e){var t=this;t.iD(e,f.CLIP_END)},c.prototype.fD=function(e,t){t=t||{};var r,n=this,i=t.adNetwork||"";e&&(r={evt:"ad_oppty",pos:e.adPosition,ntwk:e.networkName+i,medT:t.medT,medS:t.medS,adlbl:t.label,sadl:t.sadl,ibn:t.ibn,ibnc:t.ibnc,adseq:t.adCallSequence,tmout:n.playerTimeout,vptm:n.vpaidTimeout,taken:e.taken,ad_sys:t.adSystem,yvap:!0,mtype:t.mtype,cjs:t.cjs,cswf:t.cswf,cmp4:t.cmp4,cwbm:t.cwbm,cflv:t.cflv,f_hop:t.firstRedirect,r_code:t.responseCode,gdprnoad:t.gdprnoad,r_type:t.responseType,crid:t.creativeId,bkid:t.bookingId,plcid:t.placementId,adid:t.adId,v_cr_id:t.vastCreativeId,f_call:t.firstCall,mrtime:t.midrollAdBreak,mrpos:t.midrollAdPos,mrdur:t.midrollAdBreakDur,pbbid:t.pbbid,vim:t.vim},n.CB.publish(p.AD_METRIC,{ult:r}))},c.prototype.oD=function(e,t,r,n){var i,a,o,s,c,u,d=this,v=0,m=0;r&&(m=r.adObj.duration||0),r&&r.type===f.MIDROLL&&(v=r.midrolladsequence),e&&t&&(o=new l,r&&r.adObj&&r.adObj.serveId&&(o.serveId=r.adObj.serveId),i=d.gD(e,t),a=d.lD(e,t),i.adStartEvents=o,s=i.adOppEvents[v],c=i.adCallEvents[v],a&&(s=s||a.adOppEvents[v],c=c||a.adCallEvents[v]),s&&c&&(u={evt:"ad_init",init_code:n,ntwk:c.networkName+c.adNetwork,medT:c.medT,medS:c.medS,adlbl:c.label,sadl:c.sadl,ibn:c.ibn,ibnc:c.ibnc,pos:s.adPosition,f_hop:c.firstRedirect,n_hop:c.redirectCount,r_code:c.responseCode,gdprnoad:c.gdprnoad,r_type:c.responseType,crid:c.creativeId,bkid:c.bookingId,plcid:c.placementId,cchit:c.cacheHit,adseq:c.adCallSequence,mrtime:c.midrollAdBreak,mrpos:c.midrollAdPos,mrdur:c.midrollAdBreakDur,duration:m,tmout:d.playerTimeout,vptm:d.vpaidTimeout,serv_id:o.serveId,adid:c.adId,ad_xml_err:c.adXmlParseErr,v_cr_id:c.vastCreativeId,ad_sys:c.adSystem,f_call:c.firstCall,yvap:!0,mtype:c.mtype,cjs:c.cjs,cswf:c.cswf,cmp4:c.cmp4,cwbm:c.cwbm,cflv:c.cflv,pbbid:c.pbbid,vim:c.vim},d.CB.publish(p.AD_METRIC,{ult:u})),d.mD(e,t,v))},c.prototype.kD=function(e,t){var r,n=this;if(e&&t&&(r={evt:"ad_call",ntwk:t.networkName+t.adNetwork,medT:t.medT,medS:t.medS,adlbl:t.label,sadl:t.sadl,ibn:t.ibn,ibnc:t.ibnc,pos:e.adPosition,mrtime:t.midrollAdBreak,mrpos:t.midrollAdPos,mrdur:t.midrollAdBreakDur,f_hop:t.firstRedirect,n_hop:t.redirectCount,r_code:t.responseCode,gdprnoad:t.gdprnoad,r_type:t.responseType,adl:t.latency,s_adl:t.startTime,crid:t.creativeId,bkid:t.bookingId,plcid:t.placementId,cchit:t.cacheHit,adseq:t.adCallSequence,tmout:n.playerTimeout,vptm:n.vpaidTimeout,adblock:f.ADBLOCKER,ad_sys:t.adSystem,adid:t.adId,ad_xml_err:t.adXmlParseErr,v_cr_id:t.vastCreativeId,f_call:t.firstCall,yvap:!0,mtype:t.mtype,cjs:t.cjs,cswf:t.cswf,cmp4:t.cmp4,cwbm:t.cwbm,cflv:t.cflv,pbbid:t.pbbid,vim:t.vim},n.CB.publish(p.AD_METRIC,{ult:r}),window.showLatencies)){var i={adl:t.latency};window.showLatencies(i)}},c.prototype.jD=function(e,t){var r,n,i=this;if(e&&Array.isArray(t))for(var a=0,o=t.length;a<o;a++)if(n=t[a],r={evt:"ad_callf",ntwk:n.networkName+n.adNetwork,medT:n.medT,medS:n.medS,adlbl:n.label,sadl:n.sadl,ibn:n.ibn,ibnc:n.ibnc,pos:e.adPosition,f_hop:n.firstRedirect,n_hop:n.redirectCount,r_code:n.responseCode,gdprnoad:n.gdprnoad,r_type:n.responseType,adl:n.latency,s_adl:n.startTime,crid:n.creativeId,bkid:n.bookingId,plcid:n.placementId,cchit:n.cacheHit,adseq:n.adCallSequence,tmout:i.playerTimeout,vptm:i.vpaidTimeout,adblock:f.ADBLOCKER,ad_sys:n.adSystem,adid:n.adId,ad_xml_err:n.adXmlParseErr,v_cr_id:n.vastCreativeId,f_call:n.firstCall,yvap:!0,mtype:n.mtype,cjs:n.cjs,cswf:n.cswf,cmp4:n.cmp4,cwbm:n.cwbm,cflv:n.cflv,mrtime:n.midrollAdBreak,mrpos:n.midrollAdPos,mrdur:n.midrollAdBreakDur,pbbid:n.pbbid,vim:n.vim},i.CB.publish(p.AD_METRIC,{ult:r}),window.showLatencies){var s={adl:n.latency};window.showLatencies(s)}},c.prototype.nD=function(e,t){var r,n=this;if(e&&t&&(r={evt:"ad_req",ntwk:t.networkName+t.adNetwork,medT:t.medT,medS:t.medS,adlbl:t.label,sadl:t.sadl,ibn:t.ibn,ibnc:t.ibnc,pos:e.adPosition,mrtime:t.midrollAdBreak,mrpos:t.midrollAdPos,mrdur:t.midrollAdBreakDur,f_hop:t.firstRedirect,n_hop:t.redirectCount,r_code:t.responseCode,gdprnoad:t.gdprnoad,r_type:t.responseType,adl:t.latency,s_adl:t.startTime,crid:t.creativeId,bkid:t.bookingId,plcid:t.placementId,cchit:t.cacheHit,adseq:t.adCallSequence,tmout:n.playerTimeout,vptm:n.vpaidTimeout,adblock:f.ADBLOCKER,ad_sys:t.adSystem,adid:t.adId,ad_xml_err:t.adXmlParseErr,v_cr_id:t.vastCreativeId,f_call:t.firstCall,yvap:!0,mtype:t.mtype,cjs:t.cjs,cswf:t.cswf,cmp4:t.cmp4,cwbm:t.cwbm,cflv:t.cflv,pbbid:t.pbbid,vim:t.vim},n.CB.publish(p.AD_METRIC,{ult:r}),window.showLatencies)){var i={adl:t.latency};window.showLatencies(i)}},c.prototype.getArchive=function(){var e=this;return e.OC}},{"../../util":"/nextgen/src/util.js","../common/Constants":99,"../common/Errors":101,"../common/Events":102,"../model/analytic-profile-model":125}],128:[function(e,t,r){"use strict";function n(){var e=this;e.diagnostic=null,e.pD={}}function i(e,t,r){var n=this,i=r.adObj||{};n.tD=i,n.clipId=e,n.playbackId=t,n.position=r.type,n.firstCall=r.firstCall,n.redirectList=[].concat(r.redirectList),n.errorState=r.errorState,n.vastCreativeId=i.vastCreativeId,n.creativeId=i.creativeId,n.bookingId=i.bookingId,n.type=i.type,n.adId=i.adId,n.duration=i.duration,n.AdParameters=i.adParameters&&i.adParameters.AdParameters,n.streams=i.streams,n.adstate=l.UNPLAYED,n.adstateData={},n.updateState=function(e,t){n.adstate!==l.UNPLAYED&&n.adstate!==l.PLAYING||(n.adstate=e,n.adstateData[e]=t)}}var a=e("../../views/ads-diagnostics.html"),o=e("../../util"),s=e("../common/Constants"),l={UNPLAYED:"unplayed",PLAYING:"playing",ENDED:"ended",ERROR:"error",CANCELLED:"cancelled"};t.exports=n,t.exports.ADSTATES=l,n.prototype.generateDiagnostics=function(e){var t=this,r=[];for(var n in e)if(e.hasOwnProperty(n)){var i={};i.clipId=n;var l=e[n];i.data=[];var c={};c.position=s.PREROLL,c.data=t.qD(l.preroll),i.data.push(c);var u={};u.position=s.BUMPER,u.data=t.qD(l.bumper),i.data.push(u);var p={};p.position=s.MIDROLL,p.data=t.qD(l.midroll),i.data.push(p);var d={};d.position=s.POSTROLL,d.data=t.qD(l.postroll),i.data.push(d),r.push(i)}var f;return r&&(f=o.render(a,{clipStats:r})),f},n.prototype.qD=function(e){var t=[];if(e)for(var r=e.adOppEvents,n=e.adCallEvents,i=e.adDeliveryEvents,a=0;a<r.length;a++){var o={},s=r[a];s&&(o.taken=1===s.taken,o.communicator=s.networkName);var l=n[a];l&&(o.responseCode=l.responseCode,o.responseType=l.responseType,o.firstRedirect=l.firstRedirect,o.redirectCount=l.redirectCount);var c=i[a];c&&(o.error=c.error,o.mediaStartLatency=c.mediaStartLatency),t.push(o)}return t},n.prototype.registerAdStateChangeListener=function(e){var t=this;t.rD=e},n.prototype.registerAdDataAvailableListener=function(e){var t=this;t.sD=e},n.prototype.updateAdState=function(e,t,r){var n=this,i=n.getAdDiagnosticsById(e);i&&(i.updateState(t,r),n.rD&&n.rD(e,i.adstate,i.adstateData))},n.prototype.getAllAdDiagnostics=function(){var e=this;return e.pD},n.prototype.getAdDiagnosticsById=function(e){var t=this;for(var r in t.pD)if(t.pD.hasOwnProperty(r)){var n=t.pD[r][e];if(n)return n}return null},n.prototype.addAdData=function(e,t,r){var n=this;n.pD[e]||(n.pD[e]={});var a=new i(e,t,r);n.pD[e][t]=a,n.sD&&n.sD(a)}},{"../../util":"/nextgen/src/util.js","../../views/ads-diagnostics.html":49,"../common/Constants":99}],129:[function(e,t,r){"use strict";function n(e){var t,r=this,i="",o=-1;if(r&&r instanceof n&&e&&!a.hasOwn(r,"_rendererDiv")){try{o=e.getAttribute&&e.setAttribute&&(e.parentElement||e.parentNode)?1:0}catch(e){o=-2}if(1===o)try{o=e.ownerDocument||e.document?1:-3}catch(e){o=-4}1===o?(t=r.getFrameElement(),t&&(e=t),i=e.getAttribute("id")||"",i=i?i:e.id,r.uD=e,i||(i="yvapview_"+c,e.id=i,e.setAttribute("id",i),c+=u),r.vD=i,r.wD=1):(r.uD=null,r.vD="",r.wD=o)}}function i(e,t,r){var i=this;n.call(i,t),i.Lm(),i.k=e,i.BD=r,i.k.subscribe(l.AD_PLAYBACK_ENDED,i.CD,i),i.k.subscribe(l.Ad.PAUSE,i.Wl,i),i.k.subscribe(l.AD_PLAYBACK_RESUMED,i.DD,i),i.k.subscribe(l.FULLSCREEN_CHANGE,i.FD,i),i.k.subscribe(l.API.PLAYER_DOCKED_CHANGE,i.GD,i),i.k.subscribe(l.API.PLAYER_MUTE_CHANGE,i.HD,i)}var a=(e("../../util"),e("../../../../lib/logger"),e("../yvap-util")),o=e("../common/Constants"),s=e("./ViewabilityTracker"),l=e("../../event"),c=(new Date).getTime()-Math.round(1e4*Math.random()),u=Math.round(100*Math.random());t.exports=i,n.getViewability=function(e,t){var r=new n(e);return r.getViewability(t)},n.prototype.getWindow=function(){return window},n.prototype.getFrameElement=function(){var e=this,t=e&&e.getWindow(),r=!a.isInTopWindow(t),n=null;if(r)try{n=t.frameElement||null}catch(e){n=null}return n},n.prototype.xD=function(){var e=this,t=e&&e.getWindow()||null,r=null;if(a.isInSafeFrame(t))try{r=t.$sf.ext.geom()||null}catch(e){r=null}return r},n.prototype.yD=function(){var e,t=this,r=t&&t.getWindow()||null,n=a.getDARLA(r)||null,i=n&&n.darla||null,o=t&&t.vD||"";if(i&&o)try{e=i.yvap.view(o),e&&"object"==typeof e&&("self"in e&&"rect"in e||"iv"in e||(e=null))}catch(t){e=null}return e},n.prototype.zD=function(){var e=this,t=e&&e.getWindow()||null,r=a.getDARLA(t)||null,n=r&&r.darla||null;if(n&&n.metrics&&n.metrics.getIvtSignals)try{return n.metrics.getIvtSignals()}catch(e){}return""},n.prototype.getSize=function(e){var t,r,n=this,i=n&&n.uD||null,o=n&&n.getWindow()||null,s=(n&&n.vD||"",""),l=0,c=0;if(o)if(a.isInTopWindow(o))if(t=n.yD(),t&&(r=t.rect||t.self||t),r)l=r.w,c=r.h;else try{l=i.clientWidth,c=i.clientHeight}catch(e){l=c=0}else if(t=n.xD(),t&&(r=t.rect||t.self||t),r)l=r.w,c=r.h;else try{l=i.clientWidth,c=i.clientHeight}catch(e){l=c=0}return l=parseInt(l,10),c=parseInt(c,10),(isNaN(l)||l<0)&&(l=c=0),(isNaN(c)||c<0)&&(l=c=0),s=l+"x"+c,e=e||{},e.w=l,e.h=c,t&&(e.v=t),s},n.prototype.getViewability=function(e){var t,r,n,i=this,o=i&&i.getWindow(),s=0;return i.Tq?s=1:(t=a.isInTopWindow(o)?i.yD():i.xD(),t&&(n=t.rect,r=t.self),r&&"iv"in r?s=r.iv:n&&"iv"in n?s=n.iv:t&&"iv"in t&&(s=t.iv),s=parseFloat(s),(isNaN(s)||s<0)&&(s=0)),e&&t&&a.mix(e,t,!0,!0),s},i.prototype=new n,i.prototype.Lm=function(){var e=this;clearInterval(e.ID),e.ID=null,e.JD=null,e.KD=null,e.Tq=!1,e.Vq=!1,e.LD=!0,e.MD=0,e.ND=0,e.OD=0,e.PD=0,e.QD=0,e.RD=[],e.SD=o.UNKNOWN,e.TD=[],e.UD=0},i.prototype.VD=function(){var e,t,r,n=this,i=n&&n.getWindow(),o=(n&&n.vD,0);n.Tq||n.Vq?o=1:(e=a.isInTopWindow(i)?n.yD():n.xD(),e&&(r=e.rect,t=e.self),t&&"iv"in t?o=t.iv:r&&"iv"in r?o=r.iv:e&&"iv"in e&&(o=e.iv),o=parseFloat(o),(isNaN(o)||o<0)&&(o=0)),n.TD.forEach(function(e){e.viewabilityUpdated(o)}),n.WD(o)},i.prototype.WD=function(e){var t=this;t.PD=t.LD?0:t.PD+o.INTERNAL_POLLING_INTERVAL,e>=o.VIEWABILITY_THRESHOLD&&!t.LD?(t.ND=t.ND+o.INTERNAL_POLLING_INTERVAL,t.OD=t.OD+o.INTERNAL_POLLING_INTERVAL):t.ND=0,t.LD?(t.LD=!1,t.MD=e>=o.VIEWABILITY_THRESHOLD?1:0):1!==e||t.BD||(t.UD+=o.INTERNAL_POLLING_INTERVAL),t.RD.push(e),t.TD.forEach(function(r){r.maybeSendBeacon(e,t.BD)})},i.prototype.FD=function(){var e=this,t=e.Tq;e.Tq=!t},i.prototype.GD=function(e){var t=this;t.Vq=e||!1},i.prototype.Wl=function(){var e=this;clearInterval(e.ID)},i.prototype.DD=function(e){var t=this;1===t.QD&&(t.ID=setInterval(function(){t.VD()},o.INTERNAL_POLLING_INTERVAL))},i.prototype.HD=function(e){var t=this;t.BD=e,t.TD.forEach(function(t){t.muteTriggered(e)})},i.prototype.CD=function(e){var t=this;clearInterval(t.ID),t.QD=0,t.TD.forEach(function(e){e.stopTriggered()})},i.prototype.XD=function(){var e=this;return e.KD&&e.KD.viewability},i.prototype.start=function(e,t){var r=this;r.Lm(),r.uD&&e&&(r.JD=e.adObj,r.KD=e.adSpec,r.XD()&&(a.isViewabilityMeasurable()?(r.SD=o.VIEWABILITY_MEASURABLE,r.TD=r.YD(r.JD),r.TD&&r.TD.length>0&&(r.QD=1,r.VD(),r.ID=setInterval(function(){r.VD()},o.INTERNAL_POLLING_INTERVAL))):r.SD=a.getViewabilityNonMeasurableValue()))},i.prototype.YD=function(e){var t=this,r=[],n=e&&e.rules||{},i=e&&e.beacons||{},a=n.viewabilityDefVideo,o=i.impression;a&&o&&r.push(new s(a,o,t,t.BD));var l=n.viewabilityDefVideo3P,c=i.impression3p;l&&c&&l.forEach(function(e){r.push(new s(e,c,t,t.BD))});var u=n.viewabilityDefStatic,p=i.geminiimpression;return u&&p&&r.push(new s(u,p,t,t.BD)),r},i.prototype.getViewabilitySummary=function(){var e=this;if(!e.XD())return{vi_m:o.VIEWABILITY_NOT_MEASURABLE,vi_lpv:o.VIEWABILITY_NOT_MEASURABLE,vi_psnd:o.UNKNOWN};var t={data:e.RD,max:function(){return this.data.length?Math.max.apply(Math,this.data):0},min:function(){return this.data.length?Math.min.apply(Math,this.data):0},avg:function(){for(var e=this.data,t=e.length,r=0,n=0,i=0;i<t;i++)r+=e[i];return n=r/t||0},latest:function(){var e=this.data.length,t=0;if(e){var r=e-1;t=this.data[r]||0}return t}},r={},n=(e.getSize(r),{vi_tpd:e.PD,vi_tvd:e.OD,vi_mpv:(100*t.min()).toFixed(0),vi_mxpv:(100*t.max()).toFixed(0),vi_apv:(100*t.avg()).toFixed(0),vi_lpv:t.latest(),vi_tativ:e.UD,vi_pw:r.w,vi_ph:r.h,vi_psnd:e.BD?o.PLAYER_SOUND_OFF:o.PLAYER_SOUND_ON,vi_pfs:e.Tq?o.PLAYER_FULLSCREEN_ON:o.PLAYER_FULLSCREEN_OFF,vi_ploc:o.UNKNOWN,vi_pib:o.UNKNOWN,vi_pap:o.UNKNOWN,vi_m:e.SD,ivt:""});return n}},{"../../../../lib/logger":"/lib/logger.js","../../event":"/nextgen/src/event.js","../../util":"/nextgen/src/util.js","../common/Constants":99,"../yvap-util":138,"./ViewabilityTracker":130}],130:[function(e,t,r){"use strict";function n(e,t,r,n){var a=this;a.ZD=e||{},a.$D=t.slice()||[],a._D=r,a.aE=!1,a.bE=a.ZD[i.VIEWABILITY_RULE_TYPE],a.cE=1===a.ZD[i.VIEWABILITY_RULE_CONSECUTIVE_PLAYBACK],a.dE=1===a.ZD[i.VIEWABILITY_RULE_AUDIO],a.eE=(a.ZD[i.VIEWABILITY_RULE_MIN_PIXELS]||0)/100,a.fE=1e3*(a.ZD[i.VIEWABILITY_RULE_MIN_DURATION]||0),a.gE=null,a.hE=n,a.iE=0}var i=e("../common/Constants"),a=e("../../util"),o=e("../yvap-util");t.exports=n,n.prototype.stopTriggered=function(){var e=this;e.cE&&(e.iE=0)},n.prototype.muteTriggered=function(e){var t=this;t.dE&&t.cE&&e&&(t.iE=0)},n.prototype.viewabilityUpdated=function(e){var t=this;t.cE&&e<t.eE&&(t.iE=0)},n.prototype.maybeSendBeacon=function(e,t){var r=this;return!!r.aE||(null===r.gE?r.gE=e:r.gE>=r.eE&&e>=r.eE&&(r.dE&&(r.hE||t)||(r.iE+=i.INTERNAL_POLLING_INTERVAL)),r.gE=e,r.hE=t,r.iE>=r.fE&&(r.ck(),!0))},n.prototype.ck=function(){var e=this,t=[];if(e.aE)return t;var r=e._D.getViewabilitySummary();r.vr_type=e.bE;for(var n=0;n<e.$D.length;n++){var i=o.expandViewabilityMacros(e.$D[n],r);a.sendImageBeacon(i),t.push(i)}return e.aE=!0,t}},{"../../util":"/nextgen/src/util.js","../common/Constants":99,"../yvap-util":138}],131:[function(e,t,r){!function(){function e(){var e=this;e.jE=-1,e.fh=0}e.prototype.start=function(){var e=this;e.fh=(new Date).getTime()},e.prototype.end=function(){var e=this;e.fh&&(e.jE=(new Date).getTime()-e.fh)},e.prototype.getLatency=function(){var e=this;return e.jE},e.prototype.getStartTime=function(){var e=this;return e.fh},t.exports=e}()},{}],132:[function(e,t,r){"use strict";function n(e,t,r,n,i){var a=this;t&&(a.playbackId=e||"",a.resourceType=t.resourceType||"",a.resourceUrl=t.resourceUrl||"",a.scalable=t.scalable||"",a.duration=n||0,a.position=r||"",i&&(a.adParams=i.AdParameters))}t.exports=n},{}],133:[function(e,t,r){"use strict";function n(e){var t=this;t.kE={},e&&(t.clipId=e.clipId,t.clipDuration=e.clipDuration,t.licenseId=e.licenseId,t.spaceId=e.spaceId,t.playlistId=e.playlistId,e.vrm?t.lE(e.vrm):e.yvap&&t.mE(e.yvap),t.isLive=e.isLive||!1,t.hasLiveMidrolls=e.hasLiveMidrolls||!1,t.hasLiveMidrolls&&(t.liveMidrollsMaxDur=e.liveMidrollsMaxDur),t.isLive&&0===t.clipDuration&&(t.clipDuration=450))}t.exports=n;var i=e("./common/Constants"),a=e("./communicator/ParserManager");n.prototype.lE=function(e){var t=this;if(e){var r=e.status&&e.status.code;if("OK"===r){var n=a.parseVRMResponse(e);n&&(t.vmapData=n)}t[i.YVAP_INFO_AD_BREAKS]=e[i.YVAP_INFO_AD_BREAKS]||""}},n.prototype.mE=function(e){var t=this;if(e){var r=e.adRules&&e.adRules.adResponse;if(r){var n=a.parseAdXml(r);n&&(t.vmapData=n)}t[i.YVAP_INFO_AD_BREAKS]=e[i.YVAP_INFO_AD_BREAKS]||""}},n.prototype.clean=function(){var e=this;e.vmapData=null,e[i.YVAP_INFO_AD_BREAKS]=null}},{"./common/Constants":99,"./communicator/ParserManager":109}],134:[function(e,t,r){"use strict";function n(e,t){var r=this;r.CB=e,t&&t.getElementsByTagName&&(r.Kn=t),r.nE=document.createElement("div"),r.nE.style.display="inline-block",r.nE.style.textAlign="auto",r.nE.style.position="absolute",r.oE=null,r.pE=null;r.svgElem=document.createElement("div"),r.svgElem.style.display="block",r.svgElem.style.position="absolute",r.svgElem.style.top="0",r.svgElem.style.right="0",r.svgElem.style.backgroundColor="white",r.svgElem.style.pointerEvents="auto",r.svgElem.style.width="10px",r.svgElem.style.height="10px",r.svgElem.innerHTML='<svg width="10" height="10" xmlns="http://www.w3.org/2000/svg" style="position: absolute; top:0px; right:0px;">        <g>        <title>Layer 1</title>        <polygon fill="#000000" points="10,1.502 8.498,0 5,3.499 1.502,0.001 0,1.503 3.498,5 0,8.498 1.502,10 5,6.502 8.498,10 10,8.498    6.502,5 " id="svg_1"/>        </g>        </svg>',r.svgElem.addEventListener("click",function(e){r.removeOverlay()})}var i=e("../common/Events");e("../../../../lib/logger");t.exports=n,n.prototype.renderOverlay=function(e){var t,r,n,a,o,s,l,c=this,u=document.createElement("div");if(c.Kn&&!c.oE&&e&&(l=e.playbackId||"",r=e.resourceType||"",t=e.resourceUrl||"",a=e.scalable||!1,o=e.duration||0,s=e.position,"image/jpeg"===r&&t&&(n=document.createElement("img"),n.src=t),n&&c.Kn)){c.nE.style[s]="0px",u.appendChild(n),u.appendChild(c.svgElem),c.oE=u;var p=c.nE.style;p.position="absolute",p.display="block",c.nE.style[s]="0px",p.height="50px",p.width="100%",p.zIndex=100,p.pointerEvents="none",p.background="transparent",p.textAlign="center",u.style.position="relative",u.style.display="inline-block",u.style.textAlign="auto",u.style.background="transparent",u.style.textAlign="center",u.style.height="50px",c.Kn.appendChild(c.nE),c.nE.appendChild(u),c.Kn.style.display="block",c.pE=setTimeout(function(){c.removeOverlay()},1e3*o),n.style.pointerEvents="auto",n.style.opacity="0.5",n.addEventListener("click",function(e){c.CB&&c.CB.publish(i.OVERLAY_CLICK,l)}),n.addEventListener("mouseover",function(e){e.target.style.opacity="1.0"}),n.addEventListener("mouseout",function(e){e.target.style.opacity="0.85"}),c.CB&&c.CB.publish(i.OVERLAY_RENDERED,l)}},n.prototype.removeOverlay=function(){var e=this;e.Kn&&e.oE&&e.nE&&(e.nE.removeChild(e.oE),e.Kn.removeChild(e.nE),e.Kn.style.display="none",e.oE=null),clearTimeout(e.pE)}},{"../../../../lib/logger":"/lib/logger.js","../common/Events":102}],135:[function(e,t,r){"use strict";function n(e,t,r,n,i){var a=this,o=e.yvap.timeout,d=e.yvap.standaloneAd,f=e.yvap.vpaidTimeout;a._b=e,a.k=t,a.CB=new l("yvap"),a.uD=r||{},a.bh=n||{},a.qE=!(!e.yvap.standaloneAd||!e.yvap.standaloneAd.xml),a.SB=new h(a.CB),a.rE=new _(a.CB,"fireball",o,f),a.IB=new y,a.sE=g,a.As=new b;a.uD.clientWidth,a.uD.clientHeight;a.tE=new E(a.k,a.CB,e),a.uE=new T(a.CB,i),a.vE=new k(a.CB,a.SB),a.wE=new M(a.CB,a.SB),(!c.ie||c.ie>=10)&&L.detectAdBlocker(function(e){p.ADBLOCKER=e}),a.SD=L.getViewabilityNonMeasurableValue(),a.xE="",a.playbackMap={},a.waitlistMap={},a.yE=0,a.Xc=0,a.zE=0,a.AE=!1,a.BE=1,"number"==typeof e.yvap.volume&&(a.BE=e.yvap.volume),a.CE=e.yvap.mute||!1,a.Ae(a.BE),a.Be(a.CE),a._D=new A(a.k,a.uD,a.CE),a.DE=!1,a.CB.subscribe(u.CACHE_UPDATE,a.EE,a),a.CB.subscribe(u.MIDROLL_CACHE_UPDATE,a.FE,a),a.CB.subscribe(u.MIDROLL_PLAY_CUE,a.playMidRolls,a),a.CB.subscribe(u.STANDALONE_AD_UPDATE,a.GE,a),a.CB.subscribe(u.AD_METRIC,a.HE,a),t.subscribe(s.PLAYBACK_PROGRESS,a.IE,a),t.subscribe(s.PLAYBACK_STARTED,a.ZC,a),t.subscribe(s.PLAYBACK_ENDED,a.$C,a),t.subscribe(s.AD_PLAYBACK_STARTED,a.Sf,a),t.subscribe(s.AD_PLAYBACK_PROGRESS,a.YC,a),t.subscribe(s.AD_PLAYBACK_ENDED,a.JE,a),t.subscribe(s.AD_CLICK,a.ub,a),t.subscribe(s.Ad.BREAK_CANCELLED,a.Ti,a),t.subscribe(s.Ad.NO_PLAYABLE_STREAM,a.KE,a),t.subscribe(s.Ad.NO_AD,a.LE,a),t.subscribe(s.AD_PLAYBACK_ERROR,a.ME,a),t.subscribe(s.API.PLAYBACK_SEEK_COMPLETE,a.NE,a),t.subscribe(s.PLAYER_RESIZE,a.OE,a),t.subscribe(s.CONTROLS_SET_VOLUME,a.PE,a),t.subscribe(s.CONTROLS_SET_MUTE,a.QE,a),t.subscribe(s.AD_PLAYBACK_REQUEST,a.RE,a),t.subscribe(s.PAUSE_VPAID,a.SE,a),t.subscribe(s.RESUME_VPAID,a.TE,a),a.CB.subscribe(u.OVERLAY_CLICK,a.UE,a),a.CB.subscribe(u.OVERLAY_RENDERED,a.VE,a),t.subscribe(s.AD_BREAK_STARTED,a.WE,a),t.subscribe(s.AD_BREAK_ENDED,a._C,a),a.CB.subscribe(u.AD_STARTED,a.XE,a),a.CB.subscribe(u.AD_INITED,a.dD,a),a.CB.subscribe(u.AD_INIT_ERROR,a.eD,a),a.CB.subscribe(u.VPAID_AD_QUARTILE,a.YE,a),a.ZE="",a.$E(),d&&(d.xml||d.gemini||d.brxd)&&(a.qE=!0,d.xml?a._E=new C(a.CB,d):d.gemini?a._E=new D(a.CB,d):d.brxd&&(a._E=new O(a.CB,d))),n.createAdsInfoPanel(a.As),n.updateAdDiagnostics(a.As)}function i(e,t){if(e){var r=e.getScriptExtension("html"),n=e.getScriptExtension("url");r&&r.length>0&&a(r,t),n&&n.length>0&&o(n,t)}}function a(e,t){!e||e.length<=0||e.forEach(function(e){var r=document.createElement("script");r.appendChild(document.createTextNode(e)),t.uD.appendChild(r),t.k.subscribe(s.AD_PLAYBACK_ENDED,function(){r&&r.parentNode&&r.parentNode.removeChild(r)})})}function o(e,t){!e||e.length<=0||e.forEach(function(e){function r(){n.onload=function(){},n.onerror=function(){},n.onreadystatechange=function(){},n.parentNode.removeChild(n)}var n=document.createElement("script");n.type="text/javascript",n.src=e,n.onload=r,n.onerror=r,n.onreadystatechange=function(){"complete"!==n.readyState&&"loaded"!==n.readyState||n.onload()},t.uD.appendChild(n)})}t.exports=n;var s=(e("../../../lib/logger"),e("../event")),l=e("../../../lib/event-bus"),c=e("user-agent").userAgent,u=(e("../../../lib"),e("./common/Events")),p=e("./common/Constants"),d=e("./common/Errors"),f=e("./ads-json"),v=e("./engine/AdSpec"),m=e("./player-data"),y=e("./engine/AdEngine"),h=e("./cache/CacheManager"),E=e("./vpaid/vpaid-js-interface"),g=e("./monitoring/AdPlaybackManager"),b=e("./monitoring/Diagnostics"),_=e("./monitoring/Analytics"),A=e("./monitoring/ViewabilityManager"),T=(e("./engine/RuleGroup"),e("./renderer/HTML5OverlayRenderer")),S=e("./allocation/CommunicatorSpec"),I=e("./common/CookieUtil"),L=e("./yvap-util"),R=e("./overlay-json"),C=e("./communicator/StandaloneGeminiBRXHelper"),D=e("./communicator/StandaloneGeminiNativeHelper"),O=e("./communicator/StandaloneBRXDHelper"),N=e("./communicator/RefreshCommunicator"),P=e("./midrolls-util"),k=e("./communicator/MidRollsHelper"),M=e("./communicator/MidRollsLabelHelper"),w=e("./communicator/ParserManager"),x=e("./communicator/AdResponse"),F=e("./communicator/Ad"),U={};U[p.BUMPER]=!0,U[p.PREROLL]=!0,U[p.POSTROLL]=!0,U[p.NON_LINEAR]=!1;var B=e("./yvap-util"),H=[d.AD_CALL_TIMEOUT,d.PLAYER_TIMEOUT,d.ERR_VPAID_TIMEOUT];n.prototype.aF=function(e){var t=this,r=e.clipId,n=e.vmapData;if(t.SB.addPlayerDataForClipId(e,r),n){var i=t.IB.understandRules(n);t.SB.addRuleForClipId(i,r),t.SB.updateAdCache(n,r)}},n.prototype.updatePlayerData=function(e){for(var t,r=this,n=0;n<e.length;n++){t=new m(e[n]);var i=t.clipId;r.aF(t);var a=t[p.YVAP_INFO_AD_BREAKS];if((a||t.hasLiveMidrolls)&&a){var o=w.parseAdXml(a)||{};o=o.adBreakMap,r.SB.addCuePointsForClipId(o,i)}t.clean()}},n.prototype.beginAdExperience=function(e,t){var r,n=this;if(n.waitlistMap={},n.xE=e,n.DE=!1,n.uE.removeOverlay(),n.tE.stopAndUnloadAd(),n.CB.publish(u.BEGIN_AD_EXP,e),n.qE){var i=n._E.getAd(e);return void(i&&n.tC(i))}if(r=n.SB.getCuePointsForClipId(e)){var a=[];for(var o in r)if(r.hasOwnProperty(o)){var l=B.convertTimeToSeconds(r[o].timeOffset);a.push(l)}n.k.publish(s.AD_BREAK_TIMELINE,a)}var c=n.SB.getPlayerDataForClipId(e);(r||c.hasLiveMidrolls)&&(n.vE.stopMidRollsFetchThread(),n.vE.startMidRollsFetchThread(e));var d=n.bF(p.PREROLL,e);n.tC(d);var f=n.bF(p.BUMPER,e);n.tC(f),n.cF()},n.prototype.cF=function(){var e=this,t=!1;for(var r in e.waitlistMap)e.waitlistMap.hasOwnProperty(r)&&(t=t||e.waitlistMap[r]);t||e.k.publish(s.ADS_READY)},n.prototype.bF=function(e,t,r){var n=this,i=null,a=n.SB.getRuleForClipId(t),o=n.SB.getPlayerDataForClipId(t);if(a&&o){var s=n.IB.onAdEvent(e,a,o.clipDuration,r),l=new S(p.REFRESH);n.CB.publish(u.AD_OPPORTUNITY,t,e,s,l);var c=new N(l);if(c&&s&&(i=n.SB.getAd(t,c,s),!i)){var d=c.getKey(s,o);n.dF(d,s)}}return i},n.prototype.createJsonList=function(e){for(var t,r,n=this,i=[],a=0;a<e.length;a++)r=e[a],t=n.eF(r),n.CB.publish(u.AD_SUBMITTED,n.xE,r),i.push(t);return i},n.prototype.eF=function(e){var t=this,r=null,n=t.SB.getPlayerDataForClipId(t.xE);if(e){var i=e.adObj,a=e.type,o=e.adSpec,s="ad"+Math.floor(1e3*Math.random())+(new Date).getTime(),l=0;if(t.playbackMap[s]=e,i&&!e.errorState){var c=i.type,u=i.streams,d=o&&n&&n.isLive?o.liveClickDisabled:o.vodClickDisabled,v=!d&&i.params?i.params.clickurl:null,m=!d&&i.params?i.params.ctaurl:null,y=i.adId;l=i.duration||p.DEFAULT_AD_DURATION,r=new f(s,a,u,v,m,c,y,l,i)}else r=new f(s,a,null,"",null,p.NOAD,"",l,i);t.As.addAdData(t.xE,s,e)}return r},n.prototype.fF=function(e){var t=this,r=e.communicatorSpec;e.index++;var n=e&&e.adSources&&e.adSources[e.index];if(r.communicatorName===p.REFRESH&&n){var i,a=t.SB.getPlayerDataForClipId(t.xE),o=(e.adObj,e.adSpec);t.CB.publish(u.AD_HANDLE_FALLBACK,t.xE,e);var s=new N(r);return i=s.getKey(o,a),t.dF(i,o),t.SB.getNewAd(s,o,a,n,e),null}return e},n.prototype.tC=function(e){var t=this,r=[],n=!1;if(e){e.vim=t.SD;var i=e.adObj,a=(e.adSpec,e.errorState&&H.indexOf(e.errorState)===-1);n=i&&i.type===p.NOAD,(n||a)&&(e=t.fF(e))}if(e){var o=t.eF(e);if(r.push(o),t.DE){var l=e.type;l!==p.BUMPER&&l!==p.PREROLL||(e.errorState=d.PLAYER_TIMEOUT,g.onNoAd(e,t.xE))}t.CB.publish(u.AD_SUBMITTED,t.xE,e)}r.length>0&&(t.k.publish(s.ADS_OBJS_UPDATE,r),t.cF())},n.prototype.gF=function(e){var t=this;if(e){var r=e.adSpec,n=e.adObj;if(n){var i="ad"+Math.floor(1e3*Math.random())+(new Date).getTime();t.playbackMap[i]=e;var a=new R(i,n.nonLinearAd,r.placement,r.duration,n.adParameters),o=a.resourceType;o===p.OVERLAY_IMAGE&&t.uE.renderOverlay(a)}}},n.prototype.dF=function(e,t){var r=this;e&&t&&(r.waitlistMap[e]=t)},n.prototype.renderVPAIDAd=function(e,t,r,n,i){var a,o,l=this;if(l.hF=null,e){o=l.playbackMap[e]||{},a=o.adObj||{};var c=null;a.streams&&a.streams.length>0&&(c=a.streams[0],a.streams=[c]),l.CB.publish(u.VPAID_AD_RENDERED,l.xE,o.type,o),c?(l.hF="js",l.tE.render(e,r,n,t,a,i)):l.k.publish(s.Ad.ERROR,d.INCOMPATIBLE_MEDIA)}else l.k.publish(s.Ad.ERROR,d.GENERIC)},n.prototype.iF=function(e,t){return t?P.findBestCombination(e,t):e},n.prototype.getMidrollAds=function(e,t){var r,n,i=this,a=i.vE.play(i.xE,e,t),o=[];t&&(a=i.iF(a,t));for(var s=0;s<a.length;s++)r=a[s],n=i.eF(r),i.CB.publish(u.AD_SUBMITTED,i.xE,r),o.push(n);return o},n.prototype.RE=function(e){var t,r=this;e&&(t=r.playbackMap[e],t&&g.onAdBreakStart(t))},n.prototype.FE=function(e){var t=this;t.k.publish(s.YVAP_MIDROLL_CACHE_UPDATE,e)},n.prototype.EE=function(e,t){var r,n,i=this;e&&(r=i.waitlistMap[e],r&&(n=i.SB.getAdResponseForKey(e),n&&(n.adSpec=r,n.type=r.type,i.waitlistMap[e]=null,n.type===p.NON_LINEAR?i.gF(n):i.tC(n))))},n.prototype.GE=function(e){var t=this;t.qE&&e&&t.tC(e)},n.prototype.HE=function(e){var t=this;t.k.publish(s.AD_METRICS,e)},n.prototype.ZC=function(e){var t=this;t.yE=0,I.incrementTotalClipCount(),I.incrementRecentClipCount(),t.DE=!0,t.CB.publish(u.VIDEO_START,e);var r=t.bF(p.POSTROLL,e);t.tC(r),t.SB.sync();var n=t.rE.getArchive(),i=t.As.generateDiagnostics(n);
t.k.publish(s.YVAP_INFO_UPDATE,i)},n.prototype.IE=function(e,t,r){var n=this,i=t-n.yE;n.yE=t,I.incrementTotalVideoLength(i),I.incrementRecentVideoLength(i);var a=n.bF(p.NON_LINEAR,e,t);n.gF(a)},n.prototype.NE=function(e){},n.prototype.$C=function(e){var t=this;t.uE.removeOverlay(),t.CB.publish(u.VIDEO_END,t.xE)},n.prototype.WE=function(){},n.prototype._C=function(){var e=this;e.CB.publish(u.AD_BREAK_ENDED,e.xE)},n.prototype.JE=function(e){var t,r=this;e&&(t=r.playbackMap[e],t&&r.CB.publish(u.AD_PROGRESS,r.xE,t.type,t,100)),r.playbackMap[e]=null,r.As.updateAdState(e,b.ADSTATES.ENDED)},n.prototype.UE=function(e){var t,r,n,i=this;e&&(n=i.playbackMap[e],n&&(r=n.adObj||{},t=r.params?r.params.clickurl:null,g.onAdClick(n),t&&window.open(t,"_blank")))},n.prototype.VE=function(e){var t,r=this;e&&(t=r.playbackMap[e],t&&g.onAdStart(t))},n.prototype.Sf=function(e,t,r,n,a,o,s,l,c,d){var f,v=this,m=r||"";v.yE=0,v.Xc=0,v.zE=0,v.AE=!1,I.resetRecentVideoLength(),I.resetRecentClipCount(),I.incrementAdCount(),v.uE.removeOverlay(),e&&(f=v.playbackMap[e],f&&(g.onAdStart(f),i(f.adObj,v),p.VIEWABILITY_ON&&v._D.start(f,v.xE),v.CB.publish(u.AD_DELIVERED,v.xE,f.type,m,f,n,a,o,s,l,c,d))),v.As.updateAdState(e,b.ADSTATES.PLAYING,{chosenBitrate:t,latency:r,swfLoadLat:n,vpaidInitLat:a,vpaidStartLat:o})},n.prototype.XE=function(e){var t,r=this,n=r.CE?0:r.BE;e&&(t=r.playbackMap[e],t&&r.CB.publish(u.VPAID_AD_STARTED,r.xE,t.type,t),"js"===r.hF&&r.tE.updateVolume(n))},n.prototype.dD=function(e){var t,r=this,n=r.CE?0:r.BE;e&&("js"===r.hF&&r.tE.updateVolume(n),t=r.playbackMap[e],t&&r.CB.publish(u.VPAID_AD_INITED,r.xE,t.type,t))},n.prototype.YC=function(e,t,r){var n,i,a=this,o=t-a.yE,s=r/4;a.yE=t,I.incrementAdLength(o),e&&(n=a.playbackMap[e],n&&(i=a._D.getViewabilitySummary(),n.adDuration||(n.adDuration=r),t>=p.AD_VIEW_DURATION&&!a.AE&&(a.CB.publish(u.AD_PROGRESS,a.xE,n.type,n,p.AD_VIEW_DURATION),a.AE=!0),t>=a.Xc+s&&(a.Xc+=s,a.zE+=25,a.zE<100&&a.CB.publish(u.AD_PROGRESS,a.xE,n.type,n,a.zE)),g.onAdProgress(n,t,r,i)))},n.prototype.YE=function(e,t,r){var n=this;if(e){var i=n.playbackMap[e];if(i){var a=p.VIEWABILITY_ON&&L.isViewabilityMeasurable()?n._D.getViewabilitySummary():{};g.onVPAIDAdQuartile(i,t,r,a)}}},n.prototype.ub=function(e){var t=this,r=t.playbackMap[e];r&&g.onAdClick(r)},n.prototype.Ti=function(e){function t(e){r.As.updateAdState(e,b.ADSTATES.CANCELLED)}var r=this;t(e.currentPlaybackId),e.unplayedPlaybackIds.forEach(t)},n.prototype.KE=function(e){var t=this,r=t.playbackMap[e];r&&(r.errorState=d.INCOMPATIBLE_MEDIA,t.CB.publish(u.AD_DELIVERY_ERROR,t.xE,r.type,d.INCOMPATIBLE_MEDIA,r),g.onNoAd(r,t.xE))},n.prototype.ME=function(e,t,r){var n=this,i=n.playbackMap[e],a="string"==typeof t?t:d.MEDIA_PLAYBACK;a=p.ADBLOCKER?d.ADBLOCKER:a;var o=-1,s=-1,l=2;r&&(o=r.swfLoadLatency,s=r.initLatency,l=r.timeoutStatus),i&&(i.errorState=a,n.CB.publish(u.AD_DELIVERY_ERROR,n.xE,i.type,a,i,o,s,l),g.onNoAd(i,n.xE)),n.As.updateAdState(e,b.ADSTATES.ERROR,{error:a,vsl:o,vil:s,timeoutStatus:l})},n.prototype.LE=function(e){var t=this,r=t.playbackMap[e];r&&g.onNoAd(r,t.xE)},n.prototype.SE=function(){var e=this;e.tE.pauseAd()},n.prototype.TE=function(){var e=this;e.tE.resumeAd()},n.prototype.OE=function(e,t){var r=this;r.tE.updateDimensions(e,t)},n.prototype.PE=function(e){var t=this;t.Ae(e,!0)},n.prototype.Ae=function(e,t){var r=this;e>=0&&(r.BE=e,r.tE.updateVolume(e,t))},n.prototype.QE=function(e){var t=this;t.Be(e,!0)},n.prototype.Be=function(e,t){var r=this;r.CE=e||!1;var n=e?0:r.BE;r.tE.updateVolume(n,t)},n.prototype.isAdBlockerDetected=function(){return p.ADBLOCKER},n.prototype.getVPAIDLatencies=function(){var e=this;return"js"===e.hF?e.tE.getVPAIDLatencies():null},n.prototype.skipAd=function(){var e=this,t=e.bh.skipNormalAd();t||e.tE.stopAd()},n.prototype.destroy=function(){var e=this;e.jF&&e.jF()},n.prototype.$E=function(){var e=this,t=[89,86,65,80,84,72,69,66,69,83,84],r=String.fromCharCode.apply(null,t);r=r.toLowerCase();var n=function(t){t=t||window.event;var n="number"==typeof t.which?t.which:t.keyCode;n&&0===r.indexOf(e.ZE)?e.ZE=e.ZE+String.fromCharCode(n).toLowerCase():e.ZE="",e.ZE.toLowerCase()===r&&e.skipAd()};e.bh&&"function"==typeof e.bh.skipNormalAd&&(document.addEventListener("keydown",n),e.jF=function(){document.removeEventListener("keydown",n)})},n.prototype.cueMidRolls=function(e,t,r,n,i){var a=this;a.wE.cue(a.xE,e,t,r,n,i)},n.prototype.playMidRolls=function(e,t,r,n,i,a){var o=this,s=o.wE.play(o.xE,e,t,r,n),l=Math.ceil(t/p.DEFAULT_AD_DURATION),c=null,u=0,f=null;if(s&&i){if(u=s.length,u<l)for(var m=0,y=l-u;m<y;m++)c=new x,c.adObj=new F,c.communicatorSpec=new S(p.REFRESH),c.adSpec=new v(p.MIDROLL,["clickable"]),c.type=p.MIDROLL,c.errorState=d.MIDROLL_NO_AD,c.adObj.type=p.NOAD,c.midrollbreak=n,c.midrolladsequence=u+m+1,f=o.SB.getMidrollPrimaryAdSource(o.xE,p.MIDROLL,e),c.adSpec.adCallSequence=f.sequence,s.push(c);s=o.createJsonList(s),i(s),o.wE.resetState()}else a?i&&i([]):o.cueMidRolls(e,t,r,n,i)}},{"../../../lib":"/lib/index.js","../../../lib/event-bus":"/lib/event-bus.js","../../../lib/logger":"/lib/logger.js","../event":"/nextgen/src/event.js","./ads-json":95,"./allocation/CommunicatorSpec":96,"./cache/CacheManager":98,"./common/Constants":99,"./common/CookieUtil":100,"./common/Errors":101,"./common/Events":102,"./communicator/Ad":103,"./communicator/AdResponse":104,"./communicator/MidRollsHelper":107,"./communicator/MidRollsLabelHelper":108,"./communicator/ParserManager":109,"./communicator/RefreshCommunicator":110,"./communicator/StandaloneBRXDHelper":112,"./communicator/StandaloneGeminiBRXHelper":113,"./communicator/StandaloneGeminiNativeHelper":114,"./engine/AdEngine":121,"./engine/AdSpec":122,"./engine/RuleGroup":123,"./midrolls-util":124,"./monitoring/AdPlaybackManager":126,"./monitoring/Analytics":127,"./monitoring/Diagnostics":128,"./monitoring/ViewabilityManager":129,"./overlay-json":132,"./player-data":133,"./renderer/HTML5OverlayRenderer":134,"./vpaid/vpaid-js-interface":137,"./yvap-util":138,"user-agent":233}],136:[function(e,t,r){"use strict";function n(e,t,r){var n=this,a=i.getWindow(),o=a.location.protocol,l=r&&r.yvap&&r.yvap.vpaidTimeout;n.k=e,n.CB=t,n._b=r||{},n.kF=n._b.yvap&&n._b.yvap.mute||n.lF(),n.mF=n.mF(),n.nF=l||s.DEFAULT_VPAID_TIMEOUT,n.oF="YvapID-"+Math.floor(1e3*Math.random()),n.ah={startTime:null,iframeYvapID:null,isInSafeFrame:!1,parentURL:null},n.ch=null,n.eh=null,n.fh=Date.now(),n.gh=!1,n.pF=!1,n._b.isLocal?n.jh=o+"//"+a.location.host:n.jh="https:"===o?"https://s.yimg.com":"http://l.yimg.com",n.qF=d.isInSafeFrame(window),n.qF&&(window.vpaidjsController=n),n.rF=n.kh.bind(n)}t.exports=n;var i=e("../../util"),a=e("../../../../lib"),o=e("../common/Errors"),s=e("../common/Constants"),l=e("../../event"),c=e("../../../../lib/user-agent"),u=e("../../navigator-info"),p=e("../../vpaid/video-vpaid-events"),d=e("../yvap-util"),f={EVENT_BUS:"EVENT_BUS",YVAP_BUS:"YVAP_BUS",REMOVE_IFRAME:"REMOVE_IFRAME",CLEAR_IFRAME_NAME:"CLEAR_IFRAME_NAME",PLAYER_DIMENSION_CHANGE:"PLAYER_DIMENSION_CHANGE"},v=[p.AD_P_PROGRESS,p.AD_P_ED,p.AD_CLICK,p.AD_P_STARTED,p.Ad.E,p.Ad.ED];n.prototype.mh=function(){var e=this;if(e.ch&&e.ch.contentWindow&&e.gh){var t=Array.prototype.slice.call(arguments),r=JSON.stringify(t);e.ch.contentWindow.postMessage(r,e.jh)}},n.prototype.render=function(e,t,r,n,i,a){var c=this,u=window,p={type:"",message:""};if(!a||!a.nodeName&&!a.tagName)return p={type:o.VPAID_AD_RENDER_ERROR,message:"Container for iframe controller has to be a DOMElement"},c.k.publish(l.Ad.ERROR,p.type),void c.k.publish(l.Ad.ENDED);c.eh=a,c.ah={startTime:c.fh,iframeYvapID:c.oF,isInSafeFrame:c.qF,parentURL:u.location.protocol+"//"+u.location.host},window.addEventListener("message",c.rF);var d=document.createElement("iframe"),f=encodeURIComponent(JSON.stringify(c.ah)),v="";v=c._b.isLocal?c.jh+"/vpaidjs.html":c.jh+"/rx/builds/7.86.909.1590008200/vpaidjs.html",d.setAttribute("src",v),d.setAttribute("name",f),d.setAttribute("id",c.oF),d.setAttribute("width","100%"),d.setAttribute("height","100%"),d.setAttribute("frameBorder","0"),d.setAttribute("allowFullScreen",""),d.setAttribute("style","position: absolute; z-index: 10"),d.setAttribute("allow","autoplay; fullscreen"),c.eh.appendChild(d),c.k.publish(l.Ad.IFRAME_LOAD),c.ch=d,c.ch.onload=function(){c.k.publish(l.Ad.IFRAME_LOADED);var a=[e,t,r,n,i,s.DEFAULT_AD_DURATION],o=[c.kF,c.nF,c.pF,c.mF];JSON.stringify(a);c.gh=!0,c.mh("setupConstants",o),c.mh("render",a)}},n.prototype.sF=function(){var e=this;window.removeEventListener("message",e.rF)},n.prototype.mF=function(){return c.mobile&&u.canPlayInline},n.prototype.lF=function(){return c.mobile&&u.hasNativeAutoplaySupport},n.prototype.onStartScreenClick=function(){var e=this;e.pF=!0,e.mh("onStartScreenClick")},n.prototype.kh=function(e){var t=this,r=null;if(e.origin===t.jh){try{r=JSON.parse(e.data)}catch(e){return}t.tF(r)}},n.prototype.handleMessage=function(e){var t=this;t.tF(e)},n.prototype.tF=function(e){var t=this,r=null,n=null;if(e&&a.isArray(e)&&e.length>=2){if(r=e.pop(),!a.isString(r)||0!==r.indexOf("YvapID-"))return;if(t.oF!==r)return;if(n=e.pop(),!n||!f[n])return;switch(n){case f.EVENT_BUS:if(!e[0]||v.indexOf(e[0])===-1)return;t.k.publish.apply(t.k,e);break;case f.YVAP_BUS:if(!e[0])return;t.CB.publish.apply(t.CB,e);break;case f.REMOVE_IFRAME:t.sF()}}},n.prototype.pauseAd=function(){var e=this;e.mh("pauseAd")},n.prototype.resumeAd=function(){var e=this;e.mh("resumeAd")},n.prototype.updateVolume=function(e,t){var r=this,n=[e,t];r.mh("updateVolume",n)},n.prototype.updateDimensions=function(e,t){var r=this,n=[e,t];r.mh("updateDimensions",n)},n.prototype.stopAd=function(){var e=this;e.mh("stopAd")},n.prototype.stopAndUnloadAd=function(){var e=this;e.mh("stopAndUnloadAd")}},{"../../../../lib":"/lib/index.js","../../../../lib/user-agent":2,"../../event":"/nextgen/src/event.js","../../navigator-info":26,"../../util":"/nextgen/src/util.js","../../vpaid/video-vpaid-events":93,"../common/Constants":99,"../common/Errors":101,"../yvap-util":138}],137:[function(e,t,r){"use strict";function n(e,t,r){var n=this;n.k=e,n.CB=t,n.ID,n.gb=0,n.uF={},n.vF={},n.pF=!1,n.k.subscribe(i.START_SCREEN_CLICK,n.Zd,n),n.CB.subscribe(a.VPAID_AD_LATENCY_UPDATE,n.wF,n),n.xF=new o(e,t,r)}t.exports=n;var i=e("../../event"),a=e("../common/Events"),o=e("../vpaid/vpaid-js-iframe-controller");n.prototype.Zd=function(){var e=this;e.xF.onStartScreenClick()},n.prototype.pauseAd=function(){var e=this;e.xF.pauseAd()},n.prototype.resumeAd=function(){var e=this;e.xF.resumeAd()},n.prototype.updateVolume=function(e,t){var r=this;t="boolean"==typeof t&&t,r.xF.updateVolume(e,t)},n.prototype.updateDimensions=function(e,t){var r=this;r.xF.updateDimensions(e,t)},n.prototype.stopAd=function(){var e=this;e.xF.stopAd()},n.prototype.stopAndUnloadAd=function(){var e=this;e.xF.stopAndUnloadAd()},n.prototype.render=function(e,t,r,n,i,a){var o=this;o.xF.render(e,t,r,n,i,a)},n.prototype.getVPAIDLatencies=function(){var e=this;return e.vF},n.prototype.wF=function(e){var t=this;e=e||{};for(var r in e)r&&(t.vF[r]=e[r])}},{"../../event":"/nextgen/src/event.js","../common/Events":102,"../vpaid/vpaid-js-iframe-controller":136}],138:[function(e,t,r){"use strict";function n(e){var t=e&&typeof e||"";return"object"===t||"function"===t}function i(e,t){return n(e)&&b.call(e,t)}function a(e,t){return n(e)&&n(t)&&g.call(t,e)}function o(e,t,r,a,s,l,c){var u,p,d,f,v,m,y,h;if(!n(t))return e;if(e||(e={}),u=c?e:t,!d&&u)for(d in u)try{if(p=t[d],f=typeof p,m=!0,y=d in e,r&&!i(u,d))continue;if(a&&"function"===f)continue;if(y&&(2!==s||l?s&&(m=!1):m="object"===f),!m)continue;if("object"===f&&p){if(l)continue;try{h=p.tagName||p.nodeType,h=!h&&(p==window||p==self||p==document),h=!h&&(p==parent||p==top)}catch(e){h=!1}v=2===s&&y?e[d]:{},p=h?"#node":o(v,p,r,a,s,!1,c)}e[d]=p}catch(e){}return e}function s(e){var t,r=this;if(r&&a(r,h))if(e=l(e),t=c(e,!0)){if(!i(r,"darla"))try{r.darla=t.DARLA||null}catch(e){r.darla=null}i(r,"isIFrame")||(u(e)?r.isIFrame=0:r.isIFrame=1)}else i(r,"darla")||(r.darla=null),i(r,"isIFrame")||(r.isIFrame=1)}function l(e){try{e=e||window,e=e.Object?e:null}catch(t){e=null}return e}function c(e,t){var r=null;try{e=l(e),r=e&&e.top||null,r&&t&&(r=r.document?r:null)}catch(e){r=null}return r}function u(e){var t;return e=l(e),t=c(e),!(!e||!t||e!=t)}function p(e){var t,r=!1;if(e=l(e),f(e))try{t=e&&e.$sf&&e.$sf.ext,t&&("function"!=typeof t.register&&"function"!=typeof t.supports||(r=!0))}catch(e){r=!1}return r}function d(e){var t=new s(e);return t.darla||(t=null),t}function f(e,t){var r,n,i=!1;if(e=l(e),r=c(e),e&&r)try{n=e.parent,i=n&&!u(e)&&n==r}catch(e){i=!1}if(i&&t)try{i=!(!n||!n.document)}catch(e){i=!1}return i}var v=e("./common/Constants"),m=e("../util"),y=e("xhr"),h=(e("user-agent").userAgent,{}),E=Object.prototype,g=E.isPrototypeOf,b=E.hasOwnProperty;h.constructor=s,h.darla=null,h.isIFrame=0,s.prototype=h,r.mix=o,r.isObjLike=n,r.hasOwn=i,r.kindOf=a,r.convertTimeToSeconds=function(e){var t=e.split(":").reverse();t=t.map(function(e){return parseFloat(e,10)});var r=t[0];4===t.length?t=t.slice(1):r=0;var n=t.reduce(function(e,t,r,n){return e+Math.pow(60,r)*t});return n+=r/1e3,isNaN(n)?null:n},r.isViewabilityMeasurable=function(e){return this.getViewabilityNonMeasurableValue(e)===v.VIEWABILITY_MEASURABLE},r.isInTopWindow=u,r.isInSafeFrame=p,r.isDirectChildOfTopWindow=f,r.getTopWin=c,r.getViewabilityNonMeasurableValue=function(e){var t=v.VIEWABILITY_MEASURABLE,r=d(e),n=null;return null===r?u(e)?t=v.VIEWABILITY_NOT_MEASURABLE_NO_DARLA:p(e)||(t=v.VIEWABILITY_NOT_MEASURABLE_IFRAME):(n=r.yvap?r:r.darla||null,n.yvap||(t=v.VIEWABILITY_NOT_MEASURABLE_NO_DARLA)),t},r.getDARLA=d,r.getTimeStamp=function(){var e=new Date,t=[e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()],r=t.join("");return r},r.expandMacro=function(e,t){var r=/\$\{(\w)+\}/g,n=function(e){var r=/(\w)+/g,n=e.match(r),i=n[0];return t[i]?t[i]:""};return e=e.replace(r,n),e=this.cleanUpUrl(e)},r.cleanUpUrl=function(e){for(var t,r,n=/(\w)+=&/g;e.match(n);)e=e.replace(n,"");for(t=/(\w)+=($|;|;;)/;e.match(t);)e=e.replace(t,"$2");for(r=/(;|;;|&)$/;e.match(r);)e=e.replace(r,"");return e},r.generateYqlQuery=function(e,t){return"select * from "+t+" where "+m.querystring(e," and ",null,function(e){return e})},r.detectAdBlocker=function(e){function t(t){n||(n=!0,e(t))}var r="https://video.adaptv.advertising.com/ad/ads/advertisers/advertisers.txt",n=!1;try{y({url:r,method:"GET",sync:!1,timeout:3e3},function(e,r,n){t(!!e)})}catch(e){t(!0)}},r.expandViewabilityMacros=function(e,t){var r=/\$\((\w)+\)/g,n=e.replace(r,function(e){var r=e;switch(e){case"$(V_SKIP_AVAIL)":r=0;break;case"$(V_AUTOPLAYED)":r=1;break;case"$(V_PLAYER_HEIGHT)":t&&(r=t.vi_ph);break;case"$(V_PLAYER_WIDTH)":t&&(r=t.vi_pw);break;case"$(V_EXPANDED)":t&&(r=t.vi_pfs);break;case"$(V_VIEW_INFO)":if(t){var n=t.vi_m;if(n!==v.VIEWABILITY_MEASURABLE)r=v.VIEWABILITY_NOT_MEASURABLE;else{var i=t.vi_lpv;r=i>=v.VIEWABILITY_THRESHOLD?v.VIEWABILITY_VISIBLE:v.VIEWABILITY_NOT_VISIBLE}}else r=v.VIEWABILITY_NOT_MEASURABLE;break;case"$(V_AUD_INFO)":r=t?t.vi_psnd:v.UNKNOWN;break;case"$(V_AUD_TIME_INVIEW_100)":t&&(r=t.vi_tativ);break;case"$(V_VIEW_TYPE)":r=t&&t.vr_type||"";break;case"$(V_MOAT_IVT)":t&&t.ivt&&(r=encodeURIComponent(t.ivt))}return r});return n}},{"../util":"/nextgen/src/util.js","./common/Constants":99,"user-agent":233,xhr:248}],139:[function(e,t,r){},{}],140:[function(e,t,r){(function(e){var r;r="undefined"!=typeof window?window:"undefined"!=typeof e?e:"undefined"!=typeof self?self:{},t.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],141:[function(e,t,r){var n={};!function(e,t){function r(e){return String(null===e||void 0===e?"":e)}function n(e){return e=r(e),c.test(e)?e.replace(i,"&amp;").replace(a,"&lt;").replace(o,"&gt;").replace(s,"&#39;").replace(l,"&quot;"):e}e.Template=function(e,r,n,i){this.r=e||this.r,this.c=n,this.options=i,this.text=r||"",this.buf=t?[]:""},e.Template.prototype={r:function(e,t,r){return""},v:n,t:r,render:function(e,t,r){return this.ri([e],t||{},r)},ri:function(e,t,r){return this.r(e,t,r)},rp:function(e,t,r,n){var i=r[e];return i?(this.c&&"string"==typeof i&&(i=this.c.compile(i,this.options)),i.ri(t,r,n)):""},rs:function(e,t,r){var n=e[e.length-1];if(!u(n))return void r(e,t,this);for(var i=0;i<n.length;i++)e.push(n[i]),r(e,t,this),e.pop()},s:function(e,t,r,n,i,a,o){var s;return(!u(e)||0!==e.length)&&("function"==typeof e&&(e=this.ls(e,t,r,n,i,a,o)),s=""===e||!!e,!n&&s&&t&&t.push("object"==typeof e?e:t[t.length-1]),s)},d:function(e,t,r,n){var i=e.split("."),a=this.f(i[0],t,r,n),o=null;if("."===e&&u(t[t.length-2]))return t[t.length-1];for(var s=1;s<i.length;s++)a&&"object"==typeof a&&i[s]in a?(o=a,a=a[i[s]]):a="";return!(n&&!a)&&(n||"function"!=typeof a||(t.push(o),a=this.lv(a,t,r),t.pop()),a)},f:function(e,t,r,n){for(var i=!1,a=null,o=!1,s=t.length-1;s>=0;s--)if(a=t[s],a&&"object"==typeof a&&e in a){i=a[e],o=!0;break}return o?(n||"function"!=typeof i||(i=this.lv(i,t,r)),i):!n&&""},ho:function(e,t,r,n,i){var a=this.c,o=this.options;o.delimiters=i;var n=e.call(t,n);return n=null==n?String(n):n.toString(),this.b(a.compile(n,o).render(t,r)),!1},b:t?function(e){this.buf.push(e)}:function(e){this.buf+=e},fl:t?function(){var e=this.buf.join("");return this.buf=[],e}:function(){var e=this.buf;return this.buf="",e},ls:function(e,t,r,n,i,a,o){var s=t[t.length-1],l=null;if(!n&&this.c&&e.length>0)return this.ho(e,s,r,this.text.substring(i,a),o);if(l=e.call(s),"function"==typeof l){if(n)return!0;if(this.c)return this.ho(l,s,r,this.text.substring(i,a),o)}return l},lv:function(e,t,n){var i=t[t.length-1],a=e.call(i);return"function"==typeof a&&(a=r(a.call(i)),this.c&&~a.indexOf("{{"))?this.c.compile(a,this.options).render(i,n):r(a)}};var i=/&/g,a=/</g,o=/>/g,s=/\'/g,l=/\"/g,c=/[&<>\"\']/,u=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}}("undefined"!=typeof r?r:n)},{}],142:[function(e,t,r){function n(e){if(!e)return!1;var t=i.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)}t.exports=n;var i=Object.prototype.toString},{}],143:[function(e,t,r){"use strict";function n(e,t){var r=this;r.yF=[],r.length=0,r.Vf=e||Uint8Array,t&&r.set(t)}var i=e("./index");t.exports=n,n.prototype.destroy=function(){var e=this;e.yF=[],e.length=0},n.prototype.set=function(e){var t=this;t.yF.push(e),t.length=t.length+e.length},n.prototype.get=function(e){var t=this;if(i.isNullOrUndefined(e)||e<0||e>t.length)throw new Error("[DataManager] Array position out of bounds");for(var r=0,n=0,a=null,o=0;o<t.yF.length;o++){var s=t.yF[o];if(r+=s.length,e<r){a=s[e-n];break}n+=s.length}return a},n.prototype.subArray=function(e,t){var r=this;if((i.isNullOrUndefined(t)||t>r.length)&&(t=r.length),i.isNullOrUndefined(e)&&(e=0),e>=t)return new r.Vf(0);for(var n=t-e,a=new r.Vf(n),o=0,s=0,l=0,c=0;c<r.yF.length;c++){var u=r.yF[c];if(l+=u.length,o>0){if(t<=l){a.set(u.subarray(0,n-o),o);break}a.set(u.subarray(0),o),o+=u.length}else{if(e<l&&t<=l){a=u.subarray(e-s,t-s);break}if(e<l){var p=e-s;a.set(u.subarray(p)),o=u.length-p}}s+=u.length}return a}},{"./index":146}],144:[function(e,t,r){"use strict";function n(e){var t=this;t.name=e?e:"unnamed",t.a={},t.zF=0}t.exports=n,n.prototype.addEventListener=function(e,t,r){var n=this;if(n.a){n.a[e]||(n.a[e]={});var i=e+"_"+ ++n.zF;return n.a[e][i]={subscriber:r,cb:t},i}},n.prototype.removeEventListener=function(e,t){var r=this;r.a&&e in r.a&&r.a[e].hasOwnProperty(t)&&delete r.a[e][t]},n.prototype.removeEventListeners=function(e){var t=this;t.a&&e&&Object.keys(e).forEach(function(r){var n=e[r];r in t.a&&t.a[r].hasOwnProperty(n)&&(delete t.a[r][n],delete e[r])})},n.prototype.publish=function(e){var t=this;if(t.a&&e in t.a){var r=t.a[e],n=arguments;Object.keys(r).forEach(function(e){var t=r[e];if(t)try{t.cb&&"function"==typeof t.cb&&t.cb.apply(t.subscriber,Array.prototype.slice.call(n,1))}catch(e){console.error("Error in event handler: ",e.message||e.toString(),e.stack)}})}},n.prototype.destroy=function(){var e=this;e.a=null}},{}],145:[function(e,t,r){"use strict";var n=t.exports={};n.inherits=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})},n.guid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},n.base64ToBuffer=function(e){return new Uint8Array(atob(e).split("").map(function(e){return e.charCodeAt(0)}))},n.arrayToUint8Array=function(e){for(var t=e.length,r=new Uint8Array(t),n=new DataView(r.buffer),i=0;i<t;i++)n.setUint8(i,e[i]);return r},n.isDrmItemContained=function(e,t){if(!e||!t||0===t.length)return!1;for(var r=0;r<t.length;r++)if(e.widevine.pssh===t[r].widevine.pssh)return!0;return!1},n.isAbsoluteUrl=function(e){return 0===e.indexOf("http")},n.isUplynk=function(e){return!(!e||!e.length)&&(e=e.toLowerCase(),e.indexOf("uplynk.com")>-1||e.indexOf("downlynk.com")>-1||e.indexOf("uplynk.localhost")>-1||e.indexOf("downlynk.localhost")>-1)},n.isWithCreds=function(e){return e&&e.length&&n.isUplynk(e)&&e.indexOf("expand=finance")>-1}},{}],146:[function(e,t,r){function n(e){return Object.prototype.toString.call(e)}r.isArray=function(e){return Array.isArray(e)},r.isBoolean=function(e){return"boolean"==typeof e},r.isNullOrUndefined=function(e){return null==e},r.isNumber=function(e){return"number"==typeof e&&!isNaN(e)},r.isString=function(e){return"string"==typeof e},r.isObject=function(e){return"[object Object]"===n(e)},r.isFunction=function(e){return"function"==typeof e},r.deepCopy=function(e){var t={};return r.isNullOrUndefined(e)?e:(Object.keys(e).forEach(function(n){r.isArray(e[n])?t[n]=e[n].slice():r.isObject(e[n])?t[n]=r.deepCopy(e[n]):t[n]=e[n]}),t)}},{}],147:[function(e,t,r){"use strict";function n(){var e=this;try{e.AF=e.getWindow()}catch(t){e.AF=null}e.XD=!1,e.AF&&e.AF.performance&&"function"==typeof e.AF.performance.clearResourceTimings&&"function"==typeof e.AF.performance.getEntriesByName&&(e.XD=!0,e.AF.performance.onresourcetimingbufferfull=e.BF.bind(e))}t.exports=n,r.entryTypes=["mark","measure","navigation","frame","resource","server"],n.prototype.getWindow=function(){return window},n.prototype.BF=function(){var e=this;e.XD&&e.AF.performance.clearResourceTimings()},n.prototype.getPerformanceTiming=function(e,t,n){var i,a=this,o={};if(!e||!t&&!n)return null;if(n&&r.entryTypes.indexOf(n)<0)return null;if(!a.XD)return null;if(i=t?a.AF.performance.getEntriesByName(t,n?n:void 0):a.AF.performance.getEntriesByType(n),!i||!i.length)return null;var s=i[i.length-1];return e.forEach(function(e){o[e]=s[e]}),o},n.prototype.destroy=function(){var e=this;e.XD&&e.AF&&(e.AF.performance.onresourcetimingbufferfull=null),e.AF=null,e.XD=!1}},{}],148:[function(e,t,r){"use strict";function n(){var e=this;e.LOCALSTORAGE_PREFIX="com.yahoo.yep",e.CF=e.DF()}t.exports=n,n.prototype.DF=function(){return"localStorage"in window&&null!==window.localStorage},n.prototype.writeProperty=function(e,t){var r=this;r.CF&&(t=JSON.stringify(t),e=r.LOCALSTORAGE_PREFIX+"."+e,window.localStorage.setItem(e,t))},n.prototype.readProperty=function(e){var t=this;if(!e||!e.length)return null;if(t.CF){e=t.LOCALSTORAGE_PREFIX+"."+e;var r=JSON.parse(window.localStorage.getItem(e));return r?r:null}return null}},{}],149:[function(e,t,r){"use strict";var n=e("./user-agent");r.apply=function(){i()};var i=function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var r=window.document.createEvent("CustomEvent");return r.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),r}!n.ie&&window.CustomEvent||(e.prototype=window.Event.prototype,window.CustomEvent=e)}},{"./user-agent":151}],150:[function(e,t,r){"use strict";function n(e,t){var r=this;if(!e||isNaN(e))throw new Error("Invalid Argument: No delay");i.call(r,r.constructor.name),r.delay=Math.max(e,20),r.repeatCount=t>0?t:Number.POSITIVE_INFINITY,r.currentCount=0,r.running=!1,r.startTime=0,r.EF=null,r.Nm={},r.FF={}}t.exports=n;var i=e("./event-bus"),a=e("./hls-utils");a.inherits(n,i),n.prototype.destroy=function(){var e=this;e.reset(),e.Nm={},i.prototype.removeEventListeners.call(e,e.FF),i.prototype.destroy.call(e)},n.prototype.addEventListener=function(e,t){var r=this;if(!t)throw new Error("Invalid Argument: No context");var n=i.prototype.addEventListener.call(r,"timedOut",e,t);r.FF.timedOut=n},n.prototype.removeEventListener=function(e,t){var r=this;if(!t)throw new Error("Invalid Argument: No context");i.removeEventListeners(r.FF)},n.prototype.start=function(){var e=this;e.EF||e.running||(e.EF=setInterval(function(){e.currentCount++,e.currentCount>=e.repeatCount&&e.stop(),e.publish("timedOut"),e.startTime=Date.now()},e.delay),e.startTime=Date.now(),e.running=!0)},n.prototype.stop=function(){var e=this;e.EF&&e.running&&(clearInterval(e.EF),e.EF=null,e.running=!1,e.startTime=0)},n.prototype.reset=function(){var e=this;e.stop(),e.currentCount=0,e.startTime=0}},{"./event-bus":144,"./hls-utils":145}],151:[function(e,t,r){"use strict";t.exports=e("user-agent").userAgent},{"user-agent":233}],152:[function(e,t,r){"use strict";function n(){var e=this;e.GF=[],e.GF.push(new i.BandwidthRule),e.GF.push(new i.BufferRule),e.GF.push(new i.ResolutionRule)}t.exports=n;var i=e("./abr-rules");n.prototype.destroy=function(){var e=this;e.GF=[]},n.prototype.getNextStreamIndex=function(e,t){var r=this;if(!i.validateAbrInput(e))return-1;if(t){var n=new i.StartupRule;return n.getNextStreamIndex(e)}var a=Number.MAX_VALUE;return r.GF.forEach(function(t){var r=t.getNextStreamIndex(e);r<0||(a=Math.min(a,r))}),a===Number.MAX_VALUE?-1:a}},{"./abr-rules":153}],153:[function(e,t,r){"use strict";function n(){var e=this;e.PIXEL_THRESHOLD_FACTOR=.5}function i(){var e=this;e.BANDWIDTH_FACTOR_LOW=1.3,e.BANDWIDTH_FACTOR_HIGH=1.6,e.MIN_BW_FOR_LOW_FACTOR=25e5,e.MIN_BUFFER_TO_SWITCH_DOWN=10}function a(){var e=this;e.BANDWIDTH_FACTOR_LOW=1.3,e.BANDWIDTH_FACTOR_HIGH=1.6,e.MIN_BW_FOR_LOW_FACTOR=25e5,e.MIN_BUFFER_TO_SWITCH_UP=6,e.MIN_LENGTH_DATA=2,e.ALLOWED_LOAD_TIME=500}function o(){var e=this;e.MAX_WIDTH_240P=427,e.MAX_HEIGHT_240P=240,e.MAX_BITRATE_240P=9e5,e.MAX_BITRATE_LIMIT=1e7,e.PIXEL_RATIO_360=6}t.exports.StartupRule=n,t.exports.BandwidthRule=i,t.exports.BufferRule=a,t.exports.ResolutionRule=o,r.validateAbrInput=function(e){return!(!e||"object"!=typeof e||!e.bitrateList||!e.bitrateList.length||"number"!=typeof e.estimatedBandwidthInBps||isNaN(e.estimatedBandwidthInBps)||void 0===e.currentIndex||null===e.currentIndex||isNaN(e.currentIndex)||void 0===e.bufferLength||isNaN(e.bufferLength)||void 0===e.displayWidth||isNaN(e.displayWidth)||e.displayWidth<=0||void 0===e.displayHeight||isNaN(e.displayHeight)||e.displayHeight<=0||void 0===e.streams||e.streams.length<=0)},n.prototype.getNextStreamIndex=function(e){var t=this;if(!r.validateAbrInput(e))return-1;for(var n,i=e.displayWidth*e.displayHeight*t.PIXEL_THRESHOLD_FACTOR,a=e.streams.length-1;a>=0;a--){var o=e.streams[a].width*e.streams[a].height;if(!n&&o<i&&(n=o),n&&o<n)return a+1}return 0},i.prototype.getNextStreamIndex=function(e){var t=this;if(!r.validateAbrInput(e))return-1;for(var n=0,i=e.estimatedBandwidthInBps||e.bwHistory,a=t.HF(i),o=0;o<e.bitrateList.length&&!(i<a*e.bitrateList[o]);o++)n=o;return n<e.currentIndex&&e.bufferLength>t.MIN_BUFFER_TO_SWITCH_DOWN&&(n=e.currentIndex),n},i.prototype.HF=function(e){var t=this;return e>=t.MIN_BW_FOR_LOW_FACTOR?t.BANDWIDTH_FACTOR_LOW:t.BANDWIDTH_FACTOR_HIGH},a.prototype.getNextStreamIndex=function(e){var t=this;if(!r.validateAbrInput(e))return-1;var n=-1,i=e.segmentLength?Math.min(e.segmentLength,t.MIN_BUFFER_TO_SWITCH_UP):t.MIN_BUFFER_TO_SWITCH_UP;return n=0===e.bufferLength?t.IF(e):e.bufferLength<i?e.currentIndex:e.bitrateList.length-1},a.prototype.IF=function(e){for(var t=this,r=0,n=e.estimatedBandwidthInBps||e.bwHistory,i=t.HF(n),a=t.ALLOWED_LOAD_TIME/1e3,o=0;o<e.bitrateList.length&&!(i*e.bitrateList[o]*t.MIN_LENGTH_DATA/n>a);o++)r=o;return r},a.prototype.HF=function(e){var t=this;return e>=t.MIN_BW_FOR_LOW_FACTOR?t.BANDWIDTH_FACTOR_LOW:t.BANDWIDTH_FACTOR_HIGH},o.prototype.getNextStreamIndex=function(e){var t=this;if(!r.validateAbrInput(e))return-1;var n=e.pixelRatio||t.getPixelRatio(e),i=e.displayWidth,a=e.displayHeight;!isNaN(n)&&n>1&&(i*=n,a*=n);for(var o=0,s=0;s<e.streams.length&&!(e.streams[s].width>i||e.streams[s].height>a);s++)o=s;var l=e.streams[o].width,c=e.streams[o].height,u=i<=t.MAX_WIDTH_240P||a<=t.MAX_HEIGHT_240P?t.MAX_BITRATE_240P:t.MAX_BITRATE_LIMIT;if(o=t.JF(e,l,c,u),o<e.streams.length-1&&e.bitrateList[o+1]<u){var p=e.streams[o+1].width,d=e.streams[o+1].height,f=e.streams[o].height,v=Math.abs(d-a)<=Math.abs(f-a);v&&(o=t.JF(e,p,d,u))}return o},o.prototype.JF=function(e,t,r,n){var i=0;return e.streams.forEach(function(a,o){var s=e.bitrateList[o];a&&a.width===t&&a.height===r&&s<=n&&o>i&&s>e.bitrateList[i]&&(i=o)}),i},o.prototype.getPixelRatio=function(e){var t=this,r=1;try{window&&(r=window.devicePixelRatio)}catch(e){r=1}return r||(r=1),e.is360&&(r*=t.PIXEL_RATIO_360),r}},{}],154:[function(e,t,r){"use strict";function n(e){var t=this;t.COLLECTION_INTERVAL=100,t.MIN_SAMPLE_SIZE=5e4,t.SAMPLE_QUEUE_LENGTH=40,t.INSTANCE_SAMPLE_QUEUE_LENGTH=15,t.BW_ADJUSTMENT_FACTOR=.8,t.KF=[],t.LF=[],t.averageBandwidth=e||0,t.instantaneousBandwidth=e||0}t.exports=n,n.prototype.destroy=function(){var e=this;e.KF=[],e.LF=[],e.averageBandwidth=0,e.instantaneousTotalBandwidth=0},n.prototype.addSample=function(e){var t=this;if(e&&!(e.time<=0)){t.MF(e);var r=0,n=t.KF.length,i=n*(n+1)/2,a=1/i;t.KF.forEach(function(e,t){r+=(t+1)*a*e.bandwidth}),t.averageBandwidth=t.BW_ADJUSTMENT_FACTOR*r,r=0,n=t.LF.length,i=n*(n+1)/2,a=1/i,t.LF.forEach(function(e,t){r+=(t+1)*a*e.bandwidth}),t.instantaneousBandwidth=t.BW_ADJUSTMENT_FACTOR*r}},n.prototype.MF=function(e){var t=this;!e||e.time<=0||(e.bandwidth=e.size/e.time*.008,e.bandwidth=Math.min(60,e.bandwidth),t.KF.push(e),t.LF.push(e),t.KF.length>t.SAMPLE_QUEUE_LENGTH&&t.KF.shift(),t.LF.length>t.INSTANCE_SAMPLE_QUEUE_LENGTH&&t.LF.shift())},n.prototype.replaceSamples=function(e,t){var r=this,n=e&&t?e/t*.008:0;if(n>0){r.averageBandwidth=n,r.KF=[];for(var i=Math.min(Math.ceil(t/r.COLLECTION_INTERVAL),r.SAMPLE_QUEUE_LENGTH),a=0;a<i;a++){var o={bandwidth:n};r.KF.push(o)}}}},{}],155:[function(e,t,r){"use strict";t.exports={Command:e("./command"),MediaLoadCommand:e("./media-load-command"),StreamLoadCommand:e("./stream-load-command"),LicenseLoadCommand:e("./license-load-command"),SegmentLoadCommand:e("./segment-load-command"),Mp4InitSegmentLoadCommand:e("./mp4-init-segment-load-command"),SubtitleSegmentLoadCommand:e("./subtitle-segment-load-command"),ErrorHandleCommand:e("./error-handle-command")}},{"./command":158,"./error-handle-command":159,"./license-load-command":160,"./media-load-command":161,"./mp4-init-segment-load-command":162,"./segment-load-command":163,"./stream-load-command":164,"./subtitle-segment-load-command":165}],156:[function(e,t,r){"use strict";var n=e("./command").CmdNames,i=e("./command-defs");t.exports.create=function(e,t,r){for(var a in n)if(n.hasOwnProperty(a)&&n[a]===e){var o=e+"Command",s=i[o];return new s(t,r)}return null}},{"./command":158,"./command-defs":155}],157:[function(e,t,r){"use strict";function n(){var e=this;e.NF={},e.FF={};for(var t in o)o.hasOwnProperty(t)&&(e.NF[o[t]]={})}t.exports=n;var i=e("../command/command"),a=i.CmdEvents,o=i.CmdNames,s=e("../command/command-factory"),l=e("../../lib/hls-utils");n.prototype.destroy=function(){var e=this;e.removeAllCommands(),e.NF=null},n.prototype.executeCommand=function(e,t,r){var n=this;t&&(t.controller=n.__controller);var i=n.createCommand(e,t,r);return i&&i.execute(),i},n.prototype.createCommand=function(e,t,r){var n,i=this;try{n=s.create(e,t,r)}catch(e){console.error("[CommandManager] Could not create command. Error = "+e.toString()),n=null}if(!n)return null;n.key=l.guid();for(var o in a)if(a.hasOwnProperty(o)){
var c=a[o],u="on"+e+c;r[u]&&(i.FF[c+e+n.key]=n.addEventListener(c,r[u],r))}var p=i.NF[e];return p[n.key]=n,n},n.prototype.removeCommand=function(e){var t=this;if(e){var r=t.NF[e.name];if(r[e.key]===e){if(delete r[e.key],e.client)for(var n in a)if(a.hasOwnProperty(n)){var i=a[n],o="on"+e.name+i;e.client[o]&&(e.removeEventListener(i,t.FF[i+e.name+e.key]),delete t.FF[i+e.name+e.key])}e.destroy()}}},n.prototype.removeRelatedCommands=function(e){var t=this;if(t.NF.hasOwnProperty(e)){var r=t.NF[e];for(var n in r)if(r.hasOwnProperty(n)){var i=r[n];i&&t.removeCommand(i)}}},n.prototype.removeAllCommands=function(){var e=this;for(var t in e.NF)e.NF.hasOwnProperty(t)&&e.removeRelatedCommands(t)},n.prototype.getCommand=function(e){var t=this,r=t.NF[e];if(!r)return null;var n=Object.keys(r);return n.length<1?null:r[n[n.length-1]]}},{"../../lib/hls-utils":145,"../command/command":158,"../command/command-factory":156}],158:[function(e,t,r){"use strict";function n(e,t){var r=this;r.data=e,r.client=t,i.call(r,r.constructor.name)}t.exports.Command=n;var i=e("../../lib/event-bus"),a=e("../../lib/hls-utils");t.exports.CmdNames={CMD_MEDIA_LOAD:"MediaLoad",CMD_STREAM_LOAD:"StreamLoad",CMD_LICENSE_LOAD:"LicenseLoad",CMD_SEGMENT_LOAD:"SegmentLoad",CMD_MP4_INIT_SEGMENT_LOAD:"Mp4InitSegmentLoad",CMD_SUBTITLE_SEGMENT_LOAD:"SubtitleSegmentLoad",CMD_ERROR_HANDLE:"ErrorHandle"},t.exports.CmdEvents={CMD_COMPLETE:"Complete",CMD_PROGRESS:"Progress",CMD_ERROR:"Error"},a.inherits(n,i),n.prototype.destroy=function(){var e=this;e.data=null,i.prototype.destroy.call(e)},n.prototype.execute=function(){},n.prototype.cancel=function(){}},{"../../lib/event-bus":144,"../../lib/hls-utils":145}],159:[function(e,t,r){"use strict";function n(e,t){var r=this;if(!e||p.isNullOrUndefined(e.streamIndex)||!e.controller)throw new Error("Invalid argument: data argument of the command is not complete");o.call(r,e,t),r.name=s.CMD_ERROR_HANDLE,r.__controller=r.data.controller,r.l=r.__controller.model,r.ERR_INTERVAL_AFTER_BUFFER_EMPTY=1e4,r.OF=new c(r.ERR_INTERVAL_AFTER_BUFFER_EMPTY,1),r.OF.addEventListener(function(){r.OF.destroy(),r.PF()},r),r.cm(e.streamIndex),r.QF=-1}t.exports=n;var i=e("../../lib/hls-utils"),a=e("./command"),o=a.Command,s=a.CmdNames,l=a.CmdEvents,c=e("../../lib/timer"),u=e("../model/worker-scope/model").AbrModes,p=e("../../lib"),d=e("../error");i.inherits(n,o),n.prototype.destroy=function(){var e=this;e.OF&&e.OF.destroy(),o.prototype.destroy.call(e)},n.prototype.execute=function(e){var t=this;if(e>=0&&t.RF.length){var r=t.RF.indexOf(e);t.RF.splice(r,1)}if(!t.OF.running||t.QF===-1||e===t.QF){if(t.data.error&&t.data.error.code===d.ERR_XHR_LOAD_FORBIDDEN[0])return void t.PF();if(t.l.getABRMode()===u.AUTO){if(t.RF.length){var n=t.RF.shift();return t.publish(l.CMD_PROGRESS,t,{index:n}),void(t.QF=n)}if(0!==t.l.currentLoadingStreamIndex)return t.publish(l.CMD_PROGRESS,t,{index:0}),void(t.QF=0)}t.l.bufferLength>.15||t.OF.start()}},n.prototype.cancel=function(){},n.prototype.cm=function(e){var t=this;if(t.RF=[],!(e<0||e>=t.l.streams.length)){var r,n=e;for(r=n-1;r>=0;r--)t.RF.push(r);for(r=n+1;r<t.l.streams.length;r++)t.RF.push(r)}},n.prototype.PF=function(){var e=this;e.publish(l.CMD_ERROR,e)}},{"../../lib":146,"../../lib/hls-utils":145,"../../lib/timer":150,"../error":184,"../model/worker-scope/model":201,"./command":158}],160:[function(e,t,r){"use strict";function n(e,t){var r=this;if(!e||!e.controller)throw new Error("Invalid argument: data argument of the command is not complete");s.call(r,e,t),r.SF=1,r.TF=[403],r.name=l.CMD_LICENSE_LOAD,r.UF=e.controller.services.getNewLoader(r.VF())}t.exports=n;var i=e("../../lib/hls-utils"),a=e("./../services/loader").Events,o=e("./command"),s=o.Command,l=o.CmdNames,c=o.CmdEvents;i.inherits(n,s),n.prototype.destroy=function(){var e=this;e.UF.destroy(),s.prototype.destroy.call(e)},n.prototype.execute=function(){var e=this,t=e.data.url,r=function(t){e.publish(c.CMD_COMPLETE,e,t)},n=function(t){e.publish(c.CMD_ERROR,e,t)};e.UF.addEventListener(a.COMPLETE,r,e),e.UF.addEventListener(a.ERROR,n,e),e.UF.load(t,e.data.challenge)},n.prototype.cancel=function(){},n.prototype.VF=function(){var e=this,t={method:"POST",responseType:"arraybuffer",headerFields:e.data.headerFields,url:e.data.url,maxRetries:e.SF,retryExclusion:e.TF};return t}},{"../../lib/hls-utils":145,"./../services/loader":218,"./command":158}],161:[function(e,t,r){"use strict";function n(e,t){var r=this;if(!e||!e.url||!e.controller)throw new Error("Invalid argument: data argument of the command is not complete");s.call(r,e,t),r.name=l.CMD_MEDIA_LOAD,r.UF=e.controller.services.getNewLoader(e)}t.exports=n;var i=e("../../lib/hls-utils"),a=e("./../services/loader").Events,o=e("./command"),s=o.Command,l=o.CmdNames,c=o.CmdEvents;i.inherits(n,s),n.prototype.destroy=function(){var e=this;e.UF.destroy(),s.prototype.destroy.call(e)},n.prototype.execute=function(){var e=this,t=e.data.url,r=function(t){e.publish(c.CMD_COMPLETE,e,t)},n=function(t){e.publish(c.CMD_ERROR,e,t)};e.UF.addEventListener(a.COMPLETE,r,e),e.UF.addEventListener(a.ERROR,n,e),e.UF.load(t)},n.prototype.cancel=function(){}},{"../../lib/hls-utils":145,"./../services/loader":218,"./command":158}],162:[function(e,t,r){"use strict";function n(e,t){var r=this;r.WF=e.stream,r.XF=[],r.YF=!!e.comboLoad,r.ZF=e.initSegment,r.$F=e.segment,r._F=e.cached,r.aG=r.constructor.super_.prototype,r.constructor.super_.call(r,e,t),r.kg=e.initSegment.url,r.name=o.CMD_MP4_INIT_SEGMENT_LOAD}t.exports=n;var i=e("../../lib/hls-utils"),a=e("./command"),o=a.CmdNames,s=a.CmdEvents,l=e("./segment-load-command");i.inherits(n,l),n.prototype.destroy=function(){var e=this;e.XF=[],e.aG.destroy.call(e)},n.prototype.bG=function(e){if(!(e&&e.controller&&e.stream&&e.initSegment&&e.initSegment.url))throw new Error("Invalid argument: data argument of the command is not complete")},n.prototype.cG=function(){var e=this;if(e.XF.push(e.ZF),e.YF){var t=e.WF.getMp4Chunk("sidx"),r=e.WF.getMp4Chunk("first");t&&e.XF.push(t),r&&e.$F&&e.XF.push(r)}},n.prototype.VF=function(){var e=this,t={responseType:"arraybuffer",isChunkedLoad:!0,minChunkSize:1e3,headerFields:{}};e.cG();var r=-1,n=-1;if(e.XF.length){var i=e.XF[0].range,a=e.XF[e.XF.length-1].range;i&&a&&(r=i.start,n=a.end)}r>=0&&n>=0&&(t.headerFields.Range="bytes="+r+"-"+n,e.dG=n-r+1);var o=e.WF.cdn||e.$F&&e.$F.cdn;if("atlas"===o){var s=e.WF.sessionId||e.$F&&e.$F.sessionId;t.headerFields.Accept="*/*; X-PB-SESSION-ID="+s}return t},n.prototype.eG=function(){var e=this;e.$F&&e.aG.eG.call(e)},n.prototype.fG=function(){var e=this;return!e.YF&&e._F&&e.ZF.loaded?void e.gG():void e.aG.fG.call(e)},n.prototype.hG=function(e,t){var r=this;e&&(r.YF?r.iG(e,t):r.jG(e,t))},n.prototype.iG=function(e,t){var r=this;if(e){var n=0,i=e.byteLength,a=e;t!==r.kG&&r.lG(t);for(var o=null,l=0;l<r.XF.length;l++){if(o=r.XF[l],!a)return;if(o.loaded||(n+=o.append(a),"first"===o.name&&r.mG&&r.mG.append(a),o.loaded&&"first"!==o.name&&r.publish(s.CMD_PROGRESS,r,{chunk:o,stream:r.WF,comboLoad:r.YF})),n>=i)return;if(n>0&&(a=e.subarray(n)),!o.loaded)return}}},n.prototype.jG=function(e,t){var r=this;t!==r.kG?r.lG(t):r.mG.append(e)},n.prototype.gG=function(){var e=this;if(!e.YF){var t=e.XF[0];t&&(t.loaded=!0,e.publish(s.CMD_PROGRESS,e,{chunk:t,stream:e.WF,comboLoad:e.YF}),e.publish(s.CMD_COMPLETE,e,{stream:e.WF,comboLoad:e.YF}))}e.aG.gG.call(e)},n.prototype.nG=function(){var e=this;e.publish(s.CMD_COMPLETE,e,{stream:e.WF,comboLoad:e.YF})},n.prototype.oG=function(e,t){var r=this;if(e){if(!r.YF){var n=r.XF[0];return n&&!n.loaded&&n.append(e.data),void r.publish(s.CMD_PROGRESS,r,{chunk:n,stream:r.WF,comboLoad:r.YF})}e.stream=r.WF,e.chunk={name:"first"},r.aG.oG.call(r,e,t)}},n.prototype.pG=function(){return 0},n.prototype.getSegment=function(){var e=this;return e.$F}},{"../../lib/hls-utils":145,"./command":158,"./segment-load-command":163}],163:[function(e,t,r){"use strict";function n(e,t){var r=this;r.bG(e),f.call(r,e,t),r.name=v.CMD_SEGMENT_LOAD,r.$F=e.segment,r.WF=e.stream,r.__controller=r.data.controller,r.l=r.__controller.model,r.kg=r.$F?r.$F.url:e.url,r.qG=r.$F?r.$F.streamIndex:e.stream.index,r.rG=r.$F?r.$F.encryptionData:null,r.sG=!1,r.tG=new c,r.kG=0,r.uG=null;var n=e.controller.services;r.TF=[403],r.UF=n.getNewLoader(r.VF()),r.rG&&r.rG.keyUri&&(r.vG=n.getNewLoader(r.wG())),r.xG=r.__controller.services.bandwidthEstimator,r.yG=new u(r.xG.COLLECTION_INTERVAL),r.yG.addEventListener(r.zG,r),r.eG()}t.exports=n;var i=e("../../lib/hls-utils"),a=e("../services/loader"),o=a.Events,s=e("../segment-data-processors/processor-chain"),l=e("../segment-data-processors/segment-data-processor-events"),c=e("../../lib/load-profiler"),u=e("../../lib/timer"),p=e("./../event").HLSEvent,d=e("./command"),f=d.Command,v=d.CmdNames,m=d.CmdEvents;i.inherits(n,f),n.prototype.destroy=function(){var e=this;e.cancel(),e.UF.destroy(),e.yG.destroy(),e.tG.destroy(),e.vG&&e.vG.destroy(),e.mG&&e.mG.destroy(),f.prototype.destroy.call(e)},n.prototype.bG=function(e){if(!(e&&e.segment&&e.stream&&e.controller))throw new Error("Invalid argument: data argument of the command is not complete")},n.prototype.wG=function(){var e=this;return{responseType:"arraybuffer",isChunkedLoad:!1,headerFields:{},retryExclusion:e.TF}},n.prototype.VF=function(){var e=this,t={responseType:"arraybuffer",isChunkedLoad:!0,headerFields:{},retryExclusion:e.TF},r=e.$F?e.$F.bitrate*e.$F.duration/8:0,n=.025;return e.$F.brStartOffset>=0&&e.$F.brEndOffset>=0&&(t.headerFields.Range="bytes="+e.$F.brStartOffset+"-"+e.$F.brEndOffset,r=e.$F.brEndOffset-e.$F.brStartOffset+1),t.minChunkSize=r*n,"atlas"===e.$F.cdn&&(t.headerFields.Accept="*/*; X-PB-SESSION-ID="+e.$F.sessionId),0===e.$F.streamIndex&&(t.timeout=1e4),t},n.prototype.eG=function(){var e=this,t=e.AG();t.containerFormat=e.$F.containerFormat,t.encryptionData=e.rG;var r=e.__controller.create(s,t);r&&(r.addEventListener(l.DATA_PROCESS_PROGRESS,e.oG,e),r.addEventListener(l.DATA_PROCESS_COMPLETE,e.nG,e),r.addEventListener(l.DATA_PROCESS_ERROR,e.BG,e),e.mG=r)},n.prototype.AG=function(){var e=this;return{seqNum:e.$F.seqNum,discontinuity:e.$F.discontinuity,demux:e.l.config.demux,width:e.WF?e.WF.width:640,height:e.WF?e.WF.height:360,timescale:e.WF.timescale?e.WF.timescale:e.l.timescale,duration:e.l.duration,segDuration:e.$F.duration?e.$F.duration:-1,pcr:e.l.getPCR(),frameRate:e.WF?e.WF.frameRate:30,mp4State:e.data.state?e.data.state.mp4:null,startOffsetTimestamp:e.l.startOffsetTimestamp,startTime:e.$F.startTime,lastAudioTimestamp:e.data.state?e.data.state.lastAudioTimestamp:NaN,lastAudioFrameDuration:e.data.state?e.data.state.lastAudioFrameDuration:NaN,prevSegEndTimeStamps:e.l.getPrevSegEndTimestamps(e.WF,e.$F),isAltAudioActive:!!e.data.state&&e.data.state.isAltAudioActive,live:e.l.live,onlyMetadata:e.data.onlyMetadata,useEditBox:!0,userAgent:e.l.userAgent,dash:e.l.isDash(),type:e.WF.type}},n.prototype.execute=function(){var e=this;e.kG=0,e.CG=!1,e.sG=!0,e.DG=Date.now(),e.EG=0,e.FG=0,e.$F&&(e.$F.totalDownloadTime=0,e.$F.timeToFirstByte=0),e.GG=Date.now(),e.yG.start(),e.rG&&e.vG&&e.HG(),e.fG()},n.prototype.cancel=function(){var e=this;e.IG(),e.UF.reset()},n.prototype.IG=function(){var e=this;e.yG.reset(),e.mG&&e.mG.close(),e.sG=!1},n.prototype.HG=function(){var e=this;if(e.rG&&e.vG){var t=e.WF.lastKey,r=e.rG.keyUri;if(t&&t.keyUri&&t.key&&t.keyUri===r)return void e.JG(t.key);var n=function(t){e.JG(t)},i=function(t){e.publish(m.CMD_ERROR,e,t)};e.vG.addEventListener(o.COMPLETE,n,e),e.vG.addEventListener(o.ERROR,i,e),e.vG.load(r)}},n.prototype.fG=function(){var e=this;if(e.UF){var t=e.kg,r=function(){e.gG()},n=function(t,r){e.hG(t,r)},i=function(t){e.publish(m.CMD_ERROR,e,t)},a=function(t,r){e.lG(t,r)};e.UF.addEventListener(o.COMPLETE,r,e),e.UF.addEventListener(o.PROGRESS,n,e),e.UF.addEventListener(o.ERROR,i,e),e.UF.addEventListener(o.BYTES_LOADED,a,e),e.UF.load(t)}},n.prototype.lG=function(e,t){var r=this;r.$F&&0===r.$F.timeToFirstByte&&(r.$F.timeToFirstByte=Date.now()-r.GG,r.__controller.sendEvent(p.SEGMENT_FIRST_BYTE_LOADED,t),r.publish(m.CMD_PROGRESS,r,{position:"firstByte"})),r.EG+=Math.max(e-r.kG,0),r.kG=e},n.prototype.hG=function(e,t){var r=this;t!==r.kG&&r.lG(t),r.mG&&r.mG.append(e)},n.prototype.gG=function(){var e=this;e.zG(),e.yG.stop();var t=e.pG();e.mG&&e.mG.endOfSegment(),t>0&&e.xG.replaceSamples(e.kG,t)},n.prototype.JG=function(e){var t=this;e.type="key",e.initVector=t.rG.initVector,e.seqNum=t.$F.seqNum,t.$F.encryptionData.key=e,t.WF.lastKey=t.rG,t.mG.append(e)},n.prototype.oG=function(e){var t=this;e&&(e.putParam&&(t.uG&&e.putParam("perfInfo",t.uG),e.putParam("bytesTotal",t.kG)),t.publish(m.CMD_PROGRESS,t,e))},n.prototype.nG=function(e){var t=this;t.publish(m.CMD_COMPLETE,t,e)},n.prototype.BG=function(){},n.prototype.zG=function(){var e=this,t=Math.max(e.EG,0),r=Date.now();e.FG=r-e.DG,e.yG.reset(),e.xG&&e.FG>10&&(e.DG=r,e.$F&&(e.$F.totalDownloadTime+=e.FG),e.EG=0,e.xG.addSample({size:t,time:e.FG})),e.yG.start()},n.prototype.pG=function(){var e=this,t=["startTime","requestStart","responseStart","responseEnd","secureConnectionStart","fetchStart","connectStart","domainLookupStart"],r=e.tG?e.tG.getPerformanceTiming(t,e.kg):null;return e.uG=r,r&&r.responseEnd&&r.startTime?r.responseEnd-r.startTime:null}},{"../../lib/hls-utils":145,"../../lib/load-profiler":147,"../../lib/timer":150,"../segment-data-processors/processor-chain":213,"../segment-data-processors/segment-data-processor-events":214,"../services/loader":218,"./../event":185,"./command":158}],164:[function(e,t,r){"use strict";function n(e,t){var r=this;if(!(e&&e.stream&&e.stream.url&&e.controller))throw new Error("Invalid argument: data argument of the command is not complete");s.call(r,e,t),r.name=l.CMD_STREAM_LOAD,r.UF=e.controller.services.getNewLoader(e.retryOpts,e.stream.url)}t.exports=n;var i=e("../../lib/hls-utils"),a=e("./../services/loader").Events,o=e("./command"),s=o.Command,l=o.CmdNames,c=o.CmdEvents;i.inherits(n,s),n.prototype.destroy=function(){var e=this;e.UF.destroy(),s.prototype.destroy.call(e)},n.prototype.execute=function(){var e=this,t=e.data.stream.url,r=function(r){e.publish(c.CMD_COMPLETE,e,{data:r.data,headers:r.headers,streamUrl:t,stream:e.data.stream})},n=function(t){e.publish(c.CMD_ERROR,e,t)};e.UF.addEventListener(a.COMPLETE,r,e),e.UF.addEventListener(a.ERROR,n,e),e.UF.load(t)},n.prototype.cancel=function(){}},{"../../lib/hls-utils":145,"./../services/loader":218,"./command":158}],165:[function(e,t,r){"use strict";function n(e,t){var r=this;if(!(e&&e.controller&&e.subtitleStream&&e.segment))throw new Error("Invalid Argument: data arg is incomplete");c.call(r,e,t),r.name=u.CMD_SUBTITLE_SEGMENT_LOAD,r.WF=e.subtitleStream,r.__controller=e.controller,r.$F=e.segment||null,r.FF={},r.KG()}t.exports=n;var i=e("../../lib/hls-utils"),a=e("../services/loader"),o=a.Events,s=e("./../event").HLSEvent,l=e("./command"),c=l.Command,u=l.CmdNames,p=l.CmdEvents;i.inherits(n,c),n.prototype.destroy=function(){var e=this;e.UF.destroy(),e.__controller.removeEventListeners(e.FF),c.prototype.destroy.call(e)},n.prototype.execute=function(){var e=this;e.$F&&e.UF&&e.UF.load(e.$F.url)},n.prototype.cancel=function(){},n.prototype.KG=function(){var e=this;e.UF=e.__controller.services.getNewLoader();var t=function(t){e.gG(t)},r=function(t){e.publish(p.CMD_ERROR,e,t)};e.UF.addEventListener(o.COMPLETE,t,e),e.UF.addEventListener(o.ERROR,r,e)},n.prototype.gG=function(e){var t=this;if(t.$F){t.$F.data=e.data;var r=t.$F.pcr();return void 0===r||null===r?void t.__controller.addEventListener(s.PCR_AVAILABLE,t.LG,t):void t.LG()}},n.prototype.LG=function(){var e=this;e.$F.parseSegment(),e.publish(p.CMD_COMPLETE,e,{data:e.$F.toObject(),url:e.$F.url})}},{"../../lib/hls-utils":145,"../services/loader":218,"./../event":185,"./command":158}],166:[function(e,t,r){"use strict";function n(){var e=this;e._node=e.MG.node,e.NG=e.MG.mediaSource,e.OG=null,e.PG=[],e.Nn=!1,e.l=e.MG.appModel,e.QG=e.l.config.pastBufferLengthLimit}t.exports=n;var i=e("./source-buffer-manager"),a=e("../../error");n.prototype.destroy=function(){var e=this;e.RG(),e.PG=[]},n.prototype.setSwitchManager=function(e){var t=this;t.OG=e},n.prototype.process=function(){var e=this;e.SG()&&"open"===e.NG.readyState&&e.NG.endOfStream()},n.prototype.onError=function(){var e=this;e.Nn=!0},n.prototype.onSeeking=function(e,t){var r=this;e&&r.RG(),t&&r.TG()},n.prototype.UG=function(e){for(var t=this,r=0;r<t.PG.length;r++)if(e===t.PG[r].type)return t.PG[r];return null},n.prototype.setMinimumBufferTime=function(e){var t=this;t.PG.forEach(function(t){t.setMinBufferTime(e)})},n.prototype.createSourceBuffer=function(e,t,r){var n=this;if(!n.NG||n.Nn)return null;var o=n.UG(e);if(!o)if(n.MG.isMimetypeSupported(t)){o=n.MG.create(i,n.NG,e,t),n.PG.push(o);var s=n.l.config.minBufferTime,l=isNaN(r)?n.l.live?s.live:s.vod:r;n.setMinimumBufferTime(l)}else{var c=new a.Error(a.ERR_MIMETYPE_NOT_SUPPORTED);n.MG.notifyError(c)}return o},n.prototype.VG=function(){var e=this;if(e.NG&&!e.Nn)for(;e.PG.length>0;){var t=e.PG.shift();t.destroy()}},n.prototype.TG=function(){var e=this,t=[];e.NG&&!e.Nn&&"open"===e.NG.readyState&&(e.PG.forEach(function(e){t.push({type:e.type,mimeType:e.mimeType})}),e.VG(),t.forEach(function(t){e.createSourceBuffer(t.type,t.mimeType,NaN)}))},n.prototype.RG=function(){var e=this;e.NG&&!e.Nn&&e.PG.forEach(function(e){e.abort()})},n.prototype.clear=function(e,t){var r=this;if(r.NG&&!r.Nn){if(!e)return void r.PG.forEach(function(e){e.clearAll()});if(!(e&&e.end-e.start<10)&&t){var n=function(e){};t.clearBuffer(e.start,e.end,n)}}},n.prototype.clearSrcBuffer=function(e,t){var r=this,n=r.UG(e);if(n){if(!t)return void n.clearAll();var i=function(e){};n.clearBuffer(t.start,t.end,i)}},n.prototype.appendBuffer=function(e,t){var r=this,n=r.createSourceBuffer(e.type,e.mimeType),i=function(e,n){r.WG(e,n),t(e,n)};n&&!r.Nn&&e.data&&e.data.length&&n.appendBuffer(e.data,e.startTime,e.endTime,e.onlyMetadata,i)},n.prototype.endOfStream=function(e){var t=this;t.PG.forEach(function(t){t.setEndOfStream(e)})},n.prototype.SG=function(){var e=this;if(!e.PG.length)return!1;var t=!0;return e.PG.forEach(function(e){t=t&&"closed"===e.state}),t},n.prototype.getPendingBufferLength=function(){var e=this,t=0;return e.PG.forEach(function(e){var r=e.getTotalPendingBufferLength();t<r&&(t=r)}),t},n.prototype.getBufferedAndPending=function(){var e=this,t={};return e.PG.forEach(function(e){var r=e.getTotalPendingBufferLength(),n=e.getBufferLength();e.mimeType.indexOf("video")!==-1?t.video={buffered:n,pending:r,mimeType:e.mimeType}:t.audio={buffered:n,pending:r,mimeType:e.mimeType}}),t},n.prototype.resetReadyState=function(){var e=this;e.PG.forEach(function(e){e.ready=!1})},n.prototype.areSrcBuffersReady=function(){for(var e=this,t=0;t<e.PG.length;t++)if(!e.PG[t].ready)return!1;return!0},n.prototype.WG=function(e,t){var r=this;t&&(r.clear(r.XG(t),t),r.clear(r.YG(t),t))},n.prototype.XG=function(e){var t=this,r=t._node.currentTime,n=null;try{n=e.buffer.buffered}catch(e){n=null}var i=0,a=0,o=t.l.live?t.QG.live:t.QG.vod;return n&&n.length&&(i=n.start(0),a=Math.max(r-o,0)),{start:i,end:a}},n.prototype.YG=function(e){var t=this,r=t._node.currentTime,n=null;try{n=e.buffer.buffered}catch(e){n=null}var i=t.l.live?t.QG.live:t.QG.vod,a={start:0,end:0};return n&&n.length>1&&r+i<n.start(1)&&(a.start=n.start(1),a.end=n.end(1)),a}},{"../../error":184,"./source-buffer-manager":169}],167:[function(e,t,r){"use strict";function n(e){var t=this;t.ZG="Controller",t.$G=s.guid(),t._node=t.MG.node,t.NG=t.MG.mediaSource,t.l=t.MG.appModel,t.mediaLoaded=!1,t._G=!1,t.aH=null,t.bH=e?e.sessionId:null,t.cH=new d(t._node,t.MG.mediaSource,t),t.dH=t.MG.create(f),t.eH=t.MG.create(y),t.fH=new E,t.gH=new l(250),t.gH.addEventListener(t.fq,t),t.hH=[];var r={userAgent:t.l.userAgent,metadata:e,config:t.l.config};if(r.config.bwHistory=t.iH(),t.jH=t.kH(r),t.jH){if(t.lH=t.mH(t.ZG),t.lH)return r.config.inWorkerScope=!0,t.lH.addEventListener("message",t.nH.bind(t)),void t.oH(a.CREATE,[r]);t.l.config.useWorker=!1}t.tc=new p(r,t.pH.bind(t)),t.jH=!1,t.qH=!1,t.rH=!1,t.sH=null,t.aH=null,t.tH=_.SYNCH_DONE,t.uH=null,t.vH=!1}t.exports=n;var i=e("../../worker-utils/worker-defs"),a=i.MessageIds,o=i.MessageTypes,s=e("../../../lib/hls-utils"),l=e("../../../lib/timer"),c=e("../../worker-utils/worker-bridge"),u=e("webworkify"),p=e("../worker-scope/controller"),d=e("./video-event-handler"),f=e("./buffer-controller"),v=e("../../event"),m=v.HLSEvent,y=e("../../services/playback-metrics"),h=e("../../worker-utils/message"),E=e("../../../lib/localstoragehandler"),g=e("../worker-scope/streamer").SynchTypes,b=e("../worker-scope/license-manager").LicenseManager,_={SYNCH_BEGIN:"synchBegin",SYNCH_METADATA_READY:"synchMetadataReady",SYNCH_DONE:"synchDone"};n.prototype.destroy=function(){var e=this;e.cH.destroy(),e.dH.destroy(),e.eH.destroy(),e.hH=null,e.wH&&e.wH.destroy(),e.gH&&(e.gH.destroy(),e.gH=null),e.jH&&e.lH?(e.oH(a.DESTROY),e.lH.terminate()):e.tc.destroy()},n.prototype.kH=function(e){var t=this,r=e?e.userAgent:null,n=!e||!e.config||e.config.useWorker;if(!r)return n;if(r.chrome&&!r.win7)return!1;if(r.safariDesktop)return!1;var i=e?e.metadata:null;if(i&&i.url&&i.url.indexOf(".mpd")>-1)return!1;if(r.firefox&&i&&i.streams&&i.streams.length&&"m3u8:fmp4"===i.streams[0].format)return!1;var a=t.xH(i);return(!a||!(r.safari||r.edge||r.ie))&&n},n.prototype.xH=function(e){var t=this;if(!e)return!1;var r=e.url,n=e.streams&&e.streams.length?t.yH(e.streams[0]):null;return s.isUplynk(r||n)},n.prototype.yH=function(e){if(!e)return null;var t=e.url;return!t&&e.host&&e.path&&(t=e.host+e.path),t},n.prototype.sendVideoEvent=function(e){var t=this;if(e){var r=e.type;switch(r){case"play":t.zH();break;case"playing":t.pb();break;case"pause":t.AH();break;case"seeking":t.je(e);break;case"seeked":t.ke(e);break;case"ended":t.BH();break;case"error":t.tb();break;case"timeupdate":t.CH(e);break;case"resize":t.DH(e)}}},n.prototype.onMediaSourceOpen=function(){var e=this;e.mediaLoaded&&(e.gH.reset(),e.gH.start(),e.hH.length&&e.EH())},n.prototype.play=function(e){var t=this;if(t.NG&&("closed"===t.NG.readyState||!t.mediaLoaded))return void t.hH.push([t,t.play,[e]]);var r=t.l.live?t._node.currentTime:t.l.duration,n=e>0&&e<=r?e:null;n&&t.FH(n,g.INIT),t.vf()},n.prototype.pause=function(){var e=this;return!e.NG||"closed"!==e.NG.readyState&&e.mediaLoaded?void e._node.pause():void e.hH.push([e,e.pause])},n.prototype.preload=function(e){var t=this;return!t.NG||"closed"!==t.NG.readyState&&t.mediaLoaded?void t.GH("preload",[e]):void t.hH.push([t,t.preload,[e]])},n.prototype.setABRMode=function(e){var t=this;t.GH("setABRMode",[e])},n.prototype.setAudioLanguage=function(e){var t=this;t.GH("setAudioLanguage",[e])},n.prototype.suspendStreaming=function(){var e=this;e.GH("suspendStreaming")},n.prototype.resumeStreaming=function(){var e=this;e.GH("resumeStreaming")},n.prototype.getSegInfo=function(){var e=this,t={mode:"sync",segInfo:null,bufferLen:null,sessionId:e.bH};return e.jH&&e.lH?(t.mode="async",e.oH(a.CALL_METHOD,null,"getSegInfo")):t.segInfo=e.tc.getSegInfo(),t.bufferLen=e.l.getBufferLength(),t},n.prototype.zH=function(){var e=this;if(e.l.setDimensions(),e.NG&&("closed"===e.NG.readyState||!e.mediaLoaded))return void e.hH.push([e,e.zH]);var t=e.aH;e.sH&&(t=e.sH,e.sH=null),e.qH=!1,e.GH("onPlay",[t]),e.eH.onPlay()},n.prototype.pb=function(){var e=this;e.GH("onPlaying")},n.prototype.AH=function(){var e=this;e.qH=!0,e.GH("onPause"),e.eH.onPause()},n.prototype.je=function(e){var t=this,r=e.target.currentTime,n=!t.l.live,i=!1,a=t.l.userAgent;a&&a.safariDesktop&&(i=!t.l.live||t.vH),t.dH.onSeeking(n,i),t.vH=!1,t.GH("onSeeking",[r])},n.prototype.ke=function(e){var t=this,r=e.target.currentTime;t.GH("onSeeked",[r])},n.prototype.BH=function(){var e=this;e.gH.stop(),e.GH("onComplete")},n.prototype.tb=function(){var e=this,t=e._node.error?e._node.error.code:null;e.GH("onError",[t]),e.dH.onError()},n.prototype.DH=function(){var e=this;e.l.setDimensions()},n.prototype.CH=function(){var e=this;e.HH("onTimeUpdate")},n.prototype.fq=function(){var e=this;e.mediaLoaded&&e.HH("onUpdate")},n.prototype.HH=function(e){var t=this;t.dH.process();var r={currentTime:t._node.currentTime,bufferedAndPending:t.dH.getBufferedAndPending(),bufferLength:t.l.getBufferLength(),pendingBufferLength:t.dH.getPendingBufferLength(),bufferedRanges:t.l.getBufferedDto(),dimensions:t.l.getDimensions(),pixelRatio:t.l.getPixelRatio(),frameStats:t.eH.getFpsStats()};t.GH(e,[r])},n.prototype.IH=function(){var e=this;e.mediaLoaded=!0,e.NG&&"closed"===e.NG.readyState||(e.gH.start(),e.hH.length&&e.EH())},n.prototype.FH=function(e,t){var r=this;r.aH=e,r.tH=_.SYNCH_BEGIN,r.uH=t,r.l.live&&(r.dH.resetReadyState(),r.dH.clear())},n.prototype.JH=function(e){var t=this;t.aH=null,t.tH=_.SYNCH_DONE,t.uH=null,t.l.live&&t.GH("onSynchComplete",[e])},n.prototype.EH=function(){var e=this,t=e.hH;e.hH=[],t.forEach(function(e){var t=e[0],r=e[1],n=e.length>2?e[2]:null;r&&"function"==typeof r&&r.apply(t,n)})},n.prototype.GH=function(e,t){var r=this;r.jH&&r.lH?r.oH(a.CALL_METHOD,t,e):r.tc[e].apply(r.tc,t)},n.prototype.mH=function(e){var t=this;if(!e)return null;if(t.jH&&"undefined"!=typeof Worker)try{return t.lH||(t.lH=u(c)),t.lH}catch(e){}return null},n.prototype.nH=function(e){var t=this;if(e){var r=e.data?new h(e.data):e;if(r&&r.instanceId===t.$G){var n=r.getParam("media");if(n&&t.l.update(n),r.type===o.EVENT)return void t.KH(r.id,r.getParam("eventData"));switch(r.id){case a.CREATE_SRC_BUFFER:t.LH(r.getParam("tracks"));break;case a.APPEND_SRC_BUFFER:t.MH(r.getParam("tracks"));break;case a.SAVE_AVG_BANDWIDTH:t.NH(r.getParam("avgBwInfo"));break;case a.END_OF_STREAM:r.args&&r.args.length&&(t.dH.endOfStream(r.getParam("endOfStream")),t.MG.sendEvent(m.CONTENT_LOAD_FINISHED,r.args[0]));break;case a.PAUSE_BEFORE_STREAM_CHANGE:t.OH(r.getParam("streamType"));break;case a.PLAY_AFTER_STREAM_CHANGE:t.PH();break;case a.DRM_INIT:t.wH||(t.wH=new b(t.tc,t._node,t.MG));for(var i=0;i<t.l.drmInfo.length;i++)t.wH.addDrmItem(t.l.drmInfo[i]);break;case a.DRM_LICENSE_INFO:t.wH&&t.wH.addDrmItem(r.getParam("drmItem"));break;case a.SKIP_GAP:t._node.currentTime=r.getParam("seekPosition")}}}},n.prototype.pH=function(e){var t=this;e.instanceId=t.$G,t.nH(e)},n.prototype.KH=function(e,t){var r=this;if(e){switch(e){case m.MEDIA_LOADED:r.IH();break;case m.WAITING:var n=t?t.minBufferTime:.1;r.dH.setMinimumBufferTime(n),r.eH.updateBufferingInfo(t);break;case m.LIVE_SYNCH:var i=t?t.synchPosition:null,a=t?t.synchType:g.INIT;r.FH(i,a);break;case m.SEG_INFO_METRICS_AVAILABLE:t={segInfo:t,bufferLen:r.l.getBufferLength(),sessionId:r.bH};break;case m.VTT_SEGMENT_LOADED:t&&(t.sessionId=r.bH);break;case m.MEDIA_METADATA_LOADED:t=r.l.streams;break;case m.ERROR:return t.error=new Error(t.message,t.code),void r.MG.notifyError(t)}r.MG.sendEvent(e,t)}},n.prototype.LH=function(e){var t=this;if(e){if(t.NG&&("closed"===t.NG.readyState||!t.mediaLoaded))return void t.hH.push([t,t.LH,[e]]);t.QH(),e.forEach(function(e){t.dH.createSourceBuffer(e.type,e.mimeType,e.minBufferTime)})}},n.prototype.QH=function(){var e=this;e.NG&&!e.NG.duration&&e.l.duration>0&&(e.NG.duration=e.l.duration)},n.prototype.MH=function(e){var t=this;e&&(e.forEach(function(e){t.dH.appendBuffer(e,function(e,r){e&&console.error("[ControllerFacade] Error in appendBuffer Err = "+e.toString()),t.WG(e,r)})}),t.l.preloading&&!t._G&&(t.MG.sendEvent(m.PRELOAD_PROGRESS),t._G=!0))},n.prototype.WG=function(){var e=this;if(!e.l.live&&e.tH===_.SYNCH_BEGIN){if(!e.dH.areSrcBuffersReady())return;return e.dH.onSeeking(!0),e.tH=_.SYNCH_METADATA_READY,void e.GH("onSynchMetadataReady",[e.aH])}if(e.aH&&e.dH.areSrcBuffersReady()){var t=e.RH(e._node),r=e._node.buffered;if(t.length&&r.length){var n=t.start(t.length-1),i=t.end(t.length-1),a=e.l.TIMESTAMP_COMPARE_EPSILON;if(e.aH+a>=n&&e.aH<=i){for(var o=e.aH,s=0;s<r.length;s++)if(!(o>r.end(s))&&o<r.start(s)){o=r.start(s);break}var l=e.l.userAgent;e.vH=l&&l.safariDesktop&&e.l.live&&e.uH===g.TIME_GAP;try{e._node.currentTime=o}catch(e){}e.JH(o)}}}},n.prototype.oH=function(e,t,r){var n=this;if(n.lH&&e){var i={type:o.MESSAGE,id:e,moduleName:n.ZG,instanceId:n.$G,funcName:r,args:t,timestamp:Date.now()};n.lH.postMessage(i)}},n.prototype.iH=function(){var e=this,t=e.fH.readProperty("avgBW"),r=t?t.avgBWtimestamp:null,n=r?Date.now()-parseInt(r):Number.MAX_VALUE;if(n<1e3*e.l.config.bwHistoryMaxAge&&t){var i=t.avgBW;return i?parseInt(i):0}return 0},n.prototype.NH=function(e){var t=this;e&&t.fH&&t.fH.writeProperty("avgBW",e)},n.prototype.PH=function(){var e=this;e.rH&&(e.vf(),e.rH=!1,e.MG.sendEvent(m.WAITING,{value:!1,bufferInit:!1}))},n.prototype.OH=function(e){var t=this,r=t._node.currentTime,n=t.l.live;n&&"audio"===e?t.dH.clearSrcBuffer(e):t.dH.clear(),t.qH||(t.MG.sendEvent(m.WAITING,{value:!0,bufferInit:!1}),t._node.pause(),t.rH=!0),n?t.sH=r:t._node.currentTime=r},n.prototype.vf=function(){var e=this;if(e._node){var t=e._node.play();return t&&"function"==typeof t.catch&&t.catch(function(){e._node.paused&&e.MG.sendEvent(m.PLAY_BLOCKED)}),t}},n.prototype.getCurrentDate=function(){var e=this;return e.l.getCurrentDate()},n.prototype.RH=function(e){var t=this,r=t.l.userAgent;return t.l.live&&r.edge&&r.edge>=17&&r.edge<18?e.buffered:e.seekable}},{"../../../lib/hls-utils":145,"../../../lib/localstoragehandler":148,"../../../lib/timer":150,"../../event":185,"../../services/playback-metrics":221,"../../worker-utils/message":229,"../../worker-utils/worker-bridge":230,"../../worker-utils/worker-defs":231,"../worker-scope/controller":173,"../worker-scope/license-manager":176,"../worker-scope/streamer":179,"./buffer-controller":166,"./video-event-handler":170,webworkify:247}],168:[function(e,t,r){"use strict";t.exports={ERROR:-1,INITIAL:0,MEDIA_METADATA_LOADING:1,MEDIA_METADATA_LOADED:2,STREAM_METADATA_LOADING:3,STREAM_METADATA_LOADED:4,MEDIA_LOADED:5,PRELOADING:6,PLAY_REQUESTED:7,PLAYING:8,PAUSED:9,PLAY_COMPLETE:10}},{}],169:[function(e,t,r){"use strict";function n(e,t,r){var n=this;n._node=n.MG.node,n.SH=!1,n.type=t,n.mimeType=r,n.NG=e,n.buffer=e.addSourceBuffer(r),n.TH=[],n.UH=[],n.VH=[],n.WH=!1,n.XH=i,n.ready=!1,n.TIMESTAMP_COMPARE_EPSILON=.065,n.GOP_LENGTH=2,n.YH=n.ZH.bind(n),n.buffer.addEventListener("updateend",n.YH),n.$H=function(){n.abort()},n.buffer.addEventListener("error",n.$H),n.state="open"}t.exports=n;var i=.1,a={APPEND:"append",REMOVE:"remove"};n.prototype.destroy=function(){var e=this;e.remove(),e.TH=[],e.UH=[],e.VH=[],e.state="closed"},n.prototype.remove=function(){var e=this;e.SH||(e.SH=!0,e.abort(),e.buffer.removeEventListener("updateend",e.YH),e.buffer.removeEventListener("error",e.$H),"closed"!==e.NG.readyState&&e.NG.removeSourceBuffer(e.buffer))},n.prototype.setMinBufferTime=function(e){var t=this;t.XH=Math.max(i,e)},n.prototype.appendBuffer=function(e,t,r,n,i){var o=this;if(!o.SH){var s={type:a.APPEND,cb:i,buffer:e,startTime:t,endTime:r,time:r-t,onlyMetadata:n||!1};o.TH.push(s),o._H()}},n.prototype.clearBuffer=function(e,t,r){var n=this;if(n.SH||e>=t)return r("["+n.constructor.name+"] Invalid remove buffer call");var i={type:a.REMOVE,cb:r,startTime:e,endTime:Math.round(1e3*parseFloat(t))/1e3};n.UH.push(i),n._H()},n.prototype.abort=function(){var e=this;if("open"===e.NG.readyState&&!e.SH){e.TH=[],e.UH=[],e.VH=[];try{e.buffer.abort()}catch(e){}}},n.prototype.clearAll=function(){var e=this;if("closed"!==e.NG.readyState&&!e.SH){e.abort();try{var t=e.buffer.buffered,r=t.length?t.start(0):0,n=t.length?t.end(t.length-1):0;n>r&&e.buffer.remove(r,n)}catch(e){}}},n.prototype.setEndOfStream=function(e){var t=this;t.WH=e,t.SH||(e?(t.aI(),t._H()):t.state=t.TH.length?t.state:"empty")},n.prototype.aI=function(){var e=this;e.WH&&"empty"===e.state&&!e.VH.length&&(e.state="closed")},n.prototype.ZH=function(){var e=this;if(!e.SH){if(e.ready=!0,e.VH.length){var t=e.VH.shift();t.cb(null,e)}e.TH.length||(e.state="empty"),e._H(),e.aI()}},n.prototype._H=function(){for(var e=this;e.UH.length;){if(e.buffer.updating)return;e.bI(e.UH.shift())}for(;e.TH.length;){if(e.buffer.updating)return;var t=e.getBufferLength()+e.getTotalPendingBufferLength(),r=e.TH.length&&e.TH[0]&&e.TH[0].onlyMetadata;
if(!e.WH&&t<e.XH&&!r)return;e.bI(e.TH.shift())}},n.prototype.bI=function(e){var t=this;if(e&&e.type)try{e.type===a.APPEND?t.buffer.appendBuffer(e.buffer):e.type===a.REMOVE&&t.buffer.remove(e.startTime,e.endTime),t.VH.push(e),t.state="updating"}catch(n){if("QuotaExceededError"===n.name){var r=t.cI();r&&e.type===a.APPEND&&t.TH.unshift(e)}}},n.prototype.cI=function(){var e=this,t=e._node.buffered,r=t.length>0?t.start(0):NaN,n=e._node.currentTime-e.GOP_LENGTH;return n>r&&(e.buffer.remove(r,n),!0)},n.prototype.getTotalPendingBufferLength=function(){var e=this,t=0;return e.TH.forEach(function(e){e&&e.time&&(t+=e.time)}),t},n.prototype.getBufferLength=function(){var e,t=this,r=t.MG.node,n=t.TIMESTAMP_COMPARE_EPSILON,i=0,a=r.currentTime,o=null;try{o=t.buffer.buffered;for(var s=0;o&&s<o.length;s++)if(a+n>=o.start(s)&&a<o.end(s)){e=s;break}e>=0&&o&&o.length&&(i=o.end(e)-a)}catch(e){}return i}},{}],170:[function(e,t,r){"use strict";function n(e,t,r){var n=this;e&&t&&r&&(n._node=e,n.Va=r,n.NG=t,n.dI())}t.exports=n,n.prototype.destroy=function(){var e=this;e.eI()},n.prototype.dI=function(){var e=this;e.cH=e.fI.bind(e),e.gI=["play","playing","pause","seeking","seeked","ended","error","timeupdate"],e.gI.forEach(function(t){e._node.addEventListener(t,e.cH)}),e.hI=e.iI.bind(e),e.NG.addEventListener("sourceopen",e.hI),window.addEventListener("resize",e.cH)},n.prototype.eI=function(){var e=this;e.gI.forEach(function(t){e._node.removeEventListener(t,e.cH)}),e.NG.removeEventListener("sourceopen",e.hI),window.removeEventListener("resize",e.cH)},n.prototype.fI=function(e){var t=this;t.Va.sendVideoEvent(e)},n.prototype.iI=function(e){var t=this;t.Va.onMediaSourceOpen(e)}},{}],171:[function(e,t,r){"use strict";function n(e,t){var r=this;r.jI(e,t)}function i(e,t){var r=this;r.jI(e,t)}t.exports.AacStreamer=n,t.exports.AacLiveStreamer=i;var a=e("../../../lib/hls-utils"),o=e("./streamer").Streamer,s=e("./live-streamer"),l=e("../../worker-utils/worker-defs"),c=e("../../../lib/index");a.inherits(n,o),a.inherits(i,s),i.prototype.jI=n.prototype.jI=function(e,t){var r=this;r.constructor.super_.call(r,e,t),r.aG=r.constructor.super_.prototype,r.processOnlyMetadata=!1,r.lastAudioTimestamp=NaN,r.lastAudioFrameDuration=NaN,r.primary=!1,r.kI="mp4a.40.2",r.lI="audio",r.mI();var n=[{type:r.lI,mimeType:r.lI+'/mp4; codecs="'+r.kI+'"',minBufferTime:r.__controller.getMinimumBufferTime()}];r.__controller.sendMessage(l.MessageIds.CREATE_SRC_BUFFER,[n],["tracks"]),r.nI=r.STATES.INITIALIZED},i.prototype.destroy=n.prototype.destroy=function(){var e=this;e.aG.destroy.call(e)},i.prototype.onSeeking=n.prototype.onSeeking=function(e){var t=this;t.lastAudioTimestamp=NaN,t.aG.onSeeking.call(t,e)},i.prototype.onSwitchBegin=n.prototype.onSwitchBegin=function(){var e=this;e.mI(),e.aG.onSwitchBegin.call(e)},i.prototype.onManualStreamChange=n.prototype.onManualStreamChange=function(){var e=this;e.mI(),e.lastAudioTimestamp=NaN,e.aG.onManualStreamChange.call(e)},i.prototype.oI=n.prototype.oI=function(){var e=this;e.mI()},i.prototype.pI=n.prototype.pI=function(e){var t=this;if(!t.isActive())return null;var r=t.fp,n=r.getSegmentfromSeqNum(e);return{segment:n,stream:r,state:{mp4:t.qI,lastAudioTimestamp:t.lastAudioTimestamp,lastAudioFrameDuration:t.lastAudioFrameDuration},onlyMetadata:t.processOnlyMetadata}},i.prototype.onSegmentLoadProgress=n.prototype.onSegmentLoadProgress=function(e,t,r){var n=this;if(t){var i=t.getParam?t.getParam("parsedInfo"):null;i&&(c.isNumber(i.lastAudioTimestamp)&&(n.lastAudioTimestamp=i.lastAudioTimestamp),c.isNumber(i.lastAudioFrameDuration)&&(n.lastAudioFrameDuration=i.lastAudioFrameDuration)),n.aG.onSegmentLoadProgress.call(n,e,t,r)}},i.prototype.mI=n.prototype.mI=function(){var e=this;e.qI={video:{shouldInit:!0,seqNum:0},audio:{shouldInit:!0,seqNum:0}}},i.prototype.rI=n.prototype.rI=function(e,t){},i.prototype.sI=function(e){var t=this;t.lastAudioTimestamp=NaN,t.isActive()&&t.aG.sI.call(t,e)}},{"../../../lib/hls-utils":145,"../../../lib/index":146,"../../worker-utils/worker-defs":231,"./live-streamer":177,"./streamer":179}],172:[function(e,t,r){"use strict";function n(){var e=this;e.l=e.__controller.model,e.tI=!1,e.Nn=!1,e.mp=NaN,e.uI=NaN,e.vI={},e.qH=!0,e.qp=-1,e.MIN_BUFFER_TO_PLAY=1,e.MIN_TIME_TO_BUFFER_CHECK=150,e.BUFFER_REPORT_THRESHOLD=20,e.MIN_BUFFER_TIME_UPPER_BOUND=5,e.WEIGHT=.5,e.CHROME_BUFFER_GAP_EPSILON=.15,e.wI=!0,e.gk=!1,e.xI()}t.exports=n;var i=e("./../../event").HLSEvent,a=e("../../worker-utils/worker-defs");n.prototype.onPlayRequested=function(){var e=this;e.yI()},n.prototype.destroy=function(){},n.prototype.checkBuffering=function(e){var t=this,r=t.l.bufferLength,n=t.l.currentTime,i=t.l.duration;if(!(isFinite(i)&&n+.05>i)){var a=t.Rp();!e&&a<t.MIN_TIME_TO_BUFFER_CHECK||(!(r<=.02||t.zI===n&&r<t.MIN_BUFFER_TO_PLAY)||t.qH||t.l.preloading||t.tI?!isNaN(t.mp)&&n>t.mp?t.AI():!t.qH&&t.zI===n&&t.l.getTotalBufferLength()>t.MIN_BUFFER_TO_PLAY&&t.BI():t.yI(),t.zI=n,t.up=Date.now())}},n.prototype.onPlaying=function(){var e=this;e.qH=!1},n.prototype.onPause=function(){var e=this;e.qH=!0,e.tI&&(e.vI.bufferInit=!0,e.AI())},n.prototype.onSeeking=function(){var e=this;e.gk=!0},n.prototype.onSeeked=function(){var e=this;e.gk=!1},n.prototype.onTimeUpdate=function(){var e=this;e.tI&&e.checkBuffering(!0)},n.prototype.onVideoSync=function(e){var t=this;t.zI=e},n.prototype.onError=function(){var e=this;e.tI&&e.AI()},n.prototype.onComplete=function(){var e=this;e.tI&&e.AI(),e.xI()},n.prototype.BI=function(){var e=this;if(!(e.l.bufferedRanges.length<2)){var t=e.l.TIMESTAMP_COMPARE_EPSILON,r=e.l.currentTime;e.l.userAgent&&e.l.userAgent.chrome&&(r-=3);for(var n=e.l.bufferedRanges.ranges,o=0;o<n.length-1;o++){var s=n[o],l=n[o+1];if(l.start-s.end>e.l.config.skipGapLimit)e.l.currentTime!==e.uI&&(e.__controller.sendEvent(i.BUFFER_GAP_DETECTED,l.start-s.end),e.uI=e.l.currentTime);else{var c=s.end-t-(e.l.userAgent.chrome?e.CHROME_BUFFER_GAP_EPSILON:0),u=l.start;r>c&&r<u&&e.__controller.sendMessage(a.MessageIds.SKIP_GAP,[l.start],["seekPosition"])}}}},n.prototype.yI=function(){var e=this;if(!e.tI){e.tI=!0;var t=e.getMinimumBufferTime();e.CI(),e.mp=e.l.currentTime,e.gk&&(e.wI=!0),e.vI={value:e.tI,bufferInit:e.wI,minBufferTime:t},e.__controller.sendEvent(i.WAITING,e.vI)}},n.prototype.AI=function(){var e=this;e.tI&&(e.tI=!1,e.mp=NaN,e.vI={value:!1,waitTime:e.DI(),bufferInit:e.wI,minBufferTime:.1},e.__controller.sendEvent(i.WAITING,e.vI),e.vI={},e.wI=!1)},n.prototype.getMinimumBufferTime=function(){var e=this,t=.1,r=e.__controller.services.bandwidthEstimator.instantaneousBandwidth,n=e.l.getCurrentLoadingStream(),i=n?n.bitrate/1e6:0,a=e.l.config.minBufferTime;a=e.l.live?a.live:a.vod;var o=e.l.config.variableMinBuffer;return t=o&&i&&!isNaN(r)?e.EI(r/i,a):a},n.prototype.EI=function(e,t){var r=this,n=r.MIN_BUFFER_TIME_UPPER_BOUND;if(t>=n)return t;var i=Math.max(t,0);if(e>=1)return i;var a=e*n;return 1*Math.max(i,n-a*r.WEIGHT).toFixed(1)},n.prototype.Rp=function(){var e=this,t=Date.now();return e.up=e.up||t,t-e.up},n.prototype.CI=function(){var e=this,t=e.Rp(),r=e.FI();e.jk=Date.now()-Math.max(t-r,0)},n.prototype.DI=function(){var e=this,t=e.FI(),r=Math.max(Date.now()-e.jk-t,0);return e.vI.bufferInit?0:r<e.BUFFER_REPORT_THRESHOLD?0:r},n.prototype.FI=function(){var e=this,t=0;return e.zI&&(t=1e3*(e.l.currentTime-e.zI).toFixed(3)),t},n.prototype.xI=function(){var e=this;e.up=null,e.zI=null},n.prototype.isBuffering=function(){var e=this;return e.tI}},{"../../worker-utils/worker-defs":231,"./../../event":185}],173:[function(e,t,r){"use strict";function n(e,t){var r=this;y.call(r,r.constructor.name),r.GI=e,r.HI=t,r.model=r.create(E,e),r.services=r.create(g),r.II=r.services.metadataParser,r.JI=r.create(f),r.KI=r.create(l),r.LI=r.create(u),r.nI=m.INITIAL,r.FF={},r.MI=r.GI.config.inWorkerScope,r.dI(),r.gk=!1,r.NI=!1,r.OI=new v(250),r.OI.addEventListener(r.QI,r),r.initialize()}t.exports=n;var i=e("../../event"),a=i.HLSEvent,o=e("../../error"),s=e("./streaming-controller"),l=s.StreamingController,c=s.Events,u=e("./buffer-monitor"),p=e("../../model/worker-scope/model").MetadataTypes,d=e("../../command/command").CmdNames,f=e("../../command/command-manager"),v=e("../../../lib/timer"),m=e("../main/controller-states"),y=e("../../../lib/event-bus"),h=e("../../../lib/hls-utils"),E=e("../../model/worker-scope/model").Model,g=e("../../services/services"),b=e("../../worker-utils/worker-defs"),_=e("../../worker-utils/message"),A=e("user-agent").userAgent;h.inherits(n,y),n.prototype.create=function(){var e=this,t=Array.prototype.slice.call(arguments),r=t.shift(),n=Object.create(r.prototype);return n.__controller=e,r.apply(n,t),n},n.prototype.destroy=function(){var e=this;e.KI&&(e.KI.destroy(),e.KI=null),e.LI&&(e.LI.destroy(),e.LI=null),e.JI&&(e.JI.destroy(),e.JI=null),e.services&&(e.services.destroy(),e.services=null),e.OI&&(e.OI.destroy(),e.OI=null),e.nI=m.INITIAL,e.removeEventListeners(e.FF),y.prototype.destroy.call(e)},n.prototype.initialize=function(){var e=this;e.RI()},n.prototype.getSegInfo=function(){var e=this,t=e.KI.getMetrics();return e.MI&&e.sendEvent(a.SEG_INFO_METRICS_AVAILABLE,t),t},n.prototype.sendEvent=function(e,t){var r=this;r.publish(e,t);var n=r.create(_,{type:b.MessageTypes.EVENT,id:e,args:[t],argNames:["eventData"]});r.SI(n)},n.prototype.sendMessage=function(e,t,r,n){var i=this,a=i.create(_,{type:b.MessageTypes.MESSAGE,id:e,args:t,argNames:r});i.SI(a,n)},n.prototype.notifyError=function(e){var t=this;t.error=e;var r=t.nI;r!==m.ERROR&&t.TI(m.ERROR),r!==m.PAUSED&&t.sendEvent(a.ERROR,"HlsError"===t.error.constructor.name?t.error.dto():t.error)},n.prototype.SI=function(e,t){var r=this;e&&r.HI&&(e.addMedia(),r.HI(e,t))},n.prototype.dI=function(){var e=this;e.KI.addEventListener(c.STREAM_METADATA_LOADED,e.UI,e),e.KI.addEventListener(c.STREAM_METADATA_LOAD_ERROR,e.VI,e),e.KI.addEventListener(c.PRELOAD_COMPLETE,e.si,e),e.KI.addEventListener(c.SEG_LOAD_PROGRESS,e.WI,e)},n.prototype.XI=function(e){},n.prototype.TI=function(e,t){var r=this;r.XI(e),r.nI=e,r.sendEvent(a.STATE_CHANGED,e),r.YI(t)},n.prototype.getState=function(){var e=this;return e.nI},n.prototype.YI=function(e){var t=this;switch(t.nI){case m.MEDIA_METADATA_LOADING:t.ZI();break;case m.MEDIA_METADATA_LOADED:if(t.sendEvent(a.MEDIA_METADATA_LOADED),t.model.isDash()){t.sendMessage(b.MessageIds.DRM_INIT),t.TI(m.MEDIA_LOADED);break}t.TI(m.STREAM_METADATA_LOADING);break;case m.STREAM_METADATA_LOADING:t.KI.loadStream(t.model.getCurrentLoadingStream());break;case m.STREAM_METADATA_LOADED:t.TI(m.MEDIA_LOADED);break;case m.MEDIA_LOADED:if(A.android&&A.chrome&&t.model.drmInfo&&t.model.drmInfo.length)return;t.$I();break;case m.PRELOADING:t.KI.onPreloadBegin(),t.sendEvent(a.PRELOAD_START),t.OI.start();break;case m.PLAY_REQUESTED:t.OI.start(),t.KI.onPlay(e),t.NI||(t.LI.onPlayRequested(),t.NI=!0);break;case m.PLAYING:t.KI.onPlaying();break;case m.PLAY_COMPLETE:t.OI.stop(),t.KI.onComplete(),t.LI.onComplete();break;case m.ERROR:t.OI.stop(),t.KI.onError(),t.JI.removeAllCommands(),t.LI.onError()}},n.prototype.RI=function(){var e=this,t=e.model.metadata;if(e.nI===m.INITIAL)return t.type===p.STRUCTURED?(e.model.build(e.II.parse(t)),void(t.hasStreamMetadata?t.hasSubtitleMetadata?e.KI.loadAllSubtitleStreams():e.TI(m.MEDIA_LOADED):t.hasMediaMetadata&&e.TI(m.MEDIA_METADATA_LOADED))):void e.TI(m.MEDIA_METADATA_LOADING)},n.prototype.QI=function(){var e=this;e.nI<m.MEDIA_LOADED||(e.LI.checkBuffering(),e.KI.process())},n.prototype.onPlay=function(e){var t=this;t.nI===m.ERROR&&t.error&&t.notifyError(t.error),t.nI<m.MEDIA_LOADED||(t.nI===m.PRELOADING&&(t.KI.onPreloadEnd(),this.sendEvent(a.PRELOAD_COMPLETE)),t.TI(m.PLAY_REQUESTED,e))},n.prototype.onPlaying=function(){var e=this;e.nI<m.MEDIA_LOADED||(e.TI(m.PLAYING),e.LI.onPlaying())},n.prototype.onPause=function(){var e=this;e.nI<m.MEDIA_LOADED||(e.KI.onPause(),e.LI.onPause(),e.TI(m.PAUSED))},n.prototype.onSeeking=function(e){var t=this;t.nI<m.MEDIA_LOADED||(t.gk=!0,t.KI.onSeeking(e),t.LI.onSeeking())},n.prototype.onSeeked=function(e){var t=this;t.nI<m.MEDIA_LOADED||(t.gk=!1,t.KI.onSeeked(e),t.LI.onSeeked())},n.prototype.onComplete=function(){var e=this;e.nI<m.MEDIA_LOADED||e.TI(m.PLAY_COMPLETE)},n.prototype.onError=function(e){var t=this;t.TI(m.ERROR)},n.prototype.onTimeUpdate=function(e){var t=this;t._I(e),t.LI.onTimeUpdate(),t.KI.onTimeUpdate(t.model.currentTime)},n.prototype.onUpdate=function(e){var t=this;t._I(e),t.LI.onTimeUpdate()},n.prototype.onSynchComplete=function(e){var t=this;t.KI.onSynchComplete(),t.LI.onVideoSync(e)},n.prototype.onSynchMetadataReady=function(e){var t=this;t.KI.onSynchMetadataReady(e)},n.prototype._I=function(e){var t=this;e&&(t.model.currentTime=e.currentTime,t.model.bufferedAndPending=e.bufferedAndPending,t.model.bufferLength=e.bufferLength,t.model.pendingBufferLength=e.pendingBufferLength,t.model.bufferedRanges=e.bufferedRanges,t.model.dimensions=e.dimensions,t.model.pixelRatio=e.pixelRatio,t.services.segmentMetrics.updateFrameStats(e.frameStats))},n.prototype.ZI=function(){var e=this,t=e.model.getMediaUrl(),r=t&&t.indexOf(".mpd")!==-1,n={url:t,withResponseHeaders:r};e.JI.executeCommand(d.CMD_MEDIA_LOAD,n,e)},n.prototype.onMediaLoadComplete=function(e,t){var r=this;if(e){if(!t)return void r.JI.removeCommand(e);var n={rawData:t.data,headers:t.headers,type:p.RAW,url:e.data?e.data.url:"",cdn:r.model.getMediaCdn()};r.model.build(r.II.parse(n)),r.JI.removeCommand(e),r.TI(m.MEDIA_METADATA_LOADED)}},n.prototype.onMediaLoadError=function(e,t){var r=this;e&&r.JI.removeCommand(e),t&&1===t.code&&(r.TI(m.ERROR),r.notifyError(new o.Error(o.ERR_PLAYLIST_LOAD)))},n.prototype.UI=function(){var e=this;e.nI<m.MEDIA_LOADED&&e.TI(m.STREAM_METADATA_LOADED)},n.prototype.VI=function(){var e=this;e.TI(m.ERROR),e.notifyError(new o.Error(o.ERR_PLAYLIST_LOAD))},n.prototype.si=function(){var e=this;e.nI===m.PRELOADING&&(e.TI(m.MEDIA_LOADED),e.sendEvent(a.PRELOAD_COMPLETE)),e.OI.reset()},n.prototype.WI=function(){var e=this;e.LI.isBuffering()&&e.sendEvent(a.BUFFER_GROWTH_DETECTED)},n.prototype.aJ=function(e){for(var t=Object.keys(m),r=0;r<t.length;r++)if(e===m[t[r]])return t[r]},n.prototype.preload=function(e){var t=this;e&&(t.model.config.preloadBufferLimit=e,t.model.bufferLength+t.model.pendingBufferLength<e&&t.nI===m.MEDIA_LOADED&&t.TI(m.PRELOADING))},n.prototype.setABRMode=function(e){var t=this;t.nI<m.MEDIA_LOADED||t.KI.setABRMode(e)},n.prototype.setAudioLanguage=function(e){var t=this;t.nI<m.MEDIA_LOADED||t.KI.setAudioLanguage(e)},n.prototype.getMinimumBufferTime=function(){var e=this;return e.LI.getMinimumBufferTime()},n.prototype.suspendStreaming=function(){var e=this;e.OI.stop(),e.KI.suspendStreaming()},n.prototype.resumeStreaming=function(){var e=this;e.nI!==m.PRELOADING&&e.nI!==m.PLAY_REQUESTED&&e.nI!==m.PLAYING&&e.nI!==m.PAUSED||(e.KI.resumeStreaming(),e.OI.start())},n.prototype.$I=function(){var e=this;e.KI.isInitialized()||(e.KI.init(),e.sendEvent(a.MEDIA_LOADED),!e.model.live&&e.model.bufferLength+e.model.pendingBufferLength<e.model.config.preloadBufferLimit&&e.TI(m.PRELOADING))},n.prototype.onGenerateRequestComplete=function(){var e=this;e.$I()}},{"../../../lib/event-bus":144,"../../../lib/hls-utils":145,"../../../lib/timer":150,"../../command/command":158,"../../command/command-manager":157,"../../error":184,"../../event":185,"../../model/worker-scope/model":201,"../../services/services":224,"../../worker-utils/message":229,"../../worker-utils/worker-defs":231,"../main/controller-states":168,"./buffer-monitor":172,"./streaming-controller":180,"user-agent":233}],174:[function(e,t,r){"use strict";function n(e,t){var r=this;s.call(r,e,t),r.aG=r.constructor.super_.prototype,r.bJ=null,r.cm(e)}function i(e,t){var r=this;o.call(r,e,t),r.aG=r.constructor.super_.prototype,r.bJ=null,r.cm(e),r.SEGMENT_OFFSET=7}t.exports.Fmp4Streamer=n,t.exports.Fmp4LiveStreamer=i;var a=e("../../../lib/hls-utils"),o=e("./live-streamer"),s=e("./streamer").Streamer,l=e("../../command/command").CmdNames,c=e("../../model/worker-scope/stream").StreamTypes,u=e("../../worker-utils/worker-defs"),p=e("../../model/worker-scope/model").StreamingMode,d=e("../../../lib/index"),f="mp4a.40.2",v="mp4a.40.2",m="avc1.640021";a.inherits(n,s),a.inherits(i,o),n.prototype.destroy=function(){var e=this;s.prototype.destroy.call(e)},i.prototype.destroy=function(){var e=this;o.prototype.destroy.call(e)},i.prototype.cm=n.prototype.cm=function(e){var t=this;t.cJ(e);var r=[{type:t.lI,mimeType:t.lI+'/mp4; codecs="'+t.kI+'"',minBufferTime:t.__controller.getMinimumBufferTime()}];t.__controller.sendMessage(u.MessageIds.CREATE_SRC_BUFFER,[r],["tracks"])},i.prototype.cJ=n.prototype.cJ=function(e){var t=this;e.type===c.AUDIO?(t.kI=t.l.userAgent.android?f:e.audioCodec||v,t.lI="audio"):(t.kI=e.videoCodec||m,t.lI="video")},i.prototype.setCurrentStream=n.prototype.setCurrentStream=function(e){var t=this;e&&t.fp&&!e.equals(t.fp)&&(t.fp=e,t.nI===t.STATES.LOADING&&t.abortCurrentSegment(t.dJ),t.isStreamReady()||(t.nI=t.STATES.NONE))},i.prototype.eJ=n.prototype.eJ=function(e,t,r,n){var i=this,a=i.fp;i.JI.removeRelatedCommands(l.CMD_MP4_INIT_SEGMENT_LOAD);var o={stream:a,segment:t,initSegment:e,comboLoad:r,cached:n};i.JI.executeCommand(l.CMD_MP4_INIT_SEGMENT_LOAD,o,i)},i.prototype.fJ=n.prototype.fJ=function(e){var t=this;if(!(t.nI>=t.STATES.INITIALIZING)){var r=d.isNullOrUndefined(e)?t.gJ(t.hJ):e,n=t.fp,i=r===n.startSeqNum,a=n.getSegmentfromSeqNum(r);if(a){var o=n.getInitSegment(a),s=!d.isNullOrUndefined(o);s||(o=n.addInitSegment(a.initSegment));var l=n.streamingMode===p.HLS&&!d.isNullOrUndefined(n.mp4Chunks.first);l&&(a=i?a:null),t.nI=t.STATES.INITIALIZING,a&&a.periodId!==t.bJ&&t.iJ(a.periodId),t.jJ(a?a.periodId:null),t.eJ(o,a,l,s)}}},i.prototype.onMp4InitSegmentLoadProgress=n.prototype.onMp4InitSegmentLoadProgress=function(e,t){var r=this,n=r.fp;if(t&&n){var i=e.getSegment();if(t.comboLoad&&i&&"firstByte"===t.position)return void r.onSegmentLoadProgress(e,t);var a=t.chunk,o=t.stream;if(a&&o){var s=o.getInitSegment(i);switch(a.name){case"init":o.setMp4Timescale(s);break;case"sidx":var l=a.data;l&&o.updateSegmentRanges(r.kJ.mp4BoxParser.parse(l,"sidx",o.sidxOffset));break;case"first":return void r.onSegmentLoadProgress(e,t)}n.equals(o)&&o.isReady()&&(r.lJ(s),r.nI=r.STATES.INITIALIZED,t.comboLoad&&i&&(r.Qj=i.seqNum,r.nI=r.STATES.LOADING))}}},i.prototype.onMp4InitSegmentLoadComplete=n.prototype.onMp4InitSegmentLoadComplete=function(e,t){var r=this;if(t){var n=e.getSegment();t.comboLoad&&n?r.onSegmentLoadComplete(e):(r.nI<r.STATES.INITIALIZED&&r.fp.equals(t.stream)&&(r.nI=r.STATES.INITIALIZED),r.JI.removeCommand(e))}},i.prototype.onMp4InitSegmentLoadError=n.prototype.onMp4InitSegmentLoadError=function(e,t){var r=this;r.JI.removeCommand(e)},i.prototype.onSegmentLoadProgress=n.prototype.onSegmentLoadProgress=function(e,t){var r=this,n=r.fp;if(t&&n){var i=t.stream;if(!i||n.equals(i)){if("firstByte"!==t.position){var a={data:new Uint8Array(t.data),codec:r.kI,type:r.lI,minBufferTime:r.__controller.getMinimumBufferTime(),frames:t.samples,startTime:n.timescale>0?t.baseTime/n.timescale:NaN,endTime:n.timescale>0?(t.baseTime+t.totalDuration)/n.timescale:NaN};r.mJ([a])}s.prototype.onSegmentLoadProgress.call(r,e,t)}}},i.prototype.iJ=n.prototype.iJ=function(e){var t=this;if(t.bJ!==e){t.bJ=e;var r=t.fp;"MAIN"!==t.type&&"AUDIO"!==t.type||t.nJ(e,r),t.jJ(e)}},i.prototype.nJ=n.prototype.nJ=function(e,t){for(var r=this,n=r.l.streams,i="[debug]["+r.type+"] Period changes to "+e+" with rays: [",a=0;a<n.length;a++)i+=n[a].groupId;i+="] currentStream = "+t.groupId},i.prototype.jJ=n.prototype.jJ=function(e){var t=this,r=t.fp;r&&r.drmInfo&&!d.isNullOrUndefined(e)&&r.drmInfo.forEach(function(r){r.periodId===e&&t.__controller.sendMessage(u.MessageIds.DRM_LICENSE_INFO,[r],["drmItem"])})},i.prototype.lJ=n.prototype.lJ=function(e){var t=this,r=t.fp;if(e){var n=e.data;if(n){var i={data:new Uint8Array(n.buffer),codec:t.kI,type:t.lI,minBufferTime:t.__controller.getMinimumBufferTime(),onlyMetadata:!0};t.mJ([i]),r.activeInitSegment=e;var a=r?r.getMp4Chunk("sidx"):null;if(a){var o=a.data;o&&(i.data=new Uint8Array(o.buffer),t.mJ([i]))}}}},i.prototype.rI=n.prototype.rI=function(e,t){},i.prototype.oI=n.prototype.oI=function(e){var t=this,r=t.fp,n=r.getSegmentfromSeqNum(e);n&&n.periodId!==t.bJ&&t.iJ(n.periodId),t.nI=t.STATES.NONE,t.oJ=!0,t.Qj=e,t.fJ(e)},n.prototype.onSynchBegin=function(){var e=this;e.processOnlyMetadata=!0},i.prototype.sI=function(e){var t=this;t.lastAudioTimestamp=NaN,t.aG.sI.call(t,e)}},{"../../../lib/hls-utils":145,"../../../lib/index":146,"../../command/command":158,"../../model/worker-scope/model":201,"../../model/worker-scope/stream":204,"../../worker-utils/worker-defs":231,"./live-streamer":177,"./streamer":179}],175:[function(e,t,r){"use strict";function n(e){var t=this;o.call(t,e),t.cm()}function i(e){var t=this;s.call(t,e),t.cm()}t.exports.Fmp4SubtitleStreamer=n,t.exports.Fmp4SubtitleLiveStreamer=i;var a=e("../../../lib/hls-utils"),o=e("./fmp4-streamer").Fmp4Streamer,s=e("./fmp4-streamer").Fmp4LiveStreamer,l=e("../../mp4/mp4-box-parser"),c=e("../../../lib/index"),u=e("./../../event").HLSEvent,p="WEBVTT\n",d="X-TIMESTAMP-MAP=LOCAL:00:00:00.000,MPEGTS:0\n\n";a.inherits(n,o),a.inherits(i,s),n.prototype.destroy=function(){var e=this;e.pJ=null,e.yF="",o.prototype.destroy.call(e)},i.prototype.destroy=function(){var e=this;e.pJ=null,e.yF="",s.prototype.destroy.call(e)},i.prototype.cm=n.prototype.cm=function(){var e=this;e.lI="subtitle",e.pJ=new l,e.qJ()},i.prototype.oI=n.prototype.oI=function(e){var t=this;t.qJ(),o.prototype.oI.call(t,e)},i.prototype.onSegmentLoadProgress=n.prototype.onSegmentLoadProgress=function(e,t){var r=this,n=r.fp;if(t&&n&&n.timescale){var i=t.stream;if((!i||n.equals(i))&&"firstByte"!==t.position){var a=r.pJ.extractVttCaptions(t.data);if(a.length){var o=r.pJ.parse(t.data,"trun"),s=o?o.sampleData:[];if(s.length===a.length){var l=r.pJ.parse(t.data,"tfdt"),c=l?l.baseMediaDecodeTime:0;c=1e3*c/n.timescale;var u=c;a.forEach(function(e,t){var i=s[t],a=i?1e3*i.sampleDuration/n.timescale:0;if(e.cueText){var o=r.rJ(e.cueTime)+c,l=null!==o?o+a:u+a;r.yF+="\n"+r.sJ(o)+" --> "+r.sJ(l),r.yF+="\n"+e.cueText+"\n"}u+=a}),r.yF+="\n"}}}}},i.prototype.onSegmentLoadComplete=n.prototype.onSegmentLoadComplete=function(e,t){var r=this,n=r.fp;if(n){var i=n.getSegmentfromSeqNum(r.Qj);i&&r.__controller.sendEvent(u.VTT_SEGMENT_LOADED,r.tJ(i))}r.aG.onSegmentLoadComplete.call(r,e,t),r.yF=""},i.prototype.qJ=n.prototype.qJ=function(){var e=this;e.yF=p+d},i.prototype.rJ=n.prototype.rJ=function(e){var t=null;if(!e)return t;var r=e.split(":");if(r&&r.length>=3){var n=r[2].split("."),i=0,a=0;n&&n.length>=2&&(i=parseInt(n[0]),a=parseInt(n[1])),t=1e3*(3600*r[0]+60*r[1]+i)+a}return t},i.prototype.sJ=n.prototype.sJ=function(e){function t(e){return e<10?"0"+e:""+e}function r(e){return e<10?"00"+e:e<100?"0"+e:""+e}var n="";if(c.isNullOrUndefined(e))return n;var i=Math.floor(e/1e3),a=Math.floor(e-1e3*i),o=Math.floor(i/3600);i-=3600*o;var s=Math.floor(i/60);return i-=60*s,n=t(o)+":"+t(s)+":"+t(i)+"."+r(a)},i.prototype.tJ=n.prototype.tJ=function(e){var t=this,r={};return e&&(r.discontinuity=e.discontinuity,r.sequenceNum=e.seqNum,r.startTime=e.startTime,r.programDateTime=e.programDateTime,r.url=e.url,r.duration=e.duration,r.clockReference=0,r.localCueTime=0,r.mpegTSTime=0,r.data=t.yF,r.offset=0,r.adjustedTime=0),r},i.prototype.rI=n.prototype.rI=function(){},i.prototype.lJ=n.prototype.lJ=function(e){var t=this,r=t.fp;r.activeInitSegment=e},i.prototype.jJ=n.prototype.jJ=function(){}},{"../../../lib/hls-utils":145,"../../../lib/index":146,"../../mp4/mp4-box-parser":206,"./../../event":185,"./fmp4-streamer":174}],176:[function(e,t,r){"use strict";function n(e,t,r){var n=this;n.uJ=s.CMD_LICENSE_LOAD,n.LICENSE_TYPE_NONE=0,n.LICENSE_TYPE_WIDEVINE=1,n.LICENSE_TYPE_PLAYREADY=2,n.vJ=0,n.playreadyKeySystem={keySystem:"com.microsoft.playready",supportedConfig:[{initDataTypes:["keyids","cenc"],audioCapabilities:[{contentType:'audio/mp4; codecs="mp4a"',robustness:""}],videoCapabilities:[{contentType:'video/mp4; codecs="avc1"',robustness:""}]}]},n.widevineKeySystem={keySystem:"com.widevine.alpha",supportedConfig:[{label:"foo",initDataTypes:["cenc"],sessionTypes:["temporary"],audioCapabilities:[{contentType:'audio/mp4; codecs="mp4a.40.5"',robustness:"SW_SECURE_CRYPTO"}],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.640028"',robustness:"HW_SECURE_ALL"},{contentType:'video/mp4; codecs="avc1.640028"',robustness:"SW_SECURE_CRYPTO"},{contentType:'video/mp4; codecs="avc1.4d001f"',robustness:"HW_SECURE_ALL"},{contentType:'video/mp4; codecs="avc1.4d001f"',robustness:"SW_SECURE_CRYPTO"},{contentType:'video/mp4; codecs="avc1.42000d"',robustness:"HW_SECURE_ALL"},{contentType:'video/mp4; codecs="avc1.42000d"',robustness:"SW_SECURE_CRYPTO"}]}]},n.LICENSE_STATUS_DONE="DONE",n.LICENSE_STATUS_LOADING="LOADING",n.LICENSE_STATUS_NEW="NEW_REQ",n.JI=e.create(o),n.wJ=[],window.addEventListener("beforeunload",n.xJ.bind(n)),n.tg=t,n.MG=r,n.yJ=null,n.zJ=null,n.AJ=null,n.BJ=[],n.ID=new l(250),n.ID.addEventListener(n.CJ,n),n.DJ=0,n.tc=e,n.EJ()}t.exports.LicenseManager=n;var i=e("../../../lib/hls-utils"),a=e("../../error"),o=e("../../command/command-manager"),s=e("../../command/command").CmdNames,l=e("../../../lib/timer");n.prototype.addDrmItem=function(e){var t=this;i.isDrmItemContained(e,t.BJ)||(e.status=t.LICENSE_STATUS_NEW,t.BJ.push(e),t.FJ(t))},n.prototype.EJ=function(){var e=this;return e.zJ=null,navigator.requestMediaKeySystemAccess?void navigator.requestMediaKeySystemAccess(e.widevineKeySystem.keySystem,e.widevineKeySystem.supportedConfig).then(function(t){e.vJ=e.LICENSE_TYPE_WIDEVINE,e.MG.appModel.licenseType="widevine",t.createMediaKeys().then(function(t){e.GJ(e,t)},function(){e.AJ={type:a.ERR_DRM_INIT,message:"LicenseManager - createMediaKeys() failed for Widevine"}})},function(){navigator.requestMediaKeySystemAccess(e.playreadyKeySystem.keySystem,e.playreadyKeySystem.supportedConfig).then(function(t){e.vJ=e.LICENSE_TYPE_PLAYREADY,e.MG.appModel.licenseType="playready",t.createMediaKeys().then(function(t){e.GJ(e,t)},function(){e.AJ={type:a.ERR_DRM_INIT,message:"LicenseManager - createMediaKeys() failed for PlayReady"}})},function(){e.AJ={type:a.ERR_DRM_CONFIG,message:"LicenseManager - Your browser/system does not support the requested configurations for playing DRM protected content."}})}):void(e.AJ={type:a.ERR_DRM_EME_MISSING,message:"LicenseManager - Browser EME components not detected! (also check URL for HTTPS)"})},n.prototype.GJ=function(e,t){e.zJ=t,e.ID.start()},n.prototype.CJ=function(){var e=this;e.tg.mediaKeys||(e.ID.stop(),e.tg.setMediaKeys(e.zJ).then(function(){e.FJ(e)},function(t){e.AJ={type:a.ERR_DRM_INIT,message:"LicenseManager - "+t}}))},n.prototype.FJ=function(e){if(null===e.zJ&&null!==e.AJ)return e.HJ(e.AJ.type,e.AJ.message),void(e.AJ=null);if(null!==e.zJ)for(var t=0;t<e.BJ.length;t++){var r=e.BJ[t];r.status===e.LICENSE_STATUS_NEW&&(e.vJ===e.LICENSE_TYPE_WIDEVINE?(r.widevine.initData=i.base64ToBuffer(r.widevine.pssh),r.widevine.initDataType="cenc",r.status=e.LICENSE_STATUS_LOADING,e.IJ(e,r.widevine)):e.vJ===e.LICENSE_TYPE_PLAYREADY&&(r.playready.initData=i.base64ToBuffer(r.playready.pssh),r.playready.initDataType="cenc",r.status=e.LICENSE_STATUS_LOADING,e.IJ(e,r.playready)))}},n.prototype.IJ=function(e,t){var r=e.zJ.createSession("temporary");e.wJ.push(r),r.addEventListener("message",function(r){e.JJ(e,t,r)},!1);var n=r.generateRequest(t.initDataType,t.initData);n.then(function(){e.DJ++,e.DJ===e.BJ.length&&e.tc.onGenerateRequestComplete()}),n.catch(function(t){e.HJ(a.ERR_DRM_LICENSE_REQUEST,"LicenseManager - keySession.generateRequest() failed: "+t)})},n.prototype.KJ=function(e,t){return e.vJ===e.LICENSE_TYPE_PLAYREADY?t.prefix+"/pr":e.vJ===e.LICENSE_TYPE_WIDEVINE?t.prefix+"/wv":""},n.prototype.JJ=function(e,t,r){var n=e.KJ(e,t),i=e.LJ(e,r.message);e.JI.executeCommand(e.uJ,{challenge:i.challenge,headerFields:i.headerFields,url:n,drmInfo:t,event:r},e)},n.prototype.LJ=function(e,t){var r,n={};if(e.vJ===e.LICENSE_TYPE_PLAYREADY){var o=(new DOMParser).parseFromString(String.fromCharCode.apply(null,new Uint16Array(t)),"application/xml");o.getElementsByTagName("Challenge")[0]?r=i.base64ToBuffer(o.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue).buffer:e.HJ(a.ERR_DRM_LICENSE_REQUEST,"LicenseManager - Cannot find <Challenge> in key message");var s=o.getElementsByTagName("name"),l=o.getElementsByTagName("value");s.length!==l.length&&e.HJ(a.ERR_DRM_LICENSE_REQUEST,"LicenseManager - Playready: Mismatched header <name>/<value> pair in key message");for(var c=0;c<s.length;c++)n[s[c].childNodes[0].nodeValue]=l[c].childNodes[0].nodeValue}else e.vJ===e.LICENSE_TYPE_WIDEVINE&&(r=t);return{challenge:r,headerFields:n}},n.prototype.onLicenseLoadComplete=function(e,t){var r=this,n=e.data?e.data.event:null,i=e.data?e.data.drmInfo:null,o=n.target.update(t.data);o.catch(function(e){r.HJ(a.ERR_DRM_LICENSE_REQUEST,"LicenseManager - call to MediaKeySession.update() failed: "+e)});for(var s=0;s<r.BJ.length;s++)r.BJ[s].widevine.pssh!==i.pssh&&r.BJ[s].playready.pssh!==i.pssh||(r.BJ[s].status=r.LICENSE_STATUS_DONE)},n.prototype.onLicenseLoadError=function(){var e=this;e.HJ(a.ERR_XHR_LOAD,"LicenseManager - XHR failed")},n.prototype.HJ=function(e,t){var r=this,n=new a.Error(e,t);r.MG.notifyError(n),console.error(t)},n.prototype.xJ=function(){for(var e=this,t=0;t<e.wJ.length;t++)e.wJ[t].close().then(function(){});e.wJ=[]},n.prototype.destroy=function(){var e=this;e.MJ=null,e.zJ=null,e.BJ=[],e.xJ(),e.ID.destroy()}},{"../../../lib/hls-utils":145,"../../../lib/timer":150,"../../command/command":158,"../../command/command-manager":157,"../../error":184}],177:[function(e,t,r){"use strict";function n(e,t){var r=this;o.call(r,e,t),r.FF={},r.FF[u.MEDIA_LOADED]=r.__controller.addEventListener(u.MEDIA_LOADED,r.IH,r),r.DEFAULT_STREAM_UPDATE_INTERVAL=8e3,r.MAX_STREAM_UPDATE_INTERVAL=1e4,r.PAST_BUFFER_LENGTH_LIMIT=r.l.config.pastBufferLengthLimit.live,r.LONG_PAUSE_INTERVAL=24e3,r.NJ=new c(r.DEFAULT_STREAM_UPDATE_INTERVAL),r.NJ.addEventListener(r.OJ,r),r.aH=null,r.PJ=null,r.QJ=!1,r.RJ=new c(r.LONG_PAUSE_INTERVAL,1),r.RJ.addEventListener(r.SJ,r)}t.exports=n;var i=e("../../../lib/hls-utils"),a=e("./streamer"),o=a.Streamer,s=a.Events,l=a.SynchTypes,c=e("../../../lib/timer"),u=e("./../../event").HLSEvent,p=e("../../model/worker-scope/stream").StreamTypes,d=e("../../../lib/index");i.inherits(n,o),n.prototype.destroy=function(){var e=this;e.NJ.destroy(),e.RJ.destroy(),e.__controller.removeEventListeners(e.FF),o.prototype.destroy.call(e)},n.prototype.onPlay=function(e){var t=this;if(t.TJ(),t.UJ()){var r=t.PJ?l.TIME_GAP:l.INIT;t.sI(r),t.process(t.hJ),t.PJ=null}else t.VJ&&(t.hJ=e,t.qH=!1,t.process(t.hJ),t.PJ=null);o.prototype.onPlay.call(t),t.RJ.stop()},n.prototype.onPause=function(){var e=this;e.PJ=Date.now(),e.RJ.start(),o.prototype.onPause.call(e)},n.prototype.onSeeking=function(e){var t=this;t.WJ(!1),t.QJ&&(t.XJ(),t.process(e))},n.prototype.onSynchComplete=function(){var e=this;e.aH=null,e.hJ=null,e.type===p.MAIN&&e.l.setLivePlaybackStartTime(null)},n.prototype.suspendStreaming=function(){var e=this;e.NJ&&e.NJ.stop()},n.prototype.resumeStreaming=function(){var e=this;e.NJ&&e.NJ.start()},n.prototype.UJ=function(){var e=this;if(!e.PJ)return!0;var t=e.fp,r=t&&t.targetDuration?3*t.targetDuration*1e3:e.LONG_PAUSE_INTERVAL;return Date.now()-e.PJ>r},n.prototype.sI=function(e){var t=this;if(t.l.hasEndlist)return void t.WJ(!0);var r=t.fp;if(r.segments.length&&!d.isNullOrUndefined(r.endSeqNum)&&!d.isNullOrUndefined(r.startSeqNum)){var n=t.YJ(),i=r.getSegmentfromSeqNum(n);t.hJ=i?i.startTime:null,t.aH=t.hJ,r.type===p.MAIN&&t.l.setLivePlaybackStartTime(t.aH);var a=t.l.userAgent;t.QJ=a&&a.safariDesktop&&e===l.TIME_GAP,t.publish(s.LIVE_SYNCH,t,{synchPosition:t.aH,synchType:e})}},n.prototype.SJ=function(){},n.prototype.ZJ=function(){var e=this;return!e.$J&&e.nI!==e.STATES.LOADING&&!e.qH&&!e._J()},n.prototype.aK=function(){var e=this;e.isActive()&&(!e.bK&&e.nI!==e.STATES.INITIALIZING||e.cK||(e.OJ(),e.TJ()))},n.prototype.YJ=function(){
var e=this,t=e.fp,r=e.l.getLivePlaybackStartTime();return t.type===p.MAIN||d.isNullOrUndefined(r)?Math.max(t.endSeqNum-e.SEGMENT_OFFSET,t.startSeqNum):t.getSeqNumBeforePosition(r)},n.prototype.dK=function(e){return e},n.prototype.onStreamLoaded=function(e){var t=this;t.TJ(),o.prototype.onStreamLoaded.call(t,e)},n.prototype.IH=function(){var e=this;e.TJ()},n.prototype.TJ=function(){var e,t,r=this;return r.l.hasEndlist?void r.NJ.destroy():r.fp.isDash()&&r.type!==p.MAIN?void r.NJ.destroy():(e=r.NJ.startTime>0?Date.now()-r.NJ.startTime:0,r.NJ.reset(),t=r.l.getStreamRefreshInterval()||r.DEFAULT_STREAM_UPDATE_INTERVAL,t-=e,t=Math.max(t,100),t=Math.min(t,r.MAX_STREAM_UPDATE_INTERVAL),r.NJ.delay=t,void r.NJ.start())},n.prototype.eK=function(){var e=this,t={url:e.fp.url,withResponseHeaders:e.l.isDash()};return e.qH&&(t.stopStreamLoadOnError=!0,t.maxRetries=1),t},n.prototype.stopStreamUpdate=function(){var e=this;e.NJ.reset()},n.prototype.canSwitch=function(e){var t=this;return!t.aH&&("mid-segment"!==e||t.nI===t.STATES.LOADING)},n.prototype.fK=function(){var e=this,t=e.fp;t&&t.endSeqNum===e.Qj&&e.l.hasEndlist&&e.WJ(!0)}},{"../../../lib/hls-utils":145,"../../../lib/index":146,"../../../lib/timer":150,"../../model/worker-scope/stream":204,"./../../event":185,"./streamer":179}],178:[function(e,t,r){"use strict";var n=e("./ts-streamer"),i=e("./subtitle-streamer"),a=e("./fmp4-streamer"),o=e("./aac-streamer"),s=e("./fmp4-subtitle-streamer"),l=e("../../model/worker-scope/stream").StreamTypes,c=n.TsStreamer,u=n.TsLiveStreamer,p=i.SubtitleStreamer,d=i.SubtitleLiveStreamer,f=a.Fmp4Streamer,v=a.Fmp4LiveStreamer,m=o.AacStreamer,y=o.AacLiveStreamer,h=s.Fmp4SubtitleStreamer,E=s.Fmp4SubtitleLiveStreamer;t.exports.create=function(e,t,r){if(!e||!t||"function"!=typeof e.create)return null;var n,i=t.type===l.SUBTITLES;switch(t.containerFormat){case"vtt":n=r?d:p;break;case"aac":n=r?y:m;break;case"mp4":n=i?r?E:h:r?v:f;break;case"ts":n=r?u:c}return n?e.create(n,t):null}},{"../../model/worker-scope/stream":204,"./aac-streamer":171,"./fmp4-streamer":174,"./fmp4-subtitle-streamer":175,"./subtitle-streamer":181,"./ts-streamer":183}],179:[function(e,t,r){"use strict";function n(e){var t=this,r=t.__controller;a.call(t,t.constructor.name),t.l=r.model,t.kJ=r.services,t.JI=r.create(f),t.gK=r.create(u,t.JI),t.gK.addEventListener(p.STREAM_LOADED,t.onStreamLoaded,t),t.gK.addEventListener(p.STREAM_LOAD_ERROR,t.onStreamLoadError,t),t.AVG_BW_MEASUREMENT_INTERVAL=30,t.hK=0,t.iK=0,t.uJ=o.CMD_SEGMENT_LOAD,t.fp=e,t.type=e?e.type:null;var n=e.altRenditionGroups&&e.altRenditionGroups.SUBTITLES&&e.altRenditionGroups.SUBTITLES.hasStreams();t.type&&t.type!==v.VIDEO&&t.type!==v.MAIN||n||(t.jK=[],t.kK=new m(t.sendVttEventCB.bind(t))),t.STATES={ERROR:-1,NONE:0,INITIALIZING:1,INITIALIZED:2,LOADING:3},t.nI=t.STATES.NONE,t.cK=!1,t.lK=!1,t.Qj=NaN,t.WH=!1,t.hJ=null,t.qH=!1,t.mK=t.l.config.maxBuffer,t.nK=t.l.live,t.oK=!1,t.VJ=!1,t.pK={audio:NaN,video:NaN},t.bK=!1,t.TF=[403]}t.exports.Streamer=n;var i=e("../../../lib/hls-utils"),a=e("../../../lib/event-bus"),o=e("../../command/command").CmdNames,s=e("../../error"),l=e("../../event").HLSEvent,c=e("../../helper/stream-loader"),u=c.StreamLoader,p=c.Events,d=e("../../worker-utils/worker-defs"),f=e("../../command/command-manager"),v=e("../../model/worker-scope/stream").StreamTypes,m=e("../../services/cea608-parser"),y=t.exports.Events={SEG_LOAD_START:"streamerSegLoadStart",SEG_LOAD_PROGRESS:"streamerSegLoadProgress",SEG_LOAD_COMPLETE:"streamerSegLoadComplete",SEG_LOAD_ERROR:"streamerSegLoadError",PRELOAD_COMPLETE:"streamerPreloadComplete",STREAM_LOAD_COMPLETE:"StreamLoadComplete",STREAM_LOAD_ERROR:"StreamLoadError",LIVE_SYNCH:"streamerLiveSynch"},h=t.exports.SynchTypes={INIT:"synchAtInit",TIME_GAP:"synchAtTimeGap"};i.inherits(n,a),n.prototype.destroy=function(){var e=this;e.gK.destroy(),e.nI=e.STATES.NONE,e.fp=null,e.JI&&(e.JI.destroy(),e.JI=null),a.prototype.destroy.call(e)},n.prototype.setCurrentStream=function(e){var t=this;e&&!e.equals(t.fp)&&(t.fp=e,t.onSwitchBegin())},n.prototype.isActive=function(){var e=this;return e.fp&&e.fp.url&&e.fp.url.length>0},n.prototype.setAltAudioActive=function(e){var t=this;t.oK=e},n.prototype.getCurrentStream=function(){var e=this;return e.fp},n.prototype.process=function(e){var t=this;if("number"==typeof e&&(t.hJ=e),!t.isStreamReady()&&t.nI!==t.STATES.ERROR)return void t.fJ();if(t.ZJ()){var r=t.gJ(t.hJ),n=t.qK(r);if("empty"===n)return void t.aK();if("ahead"!==n)return"behind"===n?void t.sI(h.TIME_GAP):void(t.ZJ()&&(t.hJ=null,t.rK(r)))}},n.prototype.suspendStreaming=n.prototype.resumeStreaming=function(){},n.prototype.onPlay=function(e){var t=this;t.qH=!1,t.mK=t.l.config.maxBuffer,e&&t.onSynchBegin()},n.prototype.onPlaying=function(){var e=this;e.VJ=!1},n.prototype.onPause=function(){var e=this;e.qH=!0},n.prototype.onSeeking=function(e){var t=this;t.XJ(),t.WJ(!1),t.process(e)},n.prototype.onSeeked=function(){},n.prototype.onError=function(){var e=this;e.JI&&e.JI.removeAllCommands()},n.prototype.onComplete=function(){},n.prototype.onTimeUpdate=function(e){var t=this;if(t.iK){var r=e-t.iK;r>0&&(t.hK+=r)}t.hK>t.AVG_BW_MEASUREMENT_INTERVAL&&(t.NH(t.kJ.bandwidthEstimator.averageBandwidth),t.hK=0),t.iK=e},n.prototype.onPreloadBegin=function(){var e=this;e.lK=!0,e.mK=e.l.config.preloadBufferLimit},n.prototype.onPreloadEnd=function(){var e=this;e.lK=!1},n.prototype.sI=function(){},n.prototype.isStreamReady=function(){var e=this,t=e.fp;return t&&t.isReady()&&e.nI>=e.STATES.INITIALIZED},n.prototype.fJ=function(){var e=this;e.isActive()&&(e.nI=e.STATES.INITIALIZING,e.aK())},n.prototype.ZJ=function(){var e=this,t=e._J(),r=e.l.config.stopBufferingOnPause;return e.lK&&t&&e.publish(y.PRELOAD_COMPLETE,e),!e.WH&&e.nI!==e.STATES.LOADING&&((!e.qH||!r)&&(!t&&!e.sK()))},n.prototype.qK=function(e){var t=this,r=t.fp;if(!r||r.isEmpty()||isNaN(e))return"empty";if(!r.contains(e)){if(e<r.startSeqNum)return"behind";if(e>r.endSeqNum)return"ahead"}return"available"},n.prototype._J=function(){var e=this;if(e.type&&e.l.bufferedAndPending){var t={buffered:0,pending:0},r=e.l.bufferedAndPending.video||t;e.type!==v.MAIN&&e.type!==v.VIDEO&&(r=e.l.bufferedAndPending.audio||t);var n=r.buffered+r.pending;return n>=e.mK}var i=e.l.bufferLength+e.l.pendingBufferLength;return i>=e.mK},n.prototype.sK=function(){var e=this,t=e.l;return t.getTotalBufferLength()>=t.config.maxTotalBuffer},n.prototype.onSwitchBegin=function(){var e=this;e.bK=!0,e.aK()},n.prototype.onSwitchEnd=function(){var e=this;e.bK=!1},n.prototype.aK=function(){var e=this;e.cK||e.OJ()},n.prototype.OJ=function(){var e=this;e.isActive()&&(e.cK=!0,e.gK.load(e.fp,e.eK()))},n.prototype.eK=function(){var e=this;return{url:e.fp.url,retryExclusion:e.TF,withResponseHeaders:e.l.isDash()}},n.prototype.onStreamLoaded=function(e){var t=this;t.nI===t.STATES.INITIALIZING&&(t.nI=t.STATES.INITIALIZED),t.cK=!1,t.publish(y.STREAM_LOAD_COMPLETE,t,{stream:e.dto()})},n.prototype.onStreamLoadError=function(e,t){var r=this;t.code===s.ERR_XHR_LOAD_LIVE_PAUSE[0]&&r.stopStreamUpdate(),r.publish(y.STREAM_LOAD_ERROR,r,{err:t,stream:e}),r.nI=r.STATES.ERROR,r.cK=!1,r.process()},n.prototype.gJ=function(e){var t=this,r=t.fp,n=NaN;return n="number"==typeof e?r.getSeqNumBeforePosition(e+t.l.TIMESTAMP_COMPARE_EPSILON):isNaN(t.Qj)?t.YJ():t.nI===t.STATES.ERROR||t.oJ?t.Qj:t.Qj+1,n=t.dK(n),t.nK||(n=Math.max(n,r.startSeqNum),n=Math.min(n,r.endSeqNum)),n},n.prototype.dK=function(e){var t=this,r=t.fp,n=t.l.bufferedRanges,i=n.length,a=t.tK(e),o=t.l.userAgent;if(o&&o.safariDesktop)return e;if(t.l.isDash())return e;if(a>=0&&i&&a<i){var s=n.ranges[a].end;return!t.nK&&s>=t.l.duration?(t.WJ(!0),r.endSeqNum):r.getSeqNumBeforePosition(s)}return e},n.prototype.YJ=function(){var e=this;return e.fp.getSeqNumBeforePosition(0)},n.prototype.tK=function(e){var t=this,r=t.fp.getSegmentfromSeqNum(e);if(!r)return-1;for(var n=t.l.TIMESTAMP_COMPARE_EPSILON,i=t.l.bufferedRanges,a=0;a<i.length;a++){var o=i.ranges[a],s=o.start-n,l=o.end+n;if(s=0===r.startTime&&s<.1?0:s,r.startTime>=s&&r.startTime+r.duration<=l)return a}return-1},n.prototype.oI=function(){},n.prototype.rK=function(e){var t=this;if(t.oI(e),!(t.nI<t.STATES.INITIALIZED)){t.XJ(),t.nI=t.STATES.LOADING,t.Qj=e,t.oJ=!1;var r=t.uK(t.Qj);r&&(t.rI(r,t.fp),t.publish(y.SEG_LOAD_START,t),t.vK(e))}},n.prototype.vK=function(){},n.prototype.uK=function(e){var t=this,r=t.pI(e),n=r?r.segment:null;return n?(t.dJ=t.JI.executeCommand(t.uJ,r,t),n):null},n.prototype.pI=function(e){var t=this,r=t.fp;return r?{segment:r.getSegmentfromSeqNum(e),stream:r}:null},n.prototype.onSegmentLoadProgress=function(e,t){var r=this;if(t){var n,i,a,o,s;if(t.id===d.MessageIds.TIMED_METADATA){var l=t.getParam("timedMetadata");return void r.l.updateTimedMetadata(l,r.Qj)}t.getParam?(n=t.getParam("tracks"),i=t.getParam("perfInfo"),a=t.getParam("bytesTotal")||0,o=t.getParam("parsedInfo"),s=t.getParam("cea608TrackData")):t.cea608TrackData&&(s=t.cea608TrackData);var c=o?o.position:t.position,u=!!o&&(o.inWorkerScope||!1);switch(r.publish(y.SEG_LOAD_PROGRESS,r,{seqNum:r.Qj,position:c,bytesTotal:a,inWorkerScope:u,perfInfo:i}),r.l.preloading=r.lK,c){case"firstByte":return;case"start":break;case"end":r.nI===r.STATES.LOADING&&(r.nI=r.STATES.INITIALIZED)}if(n&&(n.forEach(function(e){e.minBufferTime=r.__controller.getMinimumBufferTime(),r.pK[e.type]=e.endTimestamp}),r.mJ(n,t.getParam("transferables"))),r.jK&&s&&s.length>0)for(var p=0;p<s.length;p++)r.jK.push(s[p]);"end"===c&&(r.l.setSegEndTimeStamps(r.type,r.fp.groupId,r.Qj,r.pK),r.pK.audio=NaN,r.pK.video=NaN)}},n.prototype.onSegmentLoadComplete=function(e,t){var r=this;if(r.nI===r.STATES.LOADING&&(r.nI=r.STATES.INITIALIZED),r.jK&&r.jK.length>0){for(var n=[],i=0;i<r.jK.length;i++){for(var a=r.jK[i],o=0;o<n.length&&a.pts>=n[o].pts;)o++;n.splice(o,0,a)}var s=r.fp.getSegmentfromSeqNum(r.Qj);r.kK.parse(n,s),r.jK=[]}r.JI.removeCommand(e),t&&t.getParam("segTimeStamp")&&r.l.setPrevSegTimeStamps(t.getParam("segTimeStamp")),r.fK(),r.publish(y.SEG_LOAD_COMPLETE,r,{stream:r.fp}),r.dJ=null},n.prototype.onSegmentLoadError=function(e,t){var r=this;r.abortCurrentSegment(e),r.dJ=null;var n=t&&t.code===s.ERR_XHR_LOAD[0]?new s.Error(s.ERR_SEGMENT_LOAD):t;r.publish(y.SEG_LOAD_ERROR,r,{seqNum:r.Qj,err:n,stream:r.fp})},n.prototype.abortCurrentSegment=function(e){var t=this;return t.nI!==t.STATES.LOADING?null:(e&&t.JI.removeCommand(e),t.nI===t.STATES.LOADING&&(t.nI=t.STATES.INITIALIZED),t.oJ=!0,t.pK.audio=NaN,t.pK.video=NaN,t.Qj)},n.prototype.XJ=function(){var e=this;e.nI===e.STATES.LOADING&&(e.nI=e.STATES.INITIALIZED),e.pK.audio=NaN,e.pK.video=NaN,e.JI.removeRelatedCommands(e.uJ)},n.prototype.mJ=function(e,t){var r=this;e&&r.__controller.sendMessage(d.MessageIds.APPEND_SRC_BUFFER,[e],["tracks"],t)},n.prototype.WJ=function(e){var t=this;t.WH=e,t.pK.audio=NaN,t.pK.video=NaN,t.type===v.MAIN&&t.__controller.sendMessage(d.MessageIds.END_OF_STREAM,[e],["endOfStream"])},n.prototype.fK=function(){var e=this,t=e.fp;t&&t.endSeqNum===e.Qj&&e.WJ(!0)},n.prototype.NH=function(e){var t=this,r={avgBWtimestamp:Date.now(),avgBW:e};t.type===v.MAIN&&t.__controller.sendMessage(d.MessageIds.SAVE_AVG_BANDWIDTH,[r],["avgBwInfo"])},n.prototype.onManualStreamChange=function(){var e=this;e.WJ(!1),e.VJ=!0,e.XJ(),e.gK.cancel(),e.cK=!1,e.nI=e.nI!==e.STATES.ERROR?e.STATES.INITIALIZING:e.nI,e.aK()},n.prototype.onSynchBegin=function(){},n.prototype.onSynchComplete=function(){},n.prototype.onSynchMetadataReady=function(e){var t=this;t.XJ(),t.WJ(!1),t.process(e)},n.prototype.canSwitch=function(e){var t=this;return"mid-segment"!==e||t.nI===t.STATES.LOADING},n.prototype.isInError=function(){var e=this;return e.nI===e.STATES.ERROR},n.prototype.getSegLoadCommand=function(){var e=this;return e.JI.getCommand(e.uJ)},n.prototype.rI=function(){},n.prototype.sendVttEventCB=function(e){var t=this;t.__controller.sendEvent(l.VTT_SEGMENT_LOADED,e)}},{"../../../lib/event-bus":144,"../../../lib/hls-utils":145,"../../command/command":158,"../../command/command-manager":157,"../../error":184,"../../event":185,"../../helper/stream-loader":191,"../../model/worker-scope/stream":204,"../../services/cea608-parser":217,"../../worker-utils/worker-defs":231}],180:[function(e,t,r){"use strict";function n(){var e=this;v.call(e,e.constructor.name),e.l=e.__controller.model,e.kJ=e.__controller.services,e.JI=e.__controller.create(y),e.Wd=e.kJ.segmentMetrics,e.wK={},e.xK=0,e.yK=0,e.zK={},e.AK=null,e.BK=0,e.$H=e.__controller.create(s,e.JI),e.$H.addEventListener(e.$H.SWITCH_ON_ERROR,e.CK,e),e.OG=e.__controller.create(o),e.OG.addEventListener(e.OG.SWITCH_BEGIN,e.DK,e),e.OG.addEventListener(e.OG.SWITCH_END,e.EK,e),e.FK=new l(1e3*e.l.config.segmentLoadMonitorInterval),e.FK.addEventListener(e.GK,e),e.HK={},e.hH=[],e.qH=!1,e.bK=!1,e.VJ=!1,e.IK=e.OG.SCENARIOS.STARTUP,e.STATES={ERROR:-1,INITIAL:0,STREAM_METADATA_LOADED:1,INITIALIZED:2},e.nI=e.STATES.INITIAL}t.exports.StreamingController=n;var i=e("./streamer").Events,a=e("./streamer-factory"),o=e("./switch-manager"),s=e("../../helper/error-handler"),l=e("../../../lib/timer"),c=e("../../helper/stream-loader"),u=c.StreamLoader,p=c.Events,d=e("../../model/worker-scope/stream").StreamTypes,f=e("../../../lib/hls-utils"),v=e("../../../lib/event-bus"),m=e("./../../event").HLSEvent,y=e("../../command/command-manager"),h=e("../../model/worker-scope/model").AbrModes,E=e("../../worker-utils/worker-defs"),g=t.exports.Events={STREAM_METADATA_LOADED:"streamMetadataLoaded",STREAM_METADATA_LOAD_ERROR:"streamMetadataLoadError",PRELOAD_COMPLETE:"preloadComplete",SEG_LOAD_PROGRESS:"streamingControllerSegLoadProgress"};f.inherits(n,v),n.prototype.loadStream=function(e){var t=this;e&&t.nI===t.STATES.INITIAL&&(t.JK(e).load(e),t.xK++,Object.keys(e.altRenditionGroups).forEach(function(r){var n=e.getAlternateStream(r);n&&n.url&&(t.JK(n).load(n),t.xK++)}))},n.prototype.loadAllSubtitleStreams=function(){var e=this;if(e.nI===e.STATES.INITIAL){var t=[];e.l.streams.forEach(function(r){var n=r.getAlternateStream(d.SUBTITLES);n&&t.indexOf(n.url)<0&&(t.push(n.url),e.JK(n).load(n),e.xK++)}),e.nI=e.STATES.STREAM_METADATA_LOADED,e.publish(g.STREAM_METADATA_LOADED)}},n.prototype.JK=function(e){var t=this,r=t.__controller.create(u,t.JI);return r.addEventListener(p.STREAM_LOADED,t.KK,t),r.addEventListener(p.STREAM_LOAD_ERROR,t.LK,t),t.wK[e.url]=r,e.type===d.SUBTITLES&&t.yK++,r},n.prototype.MK=function(){var e=this;Object.keys(e.wK).forEach(function(t){var r=e.wK[t];r&&r.destroy()}),e.wK={},e.xK=0},n.prototype.KK=function(e){var t=this;if(e){var r=t.wK[e.url];if(r){if(t.nI>=t.STATES.STREAM_METADATA_LOADED)return r.destroy(),delete t.wK[e.url],void t.l.synchStreamTimelines(e.type);e.type!==d.SUBTITLES&&t.yK++,t.yK>=t.xK&&(t.nI=t.STATES.STREAM_METADATA_LOADED,t.l.synchStreamTimelines(),t.publish(g.STREAM_METADATA_LOADED)),r.destroy(),delete t.wK[e.url]}}},n.prototype.LK=function(e,t){var r=this;e&&e.type===d.SUBTITLES||(r.nI=r.STATES.ERROR,r.publish(g.STREAM_METADATA_LOAD_ERROR,t))},n.prototype.init=function(){var e=this;if(e.nI!==e.STATES.ERROR&&e.nI!==e.STATES.INITIALIZED){var t=e.l,r=t.getCurrentLoadingStream();if(r){e.yK=0;var n=e.NK(r);n.addEventListener(i.PRELOAD_COMPLETE,e.si,e),n.addEventListener(i.LIVE_SYNCH,e.FH,e),e.zK.MAIN=n,e.AK=n,e.BK++,Object.keys(r.altRenditionGroups).forEach(function(t){var n=r.getAlternateStream(t);if(n){var i=e.NK(n);i&&(e.zK[t]=i,e.BK++)}}),e.OK(),e.PK(),e.nI=e.STATES.INITIALIZED}}},n.prototype.isInitialized=function(){var e=this;return e.nI>=e.STATES.INITIALIZED},n.prototype.NK=function(e){var t=this;if(!e)return null;var r=a.create(t.__controller,e,t.l.live);return t.QK(r),r},n.prototype.RK=function(){var e=this;Object.keys(e.zK).forEach(function(t){e.zK[t].destroy()}),e.zK={},e.AK=null},n.prototype.QK=function(e){var t=this;if(e){var r={};r[i.SEG_LOAD_START]=t.SK,r[i.SEG_LOAD_PROGRESS]=t.WI,r[i.SEG_LOAD_COMPLETE]=t.TK,r[i.SEG_LOAD_ERROR]=t.UK,r[i.STREAM_LOAD_ERROR]=t.VK,r[i.STREAM_LOAD_COMPLETE]=t.WK,Object.keys(i).forEach(function(n){var a=i[n];e.addEventListener(a,r[a],t)})}},n.prototype.OK=function(){var e=this,t=e.zK.AUDIO;e.AK&&e.AK.setAltAudioActive(t&&t.isActive())},n.prototype.XK=function(){var e=this,t=Array.prototype.slice.call(arguments),r=t.shift(),n=e.AK;n&&n[r]&&"function"==typeof n[r]&&n[r].apply(n,t),Object.keys(e.zK).forEach(function(i){i!==d.MAIN&&(n=e.zK[i],n&&n[r]&&"function"==typeof n[r]&&n[r].apply(n,t))})},n.prototype.process=function(){var e=this;e.XK("process"),e.IK=e.OG.SCENARIOS.LOAD},n.prototype.suspendStreaming=function(){var e=this;e.XK("suspendStreaming")},n.prototype.resumeStreaming=function(){var e=this;e.XK("resumeStreaming")},n.prototype.setABRMode=function(e){var t=this,r=t.l;r.setABRMode(e)&&r.getABRMode()!==h.AUTO&&(t.VJ=!0,t.__controller.sendMessage(E.MessageIds.PAUSE_BEFORE_STREAM_CHANGE,["video"],["streamType"]),t.bK=!1,t.PK(),t.XK("onManualStreamChange"))},n.prototype.setAudioLanguage=function(e){var t=this,r=t.l;if(r.setAudioLanguage(e)){t.VJ=!0,t.__controller.sendMessage(E.MessageIds.PAUSE_BEFORE_STREAM_CHANGE,["audio"],["streamType"]);var n=d.AUDIO,i=r.getCurrentLoadingStream(),a=i?i.getAlternateStream(n):null,o=t.zK[n];a&&o&&o.setCurrentStream(a),t.OK(),t.XK("onManualStreamChange")}},n.prototype.getMetrics=function(){var e=this;return e.Wd.getMetrics()},n.prototype.onPlay=function(e){var t=this;return t.FK.start(),t.YK()?(t.XK("onPlay",e),t.qH=!1,void(t.VJ=!1)):void t.hH.push([t,t.onPlay,[e]])},n.prototype.onPlaying=function(){var e=this;e.XK("onPlaying")},n.prototype.onPause=function(){var e=this;e.FK.stop(),e.XK("onPause"),e.qH=!0},n.prototype.onSeeking=function(e){var t=this;t.l.live||t.PK(),t.XK("onSeeking",e)},n.prototype.onSeeked=function(e){var t=this;t.XK("onSeeked",e)},n.prototype.onComplete=function(){var e=this;e.Wd.onComplete(),e.XK("onComplete")},n.prototype.onError=function(){var e=this;e.XK("onError")},n.prototype.onTimeUpdate=function(e){var t=this;t.XK("onTimeUpdate",e),t.Wd.onTimeUpdate(e)},n.prototype.onSynchMetadataReady=function(e){var t=this;t.PK(),t.XK("onSynchMetadataReady",e)},n.prototype.onSynchComplete=function(){var e=this;e.XK("onSynchComplete")},n.prototype.onPreloadBegin=function(){var e=this;e.XK("onPreloadBegin")},n.prototype.onPreloadEnd=function(){var e=this;e.XK("onPreloadEnd")},n.prototype.CK=function(e){var t=this;t.bK=!1,t.PK(t.OG.SCENARIOS.ERROR,{index:e})},n.prototype.DK=function(){var e=this,t=e.l.getCurrentLoadingStream();e.bK=!0,e.AK.setCurrentStream(t),Object.keys(t.altRenditionGroups).forEach(function(r){var n=t.getAlternateStream(r);n&&e.zK[r]&&e.zK[r].setCurrentStream(n)}),e.OK()},n.prototype.EK=function(){var e=this;e.bK=!1,e.XK("onSwitchEnd")},n.prototype.GK=function(){var e=this,t=e.AK?e.AK.getSegLoadCommand():null;t&&e.PK(e.OG.SCENARIOS.MIDSEGMENT,{command:t,position:t.position})},n.prototype.ZK=function(e,t,r,n,i){var a=this,o=a.l.getCurrentLoadingStream(),s=o?o.getSegmentfromSeqNum(t):null,l={bitrateIndex:o?o.index:0,frameRate:o?o.frameRate:30,bytesTotal:r};"firstByte"===e?(l.beginTime=s?s.startTime:NaN,l.switchReason="none",l.observedBitrate=a.kJ.bandwidthEstimator.averageBandwidth,l.timeToFirstByte=s?s.timeToFirstByte:NaN,l.endTime=s?s.startTime+s.duration:NaN,a.Wd.segmentLoadBegin(t,l)):"end"===e&&(l.perfInfo=i,l.timeToDownload=s?s.totalDownloadTime:NaN,l.segmentInWorker=!!n,a.Wd.segmentLoadEnd(t,l))},n.prototype.$K=function(){var e=this;e.FK.reset(),e.qH||e.$H.running||e.FK.start()},n.prototype.PK=function(e,t){var r=this;if(e=e||r.IK,!r.bK){if(e===r.OG.SCENARIOS.MIDSEGMENT){var n=t?t.command:null,i=t?t.position:null;return void r._K(e,n,i)}var a=t?t.index:null;r.OG.switchStream(e,null,a)}},n.prototype._K=function(e,t,r){var n=this;if("end"!==r&&n.AK&&n.AK.canSwitch(e)){var i=n.OG.switchStream(e,"down");if(i){var a=n.AK.abortCurrentSegment(t);a&&n.ZK("end",a),n.process()}}},n.prototype.SK=function(){var e=this;e.$K()},n.prototype.WI=function(e,t){var r=this;if(r.aL(e)&&t){r.publish(g.SEG_LOAD_PROGRESS,t.bytesTotal),"firstByte"===t.position&&r.OG.switchComplete();var n=t.position,i=t.bytesTotal,a=t.inWorkerScope,o=t.perfInfo,s=t.seqNum;r.ZK(n,s,i,a,o),r.$K()}},n.prototype.TK=function(e){var t=this;t.bL(),t.aL(e)&&t.PK()},n.prototype.UK=function(e,t){var r=this;r.aL(e)&&r.ZK("end",t.seqNum),r.cL(t.err,t.stream)},n.prototype.WK=function(e,t){var r=this;if(r.bL(),r.aL(e)||r.l.synchStreamTimelines(e.type),r.__controller.sendEvent(m.STREAM_UPDATED,t),r.hH.length>0&&r.EH(),r.VJ){for(var n=0,i=Object.keys(r.zK),a=0;a<r.BK;a++)r.zK[i[a]].isActive()&&n++;++r.yK>=n&&(r.yK=0,r.__controller.sendMessage(E.MessageIds.PLAY_AFTER_STREAM_CHANGE))}},n.prototype.VK=function(e,t){var r=this;r.cL(t.err,t.stream)},n.prototype.cL=function(e,t){var r=this;r.FK.stop(),r.$H.handle(e,t)},n.prototype.bL=function(){var e=this,t=!0;e.$H.running&&(Object.keys(e.zK).forEach(function(r){var n=e.zK[r],i=n?n.getCurrentStream():null;i&&i.type!==d.SUBTITLES&&(t=t&&!n.isInError())}),t&&(e.$H.onLoadComplete(),e.$K()))},n.prototype.si=function(){var e=this;e.onPreloadEnd(),e.publish(g.PRELOAD_COMPLETE)},n.prototype.FH=function(e,t){var r=this;r.aL(e)&&r.__controller.sendEvent(m.LIVE_SYNCH,t)},n.prototype.aL=function(e){return e&&e.type===d.MAIN},n.prototype.YK=function(){var e=this;if(e.nI!==e.STATES.INITIALIZED)return!1;var t=!0;return Object.keys(e.zK).forEach(function(r){if(r!==d.SUBTITLES){var n=e.zK[r];t=t&&(!n.isActive()||n.isStreamReady())}}),t},n.prototype.EH=function(){var e=this,t=e.hH;e.hH=[],t.forEach(function(e){var t=e[0],r=e[1],n=e.length>2?e[2]:null;r&&"function"==typeof r&&r.apply(t,n)})},n.prototype.destroy=function(){var e=this;e.RK(),e.MK(),e.$H&&(e.$H.destroy(),e.$H=null),e.JI&&(e.JI.destroy(),e.JI=null),e.OG&&(e.OG.destroy(),e.OG=null),e.FK.destroy(),e.hH=[],v.prototype.destroy.call(e)}},{"../../../lib/event-bus":144,"../../../lib/hls-utils":145,"../../../lib/timer":150,"../../command/command-manager":157,"../../helper/error-handler":187,"../../helper/stream-loader":191,"../../model/worker-scope/model":201,"../../model/worker-scope/stream":204,"../../worker-utils/worker-defs":231,"./../../event":185,"./streamer":179,"./streamer-factory":178,"./switch-manager":182}],181:[function(e,t,r){"use strict";function n(e,t){var r=this;r.jI(e,t)}function i(e,t){var r=this;r.jI(e,t)}t.exports.SubtitleStreamer=n,t.exports.SubtitleLiveStreamer=i;var a=e("../../../lib/hls-utils"),o=e("./streamer").Streamer,s=e("./live-streamer"),l=e("../../command/command").CmdNames,c=e("./../../event").HLSEvent;a.inherits(n,o),a.inherits(i,s),i.prototype.jI=n.prototype.jI=function(e,t){var r=this;r.constructor.super_.call(r,e,t),r.aG=r.constructor.super_.prototype,r.dL={},r.uJ=l.CMD_SUBTITLE_SEGMENT_LOAD,r.primary=!1,r.nI=e.isReady()?r.STATES.INITIALIZED:r.STATES.NONE},i.prototype.destroy=n.prototype.destroy=function(){var e=this;e.dL={},e.aG.destroy.call(e)},i.prototype.onPlay=n.prototype.onPlay=function(e){var t=this;t.aG.onPlay.call(t,e)},i.prototype.onTimeUpdate=n.prototype.onTimeUpdate=function(e){var t=this;t.iK=e},i.prototype._J=n.prototype._J=function(){var e=this;return e.eL(e.iK)>=e.mK},i.prototype.sK=n.prototype.sK=function(){var e=this;return e.eL()>=e.l.config.maxTotalBuffer},i.prototype.pI=n.prototype.pI=function(e){var t=this,r=t.fp;return r?{subtitleStream:r,segment:r.getSegmentfromSeqNum(e),live:t.l.live}:{}},i.prototype.onSubtitleSegmentLoadComplete=n.prototype.onSubtitleSegmentLoadComplete=function(e,t){var r=this;if(t){var n=t.data;r.__controller.sendEvent(c.VTT_SEGMENT_LOADED,n),r.dL[n.sequenceNum]={start:n.startTime,end:n.startTime+n.duration}}r.aG.onSegmentLoadComplete.call(r,e)},i.prototype.onSubtitleSegmentLoadError=n.prototype.onSubtitleSegmentLoadError=function(e){var t=this;t.nI=t.STATES.NONE,t.JI.removeCommand(e)},i.prototype.dK=n.prototype.dK=function(e){var t=this,r=t.fp,n=e;if(!isNaN(n))for(;t.dL[n];)n++;return!t.nK&&n>r.endSeqNum?(t.WJ(!0),r.endSeqNum):n},i.prototype.eL=n.prototype.eL=function(e){var t=this,r=t.fp,n=r.getSeqNumBeforePosition(e);if(isNaN(n))return 0;for(var i=0;n<=r.endSeqNum;n++){var a=t.dL[n];if(!a)break;i=a.end-e}return i},i.prototype.fL=n.prototype.fL=function(){var e=this,t=0;return Object.keys(e.dL).forEach(function(r){var n=e.dL[r];n&&(t+=n.end-n.start)}),t},i.prototype.rI=n.prototype.rI=function(){var e=this;e.fp},i.prototype.tK=n.prototype.tK=function(){},i.prototype.mJ=n.prototype.mJ=function(){},i.prototype.onSynchMetadataReady=n.prototype.onSynchMetadataReady=function(){},i.prototype.setABRMode=n.prototype.setABRMode=function(){},i.prototype.canSwitch=n.prototype.canSwitch=function(){return!0}},{"../../../lib/hls-utils":145,"../../command/command":158,"./../../event":185,"./live-streamer":177,"./streamer":179}],182:[function(e,t,r){"use strict";function n(){var e=this;e.l=e.__controller.model,e.gL=e.__controller.create(i),e.hL={estimatedBandwidthInBps:0,bitrateList:[],currentIndex:0,bufferLength:0},e.FF={},e.IH(),e.SWITCH_BEGIN="switchBegin",e.SWITCH_END="switchEnd",e.SCENARIOS={STARTUP:"startup",LOAD:"load",ERROR:"error",MIDSEGMENT:"mid-segment"},e.switching=!0,o.call(e,e.constructor.name),e.FF[l.MEDIA_LOADED]=e.__controller.addEventListener(l.MEDIA_LOADED,e.IH,e)}t.exports=n;var i=e("./../../abr/abr-controller"),a=e("../../model/worker-scope/model").AbrModes,o=e("../../../lib/event-bus"),s=e("../../../lib/hls-utils"),l=e("./../../event").HLSEvent;s.inherits(n,o),n.prototype.destroy=function(){var e=this;e.gL.destroy(),e.__controller.removeEventListeners(e.FF),o.prototype.destroy.call(e)},n.prototype.switchStream=function(e,t,r){var n=this;n.l.getABRMode()!==a.AUTO&&n.l.streams.forEach(function(e,t){n.l.getUserReqBitrate()===e.bitrate&&(r=t)});var i=n.l.currentLoadingStreamIndex,o=n.iL(),s=n.jL(r,e,o);return!(s<0)&&(s!==i&&((!t||!("up"===t&&s<i||"down"===t&&s>i))&&(n.l.setCurrentLoadingStream(s),n.switching=!0,n.publish(n.SWITCH_BEGIN,s),!0)))},n.prototype.jL=function(e,t,r){var n=this;return"number"==typeof e?e:n.gL.getNextStreamIndex(r,t===n.SCENARIOS.STARTUP)},n.prototype.switchComplete=function(){var e=this;e.switching=!1,e.publish(e.SWITCH_END)},n.prototype.iL=function(){var e=this;e.kL();var t=e.hL,r=e.__controller.services.bandwidthEstimator,n=e.l.dimensions;return t.estimatedBandwidthInBps=1e3*r.averageBandwidth*1e3,t.currentIndex=e.l.currentLoadingStreamIndex,t.bufferLength=e.l.bufferLength,t.displayWidth=isNaN(n.width)?640:n.width,t.displayHeight=isNaN(n.height)?360:n.height,t.pixelRatio=e.l.pixelRatio,t.is360=e.l.is360,t.streams=e.l.streams,t.segmentLength=e.l.getSegmentLength(),t},n.prototype.IH=function(){var e=this;e.kL()},n.prototype.kL=function(){var e=this;e.l.streams&&!e.hL.bitrateList.length&&(e.hL.bitrateList=[],e.l.streams.forEach(function(t){e.hL.bitrateList.push("VBR"===t.rcMode.toUpperCase()?t.avgBitrate:t.bitrate)}))}},{"../../../lib/event-bus":144,"../../../lib/hls-utils":145,"../../model/worker-scope/model":201,"./../../abr/abr-controller":152,"./../../event":185}],183:[function(e,t,r){"use strict";function n(e,t){var r=this;r.jI(e,t)}function i(e,t){var r=this;r.jI(e,t),r.SEGMENT_OFFSET=2}t.exports.TsStreamer=n,t.exports.TsLiveStreamer=i;var a=e("../../../lib/hls-utils"),o=e("./streamer").Streamer,s=e("./live-streamer"),l=e("../../command/command").CmdNames,c=e("../../../lib/index"),u=e("../../worker-utils/worker-defs");a.inherits(n,o),a.inherits(i,s),i.prototype.jI=n.prototype.jI=function(e,t){var r=this;r.constructor.super_.call(r,e,t),r.aG=r.constructor.super_.prototype,r.processOnlyMetadata=!1,r.lastAudioTimestamp=NaN,r.lastAudioFrameDuration=NaN,r.mI(),r.uJ=l.CMD_SEGMENT_LOAD,r.primary=!0;var n=r.__controller.getMinimumBufferTime(),i=[{codec:"avc1.640021",type:"video",mimeType:'video/mp4; codecs="avc1.640021"',minBufferTime:n}];e&&e.hasAudio&&i.push({codec:"mp4a.40.2",type:"audio",mimeType:'audio/mp4; codecs="mp4a.40.2"',minBufferTime:n}),r.__controller.sendMessage(u.MessageIds.CREATE_SRC_BUFFER,[i],["tracks"]),r.nI=r.STATES.INITIALIZED},i.prototype.destroy=n.prototype.destroy=function(){var e=this;e.mI(),e.aG.destroy.call(e)},i.prototype.onSeeking=n.prototype.onSeeking=function(e){var t=this;t.lastAudioTimestamp=NaN,t.aG.onSeeking.call(t,e)},i.prototype.onSwitchBegin=n.prototype.onSwitchBegin=function(){var e=this;e.mI(),e.aG.onSwitchBegin.call(e)},i.prototype.oI=n.prototype.oI=function(){var e=this;e.mI()},i.prototype.pI=n.prototype.pI=function(e){var t=this,r=t.l.getSegment(t.l.currentLoadingStreamIndex,e);return{segment:r,stream:t.fp,state:{mp4:t.qI,lastAudioTimestamp:t.lastAudioTimestamp,lastAudioFrameDuration:t.lastAudioFrameDuration,isAltAudioActive:t.oK},onlyMetadata:t.processOnlyMetadata}},i.prototype.onSegmentLoadProgress=n.prototype.onSegmentLoadProgress=function(e,t,r){var n=this;if(t){var i=t.getParam?t.getParam("parsedInfo"):null;i&&(c.isNumber(i.pcr)&&n.l.setPCR(i.pcr),c.isNumber(i.startOffsetTimestamp)&&n.l.setStartOffset(i.startOffsetTimestamp),c.isNumber(i.lastAudioTimestamp)&&(n.lastAudioTimestamp=i.lastAudioTimestamp),c.isNumber(i.lastAudioFrameDuration)&&(n.lastAudioFrameDuration=i.lastAudioFrameDuration)),n.aG.onSegmentLoadProgress.call(n,e,t,r)}},i.prototype.mJ=n.prototype.mJ=function(e,t){var r=this;e&&(r.aG.mJ.call(r,e,t),e.forEach(function(e){r.qI[e.type].shouldInit=!1}))},i.prototype.onSynchMetadataReady=n.prototype.onSynchMetadataReady=function(e){var t=this;t.processOnlyMetadata=!1,t.aG.onSynchMetadataReady.call(t,e)},i.prototype.onManualStreamChange=n.prototype.onManualStreamChange=function(){var e=this;e.mI(),e.lastAudioTimestamp=NaN,e.aG.onManualStreamChange.call(e)},i.prototype.mI=n.prototype.mI=function(){var e=this;e.qI={audio:{shouldInit:!0,seqNum:0},video:{shouldInit:!0,seqNum:0}}},i.prototype.rI=n.prototype.rI=function(e,t){},n.prototype.onSynchBegin=function(){var e=this;e.processOnlyMetadata=!0},i.prototype.sI=function(e){var t=this;t.lastAudioTimestamp=NaN,t.aG.sI.call(t,e)}},{"../../../lib/hls-utils":145,"../../../lib/index":146,"../../command/command":158,"../../worker-utils/worker-defs":231,"./live-streamer":177,"./streamer":179}],184:[function(e,t,r){"use strict";function n(e,t){var r=this;r.code=e[0],r.message=e[1],r.type=e[2],r.isDrm=e[3],t&&(r.message+=": "+t),r.error=new Error(r.message,r.code)}var i={API:"api",NETWORK:"network",DECODE:"decode"};t.exports={Error:n,ERR_XHR_LOAD:[11,"Failed to load xhr request",i.NETWORK,!1],ERR_PLAYLIST_LOAD:[12,"Failed to load Playlist",i.NETWORK,!1],ERR_SUBS_LOAD:[13,"Failed to load Subtitle",i.NETWORK,!1],ERR_SEGMENT_LOAD:[14,"Failed to load Segment",i.NETWORK,!1],ERR_PARTIAL_LOAD:[15,"Loader failed to load complete data",i.NETWORK,!1],ERR_MASTER_PLAYLIST_PARSE:[16,"Failed to parse Master Playlist",i.DECODE,!1],ERR_MEDIA_PLAYLIST_PARSE:[17,"Failed to parse Media Playlist",i.DECODE,!1],ERR_SEGMENT_PARSE:[18,"Failed to parse segment data",i.DECODE,!1],ERR_API_NO_NODE:[19,"No video node is being set",i.API,!1],ERR_MIMETYPE_NOT_SUPPORTED:[20,"Mimetype is not supported in current browser",i.DECODE,!1],ERR_XHR_LOAD_LIVE_PAUSE:[21,"Failed to load xhr request during live pause",i.NETWORK,!1],ERR_DRM_EME_MISSING:[22,"Browser EME components not detected or HTTPS required",i.DECODE,!0],ERR_DRM_INIT:[23,"Failed to initialize DRM components",i.DECODE,!0],ERR_DRM_CONFIG:[24,"Browser/system does not support the requested DRM configurations",i.DECODE,!0],ERR_DRM_LICENSE_REQUEST:[25,"Failed to get DRM license",i.DECODE,!0],ERR_XHR_LOAD_FORBIDDEN:[27,"Forbidden to load xhr request",i.NETWORK,!1]},n.prototype.dto=function(){var e=this,t={code:e.code,message:e.message,type:e.type,isDrm:e.isDrm};return t}},{}],185:[function(e,t,r){"use strict";r.HLSEvent={STATE_CHANGED:"stateChanged",PRELOAD_PROGRESS:"preloadProgress",MEDIA_LOADED:"mediaLoaded",MEDIA_METADATA_LOADED:"mediaMetadataLoaded",STREAM_UPDATED:"streamUpdated",INFO_UPDATE:"infoUpdate",SEGMENT_FIRST_BYTE_LOADED:"segmentFirstByteLoaded",SEGMENT_RENDERED:"segmentRendered",VTT_SEGMENT_LOADED:"vttSegmentLoaded",PCR_AVAILABLE:"pcrAvailable",STREAM_SWITCHED:"streamSwitched",LIVE_LOADING_LATE:"liveLoadingLate",LIVE_SYNCH:"liveSynch",WAITING:"hlsWaiting",CUEPOINT_DETECTED:"cuepointDetected",CUEPOINT_STARTED:"cuepointStarted",ABR_DATA_UPDATED:"abrDataUpdated",
ERROR:"error",SEG_INFO_METRICS_AVAILABLE:"segInfoMetricsAvailable",CONTENT_LOAD_FINISHED:"contentLoadFinished",PRELOAD_START:"preloadStart",PRELOAD_COMPLETE:"preloadComplete",CC_VTT_AVAILABLE:"ccVttAvailable",BUFFER_GROWTH_DETECTED:"bufferGrowthDetected",MULTI_LANGUAGES_AVAILABLE:"multiLanguagesAvailable",TIMED_METADATA_READY:"timedMetadataReady",PLAY_BLOCKED:"playbackBlocked",BUFFER_GAP_DETECTED:"bufferGapDetected"},r.ExternalEvents=[r.HLSEvent.MEDIA_LOADED,r.HLSEvent.MEDIA_METADATA_LOADED,r.HLSEvent.INFO_UPDATE,r.HLSEvent.VTT_SEGMENT_LOADED,r.HLSEvent.SEGMENT_FIRST_BYTE_LOADED,r.HLSEvent.SEGMENT_RENDERED,r.HLSEvent.STREAM_SWITCHED,r.HLSEvent.LIVE_LOADING_LATE,r.HLSEvent.STREAM_UPDATED,r.HLSEvent.WAITING,r.HLSEvent.CUEPOINT_DETECTED,r.HLSEvent.CUEPOINT_STARTED,r.HLSEvent.ABR_DATA_UPDATED,r.HLSEvent.PRELOAD_PROGRESS,r.HLSEvent.SEG_INFO_METRICS_AVAILABLE,r.HLSEvent.CONTENT_LOAD_FINISHED,r.HLSEvent.PRELOAD_START,r.HLSEvent.PRELOAD_COMPLETE,r.HLSEvent.CC_VTT_AVAILABLE,r.HLSEvent.BUFFER_GROWTH_DETECTED,r.HLSEvent.MULTI_LANGUAGES_AVAILABLE,r.HLSEvent.TIMED_METADATA_READY,r.HLSEvent.PLAY_BLOCKED,r.HLSEvent.BUFFER_GAP_DETECTED]},{}],186:[function(e,t,r){"use strict";function n(e,t){var r=this;e.noDemux=!0,r.constructor.super_.call(r,e,t),r.aG=r.constructor.super_.prototype}t.exports=n;var i=e("../../lib/hls-utils"),a=e("./hls-transformer");i.inherits(n,a),n.prototype.destroy=function(){var e=this;e.aG.destroy.call(e)}},{"../../lib/hls-utils":145,"./hls-transformer":189}],187:[function(e,t,r){"use strict";function n(e){var t=this;t.l=t.__controller.model,t.JI=e,t.SWITCH_ON_ERROR="switchOnError",t.Nn=null,i.call(t,t.constructor.name),t.running=!1}t.exports=n;var i=e("../../lib/event-bus"),a=e("../../lib/hls-utils"),o=e("../command/command").CmdNames,s=e("../model/worker-scope/stream").StreamTypes;a.inherits(n,i),n.prototype.destroy=function(){var e=this;e.l=null,e.JI=null,e.Nn=null,e.running=!1},n.prototype.handle=function(e,t){var r=this;if(e&&t&&t.type!==s.SUBTITLES){var n=t.index;r.Nn=e;var i={streamIndex:n,error:e};r.running=!0;var a=r.JI.getCommand(o.CMD_ERROR_HANDLE);a?a.execute(n):r.JI.executeCommand(o.CMD_ERROR_HANDLE,i,r)}},n.prototype.onErrorHandleProgress=function(e,t){var r=this;r.publish(r.SWITCH_ON_ERROR,t.index)},n.prototype.onErrorHandleError=function(e){var t=this;t.running=!1,t.JI.removeCommand(e),t.__controller.notifyError(t.Nn)},n.prototype.onLoadComplete=function(){var e=this;e.running=!1;var t=e.JI.getCommand(o.CMD_ERROR_HANDLE);e.JI.removeCommand(t)}},{"../../lib/event-bus":144,"../../lib/hls-utils":145,"../command/command":158,"../model/worker-scope/stream":204}],188:[function(e,t,r){"use strict";function n(e,t){var r=this;if(r.l=r.__controller.model,r.jH=r.l.config.useWorker,r.lL=r.l.userAgent,r.ZG="HlsTransformer",r.$G=o.guid(),r.GI=e,r.HI=t,r.MIN_BUFFER_LENGTH=5,r.kH()){if(r.lH=r.__controller.services.getWorker(r.ZG),r.lH)return r.lH.addEventListener("message",r.nH.bind(r)),void r.oH(a.MessageIds.CREATE,[e]);r.l.config.useWorker=!1}r.mL=new i(e,t),r.jH=!1}t.exports=n;var i=e("./hls-transformer"),a=e("../worker-utils/worker-defs"),o=e("../../lib/hls-utils"),s=e("../controller/main/controller-states"),l=e("../worker-utils/message");n.prototype.destroy=function(){var e=this;e.jH&&e.lH?e.oH(a.MessageIds.DESTROY):e.mL.destroy()},n.prototype.close=function(){var e=this;e.jH&&e.lH?e.oH(a.MessageIds.CALL_METHOD,null,"close"):e.mL.close()},n.prototype.append=function(e){var t=this;t.jH&&t.lH?t.oH(a.MessageIds.CALL_METHOD,[e],"append",[e.buffer]):t.mL.append(e)},n.prototype.endOfSegment=function(){var e=this;e.jH&&e.lH?e.oH(a.MessageIds.CALL_METHOD,null,"endOfSegment"):e.mL.endOfSegment()},n.prototype.nH=function(e){var t=this;if(e){var r=e.data?new l(e.data):e;if(r&&r.instanceId===t.$G&&(r.id===a.MessageIds.APPEND_SRC_BUFFER||r.id===a.MessageIds.TIMED_METADATA)){var n=r.getParam("parsedInfo");n&&(n.inWorkerScope=!0),t.HI(r)}}},n.prototype.kH=function(){var e=this;return!!e.jH&&(e.lL.chrome&&!e.lL.win7?e.jH=!(e.__controller&&e.__controller.getState()>=s.PLAY_REQUESTED)||e.l.bufferLength>e.MIN_BUFFER_LENGTH:e.jH=!1,e.jH)},n.prototype.oH=function(e,t,r,n){var i=this;if(i.lH&&e){var o={type:a.MessageTypes.MESSAGE,id:e,moduleName:i.ZG,instanceId:i.$G,funcName:r,args:t,timestamp:Date.now()};i.lH.postMessage(o,n)}}},{"../../lib/hls-utils":145,"../controller/main/controller-states":168,"../worker-utils/message":229,"../worker-utils/worker-defs":231,"./hls-transformer":189}],189:[function(e,t,r){"use strict";function n(e,t){var r=this;r.GI=e,r.HI=t,r.nL=e.noDemux?null:new i(e.demux,r.processSegmentData.bind(r)),r.oL=new a,r.DEFAULT_WIDTH=640,r.DEFAULT_HEIGHT=360,r.GAP_EPSILON=100,r.pL=r.GI.startOffsetTimestamp,r.qL=r.GI.lastAudioTimestamp,r.rL=r.GI.lastAudioFrameDuration,r.oK=r.GI.isAltAudioActive,r.sL=r.GI.prevSegEndTimeStamps;var n=r.GI.mp4State;r.tL={audio:!n||!n.audio||n.audio.shouldInit,video:!n||!n.video||n.video.shouldInit},r.uL={audio:0,video:0},r.vL={audio:{dts:NaN,pts:NaN},video:{dts:NaN,pts:NaN}}}t.exports=n;var i=e("../ts-demux/ts-parser"),a=e("../mp4/mp4-generator"),o=e("../../lib"),s=e("../worker-utils/worker-defs"),l=e("../worker-utils/message");n.prototype.destroy=function(){var e=this;e.nL&&(e.nL.destroy(),e.nL=null),e.oL.destroy()},n.prototype.close=function(){var e=this;e.nL&&e.nL.destroy()},n.prototype.append=function(e){var t=this;t.nL&&t.nL.append(e)},n.prototype.endOfSegment=function(){var e=this;e.nL&&e.nL.endOfSegment()},n.prototype.processSegmentData=function(e){var t=this;if(e&&!e.error){var r,n=e.avData,i=e.pos,a=e.timedMetadata,o=t.GI.startTime,c=t.GI.timescale;if(n){var u=t.GI.pcr;(null===u||void 0===u||isNaN(u))&&(t.GI.pcr=u=n.pcr-o*c);var p=[],d=n.audio,f=n.video,v=null,m=0,y=[];if(d&&d.frames&&d.frames.length&&!t.oK&&(d.type="audio",d.config.timescale=c,d.config.duration=t.GI.duration*d.config.timescale,d.config.useEditBox=t.GI.useEditBox,t.wL("audio",d.frames[0],u,o,c),m=u+t.uL.audio,d.frames.forEach(function(e){e.dts-=m,e.pts-=m}),d.startTime=d.frames[0].dts,d.endTime=d.frames[d.frames.length-1].dts,p.push(d)),f&&f.frames&&f.frames.length){f.type="video",f.config.timescale=c,f.config.duration=t.GI.duration*f.config.timescale,f.config.width=t.GI.width||t.DEFAULT_WIDTH,f.config.height=t.GI.height||t.DEFAULT_HEIGHT,f.config.useEditBox=t.GI.useEditBox,t.wL("video",f.frames[0],u,o,c),m=u+t.uL.video,f.frames.forEach(function(e){e.dts-=m,e.pts-=m}),f.startTime=f.frames[0].dts,f.endTime=f.frames[f.frames.length-1].dts,v=f.frames[0].pts,p.push(f);for(var h=0;h<f.frames.length;h++)for(var E=0;E<f.frames[h].cea608Data.length;E++){var g=f.frames[h].cea608Data[E];g.pts=f.frames[h].pts,g.dts=f.frames[h].dts,g.timescale=f.config.timescale,y.push(g)}}r=new l({type:s.MessageTypes.MESSAGE,id:s.MessageIds.APPEND_SRC_BUFFER});var b={};b.position=t.position=i,b.pcr=u,"number"!=typeof t.pL&&"number"==typeof v&&(t.pL=v),b.startOffsetTimestamp=t.pL;var _=t.xL(p);b.lastAudioTimestamp=t.qL,b.lastAudioFrameDuration=t.rL,r.putParam("parsedInfo",b);var A=[];_&&_.tracks&&(r.putParam("tracks",_.tracks),_.tracks.forEach(function(e){A.push(e.data.buffer)}),y&&y.length>0&&r.putParam("cea608TrackData",y),r.putParam("transferables",A))}else{if(!a)return;a.timestamp=(a.pts-t.GI.pcr)/c,delete a.pts,r=new l({type:s.MessageTypes.MESSAGE,id:s.MessageIds.TIMED_METADATA}),r.putParam("timedMetadata",a)}t.HI&&t.HI(r)}},n.prototype.wL=function(e,t,r,n,i){var a=this,o=a.GI.discontinuity,s=a.vL[e];isNaN(s.dts)&&isNaN(s.pts)&&(a.vL[e]={dts:t.dts-r,pts:t.pts-r});var l=a.uL[e];if(o&&0===l){var c=a.sL?a.sL.audio:NaN;n=isNaN(c)?n*i:c,a.uL[e]=a.vL[e].dts-n}},n.prototype.xL=function(e){var t=this;if(e&&e.length){var r={tracks:[]};return e.forEach(function(e){if(e){e.config.offset=t.GI.live?0:t.pL;var n=t.GI.mp4State,i=t.tL[e.type];e.config.shouldInit=o.isNullOrUndefined(i)?"start"===t.position:i,e.config.seqNum=n[e.type]?n[e.type].seqNum++:0,"video"===e.type?e.config.defaultFrameDuration=t.GI.timescale/t.GI.frameRate:"audio"===e.type&&(e.config.defaultFrameDuration=Math.ceil(1024*t.GI.timescale/e.config.samplingFreq),t.yL(e.frames,e.config.defaultFrameDuration)),t.tL[e.type]=!1,t.GI.onlyMetadata&&(e.frames=[]);var a=t.oL.generate(e);a.onlyMetadata=t.GI.onlyMetadata,r.tracks.push(a)}}),r}},n.prototype.yL=function(e,t){var r=this;if(e&&e.length){var n=e[e.length-1].dts,i=e[0].dts;if(o.isNumber(r.qL)&&!isNaN(r.qL)){var a=i-r.qL,s=Math.ceil(2*r.rL)-r.GAP_EPSILON,l=Math.ceil(6*r.rL);if(a>s);else if(a<r.rL-r.GAP_EPSILON){var c=r.qL+r.rL,u=c-i;u>t&&(c=i+t-1),e[0].pts=c,e[0].dts=e[0].pts}if(a>s&&a<l)for(var p=Math.floor(a/t),d=0;d<p;d++){var f=e[0].dts;e.unshift(o.deepCopy(e[0])),e[0].dts=f-t,e[0].pts=e[0].dts}}r.qL=n,r.rL=t}}},{"../../lib":146,"../mp4/mp4-generator":209,"../ts-demux/ts-parser":228,"../worker-utils/message":229,"../worker-utils/worker-defs":231}],190:[function(e,t,r){"use strict";function n(){}t.exports=n;var i=10,a=10;n.prototype.zL=function(e,t){for(var r=this,n=t,i=0;r.AL(e,t);)i+=10,i+=r.BL(e,t+6),r.CL(e,t+10)&&(i+=10),t+=i;return i>0?e.subarray(n,n+i):null},n.prototype.AL=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},n.prototype.CL=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},n.prototype.BL=function(e,t){var r=(127&e[t])<<21;return r|=(127&e[t+1])<<14,r|=(127&e[t+2])<<7,r|=127&e[t+3]},n.prototype.getString=function(e){var t=this,r=t.zL(e,0);if(!r||!r.length)return null;for(var n="",i=0;i<r.length;i++)n+=String.fromCharCode(r[i]);return n},n.prototype.DL=function(e){return 100===e[5]?self.BL(e,i):0},n.prototype.EL=function(e,t){var r=e.subarray(t,t+4);return String.fromCharCode.apply(null,r)},n.prototype.getID3Payload=function(e){var t=this,r=t.zL(e,0);if(!r||!r.length)return null;var n=t.DL(r),o=i+n,s={key:t.EL(r,o),data:r.subarray(o+a)};return s},n.prototype.extractID3FromMessage=function(e){var t=this;if(!e)return null;e=new Uint8Array(e);for(var r=0;!t.AL(e,r);)r++;return r+i>e.length?null:e.subarray(r)}},{}],191:[function(e,t,r){"use strict";function n(e){var t=this;l.call(t,t.constructor.name),t.l=t.__controller.model,t.JI=e,t.II=t.__controller.services.metadataParser,t.stream=null,t.loaded=!1}t.exports.StreamLoader=n;var i=e("../command/command").CmdNames,a=e("./../model/worker-scope/model").MetadataTypes,o=e("../error"),s=e("../../lib/hls-utils"),l=e("../../lib/event-bus"),c=t.exports.Events={STREAM_LOADED:"streamLoaded",STREAM_LOAD_ERROR:"streamLoadError"};s.inherits(n,l),n.prototype.destroy=function(){var e=this;l.prototype.destroy.call(e)},n.prototype.load=function(e,t){var r=this;e&&(r.stream=e,r.loaded=!1,r.JI.executeCommand(i.CMD_STREAM_LOAD,{stream:e,retryOpts:t},r))},n.prototype.cancel=function(){var e=this;e.JI.removeRelatedCommands(i.CMD_STREAM_LOAD)},n.prototype.onStreamLoadComplete=function(e,t){var r=this;if(e){if(!t||!t.stream)return void r.JI.removeCommand(e);var n=t.stream,i={rawData:t.data,headers:t.headers,type:a.RAW,streamType:n.type,groupId:n.groupId,name:n.name,url:t.streamUrl,index:n.index};r.l.build(r.II.parse(i)),r.JI.removeCommand(e),r.loaded=!0,r.publish(c.STREAM_LOADED,n)}},n.prototype.onStreamLoadError=function(e,t){var r=this;r.JI.removeCommand(e);var n=t.code===o.ERR_XHR_LOAD[0]?new o.Error(o.ERR_PLAYLIST_LOAD):t;r.publish(c.STREAM_LOAD_ERROR,r.stream,n)}},{"../../lib/event-bus":144,"../../lib/hls-utils":145,"../command/command":158,"../error":184,"./../model/worker-scope/model":201}],192:[function(e,t,r){"use strict";function n(){var e=this;e.FL={},e.GL=Number.NaN,e.HL=!1,e.IL=NaN,e.Ep=[]}t.exports=n;var i=e("../../lib/index");n.prototype.destroy=function(){var e=this;e.FL={},e.Ep=[]},n.prototype.addStream=function(e){var t=this;t.Ep.push(e),t.Ep.length&&(t.GL=t.Ep[0].endSeqNum)},n.prototype.update=function(e){var t=this;if(e){var r=t.JL(e);if(r){var n=t.__controller.model.live;if(n&&(e=r.isDash()?t.KL(e,r):t.LL(e)),r.updateConfig(e),n&&!r.isDash()&&t.GL>=r.endSeqNum){var i=1e3*r.targetDuration,a=!isNaN(i)&&i>0?i:r.refreshInterval;r.refreshInterval=.5*a}t.GL=r.endSeqNum}}},n.prototype.JL=function(e){var t=this;if(!e||!t.Ep.length)return null;for(var r=0;r<t.Ep.length;r++)if(t.Ep[r].equals(e))return t.Ep[r];return null},n.prototype.LL=function(e){var t=this;if(!e)return e;var r=e.segmentInfoList;if(!r||!r.length)return e;Object.keys(t.FL).length||(t.FL[r[0].sequenceNum]={startTime:r[0].startTime,programDateTime:r[0].programDateTime});var n,i,a,o,s=t.FL[r[0].sequenceNum];if(s&&"number"==typeof s.startTime)n=t.FL[r[0].sequenceNum].startTime;else{var l=Object.keys(t.FL),c=parseInt(l[l.length-1]);r[r.length-1].sequenceNum<c;var u=0;for(i=1;i<r.length;i++)if(l.indexOf(r[i].sequenceNum.toString())!==-1){u=i;break}if(u)for(n=t.FL[r[u].sequenceNum].startTime,i=u-1;i>=0;i--)n-=r[i].duration;else{if(r[0].sequenceNum>c)a=parseInt(l[l.length-1]),o=t.FL[a];else for(i=r[r.length-1].sequenceNum;i<=c;){if(l.indexOf(i.toString())!==-1){a=i,o=t.FL[a];break}i++}n="number"==typeof o.programDateTime?o.startTime+(r[0].programDateTime-o.programDateTime)/1e3:o.startTime+(r[0].sequenceNum-a)*r[0].duration}}var p=0;return r.forEach(function(e){e.startTime=n+p,p+=e.duration,!t.HL&&e.discontinuity&&(t.HL=!0,t.IL=e.startTime),t.HL&&!isNaN(t.IL)&&(e.discontinuity=e.startTime>=t.IL),t.FL[e.sequenceNum]||(t.FL[e.sequenceNum]={startTime:e.startTime,programDateTime:e.programDateTime})}),e},n.prototype.KL=function(e,t){if(!e||!t)return e;var r=e.segmentInfoList;if(!r||!r.length)return e;var n=t.segments;if(!n||!n.length)return e;for(var i=0,a=!1,o=0;o<n.length;o++)if(i=n[o].seqNum,n[o].startTime>=r[0].startTime){a=!0;break}a||i++;for(var s=0;s<r.length;s++)r[s].sequenceNum=i,i++;return e},n.prototype.adjustStartTime=function(e,t,r){var n=this;if(e&&!i.isNullOrUndefined(r)&&!i.isNullOrUndefined(t)){var a=Object.keys(n.FL),o=a.length?a[0]:null,s=o?n.FL[o]:null,l=s?(s.programDateTime-r)/1e3-(s.startTime-t):0;if(!l)return void(e.adjusted=!0);a.forEach(function(e){s=n.FL[e],s.startTime+=l}),e.segments.forEach(function(e){s=n.FL[e.seqNum],e.startTime=s?s.startTime:e.startTime+l}),e.adjusted=!0}}},{"../../lib/index":146}],193:[function(e,t,r){"use strict";function n(e,t,r,n){var i=this;a.call(i,i.constructor.name),i.node=t,i.window=e,i.mediaSource=new e.MediaSource,i.hH=[],i.ML=!1,i.node.mediaKeys?(i.node.src="",i.node.setMediaKeys(null).then(function(){i.cm(e,t,r,n)})):i.cm(e,t,r,n)}t.exports=n;var i=e("./controller/main/controller-facade"),a=e("../lib/event-bus"),o=e("./event"),s=e("../lib/hls-utils"),l=e("user-agent").userAgent,c=e("./model/main/app-model");s.inherits(n,a),n.prototype.cm=function(e,t,r,n){var a=this;a.node.src=e.URL.createObjectURL(a.mediaSource),n=n||{},n.userAgent=l,n.inWorkerScope=!1,n.metadata=r,a.appModel=a.create(c,n),a.controller=a.create(i,r),a.ML=!0,a.node.load(),this.EH()},n.prototype.create=function(){var e=this,t=Array.prototype.slice.call(arguments),r=t.shift(),n=Object.create(r.prototype);return n.MG=e,r.apply(n,t),n},n.prototype.sendEvent=function(e,t){var r=this;r.publish(e,t),e&&o.ExternalEvents.indexOf(e)>=0&&r.node.dispatchEvent(r.NL(e,t))},n.prototype.getSegInfo=function(){var e=this;return e.controller?e.controller.getSegInfo():null},n.prototype.notifyError=function(e){var t=this;t.error=e;var r=t.error.type||"decode";"open"===t.mediaSource.readyState&&t.mediaSource.endOfStream(r),t.controller&&t.controller.destroy()},n.prototype.isMimetypeSupported=function(e){var t=this;return t.window.MediaSource.isTypeSupported(e)},n.prototype.NL=function(e,t){var r=this;return new r.window.CustomEvent(e,{detail:t,bubbles:!1,cancelable:!1})},n.prototype.setABRMode=function(e){var t=this;return t.controller?void t.controller.setABRMode(e):void t.hH.push(["setABRMode",[e]])},n.prototype.setAudioLanguage=function(e){var t=this;return t.controller?void t.controller.setAudioLanguage(e):void t.hH.push(["setAudioLanguage",[e]])},n.prototype.play=function(e){var t=this;return t.controller?void t.controller.play(e):void t.hH.push(["play",[e]])},n.prototype.pause=function(){var e=this;return e.controller?void e.controller.pause():void e.hH.push(["pause"])},n.prototype.preload=function(e){var t=this;return t.controller?void t.controller.preload(e):void t.hH.push(["preload",[e]])},n.prototype.getCurrentDate=function(){var e=this;return e.controller?e.controller.getCurrentDate():null},n.prototype.suspendStreaming=function(){var e=this;e.controller&&(e.ML=!1,e.controller.suspendStreaming())},n.prototype.resumeStreaming=function(){var e=this;e.controller&&!e.ML&&(e.controller.resumeStreaming(),e.ML=!0)},n.prototype.destroy=function(){var e=this;e.controller&&e.controller.destroy(),e.appModel&&e.appModel.destroy(),e.mediaSource=null,e.ML=!1,a.prototype.destroy.call(e)},n.prototype.EH=function(){var e=this,t=e.hH;e.hH=[],t.forEach(function(t){var r=e.controller,n=r[t[0]],i=t.length>1?t[1]:null;n&&"function"==typeof n&&n.apply(r,i)})}},{"../lib/event-bus":144,"../lib/hls-utils":145,"./controller/main/controller-facade":167,"./event":185,"./model/main/app-model":196,"user-agent":233}],194:[function(e,t,r){"use strict";function n(e,t){var r=this;r.OL=t||{},"string"==typeof e?r._node=document.querySelector(e):r._node=e||null,Object.defineProperty(r,"error",{enumerable:!0,get:function(){return r.MG?r.MG.error:null}}),o.apply()}t.exports=n;var i=e("./hls-context"),a=e("./error"),o=e("../lib/polyfills");n.prototype.setSrc=function(e){var t=this;if(!t._node)throw new a.Error(a.ERR_API_NO_NODE).error;if(!e)return void(t._node.src="");if(e!==t.PL){t.PL=e,t.MG&&t.unload();try{t.MG=new i(window,t._node,t.PL,t.OL)}catch(e){console.error("[HlsPlayer][setSrc] Exception = "+e.message+" stack = "+e.stack)}}},n.prototype.getSegInfo=function(){var e=this;try{return e.MG?e.MG.getSegInfo():null}catch(e){return console.error("[HlsPlayer][getSegInfo] Exception = "+e.message+" stack = "+e.stack),null}},n.prototype.setQuality=function(e){var t=this;try{t.MG.setABRMode(e)}catch(e){console.error("[HlsPlayer][setQuality] Exception = "+e.message+" stack = "+e.stack)}},n.prototype.setAudioLanguage=function(e){var t=this;try{t.MG.setAudioLanguage(e)}catch(e){console.error("[HlsPlayer][setAudioLanguage] Exception = "+e.message+" stack = "+e.stack)}},n.prototype.unload=function(){var e=this;e.MG&&e.MG.destroy(),e.MG=null},n.prototype.play=function(e){var t=this;t.MG&&t.MG.play(e)},n.prototype.pause=function(){var e=this;e.MG?e.MG.pause():e._node&&e._node.pause()},n.prototype.preload=function(e){var t=this;t.MG&&t.MG.preload(e)},n.prototype.getCurrentDate=function(){var e=this;if(e.MG)return e.MG.getCurrentDate()||null},n.prototype.suspendStreaming=function(){var e=this;e.MG&&e.MG.suspendStreaming()},n.prototype.resumeStreaming=function(){var e=this;e.MG&&e.MG.resumeStreaming()},n.prototype.destroy=function(){var e=this;e.MG&&e.MG.destroy(),e.MG=null,e.PL=null,e.OL=null,e._node=null}},{"../lib/polyfills":149,"./error":184,"./hls-context":193}],195:[function(e,t,r){"use strict";t.exports={useWorker:!0,maxRetries:5,maxBuffer:60,maxTotalBuffer:300,requestTimeout:10,chunkedRequestTimeout:5,pastBufferLengthLimit:{vod:180,live:10},segmentLoadMonitorInterval:1,preloadBufferLimit:0,skipGapLimit:.5,variableMinBuffer:!0,minBufferTime:{vod:.1,live:4},sendAbrAnalytics:!1,demux:{startChunkWithKeyFrame:!0},stopBufferingOnPause:!1,dimensions:{width:640,height:360},bwHistoryMaxAge:300}},{}],196:[function(e,t,r){"use strict";function n(e){var t=this;if(!e||!e.userAgent)throw new Error("Invalid/incomplete configuration to AppModel");t.configure(e),t.streams=[],t.altRenditionGroups=[],t.live=!1,t.duration=0,t.timescale=9e4,t.TIMESTAMP_COMPARE_EPSILON=.065,t.PIXEL_RATIO_360=6,t.currentPlayingStreamIndex=0,t.currentLoadingStreamIndex=0,t.preloading=!1,t.currentKbps=0,t.infoUpdateSent=!0,t.streamingMode=s.HLS,t.drmRequired=!1,t.drmInfo=[],t.licenseType="none",t.is360=e.metadata&&e.metadata.is360||!1,t.setDimensions(e.dimensions)}t.exports=n;var i=e("../default-config"),a=e("../../../lib/index"),o=e("../../../lib/hls-utils"),s=e("../worker-scope/model").StreamingMode;n.prototype.destroy=function(){var e=this;e.config=null,e.streams=[],e.altRenditionGroups=[]},n.prototype.configure=function(e){var t=this;t.config=t.config||a.deepCopy(i),t.userAgent=e.userAgent,e&&Object.keys(e).forEach(function(r){t.config.hasOwnProperty(r)&&(t.config[r]=e[r])}),t.config.demux.startChunkWithKeyFrame=!(t.userAgent.chrome&&t.userAgent.chrome>=50)||t.xH(e.metadata),t.config.demux.useTimer=!(t.userAgent.chrome||t.userAgent.ie||t.userAgent.edge)},n.prototype.xH=function(e){var t=this;if(!e)return!1;var r=e.url,n=e.streams&&e.streams.length?t.yH(e.streams[0]):null;return o.isUplynk(r||n)},n.prototype.yH=function(e){if(!e)return null;var t=e.url;return!t&&e.host&&e.path&&(t=e.host+e.path),t},n.prototype.update=function(e){var t=this;e&&(Object.keys(e).forEach(function(r){("currentKbps"!==r||e.currentKbps||t.infoUpdateSent)&&t.hasOwnProperty(r)&&(t[r]=e[r])}),t.infoUpdateSent=!1)},n.prototype.setDimensions=function(e){var t=this,r=t.MG.node;t.QL=e?e:{width:r?r.clientWidth:0,height:r?r.clientHeight:0}},n.prototype.getBufferLength=function(){var e,t,r=this,n=r.MG.node,i=n.buffered,a=0,o=n.currentTime;if(0===o){for(e=0;e<i.length;e++)a+=i.end(e)-i.start(e);return a}var s=r.MG.mediaSource;a=1/0;for(var l=0;l<s.activeSourceBuffers.length;l++){var c=r.RL(o,s.activeSourceBuffers[l]);c>=0&&(a=Math.min(a,c))}for(e=0;e<i.length;e++)if(o>=i.start(e)&&o<i.end(e)){t=e;break}return t>=0&&i.length&&(a=Math.min(i.end(t)-o,a)),a===1/0&&(a=0),a},n.prototype.RL=function(e,t){if(!t)return-1;for(var r,n=t.buffered,i=0,a=0;a<n.length;a++)if(e>=n.start(a)&&e<n.end(a)){r=a;break}return r>=0&&n.length&&(i=n.end(r)-e),i},n.prototype.getBufferedDto=function(){for(var e=this,t=e.MG.node,r=t.buffered,n={length:r.length,ranges:[]},i=0;i<r.length;i++)n.ranges[i]={start:r.start(i),end:r.end(i)};return n},n.prototype.getCurrentPlayingStream=function(){var e=this;return e.streams&&e.streams.length&&e.currentPlayingStreamIndex>=0&&e.currentPlayingStreamIndex<e.streams.length?e.streams[e.currentPlayingStreamIndex]:null},n.prototype.getDimensions=function(){var e=this;return e.QL},n.prototype.getPixelRatio=function(){var e=this,t=1;try{window&&(t=window.devicePixelRatio)}catch(e){t=1}return t||(t=1),e.is360&&(t*=e.PIXEL_RATIO_360),t},n.prototype.getCurrentDate=function(){var e=this,t=e.getCurrentPlayingStream(),r=e.MG.node,n=r.currentTime,i=t?t.segments:null;if(i)for(var a=i.length-1;a>=0;a--)if(i[a].programDateTime>0&&n>=i[a].startTime){var o=parseInt(1e3*(n-i[a].startTime));return i[a].programDateTime+o}}},{"../../../lib/hls-utils":145,"../../../lib/index":146,"../default-config":195,"../worker-scope/model":201}],197:[function(e,t,r){"use strict";function n(e,t,r,n){var l=this;if(l.type=e,l.groupId=t,l.SL=[],l.TL=l.__controller.create(s),r){r.forEach(function(e){var t=l.__controller.create(i,e);l.SL.push(t),l.TL.addStream(t)});var c=l.UL("default");c||(c=l.UL("autoSelect")),c&&(l.setCurrentStream(c),c.type===o.SUBTITLES&&l.__controller.sendEvent(a.CC_VTT_AVAILABLE,{sessionId:l.__controller.model.sessionId})),e===o.AUDIO&&(n&&l.setCurrentStreamWithName(n),l.VL())}!l.WL()}t.exports=n;var i=e("./alternate-stream"),a=e("../../event").HLSEvent,o=e("./stream").StreamTypes,s=e("../../helper/stream-updater");n.prototype.UL=function(e){for(var t=this,r=0;r<t.SL.length;r++)if(t.SL[r][e])return t.SL[r];return null},n.prototype.destroy=function(){var e=this;e.SL.forEach(function(e){e.destroy()}),e.SL=[],e.TL.destroy()},n.prototype.getCurrentStream=function(){var e=this;return e.fp},n.prototype.setCurrentStream=function(e){var t=this;e&&(t.fp=e)},n.prototype.setCurrentStreamWithName=function(e){var t=this;if(!e||!t.fp||e===t.fp.name)return!1;for(var r=0;r<t.SL.length;r++){var n=t.SL[r];if(e===n.name)return t.setCurrentStream(n),!0}return!1},n.prototype.update=function(e){var t=this;t.TL.update(e)},n.prototype.adjustStartTime=function(e,t){var r=this;r.SL.forEach(function(n){n.adjusted||r.TL.adjustStartTime(n,e,t)})},n.prototype.getContainerFormat=function(){var e=this;return e.fp?e.fp.containerFormat:null},n.prototype.setContainerFormat=function(e){var t=this;t.SL.forEach(function(t){t.containerFormat||(t.containerFormat=e)})},n.prototype.getDrmInfo=function(){for(var e=this,t=[],r=0;r<e.SL.length;r++){var n=e.SL[r].drmInfo;if(!n)break;for(var i=0;i<n.length;i++)t.push(n[i])}return t},n.prototype.hasStreams=function(){var e=this;return e.SL.length>0},n.prototype.WL=function(){return!0},n.prototype.VL=function(){var e=this,t={},r=[];e.SL.forEach(function(n){t[n.name]||(t[n.name]=1,r.push({name:n.name,language:n.language,selected:e.fp&&n.name===e.fp.name}))}),r.length>1&&e.__controller.sendEvent(a.MULTI_LANGUAGES_AVAILABLE,{sessionId:e.__controller.model.sessionId,languages:r})}},{"../../event":185,"../../helper/stream-updater":192,"./alternate-stream":198,"./stream":204}],198:[function(e,t,r){"use strict";function n(e){var t=this;t.constructor.super_.call(t),t.aG=t.constructor.super_.prototype,t.segments=[],e&&t.updateConfig(e)}t.exports=n;var i=e("./segment"),a=e("./vtt-segment"),o=e("../../../lib/hls-utils"),s=e("../../../lib/index"),l=e("./stream"),c=l.Stream,u=l.StreamTypes,p=e("./model").StreamingMode;o.inherits(n,c),n.prototype.destroy=function(){var e=this;e.segments=[],e.aG.destroy.call(e)},n.prototype.updateConfig=function(e){var t=this;t.aG.updateConfig.call(t,e),e&&(t.type=e.type||t.type,t.groupId=e.groupId||t.groupId,t.language=e.language||t.language,t.name=e.name||t.name,t.default=s.isNullOrUndefined(e.default)?t.default:e.default,t.autoSelect=s.isNullOrUndefined(e.autoSelect)?t.autoSelect:e.autoSelect,t.forced=s.isNullOrUndefined(e.forced)?t.forced:e.forced);var r=i;t.type===u.SUBTITLES&&(r=t.streamingMode===p.DASH&&"mp4"===e.containerFormat?i:a),e.segmentInfoList&&e.segmentInfoList.length&&(t.segments=e.segmentInfoList.map(function(e){return e.bitrate=t.bitrate,e.sessionId=t.sessionId,e.cdn=t.cdn,t.__controller.create(r,e)})),t.segments.length&&(t.startSeqNum=t.segments[0].seqNum,t.endSeqNum=t.segments[t.segments.length-1].seqNum),t.adjusted=t.type===u.MAIN||t.adjusted},n.prototype.equals=function(e){var t=this;return!!e&&(t.url===e.url&&t.groupId===e.groupId&&t.name===e.name)},n.prototype.setStreamIndex=function(){},n.prototype.dto=function(){}},{"../../../lib/hls-utils":145,"../../../lib/index":146,"./model":201,"./segment":203,"./stream":204,"./vtt-segment":205}],199:[function(e,t,r){"use strict";function n(e){var t=this;e&&(t.startSeqNum=e.startSeqNum,t.startTime=e.startTime,t.cuepointDuration=e.cuepointDuration,t.isCueOutFired=!1,t.isCueOutDetectedFired=!1)}t.exports=n,n.prototype.setCueOutFiredState=function(e){var t=this;t.isCueOutFired=e},n.prototype.setCueOutDetectedState=function(e){var t=this;t.isCueOutDetectedFired=e},n.prototype.setCueOutStartTime=function(e){var t=this;t.startTime=e},n.prototype.dto=function(){var e=this,t={};return Object.keys(e).forEach(function(r){t[r]=e[r]}),t}},{}],200:[function(e,t,r){"use strict";function n(){var e=this;e.XL={}}t.exports=n;var i=e("./mp4-chunk");n.prototype.destroy=function(){var e=this;Object.keys(e.XL).forEach(function(t){var r=e.XL[t];r&&r.destroy()}),e.XL={}},n.prototype.add=function(e){var t=this;if(!e||!e.url)return null;var r=t.YL(e);return t.XL[r]||(t.XL[r]=new i({name:"init",url:e.url,range:e.range})),t.XL[r]},n.prototype.remove=function(e){var t=this;if(e&&e.url){var r=t.YL(e),e=t.XL[r];e&&(e.destroy(),delete t.XL[r])}},n.prototype.get=function(e){var t=this;if(!e||!e.url)return null;var r=t.YL(e);return t.XL[r]},n.prototype.getFirst=function(){var e=this,t=Object.keys(e.XL);return t&&t.length?e.XL[t[0]]:null},n.prototype.YL=function(e){var t=e.range,r=t?"_"+t.start+"_"+t.end:"";return e.url+r}},{"./mp4-chunk":202}],201:[function(e,t,r){"use strict";function n(e){var t=this;if(!(e&&e.userAgent&&e.config&&e.metadata))throw new Error("Incomplete input parameters to Model");t.configure(e.config,e.userAgent),t.ZL={},t.streams=[],t.altRenditionGroups=[],t.$L=t.__controller.create(v),t._L(e.metadata),t.live=e.metadata&&e.metadata.live,t.hasEndlist=!1,t.duration=0,t.bufferLength=0,t.pendingBufferLength=0,t.bufferedRanges={length:0,ranges:[]},t.currentTime=0,t.timescale=9e4,t.TIMESTAMP_COMPARE_EPSILON=.065,t.preloading=!1,t.timedMetadataStore={},t.dimensions=e.config.dimensions?e.config.dimensions:{width:NaN,height:NaN},t.pixelRatio=1,t.bwHistory=e.config.bwHistory,t.aM=a.AUTO,t.bM=0,t.FL={},t.currentLoadingStreamIndex=-1,t.cM=null,t.dM=null,t.eM=e.metadata.url&&e.metadata.url.indexOf(".mpd")!==-1?i.DASH:i.HLS,t.drmRequired=!1,t.drmInfo=[]}r.Model=n;var i=r.StreamingMode={DASH:"dash",HLS:"hls"};r.MetadataTypes={RAW:"raw",RAW_SUBTITLE:"rawSubtitle",STRUCTURED:"structured"};var a=r.AbrModes={AUTO:"auto",LOW:"low",MID:"medium",HIGH:"high"},o=e("./stream"),s=o.Stream,l=o.StreamTypes,c=e("./alt-rendition-group"),u=e("../../event").HLSEvent,p=e("./../default-config"),d=e("../../../lib/index"),f=e("../../../lib/hls-utils"),v=e("../../helper/stream-updater");n.prototype.destroy=function(){var e=this;e.config=null,e.streams&&(e.streams.forEach(function(e){e.destroy()}),e.streams=[]),e.altRenditionGroups&&(e.altRenditionGroups.forEach(function(e){e.destroy()}),e.altRenditionGroups=[]),e.FL={},e.$L.destroy(),e.timedMetadataStore=null},n.prototype.configure=function(e,t){var r=this;r.config=r.config||d.deepCopy(p),r.userAgent=t,e&&(Object.keys(e).forEach(function(t){r.config.hasOwnProperty(t)&&(r.config[t]=e[t])}),r.inWorkerScope=e.inWorkerScope),d.isNullOrUndefined(r.config.demux.startChunkWithKeyFrame)&&r.userAgent&&(r.config.demux.startChunkWithKeyFrame=!(r.userAgent.chrome&&r.userAgent.chrome>=50))},n.prototype.build=function(e){var t=this;if(e){e.streamingMode===i.DASH&&(t.eM=e.streamingMode,t.drmRequired=e.drm,t.fM=e,t.live=!(!e.type||"dynamic"!==e.type.toLowerCase()));var r=t.gM(e.renditionGroups);t.hM(e.streamInfoList,r)}},n.prototype.iM=function(e){var t,r,n,i,a=this;for(t=0;t<e.length&&(n=e[t].getDrmInfo(),n);t++)for(r=0;r<n.length;r++)i=n[r],f.isDrmItemContained(i,a.drmInfo)||a.drmInfo.push(i)},n.prototype.gM=function(e){var t=this;return e?(Object.keys(e).forEach(function(r){var n=e[r];n&&Object.keys(n).forEach(function(e){var i=t.jM(r,e),a=n[e];a&&a.length&&(t.kM(a[0]),i?t.lM(r,e,a):t.mM(r,e,a))})}),t.iM(t.altRenditionGroups),t.altRenditionGroups):t.altRenditionGroups},n.prototype.jM=function(e,t){for(var r=this,n=0;n<r.altRenditionGroups.length;n++){var i=r.altRenditionGroups[n];if(i.type===e&&i.groupId===t)return i}return null},n.prototype.mM=function(e,t,r){var n=this,i=n.metadata&&n.metadata.currLang,a=n.__controller.create(c,e,t,r,i);n.altRenditionGroups.push(a)},n.prototype.lM=function(e,t,r){var n=this;if(r&&r.length){var i=n.jM(e,t);r.forEach(function(e){i.update(e)})}},n.prototype.hM=function(e,t){var r=this;e&&e.length&&(e=r.nM(e),e.forEach(function(e){e.sessionId=r.sessionId,e.type=l.MAIN,r.kM(e);for(var n=!1,i=r.isDash()?"groupId":"url",a=0;a<r.streams.length;a++){var o=r.streams[a];if(o[i]===e[i]){r.updateStream(a,e),n=!0;break}}n||r.addStream(e,t)}),r.iM(r.streams),r.oM(),r.duration=r.live?NaN:e[0].duration)},n.prototype.nM=function(e){var t=this;return e&&e.length?(t.userAgent.firefox&&e[0].channels&&(e=t.pM(e)),e=e.filter(function(e){var t=e.codecs;if(!t)return!0;for(var r=0;r<t.length;r++)if(t[r].indexOf("avc1")===-1&&t[r].indexOf("mp4a")===-1&&t[r].indexOf("aac")===-1)return!1;return!0})):e},n.prototype.pM=function(e){for(var t=!1,r=e[0].channels,n=1;n<e.length;n++)if(e[n].channels&&r!==e[n].channels){t=!0;break}return t?e.filter(function(e){return 1!==e.channels}):e},n.prototype.isDash=function(){var e=this;return e.eM===i.DASH},n.prototype.addStream=function(e,t){var r=this,n=r.__controller.create(s,e,t);r.streams.push(n),n.setStreamIndex(r.streams.length-1),r.$L.addStream(n),1===r.streams.length&&r.setCurrentLoadingStream(n.index)},n.prototype.updateStream=function(e,t){var r=this;e>=r.streams.length||(t.hasEndList===!0&&(r.hasEndlist=!0),
r.$L.update(t))},n.prototype.synchStreamTimelines=function(e){var t=this,r=t.getCurrentLoadingStream();if(r&&t.live&&r.segments.length){var n=r.segments[0].programDateTime,i=r.segments[0].startTime;d.isNullOrUndefined(n)||d.isNullOrUndefined(i)||t.altRenditionGroups.forEach(function(t){e&&t.type!==e||t.adjustStartTime(i,n)})}},n.prototype.getCurrentLoadingStream=function(){var e=this;return e.getStreamByIndex(e.currentLoadingStreamIndex)},n.prototype.setCurrentLoadingStream=function(e){var t=this;t.streams&&t.streams.length&&(e<0||e>=t.streams.length||(t.currentLoadingStreamIndex=e))},n.prototype.getCurrentPlayingStream=function(){var e=this;return e.getStreamByIndex(e.currentPlayingStreamIndex)},n.prototype.setCurrentPlayingStream=function(e){var t=this;t.streams&&t.streams.length&&(e<0||e>=t.streams.length||(t.currentPlayingStreamIndex=e))},n.prototype.getTotalBufferLength=function(){for(var e=this,t=e.bufferedRanges,r=0,n=0;n<t.length;n++)r+=t.ranges[n].end-t.ranges[n].start;return r},n.prototype.setPCR=function(e){var t=this;(null===t.cM||void 0===t.cM||isNaN(t.cM))&&(t.cM=e,t.__controller.sendEvent(u.PCR_AVAILABLE,e))},n.prototype.getPCR=function(){var e=this;return e.cM},n.prototype.setLivePlaybackStartTime=function(e){var t=this;t.dM=e},n.prototype.getLivePlaybackStartTime=function(){var e=this;return e.dM},n.prototype.setStartOffset=function(e){var t=this;t.startOffsetTimestamp&&!isNaN(t.startOffsetTimestamp)||(t.startOffsetTimestamp=e)},n.prototype.setSegEndTimeStamps=function(e,t,r,n){var i=this;if(e&&n){var a=e===l.MAIN?i.streams:i.jM(e,t);a&&a.length&&a.forEach(function(e){var t=e.getSegmentfromSeqNum(r);t&&(t.endTimestamps.audio=n.audio,t.endTimestamps.video=n.video)})}},n.prototype.getPrevSegEndTimestamps=function(e,t){if(!e||!t)return null;var r=e.getIndexFromSeqNum(t.seqNum);return r>=1&&e.segments&&r<e.segments.length?e.segments[r-1].endTimestamps:null},n.prototype.getStreamRefreshInterval=function(){var e=this,t=e.getCurrentLoadingStream();return t?t.refreshInterval:null},n.prototype._L=function(e){var t=this;if(e){t.sessionId=e?e.sessionId:null,t.is360=!!e&&e.is360,e.type=r.MetadataTypes.RAW,t.metadata=e;var n=e.streams,i=e.altStreams;n&&n.length>0&&((n[0].hls_info||n[0].hlsInfo||n.length>1)&&(t.metadata.type=r.MetadataTypes.STRUCTURED,t.metadata.hasMediaMetadata=!0),(n[0].hls_info||n[0].hlsInfo)&&(t.metadata.hasStreamMetadata=!0)),t.metadata.hasMediaMetadata||t.metadata.hasStreamMetadata||(t.ZL=n&&1===n.length?n[0]:e),i&&i.length&&(t.metadata.hasAltStreamMetadata=!0)}},n.prototype.oM=function(){var e=this;e.streams.sort(function(e,t){return e.bitrate-t.bitrate}),e.streams.forEach(function(e,t){e.index=t;var r=e.segments;r.forEach(function(e){e.setStreamIndex(t)})})},n.prototype.getSegment=function(e,t){var r=this;return e<0||e>=r.streams.length?null:r.streams[e].getSegmentfromSeqNum(t)},n.prototype.qM=function(e){var t=this,r=[];return t.streams.forEach(function(t){t.index!==e&&r.push({index:t.index,url:t.url})}),r},n.prototype.setABRMode=function(e){var t=this,r=t.aM;return t.aM=a.AUTO,Object.keys(a).forEach(function(r){a[r]===e.preference&&(t.aM=e.preference)}),t.bM=1e3*e.stream.bitrate,r!==t.aM},n.prototype.getABRMode=function(){var e=this;return e.aM},n.prototype.setAudioLanguage=function(e){var t=this,r=!1;return t.altRenditionGroups.forEach(function(t){t.type===l.AUDIO&&(r=t.setCurrentStreamWithName(e)||r)}),r},n.prototype.getMediaDto=function(){var e=this,t={streams:[],altRenditionGroups:[],live:e.live,duration:e.duration,currentPlayingStreamIndex:e.currentPlayingStreamIndex,currentLoadingStreamIndex:e.currentLoadingStreamIndex,preloading:e.preloading,currentKbps:e.__controller.services.segmentMetrics.getMetricsBandwidthInfo(),abrMode:e.aM,streamingMode:e.eM,drmRequired:e.drmRequired,drmInfo:e.drmInfo};return e.streams.forEach(function(e){t.streams.push(e.dto())}),t},n.prototype.getUserReqBitrate=function(){var e=this;return e.bM},n.prototype.kM=function(e){var t=this;e&&e.segmentInfoList&&!d.isNullOrUndefined(e.hasEndList)&&d.isNullOrUndefined(t.live)&&(t.live=!e.hasEndList)},n.prototype.getMediaUrl=function(){var e=this,t=e.ZL.url||"";return!t.length&&e.ZL.host&&e.ZL.path&&(t=e.ZL.host+e.ZL.path),t},n.prototype.getMediaCdn=function(){var e=this;return e.ZL.cdn||""},n.prototype.getStreamByIndex=function(e){var t=this;return t.streams&&t.streams.length&&e>=0&&e<t.streams.length?t.streams[e]:null},n.prototype.getSegmentLength=function(){var e=this;return e.streams&&e.streams.length?e.streams[0].targetDuration:NaN},n.prototype.updateTimedMetadata=function(e,t){var r=this;if(e&&e.payload){r.timedMetadataStore[t]=r.timedMetadataStore[t]||[];for(var n=r.timedMetadataStore[t].length,i=0;i<r.timedMetadataStore[t].length;i++){var a=r.timedMetadataStore[t][i];if(Math.abs(a.timestamp-e.timestamp)<=.1)return!1;if(e.timestamp<a.timestamp){n=i;break}}return r.timedMetadataStore[t].splice(n,0,e),!0}}},{"../../../lib/hls-utils":145,"../../../lib/index":146,"../../event":185,"../../helper/stream-updater":192,"./../default-config":195,"./alt-rendition-group":197,"./stream":204}],202:[function(e,t,r){"use strict";function n(e){var t=this;e&&(t.url=e.url,t.name=e.name,t.range=e.range);var r=t.range;t.loaded=!1,t.data=r&&r.end>=0&&r.start>=0&&r.end>r.start?new Uint8Array(r.end-r.start+1):null,t.rM=0,t.EG=t.data?t.data.byteLength:0}t.exports=n,n.prototype.destroy=function(){var e=this;e.data=null},n.prototype.append=function(e){var t=this;if(t.loaded||!e)return 0;var r=0;if(t.EG&&t.data){r=Math.min(e.byteLength,t.EG-t.rM);for(var n=0;n<r;n++)t.data[t.rM+n]=e[n];t.rM+=r,t.rM>=t.EG&&(t.loaded=!0)}else{var i=e.byteLength;if(!i)return;var a=null,o=0;t.data&&(a=t.data,o=a.length),r=o+i,t.data=new Uint8Array(r),a&&t.data.set(a),t.data.set(e,o),t.rM+=r}return r},n.prototype.equals=function(e){var t=this;return!!e&&(t.url===e.url&&t.name===e.name&&(!t.range||!e.range||t.range.start===e.range.start&&t.range.end===e.range.end))}},{}],203:[function(e,t,r){"use strict";function n(e){var t=this;e&&(t.duration=e.duration,t.url=e.url,t.initSegment=e.initSegment,t.seqNum=e.sequenceNum,t.startTime=e.startTime,t.discontinuity=e.discontinuity,t.programDateTime=e.programDateTime,t.streamIndex=e.levelIndex,t.bitrate=e.bitrate,t.sessionId=e.sessionId,t.cdn=e.cdn,t.sM=t.streamIndex+"_"+t.seqNum,t.brStartOffset=e.brStartOffset,t.brEndOffset=e.brEndOffset,t.containerFormat=e.containerFormat,t.encryptionData=e.encryptionData,t.endTimestamps=e.endTimestamps,t.periodId=e.periodId),t.endTimestamps||(t.endTimestamps={audio:NaN,video:NaN}),t.totalDownloadTime=0,t.timeToFirstByte=0,t.tM=0}t.exports=n,n.prototype.setStreamIndex=function(e){var t=this;t.streamIndex=e,t.sM=t.streamIndex+"_"+t.seqNum},n.prototype.dto=function(){var e=this,t={};return Object.keys(e).forEach(function(r){"__controller"!==r&&(t[r]=e[r])}),t}},{}],204:[function(e,t,r){"use strict";function n(e,t){var r=this;r.segments=[],r.cuepoints=[],r.type=i.MAIN,r.videoCodec=null,r.audioCodec=null,r.mp4Chunks={sidx:null,first:null},r.adjusted=!1,r.uM=new u(r),r.activeInitSegment=null,e&&(r.vM(e,t),r.updateConfig(e)),r.pJ=new c}t.exports.Stream=n;var i=r.StreamTypes={MAIN:"MAIN",AUDIO:"AUDIO",VIDEO:"VIDEO",SUBTITLES:"SUBTITLES",CLOSED_CAPTIONS:"CLOSED_CAPTIONS"},a=e("./segment"),o=e("./cuepoint"),s=e("./mp4-chunk"),l=e("./model").StreamingMode,c=e("../../mp4/mp4-box-parser"),u=e("./init-segment-cache");n.prototype.destroy=function(){var e=this;e.segments=[],e.cuepoints=[],"mp4"===e.containerFormat&&Object.keys(e.mp4Chunks).forEach(function(t){var r=e.mp4Chunks[t];r&&r.destroy()}),e.uM.destroy()},n.prototype.vM=function(e,t){var r=this;if(r.altRenditionGroups={},t)for(var n=0;n<t.length;n++){var i=t[n];i.groupId===e.audioGroupId?(r.altRenditionGroups.AUDIO=i,r.audioGroupId=e.audioGroupId):i.groupId===e.videoGroupId?(r.altRenditionGroups.VIDEO=i,r.videoGroupId=e.videoGroupId):i.groupId===e.subtitlesGroupId?(r.altRenditionGroups.SUBTITLES=i,r.subtitlesGroupId=e.subtitlesGroupId):i.groupId===e.ccGroupId&&(r.altRenditionGroups.CLOSED_CAPTIONS=i,r.ccGroupId=e.ccGroupId)}},n.prototype.getAlternateStream=function(e){var t=this;if(t.altRenditionGroups[e])return t.altRenditionGroups[e].getCurrentStream()},n.prototype.setAlternateStream=function(e,t){var r=this;r.altRenditionGroups[e]&&r.altRenditionGroups[e].setCurrentStream(t)},n.prototype.updateConfig=function(e){var t=this,r=t.audioCodec&&t.audioCodec.length>0;if(e&&(t.streamingMode=e.streamingMode||t.streamingMode,t.bitrate=e.bitrate||t.bitrate,t.avgBitrate=e.avgBitrate||t.avgBitrate,t.url=e.url||t.url,t.containerFormat=e.containerFormat||t.containerFormat,t.cdn=e.cdn||t.cdn,t.rcMode=e.rcMode||"cbr",t.channels=e.channels>=0?e.channels:t.channels,t.width=e.width>=0?e.width:t.width,t.height=e.height>=0?e.height:t.height,t.index=e.index>=0?e.index:t.index,t.hlsInfo=e.hlsInfo||t.hlsInfo,t.targetDuration=e.targetDuration||NaN,t.sessionId=e.sessionId||null,t.audioCodec=e.audioCodec||t.audioCodec,t.videoCodec=e.videoCodec||t.videoCodec,t.type=e.type||i.MAIN,t.sidxOffset=e.sidxOffset>=0?e.sidxOffset:t.sidxOffset,t.sidxLength=e.sidxLength>=0?e.sidxLength:t.sidxLength,t.firstSegOffset=e.firstSegOffset>=0?e.firstSegOffset:t.firstSegOffset,t.firstSegLength=e.firstSegLength>=0?e.firstSegLength:t.firstSegLength,t.hasAudio=e.hasAudio||r||t.channels>0||t.hasAudio,t.groupId=e.groupId||null,void 0!==e.hasEndList&&null!==e.hasEndList&&(t.hasEndList=e.hasEndList),t.hlsInfo&&t.hlsInfo.mp4_url&&(t.mp4Chunks.sidx=t.wM("sidx",t.sidxOffset,t.sidxLength,t.hlsInfo.mp4_url),t.mp4Chunks.first=t.wM("first",t.firstSegOffset,t.firstSegLength,t.hlsInfo.mp4_url)),e.drmInfo&&(t.drmInfo=e.drmInfo)),t.url&&t.url.length&&t.url.indexOf("_60fps")>=0?t.frameRate=60:t.frameRate="AUDIO"===t.type?0:30,e&&e.segmentInfoList){var n=[];e.segmentInfoList.forEach(function(e){e.levelIndex=t.index,e.bitrate=t.bitrate,e.sessionId=t.sessionId,e.cdn=t.cdn;var r=t.getSegmentfromSeqNum(e.sequenceNum);r&&(e.endTimestamps=r.endTimestamps),n.push(t.__controller.create(a,e))}),n.length&&(t.segments=n,t.startSeqNum=n[0].seqNum,t.endSeqNum=n[n.length-1].seqNum,e.cuepointList&&e.cuepointList.length&&(e.cuepointList.forEach(function(e){t.hasCuepoint(e.startSeqNum)||t.cuepoints.push(new o(e))}),t.updateCuepointTime()))}t.segments&&t.segments.length&&(t.refreshInterval=1e3*t.segments[t.segments.length-1].duration);var s=t.altRenditionGroups?t.altRenditionGroups.AUDIO:null;t.type===i.MAIN&&s&&t.containerFormat&&!s.getContainerFormat()&&s.setContainerFormat("ts"===t.containerFormat?"aac":"mp4")},n.prototype.addInitSegment=function(e){var t=this;return"mp4"===t.containerFormat?t.uM.add(e):null},n.prototype.getInitSegment=function(e){var t=this;if(!e){if(!t.segments.length)return null;e=t.segments[0]}return t.uM.get(e.initSegment)},n.prototype.wM=function(e,t,r,n){var i=this,a=i.mp4Chunks[e];if(a)return a;if("mp4"!==i.containerFormat||!n)return null;var o;return t>=0&&r>=0&&(o={start:t,end:t+r-1}),new s({name:e,url:n,range:o})},n.prototype.getMp4Chunk=function(e){var t=this;return"mp4"===t.containerFormat?t.mp4Chunks[e]:null},n.prototype.dto=function(){var e=this,t={segments:[],cuepoints:[]},r=["segments","__controller","cuepoints","altRenditionGroups","_initSegmentCache","activeInitSegment"];return Object.keys(e).forEach(function(n){r.indexOf(n)>=0||(t[n]=e[n])}),e.segments.forEach(function(e){t.segments.push(e.dto())}),e.cuepoints.forEach(function(e){t.cuepoints.push(e.dto())}),t},n.prototype.setStreamIndex=function(e){var t=this;t.index=e,t.segments.forEach(function(t){t.setStreamIndex(e)})},n.prototype.getSeqNumBeforePosition=function(e){var t=this;if(!t.segments.length)return NaN;if(e<t.segments[0].startTime)return t.startSeqNum;for(var r=0;r<t.segments.length;r++){var n=t.segments[r];if(n&&n.startTime<=e&&n.startTime+n.duration>e)return t.startSeqNum+r}var i=t.segments[t.segments.length-1];return i&&i.startTime+i.duration===e?t.endSeqNum:NaN},n.prototype.getSegmentfromSeqNum=function(e){var t=this,r=t.getIndexFromSeqNum(e);return r>=0&&r<t.segments.length?t.segments[r]:null},n.prototype.getIndexFromSeqNum=function(e){var t=this;if(e>=t.startSeqNum&&e<=t.endSeqNum)for(var r=0;r<t.segments.length;r++)if(t.segments[r]&&t.segments[r].seqNum===e)return r;return-1},n.prototype.contains=function(e){var t=this;return e>=t.startSeqNum&&e<=t.endSeqNum},n.prototype.isEmpty=function(){var e=this;return 0===e.segments.length},n.prototype.isReady=function(){var e=this;if("mp4"!==e.containerFormat)return e.url&&e.segments.length>0;var t=e.uM.getFirst();if(e.streamingMode===l.HLS&&e.hlsInfo&&e.hlsInfo.mp4_url){var r=e.mp4Chunks.sidx;return t&&r&&t.loaded&&r.loaded}return t&&t.loaded&&e.segments.length>0},n.prototype.hasCuepoint=function(e){for(var t=this,r=t.cuepoints.length-1;r>=0;r--)if(t.cuepoints[r].startSeqNum===e)return!0;return!1},n.prototype.updateCuepointTime=function(){for(var e,t=this,r=0;r<t.cuepoints.length;r++)e=t.getSegmentfromSeqNum(t.cuepoints[r].startSeqNum),e&&t.cuepoints[r].setCueOutStartTime(e.startTime)},n.prototype.equals=function(e){var t=this;return!!e&&(t.url===e.url&&t.type===e.type&&(t.isDash()?t.groupId===e.groupId:t.index===e.index))},n.prototype.updateSegmentRanges=function(e){var t=this;if(e&&e.length)for(var r=0;r<e.length&&r<t.segments.length;r++)t.segments[r].brStartOffset=e[r].brStartOffset,t.segments[r].brEndOffset=e[r].brEndOffset},n.prototype.setMp4Timescale=function(e){var t=this;if("mp4"===t.containerFormat&&e&&e.loaded&&e.data){var r=t.pJ.parse(e.data,"mdhd");if(r&&r.timescale>0)t.timescale=r.timescale;else{var n=t.pJ.parse(e.data,"mvhd");t.timescale=n.timescale}}},n.prototype.isDash=function(){var e=this;return e.streamingMode===l.DASH},n.prototype.getDrmInfo=function(){var e=this;return e.drmInfo}},{"../../mp4/mp4-box-parser":206,"./cuepoint":199,"./init-segment-cache":200,"./model":201,"./mp4-chunk":202,"./segment":203}],205:[function(e,t,r){"use strict";function n(e){var t=this;e&&(t.discontinuity=e.discontinuity,t.seqNum=e.sequenceNum,t.startTime=e.startTime,t.programDateTime=e.programDateTime,t.url=e.url,t.duration=e.duration),t.clockReference=0,t.localCueTime=0,t.mpegTSTime=0,t.offset=0,t.adjustedTime=0}t.exports=n,n.prototype.destroy=function(){var e=this;e.data=null},n.prototype.toObject=function(){var e=this,t={};return t.discontinuity=e.discontinuity,t.sequenceNum=e.seqNum,t.startTime=e.startTime,t.programDateTime=e.programDateTime,t.url=e.url,t.duration=e.duration,t.playlistUrl=e.playlistUrl,t.clockReference=e.clockReference,t.localCueTime=e.localCueTime,t.mpegTSTime=e.mpegTSTime,t.data=e.data,t.offset=e.offset,t.adjustedTime=e.adjustedTime,t},n.prototype.parseSegment=function(){var e=this;if(e.data){var t=e.data.split("\n");if(!(t.length<=0)&&0===t[0].indexOf("WEBVTT")){for(var r=Math.floor((Math.pow(2,33)-1)/90),n=0,i=0,a=1;a<t.length;a++){var o=t[a].trim();if(0===o.indexOf("X-TIMESTAMP-MAP")){var s=new RegExp(/LOCAL[:=]([^,]+)/),l=new RegExp(/MPEGTS[:=]([^,]+)/);i=0,n=0;var c=s.exec(o);if(c&&c.length>=2){var u=c[1],p=u.split(":");if(p&&p.length>=3){var d=p[2].split("."),f=0,v=0;d&&d.length>=2&&(f=parseInt(d[0]),v=parseInt(d[1])),i=1e3*(3600*p[0]+60*p[1]+f)+v,i%=r}}var m=l.exec(o);m&&m.length>=2&&(n=parseFloat(m[1]),n=Math.round(n/90)),e.clockReference=e.pcr(),e.localCueTime=i,e.mpegTSTime=n,null===e.clockReference||void 0===e.clockReference}else if(o.indexOf("-->")>=0){var y=o.split("-->");if(y){var h=y[0].split(":");if(h){var E=parseInt(h[0]),g=parseInt(h[1]),b=parseFloat(h[2]),_=1e3*(3600*E+60*g+b);null!==e.clockReference&&void 0!==e.clockReference||(e.clockReference=_%r+e.mpegTSTime)}}break}}e.adjustedTime=n-i-e.clockReference+e.offset}}},n.prototype.pcr=function(){var e=this;if(!e.__controller)return 0;var t=e.__controller.model,r=t.getPCR();if("number"!=typeof r)return null;if(r=r/e.__controller.model.timescale*1e3,t.live&&r<0){var n=-Math.floor(Math.pow(2,32)/90),i=Math.floor((Math.pow(2,32)-1)/90),a=Math.abs(r-n);r=a+i}return r},n.prototype.isBuffered=function(){var e=this;return!!e.data}},{}],206:[function(e,t,r){"use strict";function n(){var e=this;e.xM=0}t.exports=n;var i=e("../mp4/mp4-box-schema"),a=e("../../lib/index");n.prototype.destroy=function(){var e=this;e.xM=0},n.prototype.parse=function(e,t,r){var n=this;if(!e||!t||!i[t])return null;n.xM=0;var o=new DataView(e.buffer);if(a.isNullOrUndefined(r)?(r=n.findBoxOffset(o,t),n.xM=r):n.xM=r,n.xM<0)return null;var s=n.parseHeader(o,t,n.xM);return!s||s.boxSize>o.byteLength?null:"sidx"===s.boxType?n.yM(o,s,r):n.LG(o,s)},n.prototype.zM=function(e){var t=this,r=[];if(!e)return r;t.xM=0;for(var n=new DataView(e.buffer);t.xM+8<=n.byteLength;){var a=t.xM,o=t.AM(n.getUint32(a+4),4);if(i[o]){var s=t.parseHeader(n,o,a);s&&("sidx"===s.boxType?r.push(t.yM(n,s)):r.push(t.LG(n,s)))}else t.xM++}return r},n.prototype.parseHeader=function(e,t,r){var n=this,a={boxOffset:r};n.xM=r;var o=n.BM(e,a);return o===-1||a.boxType!==t?null:i[t].fullBox&&(o=n.CM(e,a),o===-1)?null:a},n.prototype.extractVttCaptions=function(e){var t=this,r=[];if(t.xM=0,!e)return r;var n=new DataView(e.buffer),i=t.findBoxOffset(n,"mdat");if(i<0)return r;var a=e.slice(i+8),o=t.zM(a);if(!o.length)return r;for(var s=0;s<o.length;s++){var l=o[s];if(l)if("vttc"===l.boxType){t.xM=0;var c=a.slice(l.boxOffset+8,l.boxOffset+l.boxSize),u=t.zM(c);r.push(t.DM(u))}else"vtte"===l.boxType&&r.push({})}return r},n.prototype.LG=function(e,t,r){var n=this;if(!e||!t||t.boxSize>e.byteLength)return t;var a=i[t.boxType],o=a.properties;if(!o)return n.xM+=t.boxSize-(a.fullBox?12:8),t;for(var s=Object.keys(o),l=0;l<s.length;l++){var c=s[l],u=o[c];if(n.EM(u.validator,t[u.validationProperty]||t.flags,u.validationResult))if("array"===u.type){t[c]=[];var p=u.length||u.lengthField&&t[u.lengthField],d=u.itemSchema;if(!d)break;p?n.FM(t,c,e,p,d,r):n.GM(t,c,e,d)}else n.HM(e,u,r,c),t[c]=n.IM(t,u,e)}return t},n.prototype.HM=function(e,t,r,n,i,a){var o=this;if(r&&t){var s=!r.pos||r.pos&&r.pos===i||i===a-1&&r.pos===-1;r.name&&n===r.name&&r.length&&t.length&&r.length===t.length&&s&&o.JM(e,r)}},n.prototype.FM=function(e,t,r,n,i,a){for(var o,s=this,l=0;l<n;l++){if(i.length)o=s.IM(e,i,r);else{o={};for(var c=Object.keys(i),u=0;u<c.length;u++){var p=c[u],d=i[p];s.EM(d.validator,e.flags)&&(s.HM(r,d,a,p,l,n),o[p]=s.IM(e,d,r))}}e[t].push(o)}},n.prototype.GM=function(e,t,r,n){for(var i,a=this;a.xM<e.boxOffset+e.boxSize;)i=a.IM(e,n,r),e[t].push(i)},n.prototype.EM=function(e,t,r){return!e||(r?(t&e)===r:t&e)},n.prototype.IM=function(e,t,r){var n,i=this;return t.length&&(n=i.KM(r,t.length),i.xM+=n.readBytes,n.readBytes===t.length/8)?"string"===t.type?i.AM(n.value,4):n.value:"string"===t.type?i.LM(e,r):"boxstring"===t.type?i.MM(e,r):null},n.prototype.KM=function(e,t){var r=this,n={value:0,readBytes:0},i=t/8;if(r.xM+i<=e.byteLength){switch(t){case 8:n.value=e.getUint8(r.xM);break;case 16:n.value=e.getUint16(r.xM);break;case 32:n.value=e.getUint32(r.xM);break;case 64:for(var a=new Uint8Array(8),o=0;o<8;o++)a[o]=e.getUint8(r.xM+o);n.value=a}n.readBytes=i}return n},n.prototype.JM=function(e,t){var r=this,n=t.value;switch(t.length){case 8:e.setUint8(r.xM,n);break;case 16:e.setUint16(r.xM,n);break;case 32:e.setUint32(r.xM,n)}},n.prototype.LM=function(e,t){var r=this,n="",i=r.KM(t,8);for(r.xM+=i.readBytes;i.readBytes>0&&i.value>0&&r.xM<e.boxOffset+e.boxSize;)n+=String.fromCharCode(i.value),i=r.KM(t,8),r.xM+=i.readBytes;return n},n.prototype.MM=function(e,t){var r=this,n=e.boxSize-(r.xM-e.boxOffset),i=String.fromCharCode.apply(null,new Uint8Array(t.buffer,r.xM,n));return r.xM+=n,i},n.prototype.findBoxOffset=function(e,t){var r=this;if(!e||e.byteLength<8)return-1;var n,a,o=i[t].parents,s=0;if(o&&o.length>0){for(var l=!1,c=0;c<o.length;c++){var u=o[c];if(n=r.findBoxOffset(e,u),n>=0){var p=i[u].fullBox?12:8;s=n+p;var d=i[u].payload;d&&(s+=d),l=!0;break}}if(!l)return-1}for(;s+8<=e.byteLength;){if(a=r.AM(e.getUint32(s+4),4),a===t)return s;var f=e.getUint32(s);if(!(f>0))break;s+=f}return-1},n.prototype.BM=function(e,t){var r=this;if(!e||!t||e.byteLength<8)return-1;t.boxSize=e.getUint32(r.xM),r.xM+=4;var n=e.getUint32(r.xM);return t.boxType=r.AM(n,4),r.xM+=4,1===t.boxSize&&(t.boxSize=r.NM(e),r.xM+=8),0},n.prototype.CM=function(e,t){var r=this;if(!e||!t)return-1;var n=e.getUint32(r.xM);return t.boxVersion=n>>24,t.flags=16777215&n,r.xM+=4,0},n.prototype.yM=function(e,t,r){var n=this;if(!e||!t)return null;r=r||0,n.xM+=4,n.xM+=4;var i;0===t.boxVersion?(e.getUint32(n.xM),n.xM+=4,i=e.getUint32(n.xM),n.xM+=4):(n.NM(e),n.xM+=8,i=n.NM(e),n.xM+=8),n.xM+=2;var a=e.getUint16(n.xM);n.xM+=2;for(var o=t.boxOffset+t.boxSize+i,s=[],l=0;l<a;l++){var c=e.getUint32(n.xM);n.xM+=4;var u=c>>>31;if(1===u)return null;var p=2147483647&c;n.xM+=8,s.push({brStartOffset:o+r,brEndOffset:o+r+p-1}),o+=p}return s},n.prototype.setSingleProp=function(e,t,r){var n=this;if(e&&t){var i=new DataView(e.buffer),a=n.findBoxOffset(i,t);if(!(a<0)){n.xM=a;var o=n.parseHeader(i,t,a);o&&n.LG(i,o,r)}}},n.prototype.AM=function(e,t){if(!e||!t)return"";for(var r=new Array(t),n=t-1;n>=0;n--){var i=255&e;r[n]=String.fromCharCode(i),e>>>=8}return r.join("")},n.prototype.NM=function(e){var t=this,r=t.xM,n=e.getUint32(r);r+=4;var i=e.getUint32(r);return n*Math.pow(2,32)+i},n.prototype.DM=function(e){for(var t={},r=0;r<e.length;r++){var n=e[r];if(n)switch(n.boxType){case"vsid":t.sourceId=n.sourceId;break;case"ctim":t.cueTime=n.cueTime;break;case"payl":t.cueText=n.cueText}}return t}},{"../../lib/index":146,"../mp4/mp4-box-schema":207}],207:[function(e,t,r){"use strict";t.exports={ftyp:{fullBox:!1,properties:{majorBrand:{length:32,type:"string"},minorVersion:{length:32},compatibleBrands:{type:"array",itemSchema:{length:32,type:"string"}}}},moov:{fullBox:!1},styp:{fullBox:!1,properties:{majorBrand:{length:32,type:"string"},minorVersion:{length:32},compatibleBrands:{type:"array",itemSchema:{length:32,type:"string"}}}},moof:{fullBox:!1},mdat:{fullBox:!1},sidx:{fullBox:!0,properties:{referenceId:{length:32},timescale:{length:32},earliestPresentationTime:{length:32},firstOffset:{length:32},reserved:{length:16},referenceCount:{length:16},referenceData:{type:"array",lengthField:"referenceCount",itemSchema:{referenceType:{length:1},referencedSize:{length:31},subsegmentDuration:{length:32},startsWithSAP:{length:1},sapType:{length:3},sapDeltaTime:{length:28}}}}},emsg:{fullBox:!0,properties:{schemeIdUri:{type:"string"},value:{type:"string"},timescale:{length:32},presentationTimeDelta:{length:32},eventDuration:{length:32},id:{length:32},message:{type:"array",itemSchema:{length:8}}}},trak:{fullBox:!1,parents:["moov"]},mdia:{fullBox:!1,parents:["trak"]},mvhd:{fullBox:!0,parents:["moov"],properties:{creationTime:{length:32},modificationTime:{length:32},timescale:{length:32},duration:{length:32},rate:{length:32},volume:{length:16},reserved:{length:80},matrix:{type:"array",length:9,itemSchema:{length:32}},preDefined:{length:192},nextTrackId:{length:32}}},mdhd:{fullBox:!0,parents:["mdia"],properties:{creationTime:{length:32},modificationTime:{length:32},timescale:{length:32},duration:{length:32},language:{length:16},preDefined:{length:16}}},esds:{fullBox:!0,parents:["mp4a","enca"],properties:{descriptorTag:{length:8},descriptorLength:{length:8},esId:{length:16},streamPriority:{length:8},decoderConfigDesc:{length:8},decoderConfigLength:{length:8},codecTag:{length:8},streamType:{length:8},bufferSize:{length:8},bufferSize2:{length:16},maxBitrate:{length:32},avgBitrate:{length:32},decoderInfoDescriptor:{length:8},decoderInfoDescriptorLength:{length:8},audioSpecificConfig0:{length:8},audioSpecificConfig1:{length:8},audioSpecificConfig2:{length:8,validator:248,validationProperty:"audioSpecificConfig0",validationResult:40},audioSpecificConfig3:{length:8,validator:248,validationProperty:"audioSpecificConfig0",validationResult:40},slDescriptor:{length:8},slDescriptorLength:{length:8},slValue:{length:8}}},mp4a:{fullBox:!1,parents:["stsd"],payload:28,properties:{reserved0:{length:48},dataReferenceIndex:{length:16},reserved1:{length:32},reserved2:{length:32},channelCount:{length:16},sampleSize:{length:16},predefined:{length:16},reserved3:{length:16},sampleRate:{length:32}}},enca:{fullBox:!1,parents:["stsd"],payload:28,properties:{reserved0:{length:48},dataReferenceIndex:{length:16},reserved1:{length:32},reserved2:{length:32},channelCount:{length:16},sampleSize:{length:16},predefined:{length:16},reserved3:{length:16},sampleRate:{length:32}}},stsd:{fullBox:!0,parents:["stbl"],payload:4,properties:{entryCount:{length:32}}},stbl:{fullBox:!1,parents:["minf"]},minf:{fullBox:!1,parents:["mdia"]},traf:{fullBox:!1,parents:["moof"]},tfdt:{fullBox:!0,parents:["traf"],properties:{baseMediaDecodeTime:{length:32}}},tfhd:{fullBox:!0,parents:["traf"],properties:{trackId:{length:32},baseDataOffset:{length:64,validator:1},sampleDescriptionIndex:{length:32,validator:2},defaultSampleDuration:{length:32,validator:8},defaultSampleSize:{length:32,validator:16},defaultSampleFlags:{length:32,validator:32}}},trun:{fullBox:!0,parents:["traf"],properties:{sampleCount:{length:32},dataOffset:{validator:1,length:32},firstSampleFlags:{validator:4,length:32},sampleData:{type:"array",lengthField:"sampleCount",itemSchema:{sampleDuration:{validator:256,length:32},sampleSize:{validator:512,length:32},sampleFlags:{validator:1024,length:32},sampleCompositionTimeOffset:{validator:2048,length:32}}}}},vttc:{fullBox:!1},vtte:{fullBox:!1},vsid:{fullBox:!1,parents:["vttc"],properties:{sourceId:{length:32}}},ctim:{fullBox:!1,parents:["vttc"],properties:{cueTime:{type:"boxstring"}}},payl:{fullBox:!1,parents:["vttc"],properties:{cueText:{type:"boxstring"}}},iden:{fullBox:!1,parents:["vttc"],properties:{cueId:{type:"boxstring"}}},sttg:{fullBox:!1,parents:["vttc"],properties:{settings:{type:"boxstring"}}}}},{}],208:[function(e,t,r){"use strict";function n(){}t.exports=n;var i=8,a=12,o=a+4,s=9e4;n.prototype.initSegment=function(e,t){var r=this,n=r.ftyp(t),i=r.moov(e),a=new Uint8Array(n.byteLength+i.byteLength);return a.set(n),a.set(i,n.byteLength),a},n.prototype.ftyp=function(e){var t=this;e=e||"avc1";var r=new Uint8Array([105,115,111,109]),n=new Uint8Array([0,0,0,1]),i=new Uint8Array([e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);return t.OM("ftyp",[r,n,i])},n.prototype.moov=function(e){var t=this,r=[];r.push(t.PM(e[0].config.duration,e[0].config.timescale));for(var n=0;n<e.length;n++)r.push(t.QM(e[n]));return r.push(t.RM(e)),t.OM("moov",r)},n.prototype.moof=function(e,t){var r=this,n=[];n.push(r.SM(e));for(var i=0;i<t.length;i++){var a=r.TM(t[i]);n.push(a)}return r.OM("moof",n)},n.prototype.mdat=function(e){var t=this,r=[];if(e&&e.frames)for(var n=0;n<e.frames.length;n++)r.push(e.frames[n].data);return t.OM("mdat",r)},n.prototype.SM=function(e){var t=this,r=new Uint8Array(4),n=new DataView(r.buffer);return n.setUint32(0,e),t.UM("mfhd",0,new Uint8Array(3),[r])},n.prototype.TM=function(e){if(e){var t=this,r=[],n=i+o+i,a=t.VM(e);n+=a.length,r.push(a);var s;e.frames&&e.frames.length&&(s=t.WM(e.frames[0].dts),n+=s.length,r.push(s));var l;return"video"===e.type&&(l=t.XM(e),n+=l.length),r.push(t.YM(e,n)),l&&r.push(l),t.OM("traf",r)}},n.prototype.VM=function(e){var t=this,r=new Uint8Array(4),n=new DataView(r.buffer);return n.setUint32(0,e.streamId),t.UM("tfhd",0,new Uint8Array([0,0,0]),[r])},n.prototype.WM=function(e){var t=this,r=new Uint8Array(4),n=new DataView(r.buffer);return n.setUint32(0,Math.max(0,e)),t.UM("tfdt",0,new Uint8Array([0,0,0]),[r])},n.prototype.YM=function(e,t){var r=this,n=e.frames||[],o=n.length,s=r.ZM(n),l=0,c=s[1],u=0;for(u=0;u<4;u++)l+=c&1<<u?1:0;var p=new Uint8Array(4*l*o),d=new DataView(p.buffer);t+=a+8+p.length+i;var f=r.$M(o,t),v=0;for(u=0;u<o;u++){var m=n[u];if(1&c&&(d.setUint32(v,m.duration),v+=4),2&c&&(d.setUint32(v,m.size),v+=4),4&c){var y=m.flags.isLeading<<2|m.flags.dependsOn,h=m.flags.isDependedOn<<6|m.flags.hasRedundancy<<4|m.flags.paddingValue<<1|m.flags.isNonSyncSample,E=240&m.flags.degradationPriority,g=15&m.flags.degradationPriority,b=y<<24|h<<16|E<<8|g;d.setUint32(v,b),v+=4}8&c&&(d.setUint32(v,m.pts-m.dts),v+=4)}return r.UM("trun",0,s,[f,p])},n.prototype.XM=function(e){for(var t=this,r=e.frames||[],n=r.length,i=new Uint8Array(n),a=0;a<n;a++){var o=r[a];o.flags&&(i[a]=o.flags.isLeading<<6|o.flags.dependsOn<<4|o.flags.isDependedOn<<2|o.flags.hasRedundancy)}return t.UM("sdtp",0,new Uint8Array(3),[i])},n.prototype.$M=function(e,t){var r=new Uint8Array(8),n=new DataView(r.buffer);return n.setUint32(0,e),n.setInt32(4,t),r},n.prototype.ZM=function(e){var t=e.length,r=new Uint8Array(3);return r[2]=1,t&&(void 0!==e[0].duration&&(r[1]|=1),void 0!==e[0].size&&(r[1]|=2),void 0!==e[0].flags&&(r[1]|=4),void 0!==e[0].pts&&(r[1]|=8)),r},n.prototype.PM=function(e,t){var r=this,n=new Uint8Array(96),i=new DataView(n.buffer);i.setUint32(0,1),i.setUint32(4,2);var a=t||s;return i.setUint32(8,a),e&&i.setUint32(12,e),i.setUint32(16,65536),i.setUint16(20,256),i.setUint32(32,65536),i.setUint32(48,65536),i.setUint32(64,1073741824),i.setUint32(92,4294967295),r.UM("mvhd",0,new Uint8Array(3),[n])},n.prototype.QM=function(e){var t=this;e.config.duration=e.config.duration||4294967295;var r=[t._M(e)];return e.config.useEditBox&&r.push(t.aN(e)),r.push(t.bN(e)),t.OM("trak",r)},n.prototype._M=function(e){var t=this,r=new Uint8Array(80),n=new DataView(r.buffer);return n.setUint32(8,e.streamId),n.setUint32(16,e.config.duration),n.setUint8(32,"audio"===e.type?1:0),n.setUint32(36,65536),n.setUint32(52,65536),n.setUint32(68,1073741824),n.setUint16(72,e.config.width),n.setUint16(76,e.config.height),t.UM("tkhd",0,new Uint8Array([0,0,7]),[r])},n.prototype.aN=function(e){var t=this;return t.OM("edts",[t.cN(e)])},n.prototype.cN=function(e){var t=this,r=new Uint8Array(16),n=new DataView(r.buffer);return n.setUint32(0,1),n.setUint32(4,0),n.setUint32(8,e.config.offset),n.setUint16(12,1),n.setUint16(14,0),t.UM("elst",0,new Uint8Array(3),[r])},n.prototype.bN=function(e){var t=this;return t.OM("mdia",[t.dN(e),t.eN(e.type),t.fN(e)])},n.prototype.dN=function(e){var t=this,r=new Uint8Array(20),n=new DataView(r.buffer);n.setUint32(0,2),n.setUint32(4,3);var i=e.config.timescale||s;return n.setUint32(8,i),n.setUint32(12,e.config.duration),n.setUint16(16,21956),t.UM("mdhd",0,new Uint8Array(3),[r])},n.prototype.eN=function(e){var t=this,r={video:1986618469,audio:1936684398,hint:1751740020},n=new Uint8Array(32),i=new DataView(n.buffer);return i.setUint32(4,r[e]),i.setUint32(20,r[e]),i.setUint32(24,1214344804),i.setUint32(28,1818587648),t.UM("hdlr",0,new Uint8Array(3),[n])},n.prototype.fN=function(e){var t=this,r="audio"===e.type?t.gN():t.hN();return t.OM("minf",[r,t.iN(),t.jN(e)])},n.prototype.hN=function(){var e=this,t=new Uint8Array(8);return e.UM("vmhd",0,new Uint8Array([0,0,1]),[t])},n.prototype.gN=function(){var e=this,t=new Uint8Array(4);return e.UM("smhd",0,new Uint8Array(3),[t])},n.prototype.iN=function(){var e=this;return e.OM("dinf",[e.kN()])},n.prototype.kN=function(){var e=this,t=new Uint8Array([0,0,0,1]),r=[];return r.push(t),r.push(e.kg(new Uint8Array([0,0,1]))),e.UM("dref",0,new Uint8Array(3),r)},n.prototype.kg=function(e){var t=this;return t.UM("url ",0,e,[])},n.prototype.lN=function(e){var t=this;return t.UM("urn ",0,e,[])},n.prototype.jN=function(e){var t=this;return t.OM("stbl",[t.mN(e),t.nN(),t.oN(),t.pN(),t.qN()])},n.prototype.mN=function(e){var t=this,r="audio"===e.type?t.rN(e):t.sN(e),n=new Uint8Array([0,0,0,1]);return t.UM("stsd",0,new Uint8Array(3),[n,r])},n.prototype.sN=function(e){var t=this,r=[];r.push((65280&e.config.ppsLength)>>>8),r.push(255&e.config.ppsLength);try{e.config.ppsLength>0&&(r=r.concat(Array.prototype.slice.call(e.config.pps)))}catch(e){}var n=[];n.push((65280&e.config.spsLength)>>>8),n.push(255&e.config.spsLength);try{e.config.spsLength>0&&(n=n.concat(Array.prototype.slice.call(e.config.sps)))}catch(e){}var i=new Uint8Array(78),a=new DataView(i.buffer);return a.setUint16(6,1),a.setUint16(24,e.config.width),a.setUint16(26,e.config.height),a.setUint32(28,4718592),a.setUint32(32,4718592),a.setUint16(40,1),a.setUint32(42,259613032),a.setUint32(46,1869557110),a.setUint32(50,1768187247),
a.setUint32(54,761818227),a.setUint16(74,24),a.setUint16(76,65535),t.OM("avc1",[i,t.OM("avcC",[new Uint8Array([1,e.config.profileIndication,e.config.profileCompatibility,e.config.levelIndication,255].concat([255&e.config.numOfSPS|224]).concat(n).concat([255&e.config.numOfPPS]).concat(r))]),t.tN()])},n.prototype.tN=function(){var e=this,t=new Uint8Array(12),r=new DataView(t.buffer);return r.setUint32(0,1875072),e.OM("btrt",[t])},n.prototype.rN=function(e){var t=this,r=new Uint8Array(8),n=new DataView(r.buffer);n.setUint16(6,1);var i=new Uint8Array(20);return n=new DataView(i.buffer),n.setUint16(8,e.config.channels),n.setUint16(10,e.config.sampleSize),n.setUint16(16,e.config.samplingFreq),t.OM("mp4a",[r,i,t.uN(e)])},n.prototype.uN=function(e){var t=this,r=new Uint8Array(27),n=new DataView(r.buffer);return n.setUint8(0,3),n.setUint8(1,25),n.setUint8(5,4),n.setUint8(6,17),n.setUint8(7,64),n.setUint8(8,21),n.setUint16(10,1536),n.setUint8(20,5),n.setUint8(21,2),n.setUint8(22,e.config.audioObjectTypeIndex<<3|e.config.samplingFreqIndex>>>1),n.setUint8(23,e.config.samplingFreqIndex<<7|e.config.channels<<3),n.setUint8(24,6),n.setUint8(25,1),n.setUint8(26,2),t.UM("esds",0,new Uint8Array(3),[r])},n.prototype.nN=function(){var e=this,t=new Uint8Array(4);return e.UM("stts",0,new Uint8Array(3),[t])},n.prototype.oN=function(){var e=this,t=new Uint8Array(4);return e.UM("stsc",0,new Uint8Array(3),[t])},n.prototype.pN=function(){var e=this,t=new Uint8Array(8);return e.UM("stsz",0,new Uint8Array(3),[t])},n.prototype.qN=function(){var e=this,t=new Uint8Array(4);return e.UM("stco",0,new Uint8Array(3),[t])},n.prototype.RM=function(e){for(var t=this,r=[],n=0;n<e.length;n++)r.push(t.vN(e[n]));return t.OM("mvex",r)},n.prototype.vN=function(e){var t=this,r=new Uint8Array(20),n=new DataView(r.buffer);return n.setUint32(0,e.streamId),n.setUint32(4,1),n.setUint32(16,65537),"video"!==e.type&&(r[r.length-1]=0),t.UM("trex",0,new Uint8Array(3),[r])},n.prototype.UM=function(e,t,r,n){var i=this,a=new Uint8Array(1);a[0]=t;var o=[a,r];return o=o.concat(n),i.OM(e,o)},n.prototype.OM=function(e,t){var r=0,n=new Uint8Array([e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]),i=0,a=0;for(a=0;a<t.length;a++)i+=t[a].length;var o=new Uint8Array(i+8),s=new DataView(o.buffer,o.byteOffset,o.byteLength);for(s.setUint32(0,o.byteLength),o.set(n,4),r=8,a=0;a<t.length;a++)o.set(t[a],r),r+=t[a].length;return o}},{}],209:[function(e,t,r){"use strict";function n(){var e=this;e.wN=null,e.xN=new i}t.exports=n;var i=e("./mp4-box"),a=.0232199546,o=.0333333333;n.prototype.destroy=function(){var e=this;e.wN=null},n.prototype.generate=function(e){if(!e)return null;var t=this,r=[e],n=null,i=null,a=null,o=0;if(e.config.shouldInit){var s="audio"===e.type?"mp41":"avc1";n=t.yN(r,s),o+=n?n.length:0}e.frames.length&&(i=t.zN(r),o+=i?i.length:0,a=t.AN(r),o+=a?a.length:0),t.wN=new Uint8Array(o);var l=0;n&&(t.wN.set(n,l),l+=n.length),i&&(t.wN.set(i,l),l+=i.length),a&&(t.wN.set(a,l),l+=a.length);var c=e.frames.length>0?e.frames[e.frames.length-1].duration:0,u=e.endTime+c;return{data:t.wN,type:e.type,codec:e.config.codec,mimeType:e.type+'/mp4; codecs="'+e.config.codec+'"',startTime:e.frames.length?e.startTime/e.config.timescale:0,endTime:e.frames.length?u/e.config.timescale:0,endTimestamp:u}},n.prototype.yN=function(e,t){var r=this;if(!e||!e.length)return null;var n=r.xN.initSegment(e,t);return n?n:null},n.prototype.zN=function(e){var t=this,r=0;return e&&e.length?(e.forEach(function(e){r=e.config.seqNum,e.frames&&e.frames.length&&e.frames.forEach(function(r,n,i){r.size=r.nalUnitSize?r.nalUnitSize+4*r.nalUnits.length:r.data?r.data.length:0,n<i.length-1?r.duration=e.frames[n+1].dts-r.dts:n>0?r.duration=r.dts-e.frames[n-1].dts:r.duration=e.config.defaultFrameDuration||t.BN(e.type.track.config.timescale),r.duration<0})}),t.xN.moof(r,e)):null},n.prototype.AN=function(e){var t=this;if(!e||!e.length)return null;var r,n=[],i=0;e.forEach(function(e){"video"===e.type&&e.frames.forEach(function(e){e.normalizedData=new Uint8Array(e.nalUnitSize+4*e.nalUnits.length);var t=new DataView(e.normalizedData.buffer),r=0;e.nalUnits.forEach(function(n){t.setUint32(r,n.data.byteLength),r+=4,e.normalizedData.set(n.data,r),r+=n.data.byteLength}),e.data=e.normalizedData}),r=t.xN.mdat(e),r&&r.length&&(n.push(r),i+=r.length)});var a=new Uint8Array(i),o=0;return n.forEach(function(e){a.set(e,o),o+=e.length}),a},n.prototype.BN=function(e,t){var r="audio"===e?a:o;return r*t}},{"./mp4-box":208}],210:[function(e,t,r){"use strict";function n(e){var t=this;s.call(t,t.constructor.name),t._b=e,t.yF=null,t.CN="start",t.WF=new c,t.DN=!1,t.FF={},t.EN=t.__controller.create(i,e,t.FN.bind(t)),t.qL=e.lastAudioTimestamp,t.rL=e.lastAudioFrameDuration,o.isNullOrUndefined(t._b.pcr)&&(t.FF[u]=t.__controller.addEventListener(u,t.GN,t))}t.exports=n;var i=e("../helper/aac-to-mp4"),a=e("../../lib/hls-utils"),o=e("../../lib/index"),s=e("../../lib/event-bus"),l=e("./segment-data-processor-events"),c=e("../ts-demux/av-stream").AACStream,u=e("../event").HLSEvent.PCR_AVAILABLE;a.inherits(n,s),n.prototype.destroy=function(){var e=this;e.close(),e.EN.destroy(),e.WF.destroy(),s.prototype.destroy.call(e)},n.prototype.setSource=function(e){var t=this;t.HN=e,t.dI()},n.prototype.dI=function(){var e=this;e.HN&&(e.HN.addEventListener(l.DATA_PROCESS_PROGRESS,function(t){e.append(t)},e),e.HN.addEventListener(l.DATA_PROCESS_COMPLETE,function(){e.endOfSegment()},e),e.HN.addEventListener(l.DATA_PROCESS_ERROR,function(t){e.publish(l.DATA_PROCESS_ERROR,t)},e))},n.prototype.close=function(){var e=this;e.yF=null,e.__controller.removeEventListener(u,e.FF[u]),e.EN.close()},n.prototype.append=function(e){var t=this;if(e){var r=e.length;if(r){var n=null,i=0;t.yF&&(n=t.yF,i=n.length);var a=i+r;t.yF=new Uint8Array(a),n&&t.yF.set(n),t.yF.set(e,i),t.LG()}}},n.prototype.GN=function(e){var t=this;t._b.pcr=e,t.LG(),t.__controller.removeEventListener(u,t.FF[u])},n.prototype.LG=function(){var e=this,t=e._b.pcr;if(!o.isNullOrUndefined(t)){if(e.yF&&e.yF.length>0){var r;r=e.qL&&e.rL?t+e.qL+e.rL:t+e._b.startTime*e._b.timescale;var n=e.WF.readFramesFromBitstream(e.yF,r);e.yF=e.yF.subarray(n)}var i=e.WF.getLastFrameDetails();i&&(e.qL=i.timestamp-t,e.rL=i.duration),(e.WF.ready||e.DN)&&e.IN()}},n.prototype.IN=function(){var e=this,t=e.WF.getFrames(),r=t&&t.length>0;if("end"===e.CN||r){var n=r?t[0].dts:null,i={audio:{frames:t,config:e.WF.getConfig()},pcr:n};e.EN.processSegmentData({avData:i,pos:e.CN}),"start"===e.CN&&(e.CN="middle")}},n.prototype.endOfSegment=function(){var e=this;e.CN="end",e.DN=!0,e.LG(),e.EN.endOfSegment()},n.prototype.FN=function(e,t){var r=this;if(e){r.publish(l.DATA_PROCESS_PROGRESS,e,t);var n;e.getParam&&(n=e.getParam("parsedInfo"));var i=n?n.position:e.position;"end"===i&&r.publish(l.DATA_PROCESS_COMPLETE)}}},{"../../lib/event-bus":144,"../../lib/hls-utils":145,"../../lib/index":146,"../event":185,"../helper/aac-to-mp4":186,"../ts-demux/av-stream":225,"./segment-data-processor-events":214}],211:[function(e,t,r){"use strict";function n(){var e=this;e.lL=e.__controller.model.userAgent,o.call(e,e.constructor.name),"undefined"==typeof window?e.JN=crypto||msCrypto:e.JN=window.crypto||window.msCrypto,e.JN=e.JN.subtle||e.JN.webkitSubtle,e.yF=null,e.KN=null,e.LN={name:s,length:128,iv:null}}t.exports=n;var i=e("../segment-data-processors/segment-data-processor-events"),a=e("../../lib/hls-utils"),o=e("../../lib/event-bus"),s="AES-CBC",l="Key Import is rejected",c="Key Import operation is not created in IE-11",u="Decryption operation is not created in IE-11",p="Decryption is rejected";a.inherits(n,o),n.prototype.destroy=function(){var e=this;e.close(),o.prototype.destroy.call(e)},n.prototype.close=function(){var e=this;e.yF=null,e.MN=null,e.KN=null,e.NN=null},n.prototype.append=function(e){var t=this;e&&("key"===e.type?t.PN(e):t.QN(e))},n.prototype.QN=function(e){var t=this;if(e)if(t.MN){var r=new Uint8Array(t.MN.byteLength+e.byteLength);r.set(new Uint8Array(t.MN),0),r.set(new Uint8Array(e),t.MN.byteLength),t.MN=r}else t.MN=e},n.prototype.PN=function(e){var t=this;if(e)return e.initVector||(e.initVector=t.RN(e.seqNum)),t.KN=e,t.LN.iv=t.SN(e.initVector).buffer,11===t.lL.ie?void t.TN(e):void t.JN.importKey("raw",e.data,t.LN,!0,["decrypt"]).then(function(e){t.NN=e,t.UN()},function(e){t.tb(l,e)})},n.prototype.TN=function(e){var t=this,r=t.JN.importKey("raw",e.data,t.LN,!0,["decrypt"]);return r?(r.onerror=function(e){t.tb(l,e)},void(r.oncomplete=function(e){t.NN=e&&e.target?e.target.result:null,t.UN()})):void t.tb(c)},n.prototype.UN=function(){var e=this;if(e.NN&&e.MN&&e.MN.byteLength&&e.DN){var t=e.MN.buffer,r=t.byteLength-t.byteLength%16,n=t.slice(0,r);return e.MN=new Uint8Array(t.slice(r)),11===e.lL.ie?void e.VN(n):void e.JN.decrypt(e.LN,e.NN,n).then(function(t){e.WN(t)},function(t){e.tb(p,t)}).catch(function(t){e.tb("Exception",t.toString())})}},n.prototype.VN=function(e){var t=this;if(t.NN&&e){var r=t.JN.decrypt(t.LN,t.NN,e);if(!r)return void t.tb(u);r.onerror=function(e){t.tb(p,e)},r.oncomplete=function(e){e&&e.target&&t.WN(e.target.result)}}},n.prototype.WN=function(e){var t=this;t.publish(i.DATA_PROCESS_PROGRESS,new Uint8Array(e)),t.DN&&(0===t.MN.byteLength?t.publish(i.DATA_PROCESS_COMPLETE):t.UN())},n.prototype.SN=function(e){e=e.substr(2);for(var t=[],r=0,n=e.length;r<n;r+=2)t.push(parseInt(e.substr(r,2),16));return new Uint8Array(t)},n.prototype.endOfSegment=function(){var e=this;e.DN=!0,e.KN&&e.NN&&e.UN()},n.prototype.tb=function(e,t){var r=this;r.publish(i.DATA_PROCESS_ERROR)},n.prototype.RN=function(e){e=e||0;for(var t="0x",r=e.toString(16),n=r.length<32?32-r.length:0,i=0;i<n;i++)t+="0";return t+=r}},{"../../lib/event-bus":144,"../../lib/hls-utils":145,"../segment-data-processors/segment-data-processor-events":214}],212:[function(e,t,r){"use strict";function n(e){var t=this;o.call(t,t.constructor.name),t.yF=null,t._b=e,t.XN=new c,t.pJ=new l,t.YN=new d}t.exports=n;var i=e("../../lib"),a=e("../../lib/hls-utils"),o=e("../../lib/event-bus"),s=e("./segment-data-processor-events"),l=e("../mp4/mp4-box-parser"),c=e("../helper/id3"),u=e("../worker-utils/worker-defs"),p=e("../worker-utils/message"),d=e("../ts-demux/sei-parser"),f=e("../ts-demux/av-stream").NAL_UNIT_TYPES,v=e("../model/worker-scope/stream").StreamTypes;a.inherits(n,o),n.prototype.destroy=function(){var e=this;e.yF=null,e.pJ.destroy(),e.YN.destroy(),o.prototype.destroy.call(e)},n.prototype.setSource=function(e){var t=this;t.HN=e,t.dI()},n.prototype.dI=function(){var e=this;e.HN&&(e.HN.addEventListener(s.DATA_PROCESS_PROGRESS,function(t){e.append(t)},e),e.HN.addEventListener(s.DATA_PROCESS_COMPLETE,function(){e.endOfSegment()},e),e.HN.addEventListener(s.DATA_PROCESS_ERROR,function(t){e.publish(s.DATA_PROCESS_ERROR,t)},e))},n.prototype.close=function(){var e=this;e.yF=null},n.prototype.append=function(e){var t=this;if(e){var r=e.length;if(r){var n=null,i=0;t.yF&&(n=t.yF,i=n.length);var a=i+r;t.yF=new Uint8Array(a),n&&t.yF.set(n),t.yF.set(e,i),t.ZN()}}},n.prototype.ZN=function(){for(var e=this;e.yF&&e.yF.length>=8;){var t=e.yF.length,r=new DataView(e.yF.buffer),n=e.pJ.parse(e.yF,"styp"),i=e.pJ.parse(e.yF,"emsg"),a=e.pJ.parse(e.yF,"moof"),o=e.pJ.parse(e.yF,"ftyp"),l=e.pJ.parse(e.yF,"moov");if(o&&l){e._b.userAgent.android&&e.$N();var c=[];o&&c.push(o),l&&c.push(l);var u=e._N(c),p=e.aO(c),d=new Uint8Array(e.yF.buffer.slice(u,p));e.publish(s.DATA_PROCESS_PROGRESS,{position:"init",data:d}),e.yF.length>p?e.yF=new Uint8Array(e.yF.buffer.slice(p)):e.yF=null}else{if(!a)return;var f=e.pJ.findBoxOffset(r,"mdat");if(f<0)return;var m=e.pJ.parseHeader(r,"mdat",f),y=[];n&&y.push(n),i&&y.push(i),a&&y.push(a),m&&y.push(m);var h=e._N(y),E=e.aO(y);if(t<E)return;var g=e.bO(),b=e._b.timescale,_=e.cO(),A=e.dO(),T=e.eO(_,g);if(e._b.dash){var S=Math.round(e._b.startTime*b),I=e._b.segDuration*b;A!==S&&(A=S,e.fO(A)),T!==I&&(e.gO(_,I),T=I)}var L=null;e._b.type!==v.MAIN&&e._b.type!==v.VIDEO||(L=e.hO(f,_,A,b));var R=new Uint8Array(e.yF.buffer.slice(h,E));e.CN="firstByte"===e.CN?"start":"middle",e.publish(s.DATA_PROCESS_PROGRESS,{position:e.CN,data:R,cea608TrackData:L,baseTime:A,defaultSampleDuration:g,totalDuration:T,samples:_.samples}),e._b.dash&&i&&e.iO(i),e.yF.length>E?e.yF=new Uint8Array(e.yF.buffer.slice(E)):e.yF=null}}},n.prototype.endOfSegment=function(){var e=this;e.ZN(),e.publish(s.DATA_PROCESS_COMPLETE)},n.prototype._N=function(e){if(!e||!e.length)return 0;var t=Number.POSITIVE_INFINITY;return e.forEach(function(e){t=Math.min(t,e.boxOffset)}),t},n.prototype.aO=function(e){if(!e||!e.length)return 0;var t=0,r=e[0];return e.forEach(function(e){t<e.boxOffset&&(t=e.boxOffset,r=e)}),r.boxOffset+r.boxSize},n.prototype.dO=function(){var e=this,t=e.pJ.parse(e.yF,"tfdt");return t?t.baseMediaDecodeTime:0},n.prototype.fO=function(e){var t=this;t.pJ.setSingleProp(t.yF,"tfdt",{name:"baseMediaDecodeTime",value:e,length:32})},n.prototype.gO=function(e,t){var r=this;if(e&&e.totalDuration){var n=t-e.totalDuration,i=e.samples[e.samples.length-1],a=i.duration+n;a<0&&(a=0),r.pJ.setSingleProp(r.yF,"trun",{name:"sampleDuration",value:a,length:32,pos:-1})}},n.prototype.bO=function(){var e=this,t=e.pJ.parse(e.yF,"tfhd");return t&&t.defaultSampleDuration>0?t.defaultSampleDuration:0},n.prototype.eO=function(e,t){return e.totalDuration?e.totalDuration:e.samples.length*t},n.prototype.cO=function(){var e=this,t=[],r=0,n=e.pJ.parse(e.yF,"trun");if(n&&n.sampleData)for(var a=n.sampleData.length,o=n.sampleData,s=0;s<a;s++){var l={};o[s].sampleDuration&&(l.duration=o[s].sampleDuration,r+=l.duration),o[s].sampleSize&&(l.size=o[s].sampleSize),o[s].sampleFlags&&(l.flags=o[s].sampleFlags),i.isNullOrUndefined(o[s].sampleCompositionTimeOffset)||(l.cto=o[s].sampleCompositionTimeOffset),t.push(l)}return{samples:t,totalDuration:r}},n.prototype.iO=function(e){var t=this;if(e){var r=t.jO(e.presentationTimeDelta,e.timescale),n=e.message&&t.XN.extractID3FromMessage(e.message),i=n&&t.XN.getID3Payload(n),a={payload:i,timestamp:t._b.startTime+r},o=new p({type:u.MessageTypes.MESSAGE,id:u.MessageIds.TIMED_METADATA});o.putParam("timedMetadata",a),t.publish(s.DATA_PROCESS_PROGRESS,o)}},n.prototype.jO=function(e,t){return 0===t?0:e/t},n.prototype.$N=function(){var e=this,t=e.pJ.parse(e.yF,"esds");if(t){var r=t.audioSpecificConfig0>>3,n=t.audioSpecificConfig0<<1&14|t.audioSpecificConfig1>>7&1,i=t.audioSpecificConfig1>>3&7;if(5===r){r=2;var a=r<<3|(14&n)>>1,o=(1&n)<<7|i<<3;e.pJ.setSingleProp(e.yF,"esds",{name:"audioSpecificConfig0",value:a,length:8}),e.pJ.setSingleProp(e.yF,"esds",{name:"audioSpecificConfig1",value:o,length:8}),e.pJ.setSingleProp(e.yF,"esds",{name:"audioSpecificConfig2",value:0,length:8}),e.pJ.setSingleProp(e.yF,"esds",{name:"audioSpecificConfig3",value:0,length:8})}}},n.prototype.hO=function(e,t,r,n){for(var i=this,a=[],o=i.yF.slice(e+8),s=r,l=0,c=0,u=0;u<t.samples.length;u++){var p=t.samples[u];for(c+=p.size;l<c&&l<o.length;){var d=o[l]<<24|o[l+1]<<16|o[l+2]<<8|o[l+3];l+=4;var v=15&o[l];if(v===f.AD_INFO_SEI)for(var m=i.YN.parse(o,l+1),y=0;y<m.length;y++){var h=m[y];h.pts=s+p.cto,h.dts=s,h.timescale=n,a.push(h)}l+=d}s+=p.duration}return a}},{"../../lib":146,"../../lib/event-bus":144,"../../lib/hls-utils":145,"../helper/id3":190,"../model/worker-scope/stream":204,"../mp4/mp4-box-parser":206,"../ts-demux/av-stream":225,"../ts-demux/sei-parser":227,"../worker-utils/message":229,"../worker-utils/worker-defs":231,"./segment-data-processor-events":214}],213:[function(e,t,r){"use strict";function n(e){if(!e)throw new Error("Invalid argument: data argument of the ProcessorChain is not complete");var t=this;t._b=e,t.kO=null,t.lO=null,s.call(t,t.constructor.name),e.encryptionData&&(t.kO=t.__controller.create(l,e.encryptionData)),t.lO=i.create(t.__controller,e.containerFormat,e),t.kO&&t.lO.setSource(t.kO),t.mO=t.kO||t.lO,t.nO=t.lO,t.nO&&(t.nO.addEventListener(a.DATA_PROCESS_PROGRESS,function(e,r){t.publish(a.DATA_PROCESS_PROGRESS,e,r)},t),t.nO.addEventListener(a.DATA_PROCESS_COMPLETE,function(e){t.publish(a.DATA_PROCESS_COMPLETE,e)},t),t.nO.addEventListener(a.DATA_PROCESS_ERROR,function(){t.publish(a.DATA_PROCESS_ERROR)},t))}t.exports=n;var i=e("../segment-data-processors/segment-data-processor-factory"),a=e("../segment-data-processors/segment-data-processor-events"),o=e("../../lib/hls-utils"),s=e("../../lib/event-bus"),l=e("./encrypted-segment-data-processor");o.inherits(n,s),n.prototype.destroy=function(){var e=this;e.kO&&(e.kO.destroy(),e.kO=null),e.lO&&(e.lO.destroy(),e.lO=null),e.mO=null,e.nO=null,s.prototype.destroy.call(e)},n.prototype.append=function(e){var t=this;t.mO&&t.mO.append(e)},n.prototype.close=function(){var e=this;e.mO&&e.mO.close()},n.prototype.endOfSegment=function(){var e=this;e.mO&&e.mO.endOfSegment()}},{"../../lib/event-bus":144,"../../lib/hls-utils":145,"../segment-data-processors/segment-data-processor-events":214,"../segment-data-processors/segment-data-processor-factory":215,"./encrypted-segment-data-processor":211}],214:[function(e,t,r){"use strict";t.exports={DATA_PROCESS_PROGRESS:"dataProcessProgress",DATA_PROCESS_ERROR:"dataProcessError",DATA_PROCESS_COMPLETE:"dataProcessComplete"}},{}],215:[function(e,t,r){"use strict";var n=e("./ts-segment-data-processor"),i=e("./aac-segment-data-processor"),a=e("./fmp4-segment-data-processor");t.exports.create=function(e,t,r){if(!e||!t||"function"!=typeof e.create)return null;var o;switch(t){case"mp4":o=a;break;case"aac":o=i;break;default:case"ts":o=n}return e.create(o,r)}},{"./aac-segment-data-processor":210,"./fmp4-segment-data-processor":212,"./ts-segment-data-processor":216}],216:[function(e,t,r){"use strict";function n(e){var t=this;o.call(t,t.constructor.name),t._b=e,t.oO=t.__controller.create(i,e,t.FN.bind(t))}t.exports=n;var i=e("../helper/hls-transformer-facade"),a=e("../../lib/hls-utils"),o=e("../../lib/event-bus"),s=e("./segment-data-processor-events");a.inherits(n,o),n.prototype.destroy=function(){var e=this;e.oO.destroy(),o.prototype.destroy.call(e)},n.prototype.setSource=function(e){var t=this;t.HN=e,t.dI()},n.prototype.dI=function(){var e=this;e.HN&&(e.HN.addEventListener(s.DATA_PROCESS_PROGRESS,function(t){e.append(t)},e),e.HN.addEventListener(s.DATA_PROCESS_COMPLETE,function(){e.endOfSegment()},e),e.HN.addEventListener(s.DATA_PROCESS_ERROR,function(t){e.publish(s.DATA_PROCESS_ERROR,t)},e))},n.prototype.close=function(){var e=this;e.oO.close()},n.prototype.append=function(e){var t=this;t.oO.append(e)},n.prototype.endOfSegment=function(){var e=this;e.oO.endOfSegment()},n.prototype.FN=function(e){var t=this;if(e){t.publish(s.DATA_PROCESS_PROGRESS,e);var r;e.getParam&&(r=e.getParam("parsedInfo"));var n=r?r.position:e.position;"end"===n&&t.publish(s.DATA_PROCESS_COMPLETE,e)}}},{"../../lib/event-bus":144,"../../lib/hls-utils":145,"../helper/hls-transformer-facade":188,"./segment-data-processor-events":214}],217:[function(e,t,r){"use strict";function n(e){var t=this;t.pO=e,t.$F=null,t.qO=!1,t.rO=0,t.sO=[],t.tO=null,t.uO=0,t.vO=0,t.wO=0,t.xO=[],t.yO=0,t.zO=0,t.AO=0,t.BO=!1,t.CO=4}function i(e,t,r,n){var i=this;i.VO=e,i.WO=0,i.XO=[],i.YO=null,i.ZO=null,i.Ay=null,i.$O=t,i._O=r,i.aP=n}function a(){var e=this;e.dP=32,e.eP=-1,e.fP=!1,e.gP=!1,e.hP=0,e.iP=[],e.MAX_CHARS=32}function o(){var e=this;e.character="",e.isUnderlined=!1,e.isItalic=!1}t.exports=n,n.prototype.destroy=function(){var e=this;e.pO=null},n.prototype.parse=function(e,t){var r=this;r.$F=t;for(var n=0;n<e.length;n++)r.DO(e[n]);r.$F=null},n.prototype.DO=function(e){var t=this;if(t.EO(e.data1)&&t.EO(e.data2)&&(t.AO=e.pts/e.timescale,e.data1&=127,e.data2&=127,0!==e.data1||0!==e.data2)){if(e.data1>=1&&e.data1<=14&&1===e.fieldType&&(t.qO=!0),15===e.data1&&t.qO&&1===e.fieldType)return void(t.qO=!1);if(e.data1>=16&&e.data1<31){if(t.FO(e.data1,e.data2))return;if(8!==(8&e.data1)&&0===e.fieldType?t.GO(0):8===(8&e.data1)&&0===e.fieldType?t.GO(1):8!==(8&e.data1)&&1===e.fieldType?t.GO(2):8===(8&e.data1)&&1===e.fieldType&&t.GO(3),null===t.tO)return;t.HO(e),t.IO(e),t.JO(e);var r=119&e.data1;17===r&&48===(112&e.data2)?t.KO(15&e.data2):18!==r&&26!==r||64&e.data2?19!==r&&27!==r||64&e.data2||t.MO(63&e.data2):t.LO(63&e.data2)}else{if(t.qO&&1===e.fieldType)return;if(e.data1>=32&&e.data1<=126){if(0===e.fieldType&&2===t.rO?t.GO(0):0===e.fieldType&&3===t.rO?t.GO(1):1===e.fieldType&&0===t.rO?t.GO(2):1===e.fieldType&&1===t.rO&&t.GO(3),null===t.tO)return;var n=t.NO(e.data1);if(t.tO.appendChar(n),e.data2>=32&&e.data2<=126){var i=t.NO(e.data2);t.tO.appendChar(i)}}}t.uO=e.data1,t.vO=e.data2}},n.prototype.HO=function(e){var t=this,r=119&e.data1,n=96&e.data2;17===r&&64===n?(t.tO.startNewRow(1),t.OO(e.data2)):17===r&&96===n?(t.tO.startNewRow(2),t.OO(e.data2)):18===r&&64===n?(t.tO.startNewRow(3),t.OO(e.data2)):18===r&&96===n?(t.tO.startNewRow(4),t.OO(e.data2)):21===r&&64===n?(t.tO.startNewRow(5),t.OO(e.data2)):21===r&&96===n?(t.tO.startNewRow(6),t.OO(e.data2)):22===r&&64===n?(t.tO.startNewRow(7),t.OO(e.data2)):22===r&&96===n?(t.tO.startNewRow(8),t.OO(e.data2)):23===r&&64===n?(t.tO.startNewRow(9),t.OO(e.data2)):23===r&&96===n?(t.tO.startNewRow(10),t.OO(e.data2)):16===r&&64===n?(t.tO.startNewRow(11),t.OO(e.data2)):19===r&&64===n?(t.tO.startNewRow(12),t.OO(e.data2)):19===r&&96===n?(t.tO.startNewRow(13),t.OO(e.data2)):20===r&&64===n?(t.tO.startNewRow(14),t.OO(e.data2)):20===r&&96===n&&(t.tO.startNewRow(15),t.OO(e.data2))},n.prototype.IO=function(e){var t=this,r=119&e.data1;17===r&&32===(112&e.data2)&&(t.OO(e.data2),t.tO.appendChar(" "))},n.prototype.JO=function(e){var t=this,r=119&e.data1;20===r&&32===e.data2?t.tO.setMode(s.POP_ON_MODE):20===r&&33===e.data2?t.tO.backspace():20===r&&36===e.data2?t.tO.clearEndOfRow():20===r&&37===e.data2?t.tO.setMode(s.ROLL_UP_MODE,2):20===r&&38===e.data2?t.tO.setMode(s.ROLL_UP_MODE,3):20===r&&39===e.data2?t.tO.setMode(s.ROLL_UP_MODE,4):20===r&&41===e.data2?t.tO.setMode(s.PAINT_ON_MODE):20===r&&44===e.data2?t.tO.eraseDisplayMemory():20===r&&45===e.data2?t.tO.linebreak():20===r&&46===e.data2?t.tO.eraseNondisplayMemory():20===r&&47===e.data2?t.tO.endOfCaption():23===r&&33===e.data2?t.tO.setIndent(1):23===r&&34===e.data2?t.tO.setIndent(2):23===r&&35===e.data2&&t.tO.setIndent(3)},n.prototype.KO=function(e){var t=this,r=["®","°","½","¿","™","¢","£","♪","à"," ","è","â","ê","î","ô","û"],n=e;n<0||n>=r.length||t.tO.appendChar(r[n])},n.prototype.LO=function(e){var t=this,r=["Á","É","Ó","Ú","Ü","ü","´","¡","*","'","-","©","℠","·",'"','"',"À","Â","Ç","È","Ê","Ë","ë","Î","Ï","ï","Ô","Ù","ù","Û","«","»"],n=e-32;n<0||n>=r.length||t.tO.appendChar(r[n])},n.prototype.MO=function(e){var t=this,r=["Ã","ã","Í","Ì","ì","Ò","ò","Õ","õ","{","}","\\","^","_","|","~","Ä","ä","Ö","ö","ß","¥","¤","¦","Å","å","Ø","ø","┌","┐","└","┘"],n=e-32;n<0||n>=r.length||t.tO.appendChar(r[n])},n.prototype.EO=function(e){var t=[0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0];return t[e]},n.prototype.NO=function(e){return 42===e?"á":92===e?"é":94===e?"í":95===e?"ó":96===e?"ú":123===e?"ç":124===e?"÷":125===e?"Ñ":126===e?"ñ":String.fromCharCode(e)},n.prototype.FO=function(e,t){var r=this;return r.uO===e&&r.vO===t},n.prototype.OO=function(e){var t=this;if(16===(16&e)){var r=0;0===(14&e)?r=0:2===(14&e)?r=4:4===(14&e)?r=8:6===(14&e)?r=12:8===(14&e)?r=16:10===(14&e)?r=20:12===(14&e)?r=24:14===(14&e)&&(r=28),t.tO.setColumn(r)}else 14===(14&e)&&t.tO.setItalic();1===(1&e)&&t.tO.setUnderlined()},n.prototype.GO=function(e){var t=this;t.sO[e]||(t.sO[e]=new i(e,t.onFlipMemories.bind(this),t.onEraseDisplayMemory.bind(this),t.onLinebreak.bind(this))),t.rO=e,t.tO=t.sO[e]},n.prototype.getChannel=function(e){var t=this;return t.sO[e]},n.prototype.translate608RowToVTTLine=function(e){var t=[10,15.33,20.66,26,31.33,36.66,42,47.33,52.66,58,63.33,68.66,74,79.33,84.66];return e<1||e>t.length?t[0]:t[e-1]},n.prototype.translate608ColumnToVTTPosition=function(e){var t=0;return e<=4?t=10:e>=5&&e<=8?t=20:e>=9&&e<=12?t=30:e>=13&&e<=16?t=40:e>=17&&e<=20?t=50:e>=21&&e<=24?t=60:e>=25&&e<=29?t=70:e>=29&&(t=80),t},n.prototype.onFlipMemories=function(e){var t=this;t.BO&&t.onEraseDisplayMemory(e);var r=t.getChannel(e),n=r.getMode();if(n===s.POP_ON_MODE){if(t.yO=t.AO,e===t.wO){var i=t.xO;t.xO=r.getCaptionRows(),r.setCaptionRows(i);for(var a=0;a<t.xO.length;a++)t.xO[a]&&t.xO[a].hasCaptionData()&&(t.BO=!0)}r.eraseNondisplayMemory()}},n.prototype.PO=function(e,t){var r=this,n=[];n.push("snapToLines:false"),n.push("align:start");var i="line:"+r.translate608RowToVTTLine(t)+"%";n.push(i);var a="position:"+r.translate608ColumnToVTTPosition(e)+"%";return n.push(a),n},n.prototype.QO=function(e,t,r){for(var n=t[e],i=n.toString();e<t.length-1;){var a=t[e+1];if(a&&a.hasCaptionData()){var o=a.toString();o.length>0&&(i+="\n"+o),r&&a.reset(),e++}else e++}return{rowIdx:e,rowText:i}},n.prototype.onEraseDisplayMemory=function(e){var t=this,r=t.getChannel(e),n=r.getMode();if(e!==t.wO)return void r.eraseNondisplayMemory();if(n===s.POP_ON_MODE){t.zO=t.AO;for(var i=0;i<t.xO.length;i++){var a=t.xO[i];if(a&&a.hasCaptionData()){var o=a.getStartPosition(),l=t.PO(o,i+1),c=t.QO(i,t.xO,!0);i=c.rowIdx;var u=c.rowText,p=t.zO-t.yO;p>t.CO&&(t.zO=t.yO+t.CO),t.RO(u,l),t.yO+=.001,a.reset()}}}else n===s.ROLL_UP_MODE||n===s.PAINT_ON_MODE?(t.yO!==-1&&0!==t.yO||(t.yO=t.AO),t.zO>t.yO&&(t.yO=t.zO),t.SO(e),r.eraseNondisplayMemory()):n&&r.eraseNondisplayMemory();t.BO=!1},n.prototype.onLinebreak=function(e){var t=this;if(e===t.wO){var r=t.getChannel(e),n=r.getMode();n!==s.ROLL_UP_MODE&&n!==s.PAINT_ON_MODE||(t.yO!==-1&&0!==t.yO||(t.yO=t.AO),t.zO>t.yO&&(t.yO=t.zO),t.SO(e))}},n.prototype.SO=function(e){for(var t=this,r=t.getChannel(e),n=r.getCaptionRows(),i=0;i<n.length;i++){var a=n[i];if(a&&a.hasCaptionData()){var o=t.PO(12,i),s=t.QO(i,n,!1);i=s.rowIdx;var l=s.rowText,c=1.5;t.zO=t.yO+c,t.RO(l,o),t.yO+=.001}}t.yO=-1},n.prototype.RO=function(e,t){var r=this,n="WEBVTT\n",i="X-TIMESTAMP-MAP=LOCAL:00:00:00.000,MPEGTS:0\n\n",a=n+i;a+=r.TO(r.yO),a+=" --> ",a+=r.TO(r.zO);for(var o=0;o<t.length;o++)a+=" "+t[o];if(a+="\n",a+=e+"\n",r.pO){var s={discontinuity:r.$F.discontinuity,sequenceNum:r.$F.seqNum,startTime:r.$F.startTime,programDateTime:r.$F.programDateTime,url:r.$F.url,duration:r.$F.duration,clockReference:0,localCueTime:0,mpegTSTime:0,data:a,offset:0,adjustedTime:0};r.pO(s)}},n.prototype.TO=function(e){var t=this,r=Math.floor(e/60/60);r=t.UO(r);var n=Math.floor(e/60%60);n=t.UO(n);var i=(e%60).toFixed(3);return i=t.UO(i),r+":"+n+":"+i},n.prototype.UO=function(e){return e<10&&(e="0"+e),e};var s={POP_ON_MODE:0,ROLL_UP_MODE:1,PAINT_ON_MODE:3};i.prototype.setMode=function(e,t){var r=this;r.Ay=e,t<2?t=2:t>4&&(t=4),r.WO=t},i.prototype.getMode=function(){var e=this;return e.Ay},i.prototype.bP=function(e){var t=this;if(!(e<1||e>15)){(e<t.WO||null===t.YO)&&(t.YO=t.WO);for(var r=t.XO[0],n=0;n<t.XO.length;n++)n<t.XO.length-1?t.XO[n]=t.XO[n+1]:t.XO[n]=r,(n>t.YO||t.YO-t.WO>0&&n<t.YO-t.WO)&&t.XO[n]&&t.XO[n].reset()}},i.prototype.cP=function(){var e=this;e.aP&&e.aP(e.VO)},i.prototype.startNewRow=function(e){if(!(e<1||e>15)){var t=this;t.Ay===s.ROLL_UP_MODE?t.bP(e):t.Ay===s.PAINT_ON_MODE&&t.cP(),t.YO=e,t.ZO=t.getCaptionRow(e),t.ZO.reset()}},i.prototype.getCaptionRows=function(){var e=this;return e.XO},i.prototype.setCaptionRows=function(e){var t=this;t.XO=e},i.prototype.setIndent=function(e){var t=this;t.ZO&&t.ZO.tabIndex(e)},i.prototype.setColumn=function(e){var t=this;t.ZO&&t.ZO.columnIndex(e)},i.prototype.setItalic=function(){var e=this;e.ZO&&e.ZO.setIsItalic(!0)},i.prototype.setUnderlined=function(){var e=this;e.ZO&&e.ZO.setIsUnderlined(!0)},i.prototype.appendChar=function(e){var t=this;t.ZO&&t.ZO.writeChar(e)},i.prototype.linebreak=function(){var e=this;e.aP&&e.aP(e.VO)},i.prototype.eraseNondisplayMemory=function(){for(var e=this,t=0;t<e.XO.length;t++)e.XO[t]&&e.XO[t].reset()},i.prototype.clearEndOfRow=function(){var e=this;e.ZO&&e.ZO.clearToEnd()},i.prototype.backspace=function(){var e=this;e.ZO&&e.ZO.backspace()},i.prototype.eraseDisplayMemory=function(){var e=this;e._O(e.VO)},i.prototype.endOfCaption=function(){var e=this;e.$O(e.VO)},i.prototype.getCaptionRow=function(e){var t=this;if(e<1||e>15)return null;var r=e-1;return t.XO[r]||(t.XO[r]=new a),t.XO[r]},a.prototype.reset=function(){var e=this;e.gP=!1,e.fP=!1;for(var t=0;t<e.iP.length;t++)e.iP[t]&&e.iP[t].reset();e.hP=0,e.dP=32,e.eP=-1},a.prototype.clearToEnd=function(){for(var e=this,t=e.hP;t<e.iP.length;t++)e.iP[t]&&e.iP[t].reset()},a.prototype.columnIndex=function(e){var t=this;e<0||e>=t.MAX_CHARS||(t.hP=e)},a.prototype.tabIndex=function(e){var t=this;t.jP(e)},a.prototype.writeChar=function(e){var t=this,r=t.iP[t.hP];r||(t.iP[t.hP]=new o,r=t.iP[t.hP]),r.setValue(e,t.gP,t.fP),t.hP<t.dP&&(t.dP=t.hP),t.hP>t.eP&&(t.eP=t.hP),t.jP(1)},a.prototype.backspace=function(){var e=this;e.hP>0&&(e.iP[e.hP].reset(),e.hP--)},a.prototype.jP=function(e){var t=this;t.hP+e<t.MAX_CHARS?t.hP+=e:t.hP=t.MAX_CHARS-1},a.prototype.setIsItalic=function(e){var t=this;t.gP=e},a.prototype.setIsUnderlined=function(e){var t=this;t.fP=e},a.prototype.hasCaptionData=function(){var e=this;return 32!==e.dP||e.eP!==-1},a.prototype.getCharacterAt=function(e){var t=this;return e<0||e>=t.MAX_CHARS?null:t.iP[e]},a.prototype.getStartPosition=function(){var e=this;return e.dP},a.prototype.getEndPosition=function(){var e=this;return e.eP},a.prototype.toString=function(){var e=this,t="",r=!1,n=!1;if(e.hasCaptionData())for(var i=e.dP;i<=e.eP;i++){var a=e.getCharacterAt(i);a.isItalic&&!n?(t+="<i>",n=!0):n&&!a.isItalic&&(t+="</i>",n=!1),a.isUnderlined&&!r?(t+="<u>",r=!0):r&&!a.isUnderlined&&(t+="</u>",r=!1),t+="&"===a.character?"&amp;":"<"===a.character?"&lt;":">"===a.character?"&gt;":a.character}return r&&(t+="</u>",r=!1),n&&(t+="</i>",n=!1),t},o.prototype.reset=function(){var e=this;e.character="",e.isItalic=!1,e.isUnderlined=!1},o.prototype.setValue=function(e,t,r){var n=this;n.character=e,n.isItalic=t,n.isUnderlined=r}},{}],218:[function(e,t,r){"use strict";function n(e){var t=this;if(!e||s.isNullOrUndefined(e.maxRetries)||s.isNullOrUndefined(e.requestTimeout)||s.isNullOrUndefined(e.chunkedRequestTimeout))throw new Error("[LoadRequest] Invalid Arguments: Request details are not complete");t.method=e.method||"GET",t.chunked=e.isChunkedLoad||!1,t.useMSStream=e.useMSStream||!1,t.maxRetries=e.maxRetries,t.retryExclusion=e.retryExclusion,t.requestTimeout=1e3*e.requestTimeout,t.chunkedRequestTimeout=1e3*e.chunkedRequestTimeout,t.responseType=e.responseType||"text",t.headerFields=e.headerFields,t.minChunkSize=s.isNullOrUndefined(e.minChunkSize)?1e5:e.minChunkSize,t.stopStreamLoadOnError=e.stopStreamLoadOnError,t.url=e.url,t.withCredentials=e.withCredentials||!1,t.withResponseHeaders=e.withResponseHeaders||!1}function i(e,t,r){var n=this;if(!e)throw new Error("[Loader] Invalid Arguments: Loader created without a load request");c.call(n,"Loader"),n.request=e,n.MI=r,n.window=n.MI?null:t||window,n.kP=null,n.lP={},n.mP=[1e3,1e3,2e3,2e3,3e3,3e3,5e3],n.nP=5e3,n.oP=new p(1e3,1),n.oP.addEventListener(n.load,n),n.MIN_TIMEOUT=2e3,n.MAX_TIMEOUT=15e3,n.pP=0,n.SF=e.maxRetries,n.qP=new p(n.rP(),1),n.qP.addEventListener(n.sP,n)}function a(e,t,r){var n=this;i.call(n,e,t,r)}function o(e,t,r){var n=this;a.call(n,e,t,r)}r.Loader=i,r.LoadRequest=n,r.Events={COMPLETE:"complete",ERROR:"error",PROGRESS:"progress",BYTES_LOADED:"bytesLoaded"};var s=e("../../lib"),l=e("../../lib/hls-utils"),c=e("../../lib/event-bus"),u=e("./../error"),p=e("../../lib/timer"),d={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},f={EMPTY:0,LOADING:1,DONE:2};r.getLoader=function(e,t,r){if(!e)throw new Error("[LoaderFactory] Invalid Arguments: Loader created without a load request");return e.chunked?e.useMSStream?new o(e,t,r):new a(e,t,r):new i(e,t,r);
},l.inherits(i,c),l.inherits(a,i),l.inherits(o,a),i.prototype.load=function(e,t){var n=this;if(!n.request)throw new Error("[Loader] InvalidStateError: load called without a request");return n.url=e||n.request.url,n.url?(n.tP(),n.kP=n.MI?new XMLHttpRequest:new n.window.XMLHttpRequest,n.kP.uP=0,n.kP.vP=!1,n.wP(),n.kP.withCredentials=n.request.withCredentials,n.kP.open(n.request.method,n.url,!0),n.xP=n.request.headerFields,n.xP&&Object.keys(n.xP).forEach(function(e){n.kP.setRequestHeader(e,n.xP[e])}),n.yP(),n.qP.reset(),n.qP.start(),void n.kP.send(t)):n.publish(r.Events.ERROR,new u.Error(u.ERR_XHR_LOAD))},i.prototype.yP=function(){var e=this;e.kP.responseType=e.request.responseType},i.prototype.wP=function(){var e=this;e.kP.onerror=e.cL.bind(e),e.kP.onreadystatechange=function(){if(e.kP&&e.kP.readyState===d.DONE&&!e.kP.vP){if(!e.zP(e.kP.status))return e.qP.stop(),e.cL();e.kP.vP=!0;var t={data:e.kP.response};if(e.request.withResponseHeaders){var n=e.kP.getAllResponseHeaders();if(n){var i=n.trim().split(/[\r\n]+/),a=[];i.forEach(function(e){var t=e.split(": "),r=t.shift(),n=t.join(": ");a.push({name:r,value:n})}),t.headers=a}}e.publish(r.Events.COMPLETE,t),e.qP.stop()}}},i.prototype.AP=function(e){var t=this,r=new RegExp(e+": (.*)","ig"),n=t.kP.getAllResponseHeaders(),i=r.exec(n);return i&&i.length>1?i[1]:""},i.prototype.zP=function(e){return e>=200&&e<300},i.prototype.BP=function(){var e=this;Date.now()-e.CP;e.qP.stop()},i.prototype.sP=function(){var e=this;e.BP(),e.cL()},i.prototype.DP=function(){var e=this;e.reset(),e.xg(u.ERR_PARTIAL_LOAD)},i.prototype.EP=function(){var e=this,t=e.mP.length,r=e.pP;return r<t?e.mP[r]:e.mP[t-1]+e.nP*(r-t+1)},i.prototype.cL=function(){var e=this;e.tP(),e.pP<e.SF&&(!e.request.retryExclusion||e.request.retryExclusion.indexOf(e.kP.status)===-1)?(e.pP++,e.oP.delay=e.EP(),e.oP.reset(),e.oP.start(),e.request.headerFields&&e.kP.readyState===d.DONE&&0===e.kP.status&&(e.request.headerFields=null)):e.request.stopStreamLoadOnError?e.xg(u.ERR_XHR_LOAD_LIVE_PAUSE):403===e.kP.status?e.xg(u.ERR_XHR_LOAD_FORBIDDEN):e.xg(u.ERR_XHR_LOAD)},i.prototype.xg=function(e){var t=this;t.publish(r.Events.ERROR,new u.Error(e))},i.prototype.tP=function(){var e=this;e.kP&&e.kP.readyState!==d.DONE&&e.kP.readyState!==d.UNSENT&&(e.kP.vP=!0,e.kP.abort()),e.oP.stop(),e.qP.stop()},i.prototype.rP=function(){var e=this,t=e.request,r=t.chunked?t.chunkedRequestTimeout:t.requestTimeout;return isNaN(r)||r<e.MIN_TIMEOUT||r>e.MAX_TIMEOUT?e.MAX_TIMEOUT:r},i.prototype.reset=function(){var e=this;e.tP(),e.kP=null,e.request=null},i.prototype.destroy=function(){var e=this;e.reset(),e.oP.destroy(),e.qP.destroy(),c.prototype.destroy.call(e)},a.prototype.destroy=function(){var e=this;i.prototype.destroy.call(e)},a.prototype.wP=function(){var e=this,t=function(){if(e.kP&&!e.kP.vP&&(e.kP.readyState===d.DONE||e.kP.readyState===d.LOADING)){if(!e.zP(e.kP.status))return e.qP.stop(),0===e.kP.uP?e.cL():void e.DP();var t=e.kP.responseText,n=t.length-e.kP.uP;if(n>0&&(e.qP.stop(),e.lP.atlasMarker=e.AP("X-ATLAS-MARKERS"),e.publish(r.Events.BYTES_LOADED,t.length,e.lP)),n>e.request.minChunkSize||e.kP.readyState===d.DONE){for(var i=new Uint8Array(n),a=0;a<n;a++)i[a]=255&t.charCodeAt(a+e.kP.uP);e.kP.uP=t.length,e.publish(r.Events.PROGRESS,i,t.length)}e.qP.start(),e.kP.readyState===d.DONE&&(e.kP.vP=!0,e.publish(r.Events.COMPLETE),e.qP.stop())}};e.kP.onreadystatechange=t,e.kP.onprogress=t},a.prototype.sP=function(){var e=this;return e.BP(),e.kP.uP>0&&e.kP.readyState===d.LOADING?void e.DP():void e.cL()},a.prototype.yP=function(){var e=this;e.kP.overrideMimeType("text/plain; charset=x-user-defined")},o.prototype.destroy=function(){var e=this;a.prototype.destroy.call(e)},o.prototype.wP=function(){var e=this;e.kP.onreadystatechange=function(){if(e.kP.readyState===d.LOADING){if(!e.zP(e.kP.status))return e.qP.stop(),e.cL();var t=e.kP.response;if(e.FP||(e.FP=e.MI?new MSStreamReader:new e.window.MSStreamReader),e.FP.readyState===f.LOADING)return;e.FP.readAsArrayBuffer(t),e.FP.onprogress=function(){e.qP.stop();var t=e.FP.result;t.byteLength>0&&(e.lP.atlasMarker=e.AP("X-ATLAS-MARKERS"),e.publish(r.Events.BYTES_LOADED,t.byteLength,e.lP));var n=new Uint8Array(t.slice(e.kP.uP,t.byteLength));e.kP.uP=t.byteLength,e.publish(r.Events.PROGRESS,n,t.byteLength),e.qP.start()},e.FP.onload=function(){e.qP.stop(),e.publish(r.Events.COMPLETE)},e.FP.onerror=function(){e.qP.stop()}}}},o.prototype.yP=function(){var e=this;e.kP.responseType="ms-stream"},o.prototype.reset=function(){var e=this;i.prototype.reset.call(e),e.FP&&e.FP.abort()}},{"../../lib":146,"../../lib/event-bus":144,"../../lib/hls-utils":145,"../../lib/timer":150,"./../error":184}],219:[function(e,t,r){"use strict";function n(){var e=this;e.GP=[],e.ERRORS={INVALID_M3U8:1,EMPTY_DATA:2,NO_SEGMENTS:3}}t.exports=n;var i=e("./../model/worker-scope/model"),a=i.MetadataTypes,o=i.StreamingMode,s=e("./../model/worker-scope/stream").StreamTypes,l="#EXTM3U",c="#EXT-X-STREAM-INF:",u="#EXT-X-MEDIA:TYPE=SUBTITLES,",p="#EXT-X-MEDIA:",d="#EXTINF:",f="#EXT-X-MEDIA-SEQUENCE:",v="#EXT-X-DISCONTINUITY-SEQUENCE:",m="#EXT-X-DISCONTINUITY",y="#EXT-X-TARGETDURATION:",h="#EXT-X-PROGRAM-DATE-TIME:",E="#EXT-X-ENDLIST",g="#EXT-X-CUE-OUT:",b="#EXT-X-BYTERANGE:",_="#EXT-X-MAP",A="URI",T="BYTERANGE",S="#EXT-X-KEY",I="METHOD",L="IV";n.prototype.parse=function(e){if(!e)return null;var t=this;return e.type===a.STRUCTURED?t.parseStructuredMetadata(e):t.HP(e)},n.prototype.HP=function(e){var t=this,r={},n=e.rawData;if(""===n||!n)return r.error=t.ERRORS.EMPTY_DATA,r;var i=n.split("\n");return 0!==i[0].indexOf(l)?(r.error=t.ERRORS.INVALID_M3U8,r):n.indexOf(d)>0?t.IP(i,e):n.indexOf(c)>0?t.JP(i,e):(r.error=t.ERRORS.INVALID_M3U8,r)},n.prototype.parseStructuredMetadata=function(e){var t=this,r={};return r.streamInfoList=t.parseStreamInfo(e.streams),e.hasStreamMetadata&&r.streamInfoList.forEach(function(e){e.segmentInfoList=t.parseSegmentInfo(e.hlsInfo,e.initSegment,e.index),e.duration=0,e.segmentInfoList.forEach(function(t){e.duration+=t.duration}),e.hasEndList=!0,e.targetDuration=e.hlsInfo.segment_duration}),e.hasAltStreamMetadata&&(r.renditionGroups={},e.altStreams.forEach(function(e){var n,i=e.manifestContent;i&&0===i.indexOf(u)?(n=t.KP(i,e.host),n.type=s.SUBTITLES,n.containerFormat="vtt"):(n=t.parseStreamInfo([e])[0],n.hlsInfo&&(n.segmentInfoList=t.parseSegmentInfo(n.hlsInfo,n.initSegment))),t.LP(r.renditionGroups,n)})),r},n.prototype.JP=function(e,t){for(var r=this,n=[],i={},a=t.url,o=t.cdn,s=0;s<e.length;s++){var l=null,u=e[s].trim();if(0===u.indexOf(c)){l=r.MP(r.NP(u.substr(c.length)));do s++,u=e[s];while(u.match(/^\s*$/));l.url=r.OP(u,a),l.cdn=o,n.push(l)}else 0===u.indexOf(p)&&(u=u.replace(/"/g,""),l=r.PP(r.NP(u.substr(p.length)),a),r.LP(i,l))}return{streamInfoList:n,renditionGroups:i}},n.prototype.LP=function(e,t){if(t.type&&t.groupId){var r=e[t.type];r||(r=e[t.type]={});var n=r[t.groupId];n&&n.length?n.push(t):r[t.groupId]=[t]}},n.prototype.NP=function(e){for(var t={},r=e.indexOf("=");r!==-1;){var n=e.substr(0,r);e=e.substr(r+1);var i=0;'"'===e.charAt(0)?(i=e.substr(1).indexOf('"'),t[n]=e.substr(1,i),e=e.substr(i+3)):(i=e.indexOf(","),i=i===-1?e.length:i,t[n]=e.substr(0,i),e=e.substr(i+1)),r=e.indexOf("=")}return t},n.prototype.IP=function(e,t){var r=this,n={},i={},a=[],l=[],c={streamInfoList:[],renditionGroups:{}};if(!e||!e.length)return c;var u=t.url,p=t.index;i.discontinuity=!1,i.sequenceNum=0,i.startTime=0,i.programDateTime=0,i.brStartOffset=-1,i.brEndOffset=-1,i.levelIndex=p,n.discontinuitySeqNum=0,n.index=p,n.targetDuration=0,n.hasEndList=!1,n.url=u,n.duration=0,n.containerFormat="",n.streamingMode=o.HLS;for(var A=0;A<e.length;A++){var T=e[A].trim();if(!T.match(/^\s*$/)){if(0===T.indexOf(f)&&(n.seqNum=parseInt(T.substr(f.length)),i.sequenceNum=n.seqNum),0===T.indexOf(v))n.discontinuitySeqNum=parseInt(T.substr(v.length));else if(0===T.indexOf(m))i.discontinuity=!0;else if(0===T.indexOf(y))n.targetDuration=parseFloat(T.substr(y.length));else if(0===T.indexOf(_)){var I=r.QP(T,u);i.initSegment=I}else if(0===T.indexOf(S))i.encryptionData=r.RP(T,u);else if(0===T.indexOf(h))i.programDateTime=r.SP(T);else if(0===T.indexOf(d)){var L=T.indexOf(",");i.duration=L===-1?parseFloat(T.substr(d.length)):parseFloat(T.substr(d.length,L-d.length)),n.duration+=i.duration;do A++,T=e[A].trim();while(T.match(/^\s*$/));if(0===T.indexOf(b)){var R=T.substr(b.length,T.length-b.length),C=R.indexOf("@");i.brStartOffset=parseInt(R.substr(C+1,R.length-C-1)),i.brEndOffset=i.brStartOffset+parseInt(R.substr(0,C))-1;do A++,T=e[A].trim();while(T.match(/^\s*$/))}i.url=r.OP(T,u),i.containerFormat=r.TP(i.url),n.containerFormat=i.containerFormat,a.push(r.VP(i)),i.startTime+=i.duration,i.sequenceNum++,i.programDateTime=0,i.brStartOffset=-1,i.brEndOffset=-1,i.encryptionData&&(i.encryptionData.initVector=null)}else 0===T.indexOf(E)&&(n.hasEndList=!0);if(T.indexOf(g)>=0){var D=r.WP(i.sequenceNum,T);l.push(D)}}}if(a.length&&(n.segmentInfoList=a,n.initSegment=a[0].initSegment),l.length&&(n.cuepointList=l),t.streamType&&t.streamType!==s.MAIN){var O=c.renditionGroups;n.type=t.streamType,n.groupId=t.groupId,n.name=t.name,r.LP(O,n)}else c.streamInfoList.push(n);return c},n.prototype.MP=function(e){if(!e)return null;var t={streamingMode:o.HLS};return Object.keys(e).forEach(function(r){var n=e[r];switch(r){case"BANDWIDTH":t.bitrate=1*n;break;case"AVERAGE-BANDWIDTH":t.avgBitrate=1*n;break;case"RESOLUTION":var i=n.split("x");t.width=parseInt(i[0]),t.height=parseInt(i[1]);break;case"CODECS":t.codecs=n.split(","),t.hasAudio=n.indexOf("mp4a")!==-1;break;case"AUDIO":t.audioGroupId=n.replace(/"/g,"");break;case"VIDEO":t.videoGroupId=n.replace(/"/g,"");break;case"SUBTITLES":t.subtitlesGroupId=n.replace(/"/g,"");break;case"CLOSED-CAPTIONS":t.ccGroupId=n.replace(/"/g,"")}}),t},n.prototype.TP=function(e,t){var r=null;return e&&e.length?e.indexOf(".ts")>-1?r="ts":e.indexOf(".mp4")>-1||e.indexOf(".m4s")>-1?r="mp4":e.indexOf(".aac")>-1?r="aac":e.indexOf(".vtt")>-1&&(r="vtt"):t&&(t.indexOf("mp2t")>-1?r="ts":t.indexOf("mp4")>-1?r="mp4":t.indexOf("aac")>-1?r="aac":t.indexOf("vtt")>-1&&(r="vtt")),r},n.prototype.OP=function(e,t){var r=null,n=null;return"http://"===e.substr(0,7)||"https://"===e.substr(0,8)?e:(t.indexOf("?")>-1&&(t=t.substr(0,t.indexOf("?"))),"/"===e.substr(0,1)?(r=t.substr(0,t.indexOf("//")+2),n=t.substr(t.indexOf("//")+2),r+n.substr(0,n.indexOf("/"))+e):t.substr(0,t.lastIndexOf("/")+1)+e)},n.prototype.KP=function(e,t){var r=this;e=e.replace(/"/g,"");var n=e.substr(u.length).split(",");return r.XP(n,e,t)},n.prototype.XP=function(e,t,r){var n=this,i={};return e&&e.length&&(e.forEach(function(e){e.indexOf("GROUP-ID")>-1?i.groupId=e.split("=")[1]:e.indexOf("LANGUAGE")>-1?i.language=e.split("=")[1]:e.indexOf("NAME")>-1?i.name=e.split("=")[1]:e.indexOf("AUTOSELECT")>-1?i.autoSelect="YES"===e.split("=")[1]:e.indexOf("DEFAULT")>-1?i.default="YES"===e.split("=")[1]:e.indexOf("URI")>-1?i.url=n.OP(e.substr(4),r):e.indexOf("FORCED")>-1&&(i.forced="YES"===e.split("=")[1])}),i.streamingMode=o.HLS),i},n.prototype.PP=function(e,t){var r=this;if(!e)return null;var n={streamingMode:o.HLS};return Object.keys(e).forEach(function(i){var a=e[i];switch(i){case"TYPE":n.type=a,n.type===s.SUBTITLES&&(n.containerFormat="vtt");break;case"GROUP-ID":n.groupId=a;break;case"LANGUAGE":n.language=a;break;case"NAME":n.name=a;break;case"AUTOSELECT":n.autoSelect="YES"===a;break;case"DEFAULT":n.default="YES"===a;break;case"FORCED":n.forced="YES"===a;break;case"URI":n.url=r.OP(a,t)}}),n},n.prototype.YP=function(e){var t={};return t.discontinuity=e.discontinuity,t.sequenceNum=e.sequenceNum,t.startTime=e.startTime,t.programDateTime=e.programDateTime,t.url=e.url,t.duration=e.duration,t},n.prototype.QP=function(e,t){var r=this;if(!e)return null;for(var n={},i=e.substr(_.length+1).split(","),a=0;a<i.length;a++){var o=i[a].split("=");if(0===o[0].indexOf(A))n.url=r.OP(i[a].substr(5,i[a].length-6),t);else if(0===o[0].indexOf(T)){var s=o[1].indexOf("@");n.range={start:parseInt(o[1].substr(s+1,o[1].length-s-2)),end:parseInt(o[1].substr(1,s-1)-1)}}}return n},n.prototype.RP=function(e,t){var r=this;if(!e)return null;for(var n={},i=e.substr(S.length+1).split(","),a=0;a<i.length;a++){var o=i[a].split("=");0===o[0].indexOf(A)?n.keyUri=r.OP(i[a].substr(5,i[a].length-6),t):0===o[0].indexOf(I)?n.method=o[1]:0===o[0].indexOf(L)&&(n.initVector=o[1])}return n},n.prototype.SP=function(e){if(!e)return 0;var t,r,n=e.substr(h.length),i=n.split("T"),a=i[0].split("-"),o=parseInt(a[0]),s=parseInt(a[1])-1,l=parseInt(a[2]),c=i[1],u=0;if(c.indexOf("Z")>=0)t=c.substr(0,c.indexOf("Z")).split(":");else if(c.indexOf("+")>=0){var p=c.split("+");t=p[0].split(":"),r=p[1].split(":"),u=-1}else if(c.indexOf("-")>=0){var d=c.split("-");t=d[0].split(":"),r=d[1].split(":"),u=1}var f=0,v=0,m=0;if(t&&(f=parseInt(t[0]),v=parseInt(t[1]),m=parseFloat(t[2])),r){var y=parseInt(r[0]),E=parseInt(r[1]);f=(24+f+u*y)%24,v+=u*E,v>=60?(f++,v-=60):v<0&&(f--,v+=60)}return new Date(Date.UTC(o,s,l,f,v,m)).getTime()},n.prototype.VP=function(e){var t={};t.discontinuity=e.discontinuity,t.sequenceNum=e.sequenceNum,t.startTime=e.startTime,t.programDateTime=e.programDateTime,t.brStartOffset=e.brStartOffset,t.brEndOffset=e.brEndOffset,t.containerFormat=e.containerFormat,t.levelIndex=e.levelIndex,t.url=e.url,t.duration=e.duration;var r=e.encryptionData;r&&(t.encryptionData={keyUri:r.keyUri,method:r.method,initVector:r.initVector});var n=e.initSegment;return n&&(t.initSegment={url:n.url},n.range&&(t.initSegment.range={start:n.range.start,end:n.range.end})),t},n.prototype.parseStreamInfo=function(e){var t=this;if(!e)return null;var r=[];return e.forEach(function(e,n){var i=e.host;e.path&&""!==e.path?i+=e.path:e.url&&(i=e.url);var a={streamingMode:o.HLS,bitrate:1e3*e.bitrate,avgBitrate:e.avgBitrate?1e3*e.avgBitrate:0,channels:e.channels,height:e.height,width:e.width,url:i,index:n,hlsInfo:e.hls_info,cdn:e.cdn,rcMode:e.rcMode||"cbr",format:e.format,audioCodec:e.acodec,videoCodec:e.vcodec,autoSelect:e.auto_select,default:e.default,type:(e.type||s.MAIN).toUpperCase(),name:e.name,groupId:e.group_id,language:e.language,forced:e.forced};if(e.alt_renditions&&(a.audioGroupId=e.alt_renditions.audio_group_id,a.videoGroupId=e.alt_renditions.video_group_id,a.subtitlesGroupId=e.alt_renditions.subtitle_group_id,a.ccGroupId=e.alt_renditions.cc_group_id),a.hlsInfo&&a.hlsInfo.mp4_url){var l=a.hlsInfo;a.initSegment={url:l.mp4_url},l.init_segment_offset>=0&&l.init_segment_length>=0&&(a.initSegment.range={start:l.init_segment_offset,end:l.init_segment_offset+l.init_segment_length-1}),a.sidxOffset=l.sidx_offset,a.sidxLength=l.sidx_length,a.firstSegOffset=l.first_segment_offset,a.firstSegLength=l.first_segment_length}if(e.manifestContent&&e.manifestContent.indexOf("SUBTITLES")>-1){var c=e.manifestContent.split('SUBTITLES="')[1];a.subtitlesGroupId=c.substr(0,c.indexOf('"'))}if(a.hlsInfo){var u=a.hlsInfo.ts_url||a.hlsInfo.mp4_url;a.containerFormat=t.TP(u,a.hlsInfo.mime_type)}r.push(a)}),r},n.prototype.parseSegmentInfo=function(e,t,r){var n=this;if(!e)return null;var i=[],a={};a.brStartOffset=-1,a.brEndOffset=-1,a.programDateTime=0,a.discontinuity=!1,a.sequenceNum=e.start_index,a.startTime=0,a.initSegment=t;var o="",s="_xx.ts";e.ts_url&&(o=e.ts_url.indexOf("?")>=0?"&":"?");for(var l=0;l<e.segments_count;l++){if(e.ts_url){var c=e.ts_url.indexOf(s);if(c>=0){var u="_"+a.sequenceNum.toString()+".ts";a.url=e.ts_url.replace(s,u),a.url=a.url+o+"yh=1"}else a.url=e.ts_url+o+"num="+a.sequenceNum.toString()}else a.url=e.mp4_url,0===l&&(a.brStartOffset=e.first_segment_offset,a.brEndOffset=a.brStartOffset+e.first_segment_length-1);a.levelIndex=r,a.duration=e.segment_duration,l===e.segments_count-1&&(a.duration=e.last_segment_duration),a.containerFormat=n.TP(a.url,e.mime_type),i.push(n.VP(a)),a.sequenceNum++,a.startTime+=a.duration,a.brStartOffset=-1,a.brEndOffset=-1}return i},n.prototype.ZP=function(e){var t=e.split(":"),r=0;return t.length>1&&(r=1e3*parseFloat(t[1])),r},n.prototype.WP=function(e,t){var r=this,n=e;if(!(n<0)){var i=r.ZP(t),a={};return a.startSeqNum=n,a.startTime=NaN,a.cuepointDuration=i,a}}},{"./../model/worker-scope/model":201,"./../model/worker-scope/stream":204}],220:[function(e,t,r){"use strict";function n(){var e=this;e.GP=[],e.$P=null,e._P="blah",e.aQ=null,e.bQ=null,e.ERRORS={INVALID_MPD:1,EMPTY_DATA:2,NO_SEGMENTS:3}}t.exports=n;var i=e("./../model/worker-scope/model").StreamingMode,a=e("./../model/worker-scope/stream").StreamTypes,o=e("../../lib/hls-utils"),s=1,l="MPD",c="dynamic",u="Representation",p="AdaptationSet",d="Period",f="BaseURL",v="Role",m="SegmentTemplate",y="SegmentTimeline",h="S",E="SegmentList",g="SegmentURL",b="Initialization",_="ContentProtection",A="$RepresentationID$",T="AssetIdentifier",S="AudioChannelConfiguration",I="Location",L="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",R="urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95";n.prototype.destroy=function(){},n.prototype.cQ=function(e){if(!e)return 0;var t=Date.parse(e);return t},n.prototype.dQ=function(e){var t=0;if(e&&"P"===e.charAt(0)){var r=/[\d|.|\+]+[A-Z]/g,n=e.match(r);n.forEach(function(e){var r=e.charAt(e.length-1),n=parseFloat(e,10);"S"===r?n*=1e3:"M"===r?n*=6e4:"H"===r&&(n*=36e5),t+=n})}else e&&!isNaN(e)&&(t=parseFloat(e,10));return t},n.prototype.eQ=function(e,t){if(void 0===e||void 0===t)return"";if("08d"===e){for(var r=t.toString();r.length<8;)r="0"+r;return r}return t},n.prototype.fQ=function(e,t,r,n,i,a){var o=this,s={brEndOffset:-1,brStartOffset:-1,containerFormat:"mp4",discontinuity:0,duration:e/1e3,levelIndex:0,periodId:t,sequenceNum:r,startTime:n/1e3,url:i,initSegment:{url:a}};return null===o.bQ?(o.bQ=s.startTime,s.startTime=0):(s.startTime-=o.bQ,s.startTime=Math.round(1e3*s.startTime)/1e3),s},n.prototype.gQ=function(e,t,r,n,o,s,l,c){var u=this,p="audio",d="subs",f=u.hQ(t),v=u.iQ(r),m=u.jQ(r),y=o>m?o/v:m/v,h={groupId:r.id,bitrate:parseInt(r.bandwidth),codecs:[r.codecs],containerFormat:"mp4",drmInfo:[],duration:n/1e3,hasAudio:f===a.AUDIO,hasEndList:!o&&n>0,height:f===a.VIDEO?r.height:0,segmentInfoList:[],type:f,width:f===a.VIDEO?r.width:0,streamingMode:i.DASH,initSegment:{url:c},url:l,targetDuration:y};if(f===a.AUDIO?(h.audioCodec=r.codecs,h.language=t.lang,h.autoSelect=!1,h.default=!1,h.groupId=r.id,h.channels=r.audioChannnelConfiguration?r.audioChannnelConfiguration.value:0):f===a.VIDEO?(h.audioGroupId=p,h.subtitlesGroupId=d,h.videoCodec=r.codecs):f===a.SUBTITLES&&(h.language=t.lang,h.groupId=r.id,h.codec=r.codecs,h.autoSelect=!1,h.subtitlesCodec=r.codecs),t.drm.length>0){for(var E={},g=0;g<t.drm.length;g++){var b=t.drm[g];E.periodId=e.id;var _={prefix:null!==u.aQ?u.aQ:"",pssh:b.pssh};b.schemeIdUri===L?(_.type="wv",E.widevine=_):b.schemeIdUri===R&&(_.type="pr",_.pro=b.pro,E.playready=_)}h.drmInfo.push(E)}return h},n.prototype.iQ=function(e){return e.segmentList?parseInt(e.segmentList.timescale,10):e.segmentTemplate?parseInt(e.segmentTemplate.timescale,10):1e3},n.prototype.jQ=function(e){var t=this.iQ(e);if(e.segmentList)return 1e3*parseInt(e.segmentList.duration,10)/t;if(e.segmentTemplate){var r=e.segmentTemplate;if(r.duration)return 1e3*parseInt(r.duration,10)/t;if(r.segmentTimeline){var n=0;return r.segmentTimeline.sElements.forEach(function(e){e.r&&e.r>0&&(n=1e3*parseInt(e.d,10)/t)}),n}}return 0},n.prototype.kQ=function(e,t,r,n,i,a,s,l){var u=this,p=new RegExp(/\$Number%([\d|.|\+]*[a-zA-Z])\$/),d=e.startMS,f=e.durationMS,v=u.jQ(t),m=[],y="";if(t.segmentList)for(var h=0;h<t.segmentList.segments.length;h++){var E=t.segmentList.segments[h],g=Math.min(v,f);f-=g,y=r&&!o.isAbsoluteUrl(E)?r+E:E,m.push(u.fQ(g,e.id,h,d,y,n)),d+=g}else if(t.segmentTemplate){var b=t.segmentTemplate,_=parseInt(b.startNumber,10),T=0,S=1,I=Math.ceil(e.durationMS/v),L=0,R=0,C=0;if(l===c?(L=Math.min(Math.floor((a-e.startMS)/v),I),R=Math.max(Math.floor((a-e.startMS-s)/v),S)):(L=I,R=S),L<=0||R>L)T=0;else{var D=R-1;_+=D,T=L===R?1:L-R+1,C=e.startMS+D*v,f-=D*v,T<0&&(T=0)}for(var O=b.media.replace(A,t.id),N=p.test(O)?O.match(p)[1]:"",P=_;P<T+_;P++){var k=O.replace(p,u.eQ(N,P)),M=Math.min(v,f);f-=M,y=r&&!o.isAbsoluteUrl(k)?r+k:k;var w=u.fQ(M,e.id,P-_,C,y,n);m.push(w),C+=M}}return m},n.prototype.lQ=function(e,t){var r=null;return e.segmentList?r=e.segmentList.initialization.sourceURL:e.segmentTemplate&&(r=e.segmentTemplate.initialization.replace(A,e.id)),t&&!o.isAbsoluteUrl(r)?t+r:r},n.prototype.mQ=function(e){return(new DOMParser).parseFromString(e,"application/xml")},n.prototype.parse=function(e){var t=this,r={};if(!e)return null;var n=t.mQ(e.rawData);if(null===n||null===n.documentElement||void 0===n.documentElement)return r.error=t.ERRORS.INVALID_MPD,r;if(n.documentElement.nodeName!==l)return r.error=t.ERRORS.INVALID_MPD,r;e.headers&&e.headers.length>0&&e.headers.forEach(function(e){"x-uplynk-prefix"===e.name&&(t.aQ=e.value)}),t.$P=n,t.nQ(n.documentElement,r);var o=t.cQ(r.publishTime),c=t.oQ(o);r.streamingMode=i.DASH,r.drm=!1,r.reloadUrl=e.url;for(var u=[],p=n.documentElement.childNodes,f=0;f<p.length;f++){var v=p[f];if(v.nodeType===s)if(v.nodeName===d){var m=t.pQ(v);null!==m&&u.push(m)}else v.nodeName===I&&(r.reloadUrl=v.childNodes[0].nodeValue)}for(var y=[],h=[],E=[],g=t.dQ(r.mediaPresentationDuration),b=t.dQ(r.minimumUpdatePeriod),_=t.dQ(r.suggestedPresentationDelay),A=t.cQ(r.availabilityStartTime),T=0,S=-1,L=0;L<u.length;L++){var R=u[L];R.startMS=t.qQ(R,A,T),S===-1&&(S=R.startMS);var C=L+1<u.length?u[L+1]:null;R.endMS=t.rQ(R,R.startMS,A,C,S,g,b,c),R.durationMS=R.endMS-R.startMS;for(var D=0;D<R.adaptationSets.length;D++)for(var O=R.adaptationSets[D],N=t.hQ(O),P=0;P<O.representations.length;P++){var k=O.representations[P],M=k.baseURL?k.baseURL:O.baseURL,w=t.lQ(k,M),x=t.gQ(R,O,k,g,b,r.type,r.reloadUrl,w),F=t.kQ(R,k,M,w,S,c,_,r.type);F.length>0&&(Array.prototype.push.apply(x.segmentInfoList,F),N===a.VIDEO?t.sQ(y,x):N===a.AUDIO?t.sQ(h,x):N===a.SUBTITLES&&t.sQ(E,x)),O.drm.length>0&&(r.drm=!0)}T+=R.durationMS}this.tQ(h),this.tQ(E);var U={AUDIO:{audio:h},SUBTITLES:{subs:E}};return r.streamInfoList=y,r.renditionGroups=U,r},n.prototype.tQ=function(e){e&&e.length>0&&(e[0].autoSelect=!0,e[0].default=!0)},n.prototype.sQ=function(e,t){for(var r=this,n=0;n<e.length;n++)if(e[n].groupId===t.groupId)return void r.uQ(e[n],t);t.index=e.length,e.push(t)},n.prototype.hQ=function(e){return"video/mp4"===e.mimeType?a.VIDEO:"audio/mp4"===e.mimeType?a.AUDIO:"application/mp4"===e.mimeType&&"text"===e.contentType?a.SUBTITLES:a.VIDEO},n.prototype.uQ=function(e,t){for(var r=e.segmentInfoList[e.segmentInfoList.length-1],n=r.sequenceNum+1,i=0;i<t.segmentInfoList.length;i++){var a=t.segmentInfoList[i];a.sequenceNum=n+i,e.segmentInfoList.push(a)}for(var o=0;o<t.drmInfo.length;o++)e.drmInfo.push(t.drmInfo[o]);t.bitrate>e.bitrate&&(e.bitrate=t.bitrate)},n.prototype.nQ=function(e,t){for(var r=e.attributes,n=0;n<r.length;n++)t[r[n].nodeName]=r[n].nodeValue;return r.length},n.prototype.pQ=function(e){var t=this,r={adaptationSets:[]};t.nQ(e,r);for(var n=0;n<e.childNodes.length;n++){var i=e.childNodes[n];if(i.nodeType===s)if(i.nodeName===T){var a={};t.nQ(i,a),r.assetIdentifier=a}else if(i.nodeName===p){var o=t.vQ(i);null!==o&&r.adaptationSets.push(o)}}return r},n.prototype.vQ=function(e){var t=this,r={representations:[],drm:[]};t.nQ(e,r);for(var n=0;n<e.childNodes.length;n++){var i=e.childNodes[n];if(i.nodeType===s)if(i.nodeName===v){var a={};t.nQ(i,a),r.role=a}else if(i.nodeName===f)r.baseURL=i.childNodes[0].nodeValue;else if(i.nodeName===_){var o=t.wQ(i);null!==o&&r.drm.push(o)}else if(i.nodeName===u){var l=t.xQ(i);null!==l&&r.representations.push(l)}else"SupplementalProperty"===i.nodeName}return r},n.prototype.wQ=function(e){var t=this,r={};t.nQ(e,r);for(var n=0;n<e.childNodes.length;n++){var i=e.childNodes[n];if(i.nodeType===s)if(i.nodeName.indexOf("pssh")!==-1)r.pssh=i.childNodes[0].nodeValue;else if("mspr:pro"===i.nodeName)r.pro=i.childNodes[0].nodeValue;else if("ms:laurl"===i.nodeName){var a={};t.nQ(i,a),r.laurl=a}}return r},n.prototype.xQ=function(e){var t=this,r={};t.nQ(e,r);for(var n=0;n<e.childNodes.length;n++){var i=e.childNodes[n];if(i.nodeType===s)if(i.nodeName===S){var a={};t.nQ(i,a),r.audioChannnelConfiguration=a}else if(i.nodeName===f)r.baseURL=i.childNodes[0].nodeValue;else if(i.nodeName===m){var o=t.yQ(i);r.segmentTemplate=o}else if(i.nodeName===E){var l=t.zQ(i);null!==l&&(r.segmentList=l)}}return r},n.prototype.yQ=function(e){var t=this,r={};t.nQ(e,r);for(var n=0;n<e.childNodes.length;n++){var i=e.childNodes[n];if(i.nodeType===s&&i.nodeName===y){var a=t.AQ(i);r.segmentTimeline=a}}return r},n.prototype.AQ=function(e){var t=this,r={sElements:[]};t.nQ(e,r);for(var n=0;n<e.childNodes.length;n++){var i=e.childNodes[n];if(i.nodeType===s&&i.nodeName===h){var a={};t.nQ(i,a),r.sElements.push(a)}}return r},n.prototype.zQ=function(e){var t=this,r={segments:[]};t.nQ(e,r);for(var n=0;n<e.childNodes.length;n++){var i=e.childNodes[n];if(i.nodeType===s)if(i.nodeName===b){var a={};t.nQ(i,a),r.initialization=a}else if(i.nodeName===g){var o=i.getAttribute("media");null!==o&&r.segments.push(o)}}return r},n.prototype.qQ=function(e,t,r){var n=this;return e.start?t+n.dQ(e.start):r},n.prototype.rQ=function(e,t,r,n,i,a,o,s){var l=this;return e.duration?t+l.dQ(e.duration):n&&n.start?r+l.dQ(n.start):a?r+i+a:o+s},n.prototype.oQ=function(e){var t=this,r=Date.now();t.BQ||(t.BQ=r-e);var n=r-t.BQ;return n}},{"../../lib/hls-utils":145,"./../model/worker-scope/model":201,"./../model/worker-scope/stream":204}],221:[function(e,t,r){"use strict";function n(){var e=this;e.l=e.MG.appModel,e._node=e.MG.node,e.CQ={currentStreamBitrate:0,frameDrop:0,frameRateSum:0,frameRateSampleCount:0,currentKbps:0,deliveryProtocol:e.DQ(),bufferingCount:0,totalBufferingTime:0,streamingMode:e.l.streamingMode},e.FRAMERATE_SAMPLE_SIZE=4,e.EQ={prevTotalFrames:0,prevTotalDroppedFrames:0,prevFrameRateMeasuredTime:0,frameRateSampleCollector:[],currentFrameRate:0},e.ID=new a(1e3),e.ID.addEventListener(e.FQ,e)}t.exports=n;var i=e("./../event").HLSEvent,a=e("../../lib/timer");n.prototype.destroy=function(){var e=this;e.CQ=null,e.ID.destroy()},n.prototype.onPlay=function(){var e=this;e.ID.start()},n.prototype.onPause=function(){var e=this;e.ID.stop()},n.prototype.updateBufferingInfo=function(e){var t=this;e&&(e.value||e.bufferInit||(t.CQ.bufferingCount++,t.CQ.totalBufferingTime+=e.waitTime))},n.prototype.FQ=function(){var e=this,t=e.l.streams,r=e.CQ,n=e.l.getCurrentPlayingStream(),a=e.getFpsStats();n&&(r.currentStreamIndex=e.l.currentPlayingStreamIndex,r.currentStreamBitrate=n.bitrate/1e3,r.mediaWidth=n.width,r.mediaHeight=n.height),t.length&&(r.qualityLevels=t.length,r.minBitRate=t[0].bitrate,r.maxBitRate=t[r.qualityLevels-1].bitrate),r.bufferLength=e.l.getBufferLength().toFixed(2),r.bufferLength<=5,r.frameRate=a.frameRate.toFixed(2),r.droppedFrames=a.droppedFrames,r.currentKbps=(1e3*e.l.currentKbps).toFixed(0),r.streamingMode=e.l.streamingMode,r.drm=e.l.drmRequired,r.drmsys=e.l.licenseType,e.l.infoUpdateSent=!0,e.MG.sendEvent(i.INFO_UPDATE,{mediaInfo:e.CQ})},n.prototype.getWindow=function(){return window},n.prototype.DQ=function(){var e=this,t=e.getWindow();return t&&t.location&&t.location.protocol?t.location.protocol.slice(0,-1):"http"},n.prototype.getFpsStats=function(){var e,t,r=this,n=r._node,i=0,a=r.EQ,o=n.currentTime-a.prevFrameRateMeasuredTime,s=r.GQ(),l=0;return(s.isWebKitFpsAvailable||s.isNonWebKitFpsAvailable)&&(e=s.isWebKitFpsAvailable?n:n.getVideoPlaybackQuality(),t=s.isWebKitFpsAvailable?e.webkitDecodedFrameCount:e.totalVideoFrames,l=s.isWebKitFpsAvailable?e.webkitDroppedFrameCount:e.droppedVideoFrames,i=a.prevFrameRateMeasuredTime>0&&0!==o?(t-a.prevTotalFrames-(l-a.prevTotalDroppedFrames))/o:a.currentFrameRate,i&&a.frameRateSampleCollector.push(i),r.HQ(),a.prevTotalFrames=t,a.prevTotalDroppedFrames=l,a.prevFrameRateMeasuredTime=n.currentTime),{frameRate:a.currentFrameRate,droppedFrames:l}},n.prototype.GQ=function(){var e=this,t=e._node;return{isWebKitFpsAvailable:"undefined"!=typeof t.webkitDecodedFrameCount,isNonWebKitFpsAvailable:"function"==typeof t.getVideoPlaybackQuality}},n.prototype.HQ=function(){var e=this,t=e.EQ,r=t.frameRateSampleCollector;if(r.length>=e.FRAMERATE_SAMPLE_SIZE){var n=r.reduce(function(e,t){return e+t});e.EQ.currentFrameRate=n/r.length,r.splice(0,r.length)}}},{"../../lib/timer":150,"./../event":185}],222:[function(e,t,r){"use strict";function n(){var e=this;e.ERRORS={INVALID_M3U8:1,EMPTY_DATA:2,NO_SEGMENTS:3},e.mpdParser=new o}t.exports=n;var i=e("./../model/worker-scope/model").StreamingMode,a=e("./../model/worker-scope/model").MetadataTypes,o=e("./mpd-parser"),s=e("./m3u8-parser");n.prototype.destroy=function(){var e=this;e.mpdParser.destroy()},n.prototype.parse=function(e){if(!e)return null;var t=this;return e.type===a.STRUCTURED?(new s).parseStructuredMetadata(e):t.HP(e)},n.prototype.HP=function(e){var t=this,r={},n=e.rawData;return""!==n&&n?n.indexOf("<MPD")!==-1?(e.streamingMode=i.DASH,t.mpdParser.parse(e)):n.indexOf("#EXTM3U")!==-1?(e.streamingMode=i.HLS,(new s).parse(e)):(r.error=t.ERRORS.INVALID_M3U8,r):(r.error=t.ERRORS.EMPTY_DATA,r)}},{"./../model/worker-scope/model":201,"./m3u8-parser":219,"./mpd-parser":220}],223:[function(e,t,r){"use strict";function n(){var e=this;e.l=e.__controller.model,e.Nj=!1,e.tI=!1,e.IQ=[],e.JQ=[],e.KQ=null,e.LQ=null,e.FF={},e.MQ=NaN,e.NQ(),e.Rj=0,e.OQ=0,e.PQ=0,e.QQ=!0}function i(){var e=this;e.seqNum=-1,e.beginTime=NaN,e.endTime=NaN,e.bitrateIndex=-1,e.switchReason="none",e.bufferCount=0,e.bufferTime=0,e.timeToFirstByte=0,e.timeToDownload=0,e.timeToRequest=0,e.observedBitrate=0,e.actualBitrate=0,e.frameDrop=0,e.frameRateSum=0,e.frameRateSampleCount=0,e.frameRate=30}t.exports=n;var a=e("./../event").HLSEvent;n.prototype.destroy=function(){var e=this;e.IQ=[],e.JQ=[],e.LQ=null,e.KQ=null,e.RQ()},n.prototype.NQ=function(){var e=this;e.FF[a.WAITING]=e.__controller.addEventListener(a.WAITING,e.ne,e)},n.prototype.RQ=function(){var e=this;e.__controller.removeEventListeners(e.FF)},n.prototype.onComplete=function(){var e=this;e.segmentRenderNext()},n.prototype.onTimeUpdate=function(e){var t=this,r=t.l.getCurrentPlayingStream();if(t.Rj=e,t.updateRenderState(t.LQ,t.Rj),t.l.live&&r&&r.cuepoints.length>0&&t.cuepointEventDispatcher(t.Rj,r.cuepoints),e>0&&t.LQ){var n=t.SQ();n&&t.__controller.sendEvent(a.TIMED_METADATA_READY,n.payload)}},n.prototype.SQ=function(){var e=this,t=e.LQ.seqNum,r=e.l.timedMetadataStore[t],n=e.Rj;if(!r||!r.length)return null;e.l.live&&Object.keys(e.l.timedMetadataStore).forEach(function(r){if(!(r>t)){var i=e.l.timedMetadataStore[r].every(function(t){return n-t.timestamp>=e.l.config.pastBufferLengthLimit.live});i&&delete e.l.timedMetadataStore[r]}});var i=.6;if(n<r[0].timestamp||n>r[r.length-1].timestamp+i)return null;for(var a=null,o=r.length-1;o>=0;o--){var s=r[o],l=(1e4*n-1e4*s.timestamp)/1e4;if(l>=0&&l<=i){if(s.recent)continue;a=s;break}}return a&&(a.recent=!0,setTimeout(function(){delete a.recent},1e3*i)),a},n.prototype.ne=function(e){var t=this;e&&(e.bufferInit||(e.value?t.TQ():t.UQ(e.waitTime)))},n.prototype.segmentLoadBegin=function(e,t){if(t){var r=this,n=new i;n.seqNum=e,n.beginTime=t.beginTime,n.timeToFirstByte=t.timeToFirstByte,n.bitrateIndex=Math.max(0,t.bitrateIndex),n.switchReason=t.switchReason,n.frameRate=t.frameRate,n.observedBitrate=1e3*t.observedBitrate,n.endTime=t.endTime,n.perfInfo={},n.actualBitrate=t.endTime!==t.beginTime?.008*t.bytesTotal/(t.endTime-t.beginTime):0,r.KQ&&r.IQ.push(r.KQ),r.KQ=n,(r.LQ&&e===r.LQ.seqNum||!r.LQ)&&r.segmentRenderNext(n)}},n.prototype.segmentLoadEnd=function(e,t){var r=this,n=r.KQ;n&&n.seqNum===e&&(t&&(n.timeToDownload=t.timeToDownload,n.perfInfo=t.perfInfo,n.segmentInWorker=t.segmentInWorker,n.actualBitrate=n.endTime!==n.beginTime?.008*t.bytesTotal/(n.endTime-n.beginTime):0),r.IQ.push(n),r.KQ=null)},n.prototype.segmentRenderNext=function(e){var t=this;t.LQ&&(t.JQ.push(t.LQ),t.LQ=null,t.__controller.sendEvent(a.SEGMENT_RENDERED)),e&&(t.LQ=e,t.l.setCurrentPlayingStream(e.bitrateIndex))},n.prototype.updateRenderState=function(e,t){var r=this;if(!(isNaN(t)||t<=0)&&(e||(e=r.VQ(t),e&&r.segmentRenderNext(e)),
e&&(r.WQ&&(e.frameDrop=r.WQ.frameDrop,e.frameRateSum+=Number(r.WQ.frameRate.toFixed(2)),e.frameRateSampleCount++),!(t>=e.beginTime&&t<e.endTime)))){var n=r.VQ(t);if(n&&(r.segmentRenderNext(n),n.bitrateIndex!==e.bitrateIndex)){var i=r.l.streams,o={bitrate:Math.round(i[n.bitrateIndex].bitrate/1e3),reason:n.switchReason,oldFrameRate:e.frameRate,newFrameRate:n.frameRate};r.__controller.sendEvent(a.STREAM_SWITCHED,o)}}},n.prototype.updateFrameStats=function(e){var t=this;e&&(t.WQ=e)},n.prototype.VQ=function(e){var t=this;if(t.KQ&&e>=t.KQ.beginTime&&e<t.KQ.endTime)return t.KQ;if(t.IQ.length)for(var r=t.IQ.length-1;r>=0;r--)if(e>=t.IQ[r].beginTime&&e<t.IQ[r].endTime)return t.IQ[r];return null},n.prototype.TQ=function(){var e=this;e.tI||(e.tI=!0,e.LQ!==e.KQ)},n.prototype.UQ=function(e){var t=this;if(t.tI){t.XQ=NaN,t.tI=!1;var r=t.LQ,n=r&&!isNaN(e)&&e>0;r&&(r.bufferTime+=n?e:0,r.bufferCount+=n?1:0)}},n.prototype.getMetrics=function(){var e=this,t=e.LQ,r=[];if(e.JQ.length){for(var n=0;n<e.JQ.length;n++)r.push(e.tJ(e.JQ[n]));e.JQ=[]}return t&&(r.push(e.tJ(t)),t.bufferCount=0,t.bufferTime=0,t.timeToFirstByte=NaN,t.timeToDownload&&(t.timeToDownload=NaN)),r},n.prototype.tJ=function(e){var t=this;if(!e)return null;var r=t.l.streams;e.bitrateIndex=r.length>0?Math.min(e.bitrateIndex,r.length-1):0;var n=r[e.bitrateIndex].bitrate/1e3,i=r[e.bitrateIndex].avgBitrate/1e3;e.bufferTime>0&&!e.bufferCount?e.bufferCount=1:!e.bufferTime&&e.bufferCount>0&&(e.bufferCount=0);var a={seq_num:e.seqNum,max_b:n,avg_b:i,ib:n,ob:e.observedBitrate.toFixed(2),ab:Math.round(e.actualBitrate),num_buf:e.bufferCount,buf_dur:e.bufferTime,req_t:e.timeToRequest,fb_dl_t:e.timeToFirstByte,req_dl_t:e.timeToDownload,drop_f:e.frameDrop,avg_fr:(e.frameRateSum/e.frameRateSampleCount).toFixed(2)};return a},n.prototype.getMetricsBandwidthInfo=function(){var e=this,t=e.__controller.services.bandwidthEstimator,r=t.averageBandwidth===e.MQ?0:t.averageBandwidth;return e.MQ!==t.averageBandwidth&&(e.MQ=t.averageBandwidth),r},n.prototype.cuepointEventDispatcher=function(e,t){var r,n=this,i=t.length,o=i-1;if(i>0){if(n.shouldFireCueDetectedEvent(e,t[o]))return t[o].setCueOutDetectedState(!0),r={cuepointDuration:t[o].cuepointDuration,timeGapBeforeCUEOUT:t[o].startTime-e},void n.__controller.sendEvent(a.CUEPOINT_DETECTED,r);if(n.shouldFireCueOutEvent(e,t[o]))return t[o].setCueOutFiredState(!0),r={cuepointDuration:t[o].cuepointDuration,cuepointPlayedTime:e-t[o].startTime},void n.__controller.sendEvent(a.CUEPOINT_STARTED,r)}},n.prototype.shouldFireCueDetectedEvent=function(e,t){return!!t.startTime&&(!t.isCueOutDetectedFired&&t.startTime>e)},n.prototype.shouldFireCueOutEvent=function(e,t){var r=this;if(!t.startTime)return!1;var n=r.YQ(e);return!t.isCueOutFired&&n===t.startSeqNum&&e>t.startTime},n.prototype.YQ=function(e){var t=this,r=t.l.getCurrentPlayingStream(),n=r?r.segments:null;if(n){if(1===n.length)return n[0].seqNum;for(var i=n.length-1;i>=0;i--)if(e>=n[i].startTime)return n[i].seqNum}return null}},{"./../event":185}],224:[function(e,t,r){"use strict";function n(){var e=this;e.l=e.__controller.model,e.ZQ={},e.bandwidthEstimator=new o(e.l.bwHistory),e.segmentMetrics=e.__controller.create(s),e.metadataParser=e.__controller.create(i),e.mp4BoxParser=new a}t.exports=n;var i=e("./playlist-parser"),a=e("../mp4/mp4-box-parser"),o=e("./../abr/bandwidth-estimator"),s=e("./segment-metrics"),l=e("./loader"),c=e("./../worker-utils/worker-bridge"),u=e("webworkify"),p=e("../../lib/hls-utils");n.prototype.destroy=function(){var e=this;e.bandwidthEstimator.destroy(),e.segmentMetrics.destroy(),e.metadataParser.destroy(),e.ZQ&&Object.keys(e.ZQ).forEach(function(t){e.ZQ[t].terminate()})},n.prototype.getNewLoader=function(e,t){var r=this,n=r.l,i=n.config,a=n.userAgent,o=n.inWorkerScope;e=e||{},e.maxRetries=e.maxRetries||i.maxRetries,e.requestTimeout=e.requestTimeout||i.requestTimeout,e.chunkedRequestTimeout=e.chunkedRequestTimeout||i.chunkedRequestTimeout,e.useMSStream=!!a&&(a.ie||a.edge),e.stopStreamLoadOnError=e.stopStreamLoadOnError||i.stopStreamLoadOnError,e.withCredentials=p.isWithCreds(t||e.url)||!1;var s=null;try{s=l.getLoader(new l.LoadRequest(e),e.window,o)}catch(e){s=null}return s},n.prototype.getWorker=function(e){var t=this;if(!e)return null;var r=t.l.config;if(r.useWorker&&"undefined"!=typeof Worker)try{return t.ZQ[e]||(t.ZQ[e]=u(c)),t.ZQ[e]}catch(e){}return null}},{"../../lib/hls-utils":145,"../mp4/mp4-box-parser":206,"./../abr/bandwidth-estimator":154,"./../worker-utils/worker-bridge":230,"./loader":218,"./playlist-parser":222,"./segment-metrics":223,webworkify:247}],225:[function(e,t,r){"use strict";function n(e){var t=this;t.$Q=[],t._Q=e||{},t._b={},t.ready=!1,t.aR=0}function i(e){var t=this;t.$Q=[],t._Q=e||{},t._b={},t.dR=0,t.ready=!1,t.eR=0,t.aR=f*d,t.YN=new a}t.exports.AACStream=n,t.exports.AVCStream=i;var a=e("./sei-parser"),o=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],s=["Null","Main","LC","SSR","LTP"],l="mp4a.40.2",c=66,u=0,p=10,d=9e4,f=.033,v=t.exports.NAL_UNIT_TYPES={NON_IDR:1,IDR:5,AD_INFO_SEI:6,SPS:7,PPS:8,AUD:9};n.prototype.destroy=function(){var e=this;e.$Q=[]},n.prototype.readFrames=function(e){var t=this;e&&e.packetInfo&&t.readFramesFromBitstream(e.packetInfo.streamData,e.packetInfo.pts)},n.prototype.readFramesFromBitstream=function(e,t){var r=this;if(!e||e.length<6)return 0;for(var n=0,i=0,a=0;n<e.length;){var o=0,s=(e[n++]<<8)+e[n++],c=6&s,u=1&s;if(65520===(65520&s)&&0===c){r.bR(e.subarray(n,n+2)),r._b.codec=l,n++;var p=(e[n++]<<16)+(e[n++]<<8)+e[n++];for(p=(262112&p)>>>5,i=(3&e[n++])+1,u?p-=7:(p-=9,n+=2);o<i&&n<e.length;){var d=t+a*r.aR;r.$Q.push({data:e.subarray(n,n+p),dts:d,pts:d,keyframe:!1,flags:{isLeading:!1,dependsOn:!0,isDependedOn:!1,hasRedundancy:!1,paddingValue:!1,isNonSyncSample:!1,degradationPriority:1}}),n+=p,o++,a++}}else n--}return r.ready=r.cR(),n},n.prototype.bR=function(e){var t=this;if(e&&!(e.length<2)){var r=((192&e[0])>>>6)+1;r=r>4?4:r,t._b.audioObjectTypeIndex=r,t._b.audioObjectType=s[r],r=(60&e[0])>>>2,r=r<13?r:0,t._b.samplingFreqIndex=r,t._b.samplingFreq=o[r],t._b.channels=(1&e[0])<<2|(192&e[1])>>>6,t._b.sampleSize=16,t.aR=1024*d/t._b.samplingFreq}},n.prototype.cR=function(){var e=this,t=e.$Q.length,r=t>0?e.$Q[t-1].pts-e.$Q[0].pts+e.aR:0,n=.1*d;return r>=n},n.prototype.getFrames=function(){var e=this;return e.ready=!1,e.$Q.splice(0,e.$Q.length)},n.prototype.getConfig=function(){var e=this;return e._b},n.prototype.getLastFrameDetails=function(){var e=this;return e.$Q.length?{timestamp:e.$Q[e.$Q.length-1].dts,duration:e.aR}:null},i.prototype.destroy=function(){var e=this;e.$Q=[],e.YN.destroy()},i.prototype.readFrames=function(e){var t=this;if(e&&e.packetInfo){var r=e.packetInfo.streamData;if(r&&!(r.length<4)){for(var n,i,a,o=0,s=0,l=0,c=o,u={nalUnits:[],nalUnitSize:0,dts:e.packetInfo.dts,pts:e.packetInfo.pts,keyframe:!1,data:r,cea608Data:[],flags:{isLeading:0,dependsOn:0,isDependedOn:0,hasRedundancy:0,paddingValue:0,isNonSyncSample:!1,degradationPriority:0}},p=4294967295,d=!1;o<r.length;){var f=r[o++];if(i=NaN,p=p<<8|f,1===p&&(i=4),a=16777215&p,1===a){if(!d&&o>i&&t.$Q&&t.$Q.length){var m=t.$Q[t.$Q.length-1],y=m.nalUnits,h=y.length,E=y[h-1];if(E){var g=o-i;m.nalUnitSize+=g;var b;E.data?(b=new Uint8Array(E.data.byteLength+g),b.set(E.data,0),b.set(r.subarray(0,g),E.data.byteLength)):(b=new Uint8Array(g),b.set(r.subarray(0,g),0)),E.data=b,b=new Uint8Array(m.data.byteLength+g),b.set(m.data,0),b.set(r.subarray(0,g),m.data.byteLength),m.data=b}}if(d=!0,p=4294967295,i=i||3,s=u.nalUnits.length,s>=1&&null===u.nalUnits[s-1].data)switch(l=o-c-i,n=r.subarray(c,c+l),u.nalUnitSize+=l,u.nalUnits[s-1].data=n,u.nalUnits[s-1].type){case v.SPS:t._b.profileIndication=n[1],t._b.profileCompatibility=n[2],t._b.levelIndication=n[3],t._b.numOfSPS=1,t._b.spsLength=n.length,t._b.sps=n;break;case v.PPS:t._b.numOfPPS=1,t._b.ppsLength=n.length,t._b.pps=n}c=o,l=0;var _=31&r[o++];if(_<v.AUD&&u.nalUnits.push({data:null,type:_}),_===v.IDR)t.dR=t.$Q.length,u.keyframe=!0,u.flags.dependsOn=2,t.eR++;else if(_===v.NON_IDR)u.keyframe=!1,u.flags.dependsOn=1,u.flags.isNonSyncSample=!0;else if(_===v.AD_INFO_SEI)for(var A=t.YN.parse(r,o),T=0;T<A.length;T++)u.cea608Data.push(A[T])}}s=u.nalUnits.length,s>=1&&null===u.nalUnits[s-1].data&&c<r.length&&(l=o-c,u.nalUnits[s-1].data=r.subarray(c,c+l),u.nalUnitSize+=l),t._b.codec=t.fR(t._b),u.nalUnitSize>0&&t.$Q.push(u),t.ready=t.cR()}}},i.prototype.cR=function(){var e=this,t=e.$Q.length,r=t>0?e.$Q[t-1].pts-e.$Q[0].pts+e.aR:0,n=.1*d;return e._Q.startChunkWithKeyFrame?e.eR>=2:t>1&&r>=n},i.prototype.getFrames=function(e){var t=this,r=t._Q.startChunkWithKeyFrame&&e&&e.keyFrameBoundary,n=e.keyFrameBoundary?t.$Q.length-1:t.$Q.length;r&&(n=t.dR,t.eR=1,t.ready=!1);var i=t.$Q.splice(0,n);return t.dR=0,i},i.prototype.getConfig=function(){var e=this;return e._b},i.prototype.fR=function(e){var t=e&&e.profileIndication||c;t=Math.max(t,c);var r=e&&e.profileCompatibility||u,n=e&&e.levelIndication||p;return"avc1."+(t<<16|r<<8|n).toString(16)}},{"./sei-parser":227}],226:[function(e,t,r){"use strict";function n(e,t,r){var n=this;n.streamType=e,n.streamId=t,n.gR=[],n.DN=!1,n._Q=r,n.hR=null,n.iR=new s,"audio"===e?n.WF=new l(n._Q):"video"===e&&(n.WF=new c(n._Q))}function i(e){var t=this;t.yF=new o(Uint8Array,e),t.complete=!1}t.exports=n;var a=e("./av-stream"),o=e("../../lib/data-manager"),s=e("../helper/id3"),l=a.AACStream,c=a.AVCStream;n.prototype.destroy=function(){var e=this;e.gR=[],e.WF&&(e.WF.destroy(),e.WF=null)},n.prototype.isReady=function(){var e=this,t=!!e.WF&&e.WF.ready;return e.DN||t},n.prototype.addPacket=function(e){var t=this,r=t.gR.length;r&&t.jR(),t.gR.push(new i(e))},n.prototype.append=function(e){var t=this,r=t.gR.length;e&&r&&t.gR[r-1].append(e)},n.prototype.endOfSegment=function(){var e=this;e.DN=!0,e.jR()},n.prototype.getFrames=function(e){var t=this;return t.WF?t.WF.getFrames(e):null},n.prototype.getTimedMetadata=function(){var e=this;return e.hR?e.hR:null},n.prototype.getConfig=function(){var e=this;return e.WF?e.WF.getConfig():null},n.prototype.jR=function(){var e=this,t=e.gR.length;if(t){var r=e.gR[t-1];r.complete=!0,0===r.parse()&&("id3"===e.streamType?e.hR={payload:e.iR.getID3Payload(r.packetInfo.streamData),pts:e.gR.length&&e.gR[0].packetInfo.pts}:e.WF&&e.WF.readFrames(r),e.gR.pop())}},i.prototype.append=function(e){var t=this;t.yF&&t.yF.set(e)},i.prototype.parse=function(){var e=this;if(e.packetInfo={},!e.complete||!e.yF||!e.yF.length)return e.packetInfo.result=-1,-1;if(e.yF.length<6)return e.packetInfo.result=-2,-2;var t=0,r=(e.yF.get(t++)<<16)+(e.yF.get(t++)<<8)+e.yF.get(t++);if(1!==r)return e.packetInfo.result=-3,-3;e.packetInfo.streamId=e.yF.get(t++),t+=2,t++;var n=(192&e.yF.get(t++))>>6,i=e.yF.get(t++);return 2!==n&&3!==n||(e.packetInfo.pts=e.kR(e.yF.subArray(t,t+5)),e.packetInfo.dts=e.packetInfo.pts,t+=5,i-=5,3===n&&(e.packetInfo.dts=e.kR(e.yF.subArray(t,t+5)),t+=5,i-=5)),t+=i,e.packetInfo.streamData=e.yF.subArray(t),e.packetInfo.result=0,0},i.prototype.kR=function(e){if(!e||!e.length)return 0;var t=0,r=(14&e[t++])>>>1,n=(e[t++]<<8)+(254&e[t++])>>>1,i=(e[t++]<<8)+e[t++]>>>1,a=(4&r)>>2;r&=3;var o=r<<29;n<<=15;var s=2*o+n+i,l=a?-1*Math.pow(2,32)+s:s;return l}},{"../../lib/data-manager":143,"../helper/id3":190,"./av-stream":225}],227:[function(e,t,r){"use strict";function n(){}t.exports=n,n.prototype.destroy=function(){},n.prototype.parse=function(e,t){for(var r=[],n=0;255===e[t];)n+=255,t++;if(n+=e[t],t++,!(t>=e.length)){for(var i=0;255===e[t];)i+=255,t++;if(i+=e[t],t++,4===n){var a=e[t],o=e[t+1]<<8|e[t+2],s=e[t+3]<<24|e[t+4]<<16|e[t+5]<<8|e[t+6],l=e[t+7];if(181===a&&49===o&&1195456820===s&&3===l){var c=31&e[t+8];t+=9;var u=0;t++;for(var p,d;u<c;){if(p=(4&e[t])>>2,d=3&e[t],p&&(0===d||1===d)){var f={fieldType:d,data1:e[t+1],data2:e[t+2]};r.push(f)}t+=3,u++}}}return t+=i,r}}},{}],228:[function(e,t,r){"use strict";function n(e,t){var r=this;r.yF=null,r._Q=e||{},r.lR=t,r.mR=0,r.nR=NaN,r.oR={},r.pR={},r.qR=[],r.nI="initial",r.CN="start",r.DN=!1}t.exports=n;var i=e("./pes"),a=e("./../error"),o=188,s=71,l=500,c=0;n.prototype.destroy=function(){var e=this;e.yF=null,e.qR=[],e.nI="initial",e.CN="start";var t=e.pR;for(var r in t)t.hasOwnProperty(r)&&t[r].destroy();e.pR={}},n.prototype.append=function(e){var t=this;if(e){var r=e.length;if(r){var n=null,i=0;t.yF&&(n=t.yF,i=n.length);var o=i+r;return t.yF=new Uint8Array(o),n&&t.yF.set(n),t.yF.set(e,i),t.LG()===-2?{error:a.ERR_SEGMENT_PARSE}:void 0}}},n.prototype.endOfSegment=function(){var e=this;e.DN=!0,e.yF&&e.yF.length<o&&e.rR()},n.prototype.LG=function(){var e=this;if(!e.yF)return-1;for(var t=0;e.yF.length;){var r=e.jR(e.yF.subarray(0,o));if(0===r)t++,e.yF=e.yF.subarray(o),t>=l&&(e.sR(),t=0);else{if(r!==-2)break;var n=e.tR(e.yF);if(!(n>=0))break;e.yF=e.yF.subarray(n)}}return e.DN&&0===e.yF.length?e.rR():e.sR(),0},n.prototype.jR=function(e){var t=this;if(!e||e.length<1)return-1;var r=0,n={};if(e[r++]!==s)return-2;if(!e||e.length<o)return-1;var i=e[r++];if(n.startIndicator=(64&i)>>6,n.pid=((31&i)<<8)+e[r++],i=e[r++],n.adaptationFieldExists=(32&i)>>5,n.payloadExists=(16&i)>>4,n.adaptationFieldLength=0,n.adaptationFieldExists){n.adaptationFieldLength=e[r++];var a=e[r++];16&a&&n.pid===t.mR&&n.adaptationFieldLength>=7&&t.uR(e.subarray(r,r+6)),r+=n.adaptationFieldLength-1}return!n.payloadExists||n.adaptationFieldLength>=183?0:(t.vR(e.subarray(r),n),0)},n.prototype.uR=function(e){var t=this;if(e&&!(e.length<6)){var r=0,n=e[r++],i=(128&n)>>>7;n&=127,n=(n<<24)+(e[r++]<<16)+(e[r++]<<8)+e[r++];var a=e[r++];r++;var o=(128&a)>>>7,s=2*n+o,l=i?-1*Math.pow(2,32)+s:s;t.wR||(t.wR=l)}},n.prototype.vR=function(e,t){var r=this;if(e&&t&&!isNaN(t.pid)){var n,i,a;if(r.oR.aac&&(n=r.oR.aac),r.oR.avc&&(i=r.oR.avc),r.oR.id3&&(a=r.oR.id3),!(t.pid>=1&&t.pid<=15||8191===t.pid))switch(t.pid){case c:r.xR(e,t);break;case r.nR:r.yR(e,t);break;case n:r.zR("audio",n,e,t);break;case i:r.zR("video",i,e,t);break;case a:r.zR("id3",a,e,t),r.AR();break;default:r.BR(e,t)}}},n.prototype.xR=function(e,t){var r=this;if(e){var n=0;if(t.startIndicator){var i=e[n++];n+=i}e[n++];n+=4,n+=3;var a=(e[n++]<<8)+e[n++];a>0&&(r.nR=((31&e[n++])<<8)+e[n++]),r.nI="patParsed"}},n.prototype.yR=function(e,t){var r=this;if(e){var n=0;if(t&&t.startIndicator){var i=e[n++];n+=i}var a=(e[n++],((15&e[n++])<<8)+e[n++]),o=n;n+=2,n+=3,r.mR=((31&e[n++])<<8)+e[n++];var s=((15&e[n++])<<8)+e[n++];n+=s;for(var l=null,c=null,u=0;n-o<a-4;)switch(l=e[n++],c=((31&e[n++])<<8)+e[n++],u=((15&e[n++])<<8)+e[n++],n+=u,l){case 3:case 4:r.oR.mp3=c;break;case 15:r.oR.aac=c;break;case 27:r.oR.avc=c;break;case 21:r.oR.id3=c}r.nI="pmtParsed"}},n.prototype.zR=function(e,t,r,n){var a=this;if(r){var o=a.pR,s=o[t];n.startIndicator?(s||(o[t]=new i(e,t,a._Q),s=o[t]),s.addPacket(r)):s&&s.append(r)}},n.prototype.BR=function(e,t){var r=this;if(e&&!(e.length<4)&&t.startIndicator){var n=0,i=(e[0]<<16)+(e[1]<<8)+e[2],a=e[n++];n+=a;var o=e.length>n?e[n]:NaN;if(1===i){var s=e[3]>>>4;14===s?(r.oR.avc=t.pid,r.zR("video",r.oR.avc,e,t)):12!==s&&13!==s||(r.oR.aac=t.pid,r.zR("audio",r.oR.aac,e,t))}else 2===o&&r.yR(e,t)}},n.prototype.Sp=function(){var e=this,t=!0;for(var r in e.oR)if("id3"!==r&&e.oR.hasOwnProperty(r)){var n=e.oR[r];e.pR[n]&&(t=t&&e.pR[n].isReady())}return t},n.prototype.sR=function(){var e=this;if(e.Sp()){var t={},r=!1,n=!1,i=e.pR,a=Number.POSITIVE_INFINITY;for(var o in i)if(i.hasOwnProperty(o)){var s=i[o];if(s){var l={frames:s.getFrames({keyFrameBoundary:"end"!==e.CN}),config:s.getConfig(),streamId:s.streamId};"audio"===s.streamType&&o===e.oR.aac.toString()?(t.audio=l,r=t.audio.frames&&t.audio.frames.length):"video"===s.streamType&&o===e.oR.avc.toString()&&(t.video=l,n=t.video.frames&&t.video.frames.length)}}r&&(a=Math.min(a,t.audio.frames[0].dts)),n&&(a=Math.min(a,t.video.frames[0].dts)),a!==Number.POSITIVE_INFINITY&&(t.pcr=a),("end"===e.CN||r||n)&&(e.lR&&e.lR({pos:e.CN,avData:t}),"start"===e.CN&&(e.CN="middle"))}},n.prototype.AR=function(){var e=this,t=e.pR,r=null;Object.keys(t).forEach(function(n){var i=t[n];i&&"id3"===i.streamType&&n===e.oR.id3.toString()&&(r=i.getTimedMetadata())}),r&&e.lR&&e.lR({pos:"timedMetadata",timedMetadata:r})},n.prototype.tR=function(e){if(!e)return-1;for(var t=0;t<e.length;t++)if(e[t]===s)return t;return-1},n.prototype.rR=function(){var e=this;e.CN="end";var t=e.pR;for(var r in t)t.hasOwnProperty(r)&&(t[r].endOfSegment(),"id3"===t[r].streamType&&e.AR());e.sR()}},{"./../error":184,"./pes":226}],229:[function(e,t,r){"use strict";function n(e){var t=this;e&&(t.type=e.type,t.id=e.id,t.moduleName=e.moduleName,t.instanceId=e.instanceId,t.funcName=e.funcName,t.timestamp=e.timestamp||Date.now(),t.args=e.args||[],t.argNames=e.argNames||[],t.transferables=e.transferables)}t.exports=n,n.prototype.putParam=function(e,t){var r=this;t&&(r.args.push(t),r.argNames.push(e||""))},n.prototype.getParam=function(e){var t=this;if(!e)return null;var r=t.argNames.indexOf(e);return r>=0?t.args[r]:null},n.prototype.dto=function(){var e=this,t={};return Object.keys(e).forEach(function(r){"__controller"!==r&&(t[r]=e[r])}),t},n.prototype.addMedia=function(){var e,t=this;return t.__controller&&(e=t.__controller.model.getMediaDto(),t.putParam("media",e)),e}},{}],230:[function(e,t,r){"use strict";function n(e){e.CR={},e.addEventListener("message",function(t){o(a(t,e),e)})}function i(e,t,r){if(r){var n=e.dto();r.postMessage(n,t)}}function a(e,t){if(t){var r=new u(e.data),n=r.instanceId;return r.putParam("callback",function(e,r){e.instanceId=n,i(e,r,t)}),r}}function o(e,t){var r=t;if(e){var n=e.instanceId,i=e.moduleName,a=e.funcName,o=e.args;switch(e.id){case c.CREATE:r.CR[n]=Object.create(l[i].prototype),l[i].apply(r.CR[n],o);break;case c.DESTROY:r.CR.hasOwnProperty(n)&&(r.CR[n].destroy(),delete r.CR[n]);break;case c.CALL_METHOD:if(r.CR.hasOwnProperty(n)){var s=r.CR[n];s&&s[a]&&"function"==typeof s[a]&&s[a].apply(s,o)}}}}t.exports=n;var s=e("./worker-defs"),l=s.WorkerDefs,c=s.MessageIds,u=e("./message")},{"./message":229,"./worker-defs":231}],231:[function(e,t,r){"use strict";t.exports.WorkerDefs={HlsTransformer:e("../helper/hls-transformer"),Controller:e("../controller/worker-scope/controller")},t.exports.MessageTypes={EVENT:"event",MESSAGE:"message"},t.exports.MessageIds={CREATE:"create",DESTROY:"destroy",CALL_METHOD:"callMethod",EVENT:"eventPublish",CREATE_SRC_BUFFER:"createSrcBuffer",APPEND_SRC_BUFFER:"appendSrcBuffer",TIMED_METADATA:"timedMetadata",CLEAR_SRC_BUFFER:"clearSrcBuffer",END_OF_STREAM:"endOfStream",SAVE_AVG_BANDWIDTH:"saveAvgBandwidth",PLAY_AFTER_STREAM_CHANGE:"playAfterStreamChange",PAUSE_BEFORE_STREAM_CHANGE:"pauseBeforeStreamChange",DRM_INIT:"drmInit",DRM_LICENSE_INFO:"drmLicenseInfo",SKIP_GAP:"skipGap"}},{"../controller/worker-scope/controller":173,"../helper/hls-transformer":189}],232:[function(e,t,r){var n=function(e){return e.replace(/^\s+|\s+$/g,"")},i=function(e){return"[object Array]"===Object.prototype.toString.call(e)};t.exports=function(e){if(!e)return{};for(var t={},r=n(e).split("\n"),a=0;a<r.length;a++){var o=r[a],s=o.indexOf(":"),l=n(o.slice(0,s)).toLowerCase(),c=n(o.slice(s+1));"undefined"==typeof t[l]?t[l]=c:i(t[l])?t[l].push(c):t[l]=[t[l],c]}return t}},{}],233:[function(e,t,r){"use strict";t.exports={userAgent:e("./lib/user-agent"),capabilities:e("./lib/capabilities")}},{"./lib/capabilities":234,"./lib/user-agent":235}],234:[function(e,t,r){"use strict";function n(){if("undefined"!=typeof navigator){var e=navigator&&(navigator.connection||navigator.mozConnection||navigator.webkitConnection)||{};return e.type}}function i(){if(!o.mobile)return!0;var e=o.android&&o.chrome>=50,t=o.ios&&!o.iosWebView&&o.safari>=10;return e||t}function a(e){if(!o.mobile)return!0;e=(n()||e||"").replace(/^cs_/i,"").toLowerCase();var t=e&&s[e];return!!t&&i()}var o=e("./user-agent"),s={wifi:!0,broadband:!0,dsl:!0,cable:!0};t.exports={getConnectionType:n,isAutoplaySupported:i,isAutoplayAllowed:a}},{"./user-agent":235}],235:[function(e,t,r){"use strict";var n=/<[A-Za-z]+.*?(\/>|>.*?<\/[A-Za-z]+>)|javascript:/g,i="undefined"!=typeof navigator?navigator.userAgent.toLowerCase().replace(n,""):"",a="undefined"!=typeof window?window:{},o=function(e){if(null===e)return!1;var t=e[1];return parseFloat(t.replace("_",".").split(".",2).join("."))||1},s=function(e){for(var t=a&&a.location&&a.location.search&&a.location.search.substring(1)||"",r=t.split("&"),n=0;n<r.length;n++){var i=r[n].split("=");if(decodeURIComponent(i[0])===e)return decodeURIComponent(i[1])}return null};if(r.ua=i,r.chromium=o(/chromium\/([^\s]*)/.exec(i)),r.edge=o(/edge\/([^\s]*)/.exec(i)),r.opera=/opr\/|opera\//.test(i),r.chrome=!r.chromium&&!r.edge&&!r.opera&&(o(/chrome\/([^\s]*)/.exec(i))||o(/crios\/([^\s]*)/.exec(i))),r.ie=o(/msie ([^;]*)/.exec(i))||o(/trident.*; rv:([0-9.]+)/.exec(i)),r.firefox=!r.ie&&o(/firefox\/([^\s]*)/.exec(i)),r.android=/android/.test(i),r.androidTablet=r.android&&!/mobile/.test(i),r.htc_one=/htc_one/.test(i),r.vizio=/Vizio/i.test(i)||"vizio"===s("man"),r.tivo=/TiVo/i.test(i),r.fios=/Verizon_STB|\(Verizon.*VMS1100|\(Verizon.*IPC1100|\(Verizon.*IPC3200/i.test(i),r.firetv=r.android&&/amazonwebappplatform/.test(i)&&/aft/.test(i),r.lg=/web0s/.test(i),r.tizen=/tizen/.test(i),r.orsay=/smarttv/.test(i)&&!r.tizen&&!r.lg,r.samsung=r.orsay||r.tizen,r.sony=/(sony)/.test(i),r.ps4=/(playstation 4)/.test(i),r.ios=/(ipad|iphone|ipod)/.test(i),r.iphone=/(iphone|ipod)/.test(i)&&!/ipad/.test(i),r.ipad=r.ios&&!r.iphone,r.androidBrowser=!r.chrome&&/android/.test(i),r.androidVersion=o(/android\s([0-9.]*)/.exec(i)),r.safari=!r.chrome&&!r.chromium&&!r.android&&/safari\/([^\s]*)/.test(i)&&o(/version\/([^\s]*)/.exec(i)),r.iosWebView=r.ios&&!navigator.standalone&&!r.safari,r.iosVersion=r.ios&&o(/\bos ((\d+_?){2,3})\s/.exec(i)),r.mobile=r.ios||r.android&&!r.firetv,r.safariDesktop=!r.mobile&&r.safari,r.tv=r.vizio||r.tivo||r.firetv||r.samsung||r.sony||r.ps4||r.lg||r.fios,r.desktop=!r.mobile&&!r.tv,r.phantomJS=a.window&&a.window.DR,r.tv)if(r.vizio)r.os="vizio",r.model=s("class")||s("soc");else if(r.tivo)r.os="tivo",/tcd849/.test(i)?(r.model="series6",r.version="tcd849"):/tcd8d9/.test(i)?(r.model="series6",r.version="tcd8d9"):/tcd8f9/.test(i)?(r.model="series6",r.version="tcd8f9"):/tcd8/.test(i)?(r.model="series5",r.version="tcd8"):/tcdd/.test(i)?(r.model="series5",r.version="tcdd"):r.model="series4";else if(r.firetv)r.os="firetv",/aftb/.test(i)?r.model="aftb":/afts/.test(i)?r.model="afts":/aftm/.test(i)?r.model="aftm":r.model="aftm";else if(r.lg)r.os="lg",r.model="lg";else if(r.samsung){r.os="samsung";var l="undefined"!=typeof l?l:window.tizen;l&&l.systeminfo?(r.model="tizen",r.version=l.systeminfo.getCapability("http://tizen.org/feature/platform.version")):r.model="orsay"}else r.sony?(r.os="sony",/bdp/.test(i)?r.model="bdp":r.model="tv"):r.ps4?(r.os="ps4",r.model="4"):r.fios?r.os="fios":r.os=null;else r.ios?r.os="ios":r.android?r.os="android":/windows|win32/.test(i)?(r.os="windows",r.winXP=/(windows nt 5\.[1-3])/.test(i),r.winVista=/(windows nt 6\.0)/.test(i),r.win7=/(windows nt 6\.1)/.test(i),r.win8=/(windows nt 6\.2)/.test(i),r.win8_1=/(windows nt 6\.3)/.test(i),r.win10=/(windows nt 10\.0)/.test(i),r.win64=/(wow64|win64)/.test(i)):/macintosh|mac_powerpc/.test(i)?r.os="macintosh":/symbos/.test(i)?r.os="symbos":/linux/.test(i)?r.os="linux":r.os=null},{}],236:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CAST_CODES=r.SAPI_CODES=r.PLAYER_JS_HLS_CODES=r.PLAYER_DRM_CODES=r.PLAYER_CODES=r.WARNING_CODES=r.INFO_CODES=r.E_CAST=r.E_SAPI_CLOSEDCAPTION=r.E_SAPI_POPULAR=r.E_SAPI_RELATED=r.E_SAPI_PLAYLIST=r.E_SAPI_STREAM=r.E_SAPI_ABSTRACT=r.E_PLAYER_JS_HLS=r.E_PLAYER_DRM=r.E_PLAYER_FAILOVER=r.E_PLAYER=r.E_YVAP=r.E_WARNING=r.E_INFO=void 0,r.E_INFO="100",r.E_WARNING="200",r.E_YVAP="300",r.E_PLAYER="400",r.E_PLAYER_FAILOVER="407",r.E_PLAYER_DRM="410",r.E_PLAYER_JS_HLS="430",r.E_SAPI_ABSTRACT="500",r.E_SAPI_STREAM="501",r.E_SAPI_PLAYLIST="502",r.E_SAPI_RELATED="503",r.E_SAPI_POPULAR="504",r.E_SAPI_CLOSEDCAPTION="505",r.E_CAST="800",r.INFO_CODES={E_SAPI_LICENSE_ERROR:"200",E_SAPI_UNAVAILABLE_TEMP:"201",E_SAPI_GEO:"202",E_SAPI_DEVICE:"203",E_SAPI_EMBED:"204",E_SAPI_BLACKOUT:"208",E_SAPI_AUTH_FAILED:"210",E_SAPI_INVALID_AUTH_KEY_VERSION:"211",E_SAPI_GEO_POSITION_REQUIRED:"212",E_SAPI_RESTRICTED_NETWORK_TYPE:"214",E_SAPI_UNSUPPORTED_LIVE_ON_HTML:"305",E_DRM_UNSUPPORTED_OS:"401",E_DRM_UNSUPPORTED_BROWSER:"402",E_DRM_FORBIDDEN_LICENSE:"403",E_PLAYER_ANDROID_CHROME_REQUIRED:"500",E_FLASH_RENDERER_NOT_SUPPORTED:"605",E_PLAYER_NO_COMPATIBLE_FORMAT:"700",E_PLAYER_360_IS_NOT_SUPPORTED:"701"},r.WARNING_CODES={E_PLAYBACK_TIMEOUT:"1",E_RECOVER_LONG_PAUSE:"50",E_LIVE_PLAYBACK_COMPLETE:"800",E_SSL_MISMATCH:"803",E_CSS_DOWNLOAD_FAILED:"804",E_PLAYBACK_FROZEN_DETECTED:"900",E_ER_TRY:"901",E_RECOVERY_STATUS:"902",E_BUFFER_GAP:"903"},r.PLAYER_CODES={E_PLAYER_NOT_ENABLED:"200",E_FLASH_LIVE_NOT_SUPPORTED:"252",E_NATIVE_ERROR:"303",E_NATIVE_ABORTED:"304",E_NATIVE_NETWORK_FAILURE:"305",E_NATIVE_DECODE_ERROR:"306",E_NATIVE_SRC_NOT_SUPPORTED:"307",E_NATIVE_ENCRYPT_MEDIA:"308",E_NATIVE_PREMATURE_PLAY:"309",E_NATIVE_UNAUTHORIZED_URL:"310",E_NATIVE_URL_NOT_FOUND:"311",E_CMS_JSONP_REQUEST_FAILURE:"101",E_CMS_JSONP_REQUEST_SILENT_FAIL:"102",E_CMS_RESPONSE:"405",E_CMS_JSONP_REQ_TIMEOUT:"408",E_CMS_JSONP_REQ_TIMEOUT_SILENT_FAIL:"409",E_CMS_XHR_REQ_CONNECTION_FAILED:"700",E_CMS_XHR_REQ_CONNECTION_FAILED_TIMEOUT:"701",E_CMS_XHR_RESPONSE_ABSENT:"710",E_CMS_XHR_RESPONSE_ABSENT_TIMEOUT:"711",E_CMS_XHR_REQ_LOAD_FAILED:"720",E_CMS_XHR_REQ_LOAD_TIMEOUT:"721",E_CMS_XHR_REQ_LOAD_408:"722",E_CMS_XHR_REQ_INCOMPLETE:"730",E_CMS_XHR_REQ_INCOMPLETE_TIMEOUT:"731",E_CMS_XHR_REQ_408:"732",E_CMS_XHR_REQ_ERROR:"740",E_CMS_XHR_REQ_TIMEOUT:"750",E_CMS_XHR_REQ_CORS_ERROR:"760",E_INTERNAL_VIOLATION:"600",E_INVALID_CONFIG:"601",E_RECOVERY_FAILURE:"602",E_NO_PLUGIN_FOUND:"603",E_NO_RENDERER_FOUND:"604",E_FLASH_RENDERER_NOT_SUPPORTED:"605"},r.PLAYER_DRM_CODES={E_UNSUPPORTED_OS:"1",E_UNSUPPORTED_BROWSER:"2",E_EME_MISSING:"3",E_INIT:"4",E_CONFIG:"5",E_CERTPATH_MISSING:"6",E_CERT_LOAD_FAILED:"7",E_CERT_NO_DATA:"8",E_NO_KEY_SYSTEM:"9",E_KEY_CREATION_FAILED:"10",E_KEY_SESSION_FAILED:"11",E_KEY_ERROR:"12",E_LICENSE_REQUEST:"13",E_FORBIDDEN_LICENSE:"14"},r.PLAYER_JS_HLS_CODES={MEDIA_ERR_ABORTED:"1",MEDIA_ERR_NETWORK:"2",MEDIA_ERR_DECODE:"3",MEDIA_ERR_SRC_NOT_SUPPORTED:"4",ERR_XHR_LOAD:"11",ERR_PLAYLIST_LOAD:"12",ERR_SUBS_LOAD:"13",ERR_SEGMENT_LOAD:"14",ERR_PARTIAL_LOAD:"15",ERR_MASTER_PLAYLIST_PARSE:"16",ERR_MEDIA_PLAYLIST_PARSE:"17",ERR_SEGMENT_PARSE:"18",ERR_API_NO_NODE:"19",ERR_MIMETYPE_NOT_SUPPORTED:"20"},r.SAPI_CODES={E_INCOMPATIBLE_FORMAT:"100",E_NO_STREAMS:"103",E_UNAUTHORIZED_USER:"205",E_RESTRICTED_TO_INTERNAL:"206",E_DRM_RESTRICTED:"207",E_UNSUPPORTED_FORMAT:"300",E_EXTERNAL_NO_STREAMS:"301",E_NO_PLAYABLE_STREAMS:"302",E_NOT_FOUND:"400",E_EMPTY_LIST:"403"},r.CAST_CODES={E_CONNECTION_REQUEST_FAILED:"1"}},{}],237:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.TypeChecker=r.Privacy=r.LocalStorage=r.LoaderConstants=r.Loader=r.errorCodes=void 0;var n=e("./error-codes");r.errorCodes=n;var i=e("./loader"),a=i;r.Loader=i.default,r.LoaderConstants=a;var o=e("./local-storage");r.LocalStorage=o.default;var s=e("./privacy");r.Privacy=s.default;var l=e("./type-checker");r.TypeChecker=l},{"./error-codes":236,"./loader":238,"./local-storage":239,"./privacy":240,"./type-checker":241}],238:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.XHR_TIMEOUT=r.XHR_CORS=r.XHR_ERROR=void 0;var n=e("user-agent"),i=e("xhr"),a=e("./type-checker"),o=e("./utils");r.XHR_ERROR="XHR error",r.XHR_CORS="XHR CORS",r.XHR_TIMEOUT="XHR request timed out";var s=function(){function e(){}return e.ajax=function(e,t){e=o.default.fixProtocol(e);var s=o.default.getWindow(),l=t.context,c=t.responseTypeJson,u=t.withCookie,p=t.timeout,d=o.default.once(t.successHandler),f=o.default.once(t.failureHandler),v=!1,m=null,y={url:e,cors:n.userAgent.ie&&n.userAgent.ie<10||u,withCredentials:u,timeout:p||3e3,responseType:t.responseType,headers:t.headers,method:t.method,body:t.body,beforeSend:t.beforeSend};if(l&&d&&f){var h=(new Date).getTime(),E=i.default(y,function(n,i,o){if(!v){if(t.collectPerfData){if(m={},a.isFunction(E.getResponseHeader)&&(m.resp_len=E.getResponseHeader("Content-Length")||"na"),s.performance&&s.performance.getEntriesByName){var u=0===e.indexOf("http")?e:location.protocol+e;m.resourceTiming=s.performance.getEntriesByName(u).pop(),m.resourceTimingEntries=s.performance.getEntries()}m.http_code=i.statusCode}if(i.timeDiff=(new Date).getTime()-h,n){var y=null;a.isFunction(E.getResponseHeader)&&(y=E.getResponseHeader("Access-Control-Allow-Origin"));var g=s.location.protocol+"//"+s.location.host;if(y&&y!==g){var b=r.XHR_CORS+": originHeader ="+(y||"")+": myOrigin ="+g;f.call(l,new Error(b),"default","cors")}else{var _=i.timeDiff>=p?r.XHR_TIMEOUT:r.XHR_ERROR;f.call(l,new Error(_+": timeDiff ="+i.timeDiff),i.previousState,i.statusCode,i.timeDiff,m,E)}}else i.statusCode<200||i.statusCode>=300?f.call(l,new Error(r.XHR_ERROR+": statusCode = "+i.statusCode),i.previousState,i.statusCode,i.timeDiff,m,E):d.call(l,c?JSON.parse(o):o,!1,m,E)}});E.previousState=E.readyState;var g=E.onreadystatechange;E.onreadystatechange=function(){4===E.readyState?g.call(E):E.previousState=E.readyState}}return function(){v=!0}},e.preconnect=function(e,t){if(document&&!document.head.querySelector("#"+e)){var r=document.createElement("link");r.setAttribute("rel","preconnect"),r.setAttribute("id",e),r.setAttribute("href",t);var n=document.getElementsByTagName("head")[0];n&&n.appendChild(r)}},e}();r.default=s},{"./type-checker":241,"./utils":242,"user-agent":243,xhr:246}],239:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(){}return e.get=function(e){var t;try{t=window.localStorage.getItem(e),t=t&&JSON.parse(t)||null}catch(e){t=null}return t},e.put=function(e,t){if(!e||!t)return!1;try{return t=JSON.stringify(t),localStorage.setItem(e,t),!0}catch(e){return!1}},e.remove=function(e){try{localStorage.removeItem(e)}catch(e){return}},e.getAllKeys=function(){var e=[];try{for(var t=0,r=localStorage.length;t<r;++t){var n=localStorage.key(t);n&&e.push(n)}return e}catch(t){return e}},e}();r.default=n},{}],240:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(){}return e.getGDPRConsentData=function(e){var t=this;"undefined"!=typeof window.__tcfapi?window.__tcfapi("getTCData",2,function(r,n){n?e({gdprApplies:r.gdprApplies,gdprConsentData:r.tcString},!0):t.getConsentFromV1(e)}):this.getConsentFromV1(e)},e.getUSPrivacyConsent=function(e){"undefined"!=typeof window.__uspapi?window.__uspapi("getUSPData",1,function(t,r){return r?void e({uspString:t.uspString},!0):void e(void 0,!1)}):e(void 0,!1)},e.getUSPDoNotSell=function(e){window.__uspapi?window.__uspapi("getDoNotSell",1,function(t,r){r&&t&&"boolean"==typeof t.doNotSell?e({doNotSell:t.doNotSell},r):e(void 0,!1)}):e(void 0,!1)},e.getConsentFromV1=function(e){"undefined"!=typeof window.__cmp?window.__cmp("getConsentData",null,function(t,r){return r?void e({gdprApplies:t.gdprApplies,gdprConsentData:t.consentData},!0):void e(void 0,!1)}):e(void 0,!1)},e.getVendorConsent=function(e,t){var r=this;window.__tcfapi?window.__tcfapi("getTCData",2,function(n,i){var a;i?t({gdprApplies:n.gdprApplies,hasConsent:null===(a=null===n||void 0===n?void 0:n.vendor)||void 0===a?void 0:a.consents[e]},!0):r.getVendorConsentFromV1(e,t)},[e]):this.getVendorConsentFromV1(e,t)},e.getVendorConsentFromV1=function(e,t){window.__cmp?window.__cmp("getVendorConsents",new Uint16Array([e]),function(r,n){var i;return n&&(null===(i=null===r||void 0===r?void 0:r.vendorConsents)||void 0===i?void 0:i[e])?void t({gdprApplies:!!r.gdprApplies,hasConsent:r.vendorConsents[e]},!0):void t(void 0,!1)}):t(void 0,!1)},e.initIframeForGDPR=function(){if(!window.__tcfapi&&!window.__cmp){var e=this.findApiFrame("__tcfapiLocator"),t=this.findApiFrame("__cmpLocator"),r={},n={};window.__tcfapi=function(t,n,i,a){if(e){var o=Math.random()+"",s={
__tcfapiCall:{command:t,parameter:a,version:n,callId:o}};r[o]=i,e.postMessage(s,"*")}else i({msg:"CMP not found"},!1)},window.__cmp=function(e,r,i){if(!t)return void i({msg:"CMP not found"},!1);var a=Math.random()+"",o={__cmpCall:{command:e,parameter:r,callId:a}};n[a]=i,t.postMessage(o,"*")},window.addEventListener("message",function(e){var t={};try{t="string"==typeof e.data?JSON.parse(e.data):e.data}catch(e){}if(t.__tcfapiReturn&&"function"==typeof r[t.__tcfapiReturn.callId]){var i=t.__tcfapiReturn;r[i.callId](i.returnValue,i.success),r[i.callId]=null}else if(t.__cmpReturn&&"function"==typeof n[t.__cmpReturn.callId]){var i=t.__cmpReturn;n[i.callId](i.returnValue,i.success),delete n[i.callId]}},!1)}},e.findApiFrame=function(e){for(var t=window,r=null;t;){try{if(t.frames[e]){r=t;break}}catch(e){}if(t===window.top)break;t=t.parent}return r},e}();r.default=n},{}],241:[function(e,t,r){"use strict";function n(e){return Array.isArray(e)}function i(e){return"boolean"==typeof e}function a(e){return null==e}function o(e){return"number"==typeof e&&!isNaN(e)}function s(e){return"string"==typeof e}function l(e){return"[object Object]"===p(e)}function c(e){return"function"==typeof e}function u(e){return"string"==typeof e&&""!==e}function p(e){return Object.prototype.toString.call(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.isNonEmptyString=r.isFunction=r.isObject=r.isString=r.isNumber=r.isNullOrUndefined=r.isBoolean=r.isArray=void 0,r.isArray=n,r.isBoolean=i,r.isNullOrUndefined=a,r.isNumber=o,r.isString=s,r.isObject=l,r.isFunction=c,r.isNonEmptyString=u},{}],242:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("user-agent"),i=e("./type-checker"),a=function(){function e(){}return e.getWindow=function(){return window},e.fixProtocol=function(e){return n.userAgent.samsung&&0===e.indexOf("//")?"https:"+e:e},e.once=function(e){var t=this,r=function(){var n=Array.prototype.slice.call(arguments);return r.called?r.value:(r.called=!0,r.value=e.apply(t,n),r.value)};return r.called=!1,r},e.stringifyPrimitive=function(e){return i.isString(e)?e:i.isBoolean(e)?e.toString():i.isNumber(e)&&isFinite(e)?e.toString():""},e}();r.default=a},{"./type-checker":241,"user-agent":243}],243:[function(e,t,r){arguments[4][233][0].apply(r,arguments)},{"./lib/capabilities":244,"./lib/user-agent":245,dup:233}],244:[function(e,t,r){arguments[4][234][0].apply(r,arguments)},{"./user-agent":245,dup:234}],245:[function(e,t,r){(function(e){"use strict";var t=/<[A-Za-z]+.*?(\/>|>.*?<\/[A-Za-z]+>)|javascript:/g,n="undefined"!=typeof window?window:"undefined"!=typeof e&&e.window?e.window:{},i=n.navigator?n.navigator:"undefined"!=typeof navigator?navigator:{},a=i.userAgent?i.userAgent.toLowerCase().replace(t,""):"",o=function(e){if(null===e)return!1;var t=e[1];return parseFloat(t.replace("_",".").split(".",2).join("."))||1},s=function(e){for(var t=n&&n.location&&n.location.search&&n.location.search.substring(1)||"",r=t.split("&"),i=0;i<r.length;i++){var a=r[i].split("=");if(decodeURIComponent(a[0])===e)return decodeURIComponent(a[1])}return null};if(r.ua=a,r.chromium=o(/chromium\/([^\s]*)/.exec(a)),r.edge=o(/edge\/([^\s]*)/.exec(a)),r.opera=/opr\/|opera\//.test(a),r.chrome=!r.chromium&&!r.edge&&!r.opera&&(o(/chrome\/([^\s]*)/.exec(a))||o(/crios\/([^\s]*)/.exec(a))),r.ie=o(/msie ([^;]*)/.exec(a))||o(/trident.*; rv:([0-9.]+)/.exec(a)),r.firefox=!r.ie&&o(/firefox\/([^\s]*)/.exec(a)),r.android=/android/.test(a),r.androidTablet=r.android&&!/mobile/.test(a),r.htc_one=/htc_one/.test(a),r.vizio=/vizio/.test(a)||"vizio"===s("man"),r.tivo=/tivo/.test(a),r.presto=r.opera&&/presto/i.test(a),r.fios=/verizon.*(stb|vms|ipc)/.test(a),r.philips=/philipstv/.test(a),r.toshiba=/tsb/.test(a),r.amazon=r.android&&/amazonwebappplatform/.test(a)&&/aft/.test(a),r.lg=/web0s/.test(a),r.tizen=/tizen/.test(a),r.orsay=/smarttv/.test(a)&&!r.tizen&&!r.lg&&!r.philips,r.samsung=r.orsay||r.tizen,r.sony=/sony|bravia/.test(a),r.playstation=/(playstation)/.test(a),r.ios=/(ipad|iphone|ipod)/.test(a),r.iphone=/(iphone|ipod)/.test(a)&&!/ipad/.test(a),r.ipad=r.ios&&!r.iphone,r.androidBrowser=!r.chrome&&/android/.test(a),r.chromecast=/crkey/.test(a),r.androidVersion=o(/android\s([0-9.]*)/.exec(a)),r.safari=!r.chrome&&!r.chromium&&!r.android&&/safari\/([^\s]*)/.test(a)&&o(/version\/([^\s]*)/.exec(a)),r.iosWebView=r.ios&&!navigator.standalone&&!r.safari,r.iosVersion=r.ios&&o(/\bos ((\d+_?){2,3})\s/.exec(a)),r.mobile=r.ios||r.android&&!r.amazon,r.safariDesktop=!r.mobile&&r.safari,r.tv=r.vizio||r.tivo||r.amazon||r.samsung||r.sony||r.playstation||r.lg||r.fios||r.philips||r.toshiba,r.desktop=!r.mobile&&!r.tv,r.phantomJS=n.window&&n.window.DR,r.tv){var l="undefined"!=typeof l?l:"undefined"!=typeof e&&e.tv?e.tv:{};if(r.class=r.ua,r.vizio)r.os="vizio",r.class=s("class")||s("soc"),l&&l.tts&&(r.class+="-tts");else if(r.tivo)r.os="tivo",/tcd849/.test(a)?r.class="TCD849":/tcd8d9/.test(a)?r.class="TCD8D9":/tcd8f9/.test(a)?r.class="TCD8F9":/tcd8/.test(a)?r.class="TCD8":/tcdd/.test(a)?r.class="TCDD":/tcd7/.test(a)?r.class="TCD7":/tcda9/.test(a)&&(r.class="TCDA9");else if(r.amazon)r.os="amazon",/aftb/.test(a)?r.class="AFTB":/afts/.test(a)?r.class="AFTS":/aftm/.test(a)?r.class="AFTM":/aftn/.test(a)?r.class="AFTN":/aftrs/.test(a)?r.class="AFTRS":/aftt/.test(a)&&(r.class="AFTT");else if(r.lg)r.os="lg",/qtwebengine/.test(a)?r.class="3":/safari\/537/.test(a)?r.class="1":/safari\/538/.test(a)&&(r.class="2");else if(r.samsung){r.os="samsung";var c="default";if(r.tizen){var u="undefined"!=typeof u?u:n.tizen;u&&u.systeminfo&&(r.version=u.systeminfo.getCapability("http://tizen.org/feature/platform.version"));var p="undefined"!=typeof p?p:n.webapis;if(p&&p.productinfo&&p.productinfo.getRealModel)try{var d=p.productinfo.getRealModel(),f=d.substr(4,isNaN(Number(d[5]))?2:1);c=f+d.substr(1===f.length?5:6,1)}catch(e){c="default"}}else c="orsay";r.class=c}else r.roku||r.chromecast||r.toshiba||r.philips||r.appletv||r.xbox||(r.sony?(r.os="sony",/bdp/.test(a)?r.class="BDP":/bravia|sony-kj/.test(a)?r.class="BRAVIA":r.class="default"):r.playstation?(r.os="playstation",/4pro/.test(a)?r.class="4PRO":/playstation 4/.test(a)?r.class="4":/vita/i.test(a)&&(r.class="VITA")):r.fios?(r.os="fios",/stb/.test(a)?r.class="STB":/vms/.test(a)?r.class="VMS":/ipc/.test(a)&&(r.class="IPC")):r.os=null)}else r.ios?r.os="ios":r.android?r.os="android":/windows|win32/.test(a)?(r.os="windows",r.winXP=/(windows nt 5\.[1-3])/.test(a),r.class=r.winXP?"XP":r.class,r.winVista=/(windows nt 6\.0)/.test(a),r.class=r.winVista?"VISTA":r.class,r.win7=/(windows nt 6\.1)/.test(a),r.class=r.win7?"7":r.class,r.win8=/(windows nt 6\.2)/.test(a),r.class=r.win8?"8":r.class,r.win8_1=/(windows nt 6\.3)/.test(a),r.class=r.win*-1?"8_1":r.class,r.win10=/(windows nt 10\.0)/.test(a),r.class=r.win10?"10":r.class,r.win64=/(wow64|win64)/.test(a),r.architecture=r.win64?"64":"32"):/macintosh|mac_powerpc/.test(a)?r.os="macintosh":/symbos/.test(a)?r.os="symbos":/linux/.test(a)?r.os="linux":r.os=null}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],246:[function(e,t,r){"use strict";function n(e,t){for(var r=0;r<e.length;r++)t(e[r])}function i(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function a(e,t,r){var n=e;return p(t)?(r=t,"string"==typeof e&&(n={uri:e})):n=f(t,{uri:e}),n.callback=r,n}function o(e,t,r){return t=a(e,t,r),s(t)}function s(e){function t(){4===u.readyState&&setTimeout(a,0)}function r(){var e=void 0;if(e=u.response?u.response:u.responseText||l(u),b)try{e=JSON.parse(e)}catch(e){}return e}function n(e){return clearTimeout(v),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,c(e,_)}function a(){if(!f){var t;clearTimeout(v),t=e.useXDR&&void 0===u.status?200:1223===u.status?204:u.status;var n=_,i=null;return 0!==t?(n={body:r(),statusCode:t,method:y,headers:{},url:m,rawRequest:u},u.getAllResponseHeaders&&(n.headers=d(u.getAllResponseHeaders()))):i=new Error("Internal XMLHttpRequest Error"),c(i,n,n.body)}}if("undefined"==typeof e.callback)throw new Error("callback argument missing");var s=!1,c=function(t,r,n){s||(s=!0,e.callback(t,r,n))},u=e.xhr||null;u||(u=e.cors||e.useXDR?new o.XDomainRequest:new o.XMLHttpRequest);var p,f,v,m=u.url=e.uri||e.url,y=u.method=e.method||"GET",h=e.body||e.data,E=u.headers=e.headers||{},g=!!e.sync,b=!1,_={body:void 0,headers:{},statusCode:0,method:y,url:m,rawRequest:u};if("json"in e&&e.json!==!1&&(b=!0,E.accept||E.Accept||(E.Accept="application/json"),"GET"!==y&&"HEAD"!==y&&(E["content-type"]||E["Content-Type"]||(E["Content-Type"]="application/json"),h=JSON.stringify(e.json===!0?h:e.json))),u.onreadystatechange=t,u.onload=a,u.onerror=n,u.onprogress=function(){},u.onabort=function(){f=!0},u.ontimeout=n,u.open(y,m,!g,e.username,e.password),g||(u.withCredentials=!!e.withCredentials),!g&&e.timeout>0&&(v=setTimeout(function(){if(!f){f=!0,u.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",n(e)}},e.timeout)),u.setRequestHeader)for(p in E)E.hasOwnProperty(p)&&u.setRequestHeader(p,E[p]);else if(e.headers&&!i(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(u.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(u),u.send(h||null),u}function l(e){try{if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;if(""===e.responseType&&!t)return e.responseXML}catch(e){}return null}function c(){}var u=e("global/window"),p=e("is-function"),d=e("parse-headers"),f=e("xtend");t.exports=o,t.exports.default=o,o.XMLHttpRequest=u.XMLHttpRequest||c,o.XDomainRequest="withCredentials"in new o.XMLHttpRequest?o.XMLHttpRequest:u.XDomainRequest,n(["get","put","post","patch","head","delete"],function(e){o["delete"===e?"del":e]=function(t,r,n){return r=a(t,r,n),r.method=e.toUpperCase(),s(r)}})},{"global/window":140,"is-function":142,"parse-headers":232,xtend:251}],247:[function(e,t,r){var n=arguments[3],i=arguments[4],a=arguments[5],o=JSON.stringify;t.exports=function(e){for(var t,r=Object.keys(a),s=0,l=r.length;s<l;s++){var c=r[s];if(a[c].exports===e){t=c;break}}if(!t){t=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var u={},s=0,l=r.length;s<l;s++){var c=r[s];u[c]=c}i[t]=[Function(["require","module","exports"],"("+e+")(self)"),u]}var p=Math.floor(Math.pow(16,8)*Math.random()).toString(16),d={};d[t]=t,i[p]=[Function(["require"],"require("+o(t)+")(self)"),d];var f="("+n+")({"+Object.keys(i).map(function(e){return o(e)+":["+i[e][0]+","+o(i[e][1])+"]"}).join(",")+"},{},["+o(p)+"])",v=window.URL||window.webkitURL||window.mozURL||window.msURL;return new Worker(v.createObjectURL(new Blob([f],{type:"text/javascript"})))}},{}],248:[function(e,t,r){function n(e,t){function r(){4===u.readyState&&n()}function n(){var e=null,r=u.statusCode=u.status,n=u.body=u.response||u.responseText||u.responseXML;if(1223===r&&(r=204),0===r||r>=400&&r<600){var i=u.responseText||s[String(u.status).charAt(0)];e=new Error(i),e.statusCode=u.status}if(h)try{n=u.body=JSON.parse(n)}catch(e){}t(e,u,n)}function a(e){t(e,u)}"string"==typeof e&&(e={uri:e}),e=e||{},t=o(t);var u=e.xhr||null;!u&&e.cors?u=new c:u||(u=new l);var p,d=u.url=e.uri||e.url,f=u.method=e.method||"GET",v=e.body||e.data,m=u.headers=e.headers||{},y=!!e.sync,h=!1;if("json"in e&&(h=!0,m.Accept="application/json","GET"!==f&&"HEAD"!==f&&(m["Content-Type"]="application/json",v=JSON.stringify(e.json))),u.onreadystatechange=r,u.onload=n,u.onerror=a,u.onprogress=function(){},u.ontimeout=i,u.open(f,d,!y),e.cors&&(u.withCredentials=!0),y||(u.timeout="timeout"in e?e.timeout:5e3),u.setRequestHeader)for(p in m)m.hasOwnProperty(p)&&u.setRequestHeader(p,m[p]);return"responseType"in e&&(u.responseType=e.responseType),u.send(v),u}function i(){}var a=e("global/window"),o=e("once"),s={0:"Internal XMLHttpRequest Error",4:"4xx Client Error",5:"5xx Server Error"},l=a.XMLHttpRequest||i,c="withCredentials"in new l?a.XMLHttpRequest:a.XDomainRequest;t.exports=n},{"global/window":249,once:250}],249:[function(e,t,r){(function(e){"undefined"!=typeof window?t.exports=window:"undefined"!=typeof e?t.exports=e:t.exports={}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],250:[function(e,t,r){function n(e){var t=!1;return function(){if(!t)return t=!0,e.apply(this,arguments)}}t.exports=n,n.proto=n(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return n(this)},configurable:!0})})},{}],251:[function(e,t,r){function n(){for(var e={},t=0;t<arguments.length;t++){var r=arguments[t];for(var n in r)i.call(r,n)&&(e[n]=r[n])}return e}t.exports=n;var i=Object.prototype.hasOwnProperty},{}]},{},[17]);
