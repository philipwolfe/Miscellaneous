!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("wafer-tooltip",[],e):"object"==typeof exports?exports["wafer-tooltip"]=e():(t.wafer=t.wafer||{},t.wafer.wafers=t.wafer.wafers||{},t.wafer.wafers["wafer-tooltip"]=e())}("undefined"!=typeof self?self:this,function(){return function(t){function e(r){if(o[r])return o[r].exports;var i=o[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var o={};return e.m=t,e.c=o,e.d=function(t,o,r){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="https://s.yimg.com/aaq/wf/",e(e.s="./src/entry.js")}({"./src/entry.js":function(t,e,o){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function t(t,e){var o=[],r=!0,i=!1,n=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(o.push(a.value),!e||o.length!==e);r=!0);}catch(t){i=!0,n=t}finally{try{!r&&l.return&&l.return()}finally{if(i)throw n}}return o}return function(e,o){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function t(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,o,r){return o&&t(e.prototype,o),r&&t(e,r),e}}(),u=window.wafer,c=u.constants,f=u.features,d=u.utils,p=c.ATTR_PREFIX,y=c.DISPLAY_BLOCK,h=c.DISPLAY_NONE,v=c.WAFER_DESTROYED,w="has-tooltip-click",g="wafer-tooltip",b="wafer-tooltip-wrapper",m="wafer-tooltip-text",_="wafer-tooltip-close",S=d.convertNodeListToArray,T=["handleTooltipClose"],C=1,O=0,E=3,k=[200,0],A=15,D="wafer-tooltip-template",L="top",j="",x="viewport",P=function(){function t(e){var o=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=i.selector,a=i.successClass;r(this,t),this._util={elem:e,selector:n.replace(".","")};var s=e.getAttribute(p+"local-storage-key");if(!s)return void this.teardown(p+"local-storage-key data attribute is mandatory for element with "+g+" class");var u=e.getAttribute(p+"max-display-count")||E,c=e.getAttribute(p+"reset-every")||A,f=e.getAttribute(p+"template-id")||D,d=e.getAttribute(p+"display-delay")||O,y=e.getAttribute(p+"tooltip-position")||L,v=e.getAttribute(p+"tooltip-text")||j,P=e.getAttribute(p+"trigger")||x,I=e.getAttribute(p+"trigger-offset"),W=I&&I.split(" ")||k,N=l(W,2),B=N[0],R=N[1],Y=e.getAttribute(p+"tooltip-discovered-count")||C;if(this._util.localStorageKey=s,this._util.maxDisplayCount=u,this._util.resetEvery=c,this._util.discoveredCount=Y,!this.isEligibleToShow)return void this.teardown("Tooltip is not eligible to be shown.");var X=document.getElementById(f);if(!X)return void this.teardown("Cannot find a template with id "+f);if(e.appendChild(X.content.cloneNode(!0)),"top"!==y&&"bottom"!==y)return void this.teardown(p+"tooltip-position must be 'top' or 'bottom'");var F=S(e.getElementsByClassName(b));if(!F.length)return void this.teardown("Cannot find an element with class "+b);var K=F[0];K.setAttribute("data-toolpos",y),K.style.display=h,this._util.divWrapper=K;var M=S(e.getElementsByClassName(m));if(!M.length)return void this.teardown("Cannot find an element with class "+m);M[0].innerHTML=v,this._util.closeButtonElms=S(e.getElementsByClassName(_)),e.classList.contains(_)&&this._util.closeButtonElms.push(e),this._util.closeButtonElms.length&&e.classList.add(w),e.classList.add(a),this._util.offsetX=Number(R),this._util.offsetY=Number(B),this._util.tooltipDisplayDelay=d,this._util.trigger=P,T.forEach(function(t){o[t]=o[t].bind(o)}),window.wafer.base.sync(e)}return s(t,[{key:"teardown",value:function(t){this._util.elem&&this._util.elem.classList.add(v),window.wafer.base.destroy(this._util.elem)}},{key:"destroy",value:function(){var t=this._util.elem;t&&t.classList.add(v),this._util={}}},{key:"showTooltip",value:function(){var t=this,e=this._util,o=e.divWrapper,r=e.tooltipDisplayDelay;if(this.isEligibleToShow&&o&&!this.isTooltipAlreadyVisible){this._util.timeoutId=setTimeout(function(){t._util.timeoutId=void 0,o.style.display=y},r);var i=this.getPreviousLocalState;i.lastDisplayCount++,this.writeToLocalStorage=i}}},{key:"hideTooltip",value:function(){var t=this._util.divWrapper;t&&(t.style.display=h)}},{key:"daysDifference",value:function(t,e){return Math.round((e-t)/864e5)}},{key:"handleTooltipClose",value:function(t){var e=t.target;if(-1!==this._util.closeButtonElms.indexOf(e)){this._util.divWrapper&&(this._util.divWrapper.style.display=h);var o=this.getPreviousLocalState;o.discovered++,this.writeToLocalStorage=o}}},{key:"config",get:function(){return{offsetX:this._util.offsetX,offsetY:this._util.offsetY,trigger:this._util.trigger}}},{key:"isTooltipAlreadyVisible",get:function(){var t=this._util,e=t.divWrapper,o=t.timeoutId;return e&&e.style.display===y||void 0!==o}},{key:"readFromLocalStorage",get:function(){var t=this._util.localStorageKey,e={};if(f.localStorage)try{e=JSON.parse(window.localStorage.getItem(t))||{}}catch(t){}return e}},{key:"writeToLocalStorage",set:function(t){var e=this._util.localStorageKey;if(f.localStorage)try{window.localStorage.setItem(e,JSON.stringify(t))}catch(t){}}},{key:"getPreviousLocalState",get:function(){var t=this.readFromLocalStorage;return t.discovered=t.discovered||0,t.lastResetDate=t.lastResetDate||Date.now(),t.lastDisplayCount=t.lastDisplayCount||0,t}},{key:"isEligibleToShow",get:function(){var t=this._util,e=t.discoveredCount,o=t.maxDisplayCount,r=t.resetEvery,i=this.getPreviousLocalState,n=i.discovered,a=i.lastDisplayCount,l=i.lastResetDate,s=Date.now(),u=this.daysDifference(l,s);return!(n>=e||u<r&&a>=o)}}]),t}();P.events={click:[["has-tooltip-click","handleTooltipClose"]]};var I=P,W=function(){function t(t,e){var o=[],r=!0,i=!1,n=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(o.push(a.value),!e||o.length!==e);r=!0);}catch(t){i=!0,n=t}finally{try{!r&&l.return&&l.return()}finally{if(i)throw n}}return o}return function(e,o){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),N=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(t[r]=o[r])}return t},B=function(){function t(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,o,r){return o&&t(e.prototype,o),r&&t(e,r),e}}(),R=window.wafer.utils,Y=R.elementInView,X=R.throttle,F=window.wafer.base,K=window.wafer.controllers.WaferBaseController,M=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=t.root,r=void 0===o?document:o;i(this,e);var a=e.prototype.configs,l=a.selector,s=a.successClass,u=a.validateDelay,c=void 0===u?25:u,f=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,{root:r,selector:l,props:{selector:l,successClass:s},WaferClass:I}));return f._options=N({},f._options,{defaultOffsetY:200,defaultOffsetX:0}),f._validateWithThrottle=X(function(){f.validate()},c,f),f.sync(),f}return a(e,t),B(e,[{key:"handleScroll",value:function(){this._validateWithThrottle()}},{key:"handleResize",value:function(){this._validateWithThrottle()}},{key:"willValidate",value:function(){var t=this._state.elementInstances,e=!0,o=!1,r=void 0;try{for(var i,n=t.entries()[Symbol.iterator]();!(e=(i=n.next()).done);e=!0){var a=i.value,l=W(a,2),s=l[0],u=l[1],c=u.instance,f=c.config,d=f.trigger,p=f.offsetX,y=f.offsetY;switch(d){case"onLoad":c.renderTooltip();break;case"viewport":default:Y(s,{offsetX:p,offsetY:y},F.viewport)?c.showTooltip():c.hideTooltip()}}}catch(t){o=!0,r=t}finally{try{!e&&n.return&&n.return()}finally{if(o)throw r}}}}]),e}(K);M.prototype.configs={selector:".wafer-tooltip",successClass:"wafer-tooltip-done"};var V=M;e.default=new V({selector:V.prototype.configs.selector})}})});